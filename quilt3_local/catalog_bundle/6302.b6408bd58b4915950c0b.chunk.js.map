{"version":3,"file":"6302.b6408bd58b4915950c0b.chunk.js","mappings":"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","sources":["webpack://quilt-navigator/./app/utils/MetaTitle.tsx","webpack://quilt-navigator/./app/containers/Search/Search.js","webpack://quilt-navigator/./app/utils/useEditableValue.js"],"sourcesContent":["import * as React from 'react'\nimport { Helmet } from 'react-helmet'\n\nconst BASE = 'Quilt is a versioned data hub for AWS'\n\nconst DIVIDER = ' â€¢ '\n\ninterface MetaTitleProps {\n  children?: string | string[]\n  base?: string\n}\n\nfunction getTitleSegments(base: string, children?: string | string[]) {\n  if (!children) return [base]\n\n  if (Array.isArray(children)) return [...children, base]\n\n  return [children, base]\n}\n\nexport function getTitle(base: string, children?: string | string[]) {\n  return getTitleSegments(base, children).join(DIVIDER)\n}\n\nexport default function MetaTitle({ children, base = BASE }: MetaTitleProps) {\n  return (\n    <Helmet>\n      <title>{getTitle(base, children)}</title>\n    </Helmet>\n  )\n}\n","import * as R from 'ramda'\nimport * as React from 'react'\nimport { useHistory } from 'react-router-dom'\nimport * as M from '@material-ui/core'\n\nimport Layout from 'components/Layout'\nimport * as SearchResults from 'components/SearchResults'\nimport * as BucketConfig from 'utils/BucketConfig'\nimport * as Data from 'utils/Data'\nimport MetaTitle from 'utils/MetaTitle'\nimport * as NamedRoutes from 'utils/NamedRoutes'\nimport parseSearch from 'utils/parseSearch'\nimport useSearch from 'utils/search'\nimport useEditableValue from 'utils/useEditableValue'\n\nfunction Results({ buckets, data, query, page, scrollRef, makePageUrl, retryUrl }) {\n  return data.case({\n    _: () => (\n      <SearchResults.Progress>\n        Searching {displaySelectedBuckets(buckets)} for &quot;{query}&quot;\n      </SearchResults.Progress>\n    ),\n    Err: SearchResults.handleErr(retryUrl),\n    Ok: ({ total, hits }) =>\n      total ? (\n        <SearchResults.Hits {...{ hits, page, scrollRef, makePageUrl }} showBucket />\n      ) : (\n        <SearchResults.NothingFound />\n      ),\n  })\n}\n\nconst displaySelectedBuckets = (buckets) => {\n  if (!buckets.length) return 'all buckets'\n  if (buckets.length === 1) return `s3://${buckets[0]}`\n  return `${buckets.length} buckets`\n}\n\nconst useQueryInputStyles = M.makeStyles((t) => ({\n  searchIcon: {\n    left: 8,\n    pointerEvents: 'none',\n    position: 'absolute',\n  },\n  input: {\n    paddingLeft: t.spacing(5),\n    paddingRight: t.spacing(1),\n    paddingBottom: 11,\n    paddingTop: 10,\n    [t.breakpoints.down('xs')]: {\n      paddingBottom: 15,\n      paddingTop: 14,\n    },\n  },\n}))\n\nfunction QueryInput({ query, buckets, onChange }) {\n  const classes = useQueryInputStyles()\n  const state = useEditableValue(query, onChange)\n  const { change, commit } = state\n\n  const handleChange = React.useCallback(\n    (e) => {\n      change(e.target.value)\n    },\n    [change],\n  )\n\n  const handleKeyDown = React.useCallback(\n    (e) => {\n      // eslint-disable-next-line default-case\n      switch (e.key) {\n        case 'Enter':\n          // suppress onSubmit (didn't actually find this to be a problem tho)\n          e.preventDefault()\n          commit()\n          e.target.blur()\n          break\n        case 'Escape':\n          e.target.blur()\n          break\n      }\n    },\n    [commit],\n  )\n\n  const t = M.useTheme()\n  const xs = M.useMediaQuery(t.breakpoints.down('xs'))\n  const placeholder = xs ? `Search ${displaySelectedBuckets(buckets)}` : 'Search'\n\n  return (\n    <M.InputBase\n      value={state.value}\n      onFocus={state.edit}\n      onBlur={state.cancel}\n      onChange={handleChange}\n      onKeyDown={handleKeyDown}\n      placeholder={placeholder}\n      classes={{ input: classes.input }}\n      fullWidth\n      startAdornment={<M.Icon className={classes.searchIcon}>search</M.Icon>}\n    />\n  )\n}\n\nconst useBucketSelectDropdownStyles = M.makeStyles((t) => ({\n  btn: {\n    MozAppearance: 'none',\n    WebkitAppearance: 'none',\n    WebkitTapHighlightColor: 'transparent',\n    display: 'inline-flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: 'transparent',\n    outline: 0,\n    border: 0,\n    margin: 0,\n    borderRadius: 0,\n    padding: 0,\n    userSelect: 'none',\n\n    ...t.typography.body1,\n    cursor: 'pointer',\n  },\n}))\n\nfunction BucketSelectDropdown({ buckets, onChange, short = false }) {\n  const classes = useBucketSelectDropdownStyles()\n  const state = useEditableValue(buckets, onChange)\n  const { commitValue } = state\n\n  const options = BucketConfig.useRelevantBucketConfigs()\n\n  const anchorRef = React.useRef(null)\n\n  const handleSelect = (v) => () => {\n    state.change(\n      R.ifElse(\n        R.includes(v),\n        R.without([v]),\n        R.pipe(R.append(v), R.sortBy(R.identity)),\n      )(state.value),\n    )\n  }\n\n  const selectAll = React.useCallback(() => {\n    commitValue([])\n  }, [commitValue])\n\n  return (\n    <>\n      <button type=\"button\" onClick={state.edit} className={classes.btn} ref={anchorRef}>\n        <span>{short ? <>s3://&hellip;</> : displaySelectedBuckets(state.value)}</span>\n        <M.Icon fontSize=\"inherit\">expand_more</M.Icon>\n      </button>\n      <M.Menu\n        anchorEl={anchorRef.current}\n        open={state.edited}\n        onClose={state.commit}\n        MenuListProps={{ dense: true }}\n      >\n        <M.MenuItem disabled>\n          <M.ListItemText primary=\"Select buckets to search\" />\n        </M.MenuItem>\n        <M.MenuItem selected={!state.value.length} onClick={selectAll}>\n          <M.ListItemIcon>\n            <M.Checkbox checked={!state.value.length} edge=\"start\" />\n          </M.ListItemIcon>\n          <M.ListItemText primary=\"All buckets\" />\n        </M.MenuItem>\n        {options.map((o) => (\n          <M.MenuItem\n            key={o.name}\n            onClick={handleSelect(o.name)}\n            selected={state.value.includes(o.name)}\n          >\n            <M.ListItemIcon>\n              <M.Checkbox checked={state.value.includes(o.name)} edge=\"start\" />\n            </M.ListItemIcon>\n            <M.ListItemText primary={o.title} secondary={`s3://${o.name}`} />\n          </M.MenuItem>\n        ))}\n      </M.Menu>\n    </>\n  )\n}\n\nfunction SearchStats({ data }) {\n  return data.case({\n    _: () => '',\n    Ok: ({ total }) => (\n      <M.Typography variant=\"body1\" component=\"span\">\n        {total} results\n      </M.Typography>\n    ),\n  })\n}\n\nconst displayMode = (m) => {\n  if (m === 'packages') return 'packages'\n  if (m === 'objects') return 'objects'\n  return 'objects & packages'\n}\n\nfunction ModeSelectDropdown({ mode, onChange }) {\n  const classes = useBucketSelectDropdownStyles()\n  const options = [undefined, 'objects', 'packages']\n\n  const [edited, setEdited] = React.useState(false)\n\n  const edit = React.useCallback(() => setEdited(true), [setEdited])\n  const close = React.useCallback(() => setEdited(false), [setEdited])\n\n  const anchorRef = React.useRef(null)\n\n  const handleSelect = (v) => () => {\n    onChange(v)\n    close()\n  }\n\n  return (\n    <>\n      <button type=\"button\" onClick={edit} className={classes.btn} ref={anchorRef}>\n        {displayMode(mode)}\n        <M.Icon fontSize=\"inherit\">expand_more</M.Icon>\n      </button>\n      <M.Menu\n        anchorEl={anchorRef.current}\n        open={edited}\n        onClose={close}\n        MenuListProps={{ dense: true }}\n      >\n        {options.map((o) => (\n          <M.MenuItem key={o || 'all'} onClick={handleSelect(o)} selected={mode === o}>\n            <M.ListItemText primary={displayMode(o)} />\n          </M.MenuItem>\n        ))}\n      </M.Menu>\n    </>\n  )\n}\n\nconst useModeAndBucketSelectorStyles = M.makeStyles((t) => ({\n  overlay: {\n    background: t.palette.common.white,\n    bottom: 0,\n    display: 'flex',\n    justifyContent: 'space-between',\n    left: 44,\n    paddingRight: 4,\n    position: 'absolute',\n    right: 0,\n    top: 0,\n  },\n  controls: {\n    lineHeight: '48px',\n  },\n}))\n\nfunction ModeAndBucketSelector({ mode, onModeChange, buckets, onBucketsChange }) {\n  const classes = useModeAndBucketSelectorStyles()\n  const t = M.useTheme()\n  const xs = M.useMediaQuery(t.breakpoints.down('xs'))\n\n  const [controlsShown, setControlsShown] = React.useState(false)\n  const showControls = React.useCallback(() => setControlsShown(true), [setControlsShown])\n  const hideControls = React.useCallback(\n    () => setControlsShown(false),\n    [setControlsShown],\n  )\n\n  const controls = (\n    <>\n      {!xs && <M.Typography component=\"span\">Searching </M.Typography>}\n      <ModeSelectDropdown mode={mode} onChange={onModeChange} />\n      <M.Typography component=\"span\"> in </M.Typography>\n      <BucketSelectDropdown buckets={buckets} onChange={onBucketsChange} short={xs} />\n    </>\n  )\n\n  return xs ? (\n    <>\n      <M.IconButton onClick={showControls}>\n        <M.Icon>menu</M.Icon>\n      </M.IconButton>\n      {controlsShown && (\n        <div className={classes.overlay}>\n          <div className={classes.controls}>{controls}</div>\n          <M.IconButton onClick={hideControls}>\n            <M.Icon>done</M.Icon>\n          </M.IconButton>\n        </div>\n      )}\n    </>\n  ) : (\n    controls\n  )\n}\n\nconst useSearchStyles = M.makeStyles((t) => ({\n  paper: {\n    paddingLeft: t.spacing(1.5),\n    paddingRight: t.spacing(1),\n    lineHeight: '40px',\n\n    [t.breakpoints.down('xs')]: {\n      borderRadius: 0,\n      boxShadow: 'none',\n      '&:first-child': {\n        paddingLeft: t.spacing(0.5),\n      },\n      '&:last-child': {\n        paddingRight: t.spacing(0.5),\n      },\n    },\n  },\n  stats: {\n    flexGrow: 1,\n    lineHeight: '40px',\n    padding: t.spacing(0, 3),\n    textAlign: 'right',\n    [t.breakpoints.down('xs')]: {\n      display: 'none',\n    },\n  },\n}))\n\nexport default function Search({ location: l }) {\n  const classes = useSearchStyles()\n\n  const { q, p, mode, ...params } = parseSearch(l.search)\n  const buckets = React.useMemo(\n    () => (params.buckets ? params.buckets.split(',').sort() : []),\n    [params.buckets],\n  )\n  const retry = (params.retry && parseInt(params.retry, 10)) || undefined\n  const page = p && parseInt(p, 10)\n\n  const scrollRef = React.useRef(null)\n\n  const { urls } = NamedRoutes.use()\n  const history = useHistory()\n\n  const handleQueryChange = React.useCallback(\n    (newQuery) => {\n      history.push(\n        urls.search({ q: newQuery, buckets: buckets.join(',') || undefined, mode }),\n      )\n    },\n    [history, urls, buckets, mode],\n  )\n\n  const handleBucketsChange = React.useCallback(\n    (newBuckets) => {\n      history.push(urls.search({ q, buckets: newBuckets.join(',') || undefined, mode }))\n    },\n    [history, urls, q, mode],\n  )\n\n  const handleModeChange = React.useCallback(\n    (newMode) => {\n      history.push(\n        urls.search({ q, buckets: buckets.join(',') || undefined, mode: newMode }),\n      )\n    },\n    [history, urls, buckets, q],\n  )\n\n  const retryUrl = urls.search({\n    q,\n    mode,\n    buckets: buckets.join(',') || undefined,\n    retry: (retry || 0) + 1,\n  })\n\n  const makePageUrl = React.useCallback(\n    (newP) =>\n      urls.search({\n        q,\n        buckets: buckets.join(',') || undefined,\n        p: newP !== 1 ? newP : undefined,\n        mode,\n        retry,\n      }),\n    [urls, q, buckets, mode, retry],\n  )\n\n  const data = Data.use(\n    useSearch(),\n    { buckets, mode, query: q, retry },\n    { noAutoFetch: !q },\n  )\n\n  return (\n    <Layout\n      pre={\n        <M.Container maxWidth=\"lg\">\n          <MetaTitle>{q || 'Search'}</MetaTitle>\n          <M.Box pb={{ xs: 0, sm: 5 }} mx={{ xs: -2, sm: 0 }}>\n            <M.Box\n              display=\"flex\"\n              position=\"relative\"\n              mt={{ xs: 0, sm: 3 }}\n              ref={scrollRef}\n            >\n              <M.Box\n                component={M.Paper}\n                className={classes.paper}\n                flexGrow={{ xs: 1, sm: 0 }}\n                position=\"relative\"\n              >\n                <QueryInput\n                  query={q || ''}\n                  buckets={buckets}\n                  onChange={handleQueryChange}\n                />\n              </M.Box>\n              <div className={classes.stats}>{!!q && <SearchStats data={data} />}</div>\n              <M.Box component={M.Paper} className={classes.paper}>\n                <ModeAndBucketSelector\n                  mode={mode}\n                  onModeChange={handleModeChange}\n                  buckets={buckets}\n                  onBucketsChange={handleBucketsChange}\n                />\n              </M.Box>\n            </M.Box>\n            {q ? (\n              <Results\n                {...{\n                  data,\n                  query: q,\n                  buckets,\n                  page,\n                  scrollRef,\n                  makePageUrl,\n                  retryUrl,\n                }}\n              />\n            ) : (\n              // TODO: revise copy\n              <SearchResults.Alt>\n                <M.Typography variant=\"body1\">Search for anything</M.Typography>\n              </SearchResults.Alt>\n            )}\n          </M.Box>\n        </M.Container>\n      }\n    />\n  )\n}\n","import * as R from 'ramda'\nimport * as React from 'react'\n\nimport tagged from 'utils/tagged'\nimport useMemoEq from 'utils/useMemoEq'\n\nconst State = tagged([\n  'Idle',\n  'Edited', // value\n])\n\nexport default function useEditableValue(externalValue, onCommit) {\n  const [state, setState] = React.useState(State.Idle())\n\n  const edit = React.useCallback(() => {\n    setState(State.Edited(externalValue))\n  }, [externalValue])\n\n  const cancel = React.useCallback(() => {\n    setState(State.Idle())\n  }, [])\n\n  const change = React.useCallback((v) => {\n    setState(State.mapCase({ Edited: () => v }))\n  }, [])\n\n  const commit = React.useCallback(() => {\n    State.case(\n      {\n        Edited: (v) => {\n          if (!R.equals(externalValue, v)) onCommit(v)\n          cancel()\n        },\n        _: () => {},\n      },\n      state,\n    )\n  }, [externalValue, onCommit, cancel, state])\n\n  const isEdited = State.Edited.is(state)\n  const commitValue = React.useCallback(\n    (v) => {\n      if (!isEdited) return\n      if (!R.equals(externalValue, v)) onCommit(v)\n      cancel()\n    },\n    [externalValue, onCommit, cancel, isEdited],\n  )\n\n  const value = useMemoEq([state, externalValue], () =>\n    State.case({ Idle: () => externalValue, Edited: (v) => v }, state),\n  )\n\n  const edited = useMemoEq(state, State.Edited.is)\n\n  return { value, edited, edit, cancel, change, commit, commitValue }\n}\n"],"names":["getTitle","base","children","Array","isArray","getTitleSegments","join","MetaTitle","Results","buckets","data","query","page","scrollRef","makePageUrl","retryUrl","case","_","SearchResults","displaySelectedBuckets","Err","Ok","total","hits","showBucket","length","useQueryInputStyles","t","searchIcon","left","pointerEvents","position","input","paddingLeft","spacing","paddingRight","paddingBottom","paddingTop","breakpoints","down","QueryInput","onChange","classes","state","useEditableValue","change","commit","handleChange","e","target","value","handleKeyDown","key","preventDefault","blur","placeholder","onFocus","edit","onBlur","cancel","onKeyDown","fullWidth","startAdornment","className","useBucketSelectDropdownStyles","btn","MozAppearance","WebkitAppearance","WebkitTapHighlightColor","display","alignItems","justifyContent","backgroundColor","outline","border","margin","borderRadius","padding","userSelect","typography","body1","cursor","BucketSelectDropdown","short","commitValue","options","BucketConfig","anchorRef","selectAll","type","onClick","ref","fontSize","anchorEl","current","open","edited","onClose","MenuListProps","dense","disabled","primary","selected","checked","edge","map","o","name","v","includes","title","secondary","SearchStats","variant","component","displayMode","m","ModeSelectDropdown","mode","undefined","setEdited","close","useModeAndBucketSelectorStyles","overlay","background","palette","common","white","bottom","right","top","controls","lineHeight","ModeAndBucketSelector","onModeChange","onBucketsChange","xs","controlsShown","setControlsShown","showControls","hideControls","useSearchStyles","paper","boxShadow","stats","flexGrow","textAlign","Search","l","parseSearch","search","q","p","params","split","sort","retry","parseInt","urls","NamedRoutes","history","handleQueryChange","newQuery","push","handleBucketsChange","newBuckets","handleModeChange","newMode","newP","Data","noAutoFetch","Layout","pre","maxWidth","pb","sm","mx","mt","State","externalValue","onCommit","Idle","setState","Edited","mapCase","isEdited","is"],"sourceRoot":""}