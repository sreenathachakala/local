"use strict";(self.webpackChunkquilt_navigator=self.webpackChunkquilt_navigator||[]).push([[582],{62828:(e,n,a)=>{a.d(n,{E:()=>f,Z:()=>b});var t=a(70655),i=a(94184),r=a.n(i),l=a(87553),o=a(67294),c=a(41120),s=a(22318),u=a(92863),m=a(23307),d=a(99643),k=a(42059),p=c.Z((function(e){return{root:{alignItems:"center",display:"inline-flex"},icon:{color:e.palette.text.hint,fontSize:16,marginRight:"2px"}}}));function v(e){var n=e.className,a=e.children,i=(0,t._T)(e,["className","children"]),l=p();return o.createElement(s.Z,(0,t.pi)({className:r()(l.root,n),component:"span",variant:"body2"},i),a)}function h(e){var n=e.className,a=g();return o.createElement("div",{className:r()(a.root,n)},o.createElement(m.Z,{animate:!0,className:a.property,width:"80px",height:"14px"}),o.createElement(m.Z,{animate:!0,className:a.property,width:"80px",height:"14px"}))}var g=c.Z((function(e){return{root:{alignItems:"center",display:"flex"},property:{marginLeft:e.spacing(1)}}}));function f(e){var n=e.className,a=e.lastModified,t=e.size,i=g(),c=o.useMemo((function(){return new Date}),[]),s=o.useMemo((function(){return a?l.Z(a,c.getFullYear()===a.getFullYear()?"d MMM":"d MMM yyyy"):null}),[a,c]),u=o.useMemo((function(){return(0,d.kR)(t)}),[t]);return o.createElement("div",{className:r()(i.root,n)},s&&o.createElement(v,{title:null==a?void 0:a.toLocaleString(),className:i.property},s),o.createElement(v,{className:i.property},u))}function b(e){var n=e.className,a=e.data,i=g();return o.createElement("div",{className:r()(i.root,n)},a.case({Ok:k.NB.case({Exists:function(e){var a=e.lastModified,i=e.size;return o.createElement(f,(0,t.pi)({},{className:n,lastModified:a,size:i}))},_:function(){return null}}),Err:function(e){return o.createElement(u.Z,{title:"Fetching object info failed: ".concat(e.message),color:"error"},"warning_outline")},_:function(){return o.createElement(h,{className:n})}}))}},30582:(e,n,a)=>{a.r(n),a.d(n,{default:()=>wn});var t=a(70655),i=a(26470),r=a(66518),l=a.n(r),o=a(67826),c=a(13646),s=a(13462),u=a(18549),m=a(36962),d=a(67294),k=a(16550),p=a(73727),v=a(92432),h=a(41120),g=a(10529),f=a(95477),b=a(22318),E=a(282),y=a(17812),N=a(92863),w=a(66869),Z=a(78869),S=a(22534),D=a(20740),F=a(24452),C=a(73179),T=a(52663),P=a(66083),V=a(29525),_=a(66856),O=a(60409),x=a(32248),M=a(55743);var q=a(99643);function A(e){var n,a=this,i=e.onClose,r=e.onConfirm,l=e.open,o=e.size,c=d.useState(null),s=c[0],u=c[1],m=d.useState(!1),k=m[0],p=m[1],v=d.useCallback((function(){return(0,t.mG)(a,void 0,void 0,(function(){var e;return(0,t.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),p(!0),[4,r()];case 1:return n.sent(),p(!1),i(),[3,3];case 2:return(e=n.sent())instanceof Error&&u(e),[3,3];case 3:return[2]}}))}))}),[i,r]);return d.createElement(T.Z,{open:l,onClose:i},d.createElement(P.Z,null,"Open in Teleport"),d.createElement(V.Z,null,d.createElement(b.Z,null,"Download package and open in desktop application"),"number"==typeof(n=o)&&!Number.isNaN(n)&&d.createElement(b.Z,null,"Total size of package is ",(0,q.kR)(o)),d.createElement(b.Z,null,"It could take a while"),s&&d.createElement(w.Z,{severity:"error"},s.message)),d.createElement(_.Z,null,d.createElement(E.Z,{onClick:i},"Cancel"),d.createElement(E.Z,{color:"primary",disabled:k,onClick:v,variant:"contained"},"Confirm")))}var z=function(e,n){var a=this,i=x.D$().desktop,r=O.D$(),l=d.useState(!1),o=l[0],c=l[1],s=d.useCallback((function(){return(0,t.mG)(a,void 0,void 0,(function(){var n;return(0,t.Jh)(this,(function(a){switch(a.label){case 0:return i?[4,r.invoke(O.FP.uh,e)]:[3,2];case 1:return a.sent(),[3,3];case 2:n=function(e){return M.Pz(e).replace("quilt+s3","teleport")}(e),window.location.assign(n),a.label=3;case 3:return[2]}}))}))}),[i,r,e]),u=d.useCallback((function(){return c(!1)}),[]);return{confirm:d.useCallback((function(){!n||n>104857600?c(!0):s()}),[s,n]),confirming:o,openInDesktop:s,unconfirm:u}},I=a(43987),R=a(85693),B=a(13950),L=a(84268),W=a(27474),U=a(57156),$=a(69534),j=a(23915),H=a(82268),G=a(36473),J=a(34314),K=a(62799),Y=a(15592),Q=a(37791),X=a(62828),ee=a(37600),ne=a(25170),ae=a(66688),te=a(98187),ie=a(70397),re=a(30757),le=a(20666),oe=a(31708),ce=a(39795),se=a(87832),ue=a(62782),me=a(47426),de=a(38599),ke={kind:"Document",definitions:(0,t.ev)((0,t.ev)((0,t.ev)([{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"containers_Bucket_PackageDialog_gql_PackagePromote"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"params"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PackagePushParams"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"src"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PackagePromoteSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"packagePromote"},arguments:[{kind:"Argument",name:{kind:"Name",value:"params"},value:{kind:"Variable",name:{kind:"Name",value:"params"}}},{kind:"Argument",name:{kind:"Name",value:"src"},value:{kind:"Variable",name:{kind:"Name",value:"src"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"PackagePushSuccessSelection"}},{kind:"FragmentSpread",name:{kind:"Name",value:"InvalidInputSelection"}},{kind:"FragmentSpread",name:{kind:"Name",value:"OperationErrorSelection"}}]}}]}}],ue.k.definitions,!0),me.t.definitions,!0),de.A.definitions,!0)},pe=a(42059),ve=h.Z((function(e){return{meta:{marginTop:e.spacing(3)}}}));function he(e){var n=e.animate,a=ve();return d.createElement(d.Fragment,null,d.createElement(se.H4,{animate:n}),d.createElement(se.H4,{animate:n}),d.createElement(se.BA,{className:a.meta,animate:n}),d.createElement(se.bF,{animate:n}))}function ge(e){var n=e.bucket,a=$.D$().urls;return d.createElement(P.Z,null,"Push package to"," ",d.createElement(ie.Z,{target:"_blank",to:a.bucketOverview(n)},n)," ","bucket")}var fe=h.Z((function(e){return{form:{display:"flex",flexDirection:"column",height:"100%",overflowY:"auto"},meta:{display:"flex",flexDirection:"column",paddingTop:e.spacing(3),overflowY:"auto"}}}));function be(e){var n=this,a=e.bucket,i=e.close,r=e.hash,l=e.initialMeta,o=e.name,s=e.responseError,u=e.schema,m=e.schemaLoading,k=e.selectedWorkflow,p=e.setSubmitting,h=e.setSuccess,f=e.setWorkflow,y=e.successor,w=e.validate,Z=e.workflowsConfig,S=se.Wk(k),D=se.OW(y.slug),F=d.useState(""),C=F[0],T=F[1],P=d.useState(0),O=P[0],x=P[1],M=fe(),q=se.qi(Z),A=v.Db(ke)[1],z=function(e){var i=e.commitMessage,l=e.name,c=e.meta,s=e.workflow;return(0,t.mG)(n,void 0,void 0,(function(){var e,n,m,d;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,A({params:{bucket:y.slug,name:l,message:i,userMeta:null!==(d=pe.au(c,u))&&void 0!==d?d:null,workflow:s.slug===ce.h8?null:s.slug===ce.xW?"":s.slug},src:{bucket:a,name:o,hash:r}})];case 1:if((e=t.sent()).error)throw e.error;if(!e.data)throw new Error("No data returned by the API");switch((n=e.data.packagePromote).__typename){case"PackagePushSuccess":return h({name:l,hash:n.revision.hash,bucket:y.slug}),[2];case"OperationError":return[2,(0,re.D)(n.message)];case"InvalidInput":return[2,(0,re.k)(n.errors)];default:(0,j.Z)(n)}return[3,3];case 2:return m=t.sent(),console.error("Error creating manifest:"),console.error(m),[2,(0,re.D)(m.message?"Unexpected error: ".concat(m.message):se.RZ.MANIFEST)];case 3:return[2]}}))}))},I=d.useCallback((function(e){return(0,t.mG)(n,void 0,void 0,(function(){var n,a;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return[4,D.validate(e)];case 1:return n=t.sent(),(a=d.createElement(se.Nt,{exists:!!n}))!==C&&T(a),[2]}}))}))}),[C,D]),R=d.useState(null),B=R[0],L=R[1],W=d.useMemo((function(){return new window.ResizeObserver((function(e){var n=e[0].contentRect.height;x(n)}))}),[x]),U=d.useState(!1),$=U[0],H=U[1],G=d.useCallback((function(e){var a=e.modified,i=e.values;return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){return a.workflow&&i.workflow!==k&&(f(i.workflow),H(!0),setTimeout((function(){H(!1)}),300)),I(i.name),[2]}))}))}),[I,k,f]);d.useEffect((function(){return B&&W.observe(B),function(){B&&W.unobserve(B)}}),[B,W]);var J=se.cD({metaHeight:O});return d.createElement(ae.l0,{onSubmit:function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){switch(n.label){case 0:p(!0),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,z.apply(void 0,e)];case 2:return[2,n.sent()];case 3:return p(!1),[7];case 4:return[2]}}))}))},subscription:{error:!0,hasValidationErrors:!0,submitError:!0,submitFailed:!0,submitting:!0}},(function(e){var n=e.error,t=e.hasValidationErrors,r=e.submitError,p=e.submitFailed,v=e.submitting,h=e.handleSubmit;return d.createElement(d.Fragment,null,d.createElement(ge,{bucket:y.slug}),d.createElement(V.Z,{classes:J},d.createElement("form",{onSubmit:h,className:M.form},d.createElement(ae.lP,{subscription:{modified:!0,values:!0},onChange:G}),d.createElement(ae.lP,{subscription:{modified:!0,values:!0},onChange:function(e){var n=e.modified,a=e.values;(null==n?void 0:n.workflow)&&f(a.workflow)}}),d.createElement(ae.gN,{component:se.Wr,bucket:a,name:"workflow",workflowsConfig:Z,initialValue:k,validate:q,validateFields:["meta","workflow"],errors:{required:"Workflow is required for this bucket."}}),d.createElement(ae.gN,{component:se.rr,name:"name",workflow:k||Z,validate:oe.ne(oe.C1,S.validate),validateFields:["name"],errors:{required:"Enter a package name",invalid:"Invalid package name",pattern:"Name should match ".concat(null==k?void 0:k.packageNamePattern)},helperText:C,initialValue:o}),d.createElement(ae.gN,{component:se.WZ,name:"commitMessage",validate:oe.C1,validateFields:["commitMessage"],errors:{required:"Enter a commit message"}}),m||$?d.createElement(se.BA,{className:M.meta,ref:L}):d.createElement(ae.gN,{className:M.meta,component:se.fc,name:"meta",bucket:y.slug,schema:u,schemaError:s,validate:w,validateFields:["meta"],isEqual:c.Z,ref:L,initialValue:l}),d.createElement("input",{type:"submit",style:{display:"none"}}))),d.createElement(_.Z,null,v&&d.createElement(se.RY,null,y.copyData?"Copying files and writing manifest":"Writing manifest"),!v&&(!!n||!!r)&&d.createElement(g.Z,{flexGrow:1,display:"flex",alignItems:"center",pl:2},d.createElement(N.Z,{color:"error"},"error_outline"),d.createElement(g.Z,{pl:1}),d.createElement(b.Z,{variant:"body2",color:"error"},n||r)),d.createElement(E.Z,{onClick:i,disabled:v},"Cancel"),d.createElement(E.Z,{onClick:h,variant:"contained",color:"primary",disabled:v||p&&t},"Push")))}))}function Ee(e){var n=e.bucket,a=e.error,t=e.onCancel,i=$.D$().urls;return d.createElement(se.Ss,{bucket:n,error:a,skeletonElement:d.createElement(he,{animate:!1}),title:d.createElement(d.Fragment,null,"Push package to"," ",d.createElement(ie.Z,{target:"_blank",to:i.bucketOverview(n)},n)," ","bucket"),onCancel:t})}function ye(e){var n=e.bucket,a=e.onCancel,t=$.D$().urls;return d.createElement(se.HI,{skeletonElement:d.createElement(he,null),title:d.createElement(d.Fragment,null,"Push package to"," ",d.createElement(ie.Z,{target:"_blank",to:t.bucketOverview(n)},n)," ","bucket"),onCancel:a})}var Ne=le.U("app/containers/Bucket/PackageCopyDialog:DialogState",{Loading:function(){},Error:function(e){return e},Form:function(e){return e},Success:function(e){return e}});function we(e){var n=e.open,a=e.bucket,i=e.successor,r=e.name,l=e.hash,o=e.onExited,c=R.S3.use(),s=d.useState(null),u=s[0],m=s[1],k=d.useState(!1),p=k[0],v=k[1],h=d.useState(),g=h[0],f=h[1],b=se.px({bucket:a,name:r,hash:l,skipEntries:!0,pause:!i||!n}),E=L.D$(pe.sq,{s3:c,bucket:i?i.slug:""},{noAutoFetch:!i||!n}),y=d.useMemo((function(){return u?Ne.Success(u):E.case({Ok:function(e){return b.case({Ok:function(n){return Ne.Form({manifest:n,workflowsConfig:e})},Err:Ne.Error,_:Ne.Loading})},Err:Ne.Error,_:Ne.Loading})}),[u,E,b]),N=d.useCallback((function(){p||(o({pushed:u}),m(null))}),[p,u,m,o]),w=d.useCallback((function(){p||(o({pushed:u}),m(null))}),[p,u,m,o]);return te.r3(n),d.createElement(T.Z,{fullWidth:!0,onClose:w,onExited:N,open:n,scroll:"body"},Ne.match({Error:function(e){return i&&d.createElement(Ee,{bucket:i.slug,onCancel:w,error:e})},Loading:function(){return i&&d.createElement(ye,{bucket:i.slug,onCancel:w})},Form:function(e){var n=e.manifest,o=e.workflowsConfig;return i&&d.createElement(se.ux,{initialWorkflowId:n.workflowId,workflowsConfig:o,workflow:g},(function(e){return d.createElement(be,(0,t.pi)({},e,{bucket:a,close:w,setSubmitting:v,setSuccess:m,setWorkflow:f,workflowsConfig:o,initialMeta:n.meta,hash:l,name:r,successor:i}))}))},Success:function(e){return i&&d.createElement(se.wx,(0,t.pi)({},e,{onClose:w}))}})(y))}var Ze=a(6709),Se=a(35992),De=a(29039),Fe=a(41973),Ce=a(73206),Te=a(9982),Pe=a(64395),Ve=h.Z({name:{wordBreak:"break-all"}});function _e(e){var n=e.bucket,a=e.name,t=Ve(),i=$.D$().urls,r=a.split("/"),l=r[0],o=r[1];return d.createElement("span",{className:t.name},d.createElement(ie.Z,{to:i.bucketPackageList(n,{filter:"".concat(l,"/")})},l,"/"),d.createElement(ie.Z,{to:i.bucketPackageDetail(n,a)},o))}var Oe=a(7212),xe=a(41810),Me=a(31733),qe=h.Z((function(e){return{danger:{color:e.palette.error.dark},lock:{alignItems:"center",background:"rgba(255,255,255,0.7)",border:"1px solid ".concat(e.palette.action.disabled),borderRadius:e.shape.borderRadius,bottom:0,cursor:"not-allowed",display:"flex",flexDirection:"column",justifyContent:"center",left:0,position:"absolute",right:0,top:0},progressContainer:{display:"flex",position:"relative"}}}));function Ae(e){var n=e.error,a=e.loading,t=e.onClose,i=e.onDelete,r=e.open,l=e.packageHandle,o=qe(),c=d.useCallback((function(){i(l)}),[l,i]),s=d.useCallback((function(){a||t()}),[a,t]);return d.createElement(T.Z,{"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",open:r,onClose:s},d.createElement(P.Z,{id:"alert-dialog-title"},"Really delete revision"," ",d.createElement(xe.Z,null,Me.zL(l.hash))," of"," ",d.createElement(xe.Z,null,l.name),"?"),d.createElement(V.Z,{id:"alert-dialog-description"},d.createElement(Oe.Z,null,"This package revision will be lost forever. Package deletion does not delete objects in the package, but it does delete all metadata and all records of the contents of this revision. Are you sure you want to delete it?"),!!n&&d.createElement(w.Z,{severity:"error"},n)),d.createElement(_.Z,null,d.createElement(E.Z,{onClick:s,color:"primary",autoFocus:!0,disabled:a},"Cancel"),d.createElement(E.Z,{onClick:c,className:o.danger,disabled:a},"Yes, delete it")),a&&d.createElement("div",{className:o.lock},d.createElement("div",{className:o.progressContainer},d.createElement(f.Z,{size:80,variant:"indeterminate"}))))}var ze=a(94184),Ie=a.n(ze),Re=a(87553),Be=a(52387),Le=a(62822),We=a(50998),Ue=a(95757),$e=a(81860),je=a(46869),He=a(55517),Ge=a(67456),Je=a(9961),Ke=h.Z((function(e){return{revision:(0,t.pi)((0,t.pi)({},ie.R),{alignItems:"center",display:"inline-flex"}),mono:{fontFamily:e.typography.monospace.fontFamily},line:{whiteSpace:"nowrap"},secondaryText:{display:"block",height:40,overflow:"hidden",textOverflow:"ellipsis"},list:{width:420}}}));function Ye(e){var n=e.bucket,a=e.name,t=e.hash,i=e.hashOrTag,r=e.path,l=e.revisionListQuery,c=$.D$().urls,s=Ge.D$().push,u=Ke(),m=d.useRef(null),k=d.useState(null),v=k[0],h=k[1],E=d.useState(!1),w=E[0],Z=E[1],S=d.useCallback((function(){return Z(!0)}),[]),D=d.useCallback((function(){return Z(!1)}),[]),F=function(e){return"".concat(window.origin).concat(c.bucketPackageTree(n,a,e,r))},C=function(e,n){return function(a){a.preventDefault(),(0,Je.Z)(F(e),{container:(null==n?void 0:n.current)||void 0}),s("Canonical URI copied to clipboard")}};return d.createElement(d.Fragment,null,d.createElement("span",{className:u.revision,onClick:S,ref:h,title:i.length>10?i:void 0},o.Z(10,i)," ",d.createElement(N.Z,null,"expand_more")),!!t&&d.createElement(y.Z,{size:"small",title:"Copy package revision's canonical catalog URI to the clipboard",href:F(t),onClick:C(t),style:{marginTop:-4,marginBottom:-4}},d.createElement(N.Z,null,"link")),d.createElement(Be.ZP,{open:w&&!!v,anchorEl:v,onClose:D,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},d.createElement(Le.Z,{className:u.list,ref:m},l.case({data:function(e){return e.package?e.package.revisions.page.map((function(e){return d.createElement(We.Z,{key:"".concat(e.hash,":").concat(e.modified.valueOf()),button:!0,onClick:D,selected:e.hash===t,component:p.Link,to:c.bucketPackageTree(n,a,e.hash,r)},d.createElement(Ue.Z,{primary:Re.Z(e.modified,"MMMM do yyyy - h:mma"),secondary:d.createElement("span",{className:u.secondaryText},d.createElement("span",{className:u.line},e.message||d.createElement("i",null,"No message")),d.createElement("br",null),d.createElement("span",{className:Ie()(u.line,u.mono)},e.hash))}),d.createElement($e.Z,null,d.createElement(y.Z,{title:"Copy package revision's canonical catalog URI to the clipboard",href:F(e.hash),onClick:C(e.hash,m)},d.createElement(N.Z,null,"link"))))})):d.createElement(We.Z,null,d.createElement(Ue.Z,{primary:"No revisions found",secondary:"Looks like this package has been deleted"}))},error:function(){return d.createElement(We.Z,null,d.createElement(je.Z,null,d.createElement(N.Z,null,"error")),d.createElement(b.Z,{variant:"body1"},"Error fetching revisions"))},fetching:function(){return d.createElement(We.Z,null,d.createElement(je.Z,null,d.createElement(f.Z,{size:24})),d.createElement(b.Z,{variant:"body1"},"Fetching revisions"))}}),d.createElement(He.Z,null),d.createElement(We.Z,{button:!0,onClick:D,component:p.Link,to:c.bucketPackageRevisions(n,a)},d.createElement(g.Z,{textAlign:"center",width:"100%"},"Show all revisions")))))}var Qe=a(54208);function Xe(e){var n=e.className,a=e.onCreateFile,t=e.onDelete,i=e.onDesktop,r=B.D$().preferences,l=x.D$().desktop,o=d.useMemo((function(){var e,n,o,c,s,u,m=[];return(null===(n=null===(e=null==r?void 0:r.ui)||void 0===e?void 0:e.actions)||void 0===n?void 0:n.revisePackage)&&m.push({onClick:a,title:"Create file"}),(null===(c=null===(o=null==r?void 0:r.ui)||void 0===o?void 0:o.actions)||void 0===c?void 0:c.deleteRevision)&&m.push({onClick:t,title:"Delete revision"}),(null===(u=null===(s=null==r?void 0:r.ui)||void 0===s?void 0:s.actions)||void 0===u?void 0:u.openInDesktop)&&!l&&m.push({onClick:i,title:"Open in Teleport"}),m}),[l,a,t,i,r]);return o.length?d.createElement(Qe.Z,{className:n,items:o}):null}var en={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"containers_Bucket_PackageTree_gql_Revision"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bucket"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hashOrTag"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"package"},arguments:[{kind:"Argument",name:{kind:"Name",value:"bucket"},value:{kind:"Variable",name:{kind:"Name",value:"bucket"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bucket"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"revision"},arguments:[{kind:"Argument",name:{kind:"Name",value:"hashOrTag"},value:{kind:"Variable",name:{kind:"Name",value:"hashOrTag"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hash"}},{kind:"Field",name:{kind:"Name",value:"totalBytes"}}]}}]}}]}}]},nn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"containers_Bucket_PackageTree_gql_RevisionList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bucket"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"package"},arguments:[{kind:"Argument",name:{kind:"Name",value:"bucket"},value:{kind:"Variable",name:{kind:"Name",value:"bucket"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bucket"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"revisions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"page"},arguments:[{kind:"Argument",name:{kind:"Name",value:"number"},value:{kind:"IntValue",value:"1"}},{kind:"Argument",name:{kind:"Name",value:"perPage"},value:{kind:"IntValue",value:"5"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hash"}},{kind:"Field",name:{kind:"Name",value:"modified"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}}]}}]},an={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"containers_Bucket_PackageTree_gql_Dir"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bucket"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hash"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"path"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"package"},arguments:[{kind:"Argument",name:{kind:"Name",value:"bucket"},value:{kind:"Variable",name:{kind:"Name",value:"bucket"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bucket"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"revision"},arguments:[{kind:"Argument",name:{kind:"Name",value:"hashOrTag"},value:{kind:"Variable",name:{kind:"Name",value:"hash"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hash"}},{kind:"Field",name:{kind:"Name",value:"dir"},arguments:[{kind:"Argument",name:{kind:"Name",value:"path"},value:{kind:"Variable",name:{kind:"Name",value:"path"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"path"}},{kind:"Field",name:{kind:"Name",value:"metadata"}},{kind:"Field",name:{kind:"Name",value:"children"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PackageFile"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"path"}},{kind:"Field",name:{kind:"Name",value:"size"}},{kind:"Field",name:{kind:"Name",value:"physicalKey"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PackageDir"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"path"}},{kind:"Field",name:{kind:"Name",value:"size"}}]}}]}}]}}]}}]}}]}}]},tn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"containers_Bucket_PackageTree_gql_File"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bucket"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hash"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"path"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"package"},arguments:[{kind:"Argument",name:{kind:"Name",value:"bucket"},value:{kind:"Variable",name:{kind:"Name",value:"bucket"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bucket"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"revision"},arguments:[{kind:"Argument",name:{kind:"Name",value:"hashOrTag"},value:{kind:"Variable",name:{kind:"Name",value:"hash"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hash"}},{kind:"Field",name:{kind:"Name",value:"file"},arguments:[{kind:"Argument",name:{kind:"Name",value:"path"},value:{kind:"Variable",name:{kind:"Name",value:"path"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"path"}},{kind:"Field",name:{kind:"Name",value:"metadata"}},{kind:"Field",name:{kind:"Name",value:"size"}},{kind:"Field",name:{kind:"Name",value:"physicalKey"}}]}}]}}]}}]}}]},rn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"containers_Bucket_PackageTree_gql_DeleteRevision"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bucket"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hash"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"packageRevisionDelete"},arguments:[{kind:"Argument",name:{kind:"Name",value:"bucket"},value:{kind:"Variable",name:{kind:"Name",value:"bucket"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"hash"},value:{kind:"Variable",name:{kind:"Name",value:"hash"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OperationError"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}}]};function ln(e){var n=e.bucket,a=e.name,i=e.hash,r=e.hashOrTag,c=e.path,s=c&&' --path "'.concat(G.ge(c),'"'),u=c&&', path="'.concat(G.ge(c),'"'),m="latest"===r?"":o.Z(10,i),k=m&&', top_hash="'.concat(m,'"'),p=m&&" --top-hash ".concat(m),v=[{label:"Python",hl:"python",contents:l()(gn||(gn=(0,t.cy)(['\n        import quilt3 as q3\n        # Browse\n        p = q3.Package.browse("','"',', registry="s3://','")\n        # make changes to package adding individual files\n        p.set("data.csv", "data.csv")\n        # or whole directories\n        p.set_dir("subdir", "subdir")\n        # and push changes\n        q3.Package.push("','", registry="s3://','", message="Hello World")\n\n        # Download (be mindful of large packages)\n        q3.Package.install("','"',"",', registry="s3://','", dest=".")\n      '],['\n        import quilt3 as q3\n        # Browse\n        p = q3.Package.browse("','"',', registry="s3://','")\n        # make changes to package adding individual files\n        p.set("data.csv", "data.csv")\n        # or whole directories\n        p.set_dir("subdir", "subdir")\n        # and push changes\n        q3.Package.push("','", registry="s3://','", message="Hello World")\n\n        # Download (be mindful of large packages)\n        q3.Package.install("','"',"",', registry="s3://','", dest=".")\n      '])),a,k,n,a,n,a,u,k,n)},{label:"CLI",hl:"bash",contents:l()(fn||(fn=(0,t.cy)(['\n          # Download package\n          quilt3 install "','"',""," --registry s3://"," --dest .\n        "],['\n          # Download package\n          quilt3 install "','"',""," --registry s3://"," --dest .\n        "])),a,s,p,n)+(c?"":l()(bn||(bn=(0,t.cy)(['\n\n              # Upload package\n              echo "Hello World" > README.md\n              quilt3 push "','" --registry s3://'," --dir .\n            "],['\\n\n              # Upload package\n              echo "Hello World" > README.md\n              quilt3 push "','" --registry s3://'," --dir .\n            "])),a,n))},{label:"URI",contents:M.Pz({bucket:n,name:a,hash:i,path:c})}];return d.createElement(Y.Z,null,v)}var on=h.Z((function(e){var n;return{topBar:{alignItems:"flex-end",display:"flex",marginBottom:e.spacing(2),marginTop:e.spacing(.5)},crumbs:(0,t.pi)((0,t.pi)({},e.typography.body1),(n={maxWidth:"calc(100% - 160px)",overflowWrap:"break-word"},n[e.breakpoints.down("xs")]={maxWidth:"calc(100% - 40px)"},n)),spacer:{flexGrow:1}}}));function cn(e){var n=e.crumbs,a=e.children,t=on();return d.createElement("div",{className:t.topBar},d.createElement("div",{className:t.crumbs,onCopy:Z.Yn},(0,Z.sY)(n)),d.createElement("div",{className:t.spacer}),a)}var sn=h.Z((function(e){return{button:{flexShrink:0,marginBottom:"-3px",marginLeft:e.spacing(1),marginTop:"-3px"}}}));function un(e){var n=this,a=e.bucket,r=e.name,l=e.hash,o=e.hashOrTag,m=e.path,p=e.crumbs,h=e.size,y=se.rV(),N=k.k6(),w=$.D$().urls,Z=sn(),D=(0,K.aM)({query:an,variables:{bucket:a,name:r,hash:l,path:G.ge(m)}}),F=d.useCallback((function(e){return w.bucketPackageTree(a,r,o,e.logicalKey)}),[w,a,r,o]),C=d.useState(y.includes("revisePackage"))[0],T=se.eh({initialOpen:C,bucket:a,src:{name:r,hash:l}}),P=d.useState(null),V=P[0],_=P[1],O=d.useCallback((function(){_(null)}),[_]);(0,J.Z)({bucket:a,name:r,hashOrTag:o},(function(e){c.Z({bucket:a,name:r,hashOrTag:o},e)||T.close()}));var x=B.D$().preferences,M=d.useCallback((function(){N.push(w.bucketPackageList(a))}),[a,N,w]),q=d.useState({error:void 0,loading:!1,opened:!1}),R=q[0],L=q[1],W=d.useCallback((function(){return L(s.Z("opened",!0))}),[]),U=d.useCallback((function(){L(u.Z({error:void 0,opened:!1}))}),[]),H=v.Db(rn)[1],Y=d.useCallback((function(){return(0,t.mG)(n,void 0,void 0,(function(){var e,n,i,o;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:L(s.Z("loading",!0)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,H({bucket:a,name:r,hash:l})];case 2:if((e=t.sent()).error)throw e.error;if(!e.data)throw new Error("No data returned by the API");switch((n=e.data.packageRevisionDelete).__typename){case"PackageRevisionDeleteSuccess":return L(u.Z({opened:!1,loading:!1})),M(),[2];case"OperationError":return L(u.Z({error:n.message,loading:!1})),[2];default:(0,j.Z)(n)}return[3,4];case 3:return i=t.sent(),o="Unexpected error",i.message&&(o="".concat(o,": ").concat(i.message)),L(u.Z({error:o,loading:!1})),[3,4];case 4:return[2]}}))}))}),[a,l,r,H,M,L]),X=d.useMemo((function(){return{bucket:a,name:r,hash:l}}),[a,r,l]),ae=z(X,h),te=S.BF(X,m);return d.createElement(d.Fragment,null,d.createElement(A,{open:ae.confirming,onClose:ae.unconfirm,onConfirm:ae.openInDesktop,size:h}),d.createElement(we,{bucket:a,hash:l,name:r,open:!!V,successor:V,onExited:O}),d.createElement(Ae,{error:R.error,open:R.opened,packageHandle:X,onClose:U,loading:R.loading,onDelete:Y}),T.render({resetFiles:"Undo changes",submit:"Push",successBrowse:"Browse",successTitle:"Push complete",successRenderMessage:function(e){var n=e.packageLink;return d.createElement(d.Fragment,null,"Package revision ",n," successfully created")},title:"Push package revision"}),D.case({fetching:function(){return d.createElement(d.Fragment,null,d.createElement(cn,{crumbs:p}),d.createElement(g.Z,{mt:2},d.createElement(f.Z,null)))},data:function(e){var n,c,s,u,k,v,h,f,y,N,S,D,C=null===(c=null===(n=e.package)||void 0===n?void 0:n.revision)||void 0===c?void 0:c.dir;if(!C)return d.createElement(d.Fragment,null,d.createElement(cn,{crumbs:p}),d.createElement(g.Z,{mt:4},d.createElement(b.Z,{variant:"h4",align:"center",gutterBottom:!0},"Error loading directory"),d.createElement(b.Z,{variant:"body1",align:"center"},"Seems like there's no such directory in this package")));var P=C.children.map((function(e){switch(e.__typename){case"PackageFile":return{type:"file",name:(0,i.basename)(e.path),to:w.bucketPackageTree(a,r,o,e.path),size:e.size};case"PackageDir":return{type:"dir",name:(0,i.basename)(e.path),to:w.bucketPackageTree(a,r,o,G.P8(e.path)),size:e.size};default:return(0,j.Z)(e)}}));m&&P.unshift({type:"dir",name:"..",to:w.bucketPackageTree(a,r,o,G.up(m))});var V=C.children.map((function(e){return"PackageFile"===e.__typename?(0,t.pi)((0,t.pi)({},G.UD(e.physicalKey)),{logicalKey:e.path}):null})).filter(Boolean),O=m?"package/".concat(a,"/").concat(r,"/").concat(l,"/").concat(m):"package/".concat(a,"/").concat(r,"/").concat(l),M=null===(u=null===(s=null==x?void 0:x.ui)||void 0===s?void 0:s.actions)||void 0===u?void 0:u.revisePackage;return d.createElement(d.Fragment,null,te.render(),d.createElement(cn,{crumbs:p},M&&d.createElement(E.Z,{className:Z.button,variant:"contained",color:"primary",size:"small",style:{marginTop:-3,marginBottom:-3,flexShrink:0},onClick:function(){return T.open()}},"Revise package"),(null===(v=null===(k=null==x?void 0:x.ui)||void 0===k?void 0:k.actions)||void 0===v?void 0:v.copyPackage)&&d.createElement(Se.z,{className:Z.button,bucket:a,onChange:_},"Push to bucket"),d.createElement(Q.o,{className:Z.button,label:m?"Download sub-package":"Download package",onClick:ae.confirm,path:O}),d.createElement(Xe,{className:Z.button,onDelete:W,onDesktop:ae.confirm,onCreateFile:te.open})),(null===(f=null===(h=null==x?void 0:x.ui)||void 0===h?void 0:h.blocks)||void 0===f?void 0:f.code)&&d.createElement(ln,(0,t.pi)({},(0,t.pi)((0,t.pi)({},X),{hashOrTag:o,path:m}))),!!(null===(N=null===(y=null==x?void 0:x.ui)||void 0===y?void 0:y.blocks)||void 0===N?void 0:N.meta)&&d.createElement(ee.uv,{data:I.Z.Ok(C.metadata)}),d.createElement(g.Z,{mt:2},(null===(D=null===(S=null==x?void 0:x.ui)||void 0===S?void 0:S.blocks)||void 0===D?void 0:D.browser)&&d.createElement(ne.ZP,{items:P,key:l}),d.createElement(De.Z,{path:m,files:V,mkUrl:F,packageHandle:X})))}}))}function mn(e){var n=e.crumbs;return d.createElement(d.Fragment,null,d.createElement(cn,{crumbs:n}),d.createElement(g.Z,{mt:2},d.createElement(f.Z,null)))}function dn(e){var n=e.crumbs,a=e.detail,t=e.headline;return d.createElement(d.Fragment,null,d.createElement(cn,{crumbs:n}),d.createElement(g.Z,{mt:4},d.createElement(b.Z,{variant:"h4",align:"center",gutterBottom:!0},t),!!a&&d.createElement(b.Z,{variant:"body1",align:"center"},a)))}function kn(e){var n=e.bucket,a=e.name,i=e.hash,r=e.path,l=e.crumbs,o=(0,t._T)(e,["bucket","name","hash","path","crumbs"]),c=(0,K.aM)({query:tn,variables:{bucket:n,name:a,hash:i,path:r}});return c.case({fetching:function(){return d.createElement(mn,{crumbs:l})},data:function(e){var s,u,m=null===(u=null===(s=e.package)||void 0===s?void 0:s.revision)||void 0===u?void 0:u.file;return m?d.createElement(vn,(0,t.pi)({},{bucket:n,name:a,hash:i,path:r,crumbs:l,file:m},o)):(c.error&&console.error(c.error),d.createElement(dn,{headline:"Error loading file",detail:"Seems like there's no such file in this package",crumbs:l}))}})}var pn=h.Z((function(e){var n;return{button:{marginLeft:e.spacing(2)},fileProperties:(n={},n[e.breakpoints.up("sm")]={marginBottom:"3px"},n)}}));function vn(e){var n,a,i=e.bucket,r=e.mode,l=e.name,o=e.hash,c=e.hashOrTag,s=e.path,u=e.crumbs,m=e.file,p=R.S3.use(),v=x.D$().noDownload,h=k.k6(),g=$.D$().urls,f=pn(),b=B.D$().preferences,E=d.useMemo((function(){return{bucket:i,name:l,hash:o}}),[i,l,o]),y=(0,Pe.C)(s,r,E),N=d.useCallback((function(e){h.push(g.bucketPackageTree(i,l,c,s,e.valueOf()))}),[i,h,l,s,c,g]),w=S.wt(s)&&"latest"===c&&!!(null===(a=null===(n=null==b?void 0:b.ui)||void 0===n?void 0:n.actions)||void 0===a?void 0:a.revisePackage),Z=d.useCallback((function(){var e=g.bucketPackageDetail(i,l,{action:"revisePackage"}),n=G.UD(m.physicalKey),a=g.bucketFile(n.bucket,n.key,{add:s,edit:!0,next:e});h.push(a)}),[m,i,h,l,s,g]),D=d.useMemo((function(){return(0,t.pi)((0,t.pi)({},G.UD(m.physicalKey)),{logicalKey:m.path,packageHandle:E})}),[m,E]);return d.createElement(L.ZP,{fetch:pe.cY,params:(0,t.pi)({s3:p},D)},I.Z.case({_:function(){return d.createElement(mn,{crumbs:u})},Err:function(e){return"Forbidden"===e.code?d.createElement(dn,{headline:"Access Denied",detail:"You don't have access to this object",crumbs:u}):(console.error(e),d.createElement(dn,{headline:"Error loading file",detail:"Something went wrong",crumbs:u}))},Ok:pe.NB.case({Exists:function(e){var n,a,i,r,l=e.archived,o=e.deleted,k=e.lastModified,p=e.size;return d.createElement(d.Fragment,null,d.createElement(cn,{crumbs:u},d.createElement(X.E,{className:f.fileProperties,lastModified:k,size:p}),w&&d.createElement(ee.gN,{className:f.button,icon:"edit",label:"Edit",onClick:Z}),!!y.modes.length&&d.createElement(ee.Us,{className:f.button,options:y.modes.map(Pe.D),value:(0,Pe.D)(y.mode),onChange:N}),!v&&!o&&!l&&d.createElement(ee.o6,{className:f.button,handle:D})),(null===(a=null===(n=null==b?void 0:b.ui)||void 0===n?void 0:n.blocks)||void 0===a?void 0:a.code)&&d.createElement(ln,(0,t.pi)({},(0,t.pi)((0,t.pi)({},E),{hashOrTag:c,path:s}))),(null===(r=null===(i=null==b?void 0:b.ui)||void 0===i?void 0:i.blocks)||void 0===r?void 0:r.meta)&&d.createElement(ee.mE,{data:I.Z.Ok(m.metadata)}),d.createElement(Ze.Z,{icon:"remove_red_eye",heading:"Preview",expandable:!1},function(e,n,a,t){var i=e.archived;if(e.deleted)return t(I.Z.Err(C.Mh.Deleted({handle:n})));if(i)return t(I.Z.Err(C.Mh.Archived({handle:n})));var r={mode:a,context:C.IT.FILE};return C.zD(n,t,r)}({archived:l,deleted:o},D,y.mode,(0,Te.Z)(y.handlePreviewResult))))},_:function(){return d.createElement(dn,{headline:"No Such Object",crumbs:u})}})}))}function hn(e){var n=e.bucket,a=e.name,i=e.hash,r=e.children,l=v.m8(),o=d.useCallback((function(e){return l.query(tn,{bucket:n,name:a,hash:i,path:e}).toPromise().then((function(n){var a,i,r,l=null===(r=null===(i=null===(a=n.data)||void 0===a?void 0:a.package)||void 0===i?void 0:i.revision)||void 0===r?void 0:r.file;if(!l)throw n.error||new Error('Could not resolve logical key "'.concat(e,'"'));return(0,t.pi)((0,t.pi)({},G.UD(l.physicalKey)),{logicalKey:l.path,size:l.size})}))}),[l,n,a,i]);return d.createElement(W.zt,{value:o},r)}var gn,fn,bn,En=h.Z({alertMsg:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}});function yn(e){var n=e.bucket,a=e.name,i=e.hashOrTag,r=e.hash,l=e.path,o=e.mode,c=e.resolvedFrom,s=e.revisionListQuery,u=e.size,k=En(),v=$.D$().urls,h=G.vb(l),f=d.useMemo((function(){var e=(0,t.ev)([{label:"ROOT",path:""}],G.tO(l),!0);return m.Z(Z.$2.Sep(d.createElement(d.Fragment,null," / ")),e.map((function(e){var t=e.label,r=e.path;return Z.$2.Segment({label:t,to:l===r?void 0:v.bucketPackageTree(n,a,i,r)})}))).concat(l.endsWith("/")?Z.$2.Sep(d.createElement(d.Fragment,null," /")):[])}),[n,a,i,l,v]);return d.createElement(ee.fC,null,!!c&&d.createElement(g.Z,{mb:2},d.createElement(w.Z,{severity:"info",icon:!1,classes:{message:k.alertMsg},action:d.createElement(y.Z,{size:"small",color:"inherit",component:p.Link,to:v.bucketPackageTree(n,a,i,l)},d.createElement(N.Z,{fontSize:"small"},"close"))},"Resolved from"," ",d.createElement(g.Z,{fontFamily:"monospace.fontFamily",fontWeight:"fontWeightBold",component:"span",title:c},c))),d.createElement(b.Z,{variant:"body1"},d.createElement(_e,(0,t.pi)({},{bucket:n,name:a}))," @ ",d.createElement(Ye,(0,t.pi)({},{hash:r,hashOrTag:i,bucket:n,name:a,path:l,revisionListQuery:s}))),r?d.createElement(hn,(0,t.pi)({},{bucket:n,name:a,hash:r}),h?d.createElement(un,(0,t.pi)({},{bucket:n,name:a,hash:r,path:l,hashOrTag:i,crumbs:f,size:u})):d.createElement(kn,(0,t.pi)({},{bucket:n,mode:o,name:a,hash:r,hashOrTag:i,path:l,crumbs:f}))):d.createElement(d.Fragment,null,d.createElement(cn,{crumbs:f}),d.createElement(g.Z,{mt:4},d.createElement(b.Z,{variant:"h4",align:"center",gutterBottom:!0},"Error resolving revision"),d.createElement(b.Z,{variant:"body1",align:"center"},"Revision"," ",d.createElement(g.Z,{component:"span",fontWeight:"fontWeightMedium"},'"'.concat(i,'"'))," ","could not be resolved."))))}function Nn(e){var n=e.bucket,a=e.name,i=e.hashOrTag,r=e.path,l=e.resolvedFrom,o=e.mode,c=(0,K.aM)({query:en,variables:{bucket:n,name:a,hashOrTag:i}}),s=(0,K.aM)({query:nn,variables:{bucket:n,name:a}});return c.case({fetching:function(){return d.createElement(F.Z,{color:"text.secondary"})},error:function(e){return Ce.Sj()(e)},data:function(e){var c,u,m;return e.package?d.createElement(yn,(0,t.pi)({},{bucket:n,name:a,hashOrTag:i,hash:null===(c=e.package.revision)||void 0===c?void 0:c.hash,size:null!==(m=null===(u=e.package.revision)||void 0===u?void 0:u.totalBytes)&&void 0!==m?m:void 0,path:r,mode:o,resolvedFrom:l,revisionListQuery:s})):d.createElement(D.Z,{headline:"No Such Package"},"Package named"," ",d.createElement(g.Z,{component:"span",fontWeight:"fontWeightMedium"},'"'.concat(a,'"'))," ","could not be found in this bucket.")}})}function wn(e){var n=e.match.params,a=n.bucket,i=n.name,r=n.revision,l=void 0===r?"latest":r,c=n.path,s=void 0===c?"":c,u=e.location,m=G.Jx(s),k=(0,H.Z)(u.search,!0),p=k.resolvedFrom,v=k.mode;return d.createElement(d.Fragment,null,d.createElement(U.Z,null,["".concat(i,"@").concat(o.Z(10,l),"/").concat(m),a]),d.createElement(Fe.Z,{bucket:a},d.createElement(Nn,(0,t.pi)({},{bucket:a,name:i,hashOrTag:l,path:m,resolvedFrom:p,mode:v}))))}},41973:(e,n,a)=>{a.d(n,{Z:()=>o});var t=a(67294),i=a(20740),r=a(37894),l=a(32248);function o(e){var n=e.bucket,a=e.children,o="LOCAL"===l.D$().mode,c=r.TM();return t.useMemo((function(){return c(n)}),[n,c])||o?t.createElement(t.Fragment,null,a):t.createElement(i.Z,{headline:"Packages temporarily hidden"},"Ask an admin to add the bucket ",t.createElement("strong",null,n)," to Quilt so that you can browse packages.")}},64395:(e,n,a)=>{a.d(n,{C:()=>k,D:()=>d});var t=a(26470),i=a(67294),r=a(78013),l=a(43987),o=a(32248),c=a(28238),s=c.SN({name:"Voila",persist:!0,fetch:function(e){return fetch(function(e){return"".concat(e,"/voila/")}(e)).then((function(e){return e.ok})).catch((function(){return!1})).then((function(e){return e||console.debug("Voila is not supported by current stack"),e}))}});var u={igv:"IGV",json:"JSON",jupyter:"Jupyter",vega:"Vega",voila:"Voila"},m=function(e){return!!e&&!!e.match(/https:\/\/vega\.github\.io\/schema\/([\w-]+)\/([\w.-]+)\.json/)};function d(e){return e&&{toString:function(){return u[e]},valueOf:function(){return e}}}function k(e,n,a){var u,d=(u=o.D$().registryUrl,c.et(s,u,{suspend:!0})),k=i.useState(null),p=k[0],v=k[1],h=i.useCallback((function(e){!p&&l.Z.Ok.is(e)&&v(l.Z.Ok.unbox(e))}),[p,v]),g=i.useMemo((function(){switch((0,t.extname)(e)){case".ipynb":return a&&d?["jupyter","json","voila"]:["jupyter","json"];case".json":return r.BO.case({Vega:function(e){var n;return m(null===(n=e.spec)||void 0===n?void 0:n.$schema)?["vega","json"]:[]},Json:function(e){var n;return m(null===(n=e.rendered)||void 0===n?void 0:n.$schema)?["vega","json"]:function(e){return Array.isArray(null==e?void 0:e.tracks)}(e.rendered)?["json","igv"]:[]},_:function(){return[]},__:function(){return[]}},p);default:return[]}}),[e,a,p,d]),f=g.includes(n)?n:g[0]||null;return{modes:g,mode:f,handlePreviewResult:h}}},55743:(e,n,a)=>{a.d(n,{Pz:()=>u,Qc:()=>s});var t=a(70655),i=a(17673),r=a(8575),l=a(66115),o=a(45596),c=function(e){function n(n,a){return e.call(this,"Invalid package URI (".concat(a,"): ").concat(n),{msg:n,uri:a})||this}return(0,t.ZT)(n,e),n.displayName="PackageUriError",n}(a(36155).G);function s(e){var n=(0,r.parse)(e);if("quilt+s3:"!==n.protocol)throw new c('unsupported protocol "'.concat(n.protocol,'". "quilt+s3:" is currently the only supported protocol.'),e);if(!n.slashes)throw new c("missing slashes between protocol and registry.",e);if(n.path)throw new c("non-bucket-root registries are not supported currently.",e);var a=n.host,t=(0,i.parse)((n.hash||"").replace("#",""));if(!t.package)throw new c('missing "package=" part.',e);if(Array.isArray(t.package))throw new c('"package=" specified multiple times.',e);var s=function(e,n){if(e.includes(":")&&e.includes("@"))throw new c('"package=" part may either contain ":" or "@".',n);if(e.includes(":")){var a=e.split(":"),t=a[0],i=a[1],r=a.slice(2);if(!t)throw new c('"package=" part must contain non-empty package name.',n);if(!i)throw new c('"package=" part: tag must not be empty.',n);if(r.length)throw new c('"package=" part may contain only one ":".',n);return{name:t,tag:i}}if(e.includes("@")){var l=e.split("@"),o=(t=l[0],l[1]);if(r=l.slice(2),!t)throw new c('"package=" part must contain non-empty package name.',n);if(!o)throw new c('"package=" part: hash must not be empty.',n);if(r.length)throw new c('"package=" part may contain only one "@".',n);return{name:t,hash:o}}return{name:e}}(t.package,e),u=s.name,m=s.hash,d=s.tag;if(Array.isArray(t.path))throw new c('"path=" specified multiple times.',e);var k=t.path?decodeURIComponent(t.path):void 0;return l.Z(o.Z,{bucket:a,name:u,hash:m,tag:d,path:k})}function u(e){var n=e.bucket,a=e.name,t=e.hash,i=e.tag,r=e.path;if(!n)throw new Error('PackageUri.stringify: missing "bucket"');if(!a)throw new Error('PackageUri.stringify: missing "name"');if(t&&i)throw new Error('PackageUri.stringify: can\'t have both "hash" and "tag"');var l=a;t?l+="@".concat(t):i&&(l+=":".concat(i));var o=r?"&path=".concat(encodeURIComponent(r)):"";return"quilt+s3://".concat(n,"#package=").concat(l).concat(o)}},9982:(e,n,a)=>{a.d(n,{Z:()=>m});var t=a(67294),i=a(11476),r=a(22318),l=a(95477),o=a(73179),c=i.Z("div")({textAlign:"center",width:"100%"}),s=function(e){var n=e.heading,a=e.body,i=e.action;return t.createElement(c,null,!!n&&t.createElement(r.Z,{variant:"h6",gutterBottom:!0},n),!!a&&t.createElement(r.Z,{variant:"body1",gutterBottom:!0},a),!!i&&i)},u=function(){return t.createElement(c,null,t.createElement(l.Z,null))};const m=function(e){return o.jf({renderMessage:s,renderProgress:u,onData:e})}}}]);
//# sourceMappingURL=582.fd450a43dc965da29bba.chunk.js.map