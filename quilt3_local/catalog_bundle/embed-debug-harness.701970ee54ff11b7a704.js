"use strict";(self.webpackChunkquilt_navigator=self.webpackChunkquilt_navigator||[]).push([[1345],{38751:(e,t,n)=>{var a=n(70655),r=n(82067),l=n(77584),i=n(67294),c=n(73935),u=n(10529),o=n(282),s=n(39803),m=n(22318),d=n(13457),p=(n(12327),n(74391)),f=n(39473),v=n(24452),E=n(97456),h=n(32248),Z=n(89978),b=n(19083),k=n(28238),w=n(31274),g=n(57996),y=n(68420),C=n(40018),x=window.location.origin,S=window.location.origin,O=function(){return"".concat(Math.random())};function W(e){var t=i.useState(e),n=t[0],a=t[1],r=i.useCallback((function(e){a(e.target.value)}),[a]);return{value:n,set:a,input:{value:n,onChange:r}}}function R(){var e=this,t=h.ZR(),n=b.D$({clientId:t.oktaClientId,baseUrl:t.oktaBaseUrl}),c=i.useRef(null),d=i.useState(O),f=d[0],v=d[1],E="".concat("/__embed").concat((0,g.Z)({nonce:f,origin:S})),Z={credentials:W("{}"),bucket:W(""),path:W(""),scope:W(""),rest:W("{}"),route:W(""),newRoute:W("")},k=i.useState([]),w=k[0],y=k[1],C=i.useCallback((function(e,t){var n=t.type,l=(0,a._T)(t,["type"]);y(r.Z({direction:e,type:n,contents:l,time:new Date}))}),[y]),R=i.useMemo((function(){try{return(0,a.pi)({bucket:Z.bucket.value,path:Z.path.value,scope:Z.scope.value,credentials:JSON.parse(Z.credentials.value),route:Z.route.value},JSON.parse(Z.rest.value||"{}"))}catch(e){return e}}),[Z.credentials.value,Z.bucket.value,Z.path.value,Z.scope.value,Z.rest.value,Z.route.value]),I=i.useCallback((function(){return(0,a.mG)(e,void 0,void 0,(function(){var e;return(0,a.Jh)(this,(function(t){switch(t.label){case 0:return[4,n()];case 1:return e=t.sent(),Z.credentials.set(JSON.stringify({provider:"okta",token:e})),[2]}}))}))}),[n,Z.credentials.set]),J=i.useCallback((function(e){c.current&&(c.current.contentWindow.postMessage(e,x),C("out",e))}),[c,C]),M=i.useCallback((function(){R instanceof Error||J((0,a.pi)({type:"init"},R))}),[J,R]),N=i.useCallback((function(){J({type:"navigate",route:Z.newRoute.value})}),[J,Z.newRoute.value]),_=i.useCallback((function(){v(O),y([])}),[v,y]),B=i.useCallback((function(e){e.source===c.current.contentWindow&&e.origin===x&&"quilt-embed"===e.data.source&&f===e.data.nonce&&C("in",l.Z(["source","nonce"],e.data))}),[c,C,f]);return i.useEffect((function(){return window.addEventListener("message",B),function(){window.removeEventListener("message",B)}}),[B]),i.createElement(u.Z,{display:"flex",justifyContent:"space-between",p:2,maxHeight:"100vh"},i.createElement(u.Z,{display:"flex",flexDirection:"column",flexGrow:1,pr:2,maxWidth:400,overflow:"auto"},i.createElement(o.Z,{variant:"outlined",onClick:I},"Get credentials from Okta"),i.createElement(u.Z,{mt:2}),i.createElement(s.Z,(0,a.pi)({multiline:!0,label:"Credentials (JSON)",rowsMax:10,fullWidth:!0},Z.credentials.input)),i.createElement(u.Z,{mt:2}),i.createElement(s.Z,(0,a.pi)({label:"Bucket",fullWidth:!0},Z.bucket.input)),i.createElement(u.Z,{mt:2}),i.createElement(s.Z,(0,a.pi)({label:"Path",fullWidth:!0},Z.path.input)),i.createElement(u.Z,{mt:2}),i.createElement(s.Z,(0,a.pi)({label:"Route",fullWidth:!0},Z.route.input)),i.createElement(u.Z,{mt:2}),i.createElement(s.Z,(0,a.pi)({label:"Scope",fullWidth:!0},Z.scope.input)),i.createElement(u.Z,{mt:2}),i.createElement(s.Z,(0,a.pi)({multiline:!0,label:"Extra params (JSON, merged with the rest)",rowsMax:10,fullWidth:!0},Z.rest.input)),i.createElement(u.Z,{mt:2}),i.createElement(o.Z,{variant:"outlined",onClick:M},"init"),i.createElement(u.Z,{mt:1}),i.createElement(o.Z,{variant:"outlined",onClick:_},"reload iframe"),i.createElement(u.Z,{mt:2},R instanceof Error?"".concat(R):i.createElement(p.Z,{name:"init params",value:R,defaultExpanded:!0})),i.createElement(u.Z,{mt:4}),i.createElement(o.Z,{variant:"outlined",onClick:N},"navigate to"),i.createElement(u.Z,{mt:2}),i.createElement(s.Z,(0,a.pi)({label:"New route",fullWidth:!0},Z.newRoute.input))),i.createElement(u.Z,{flexShrink:0},i.createElement("iframe",{title:"embed",src:E,width:"900",height:"600",ref:c,style:{border:"1px solid"}}),i.createElement(u.Z,{mt:3},i.createElement(m.Z,{variant:"h6",gutterBottom:!0},"Messages"),w.map((function(e){return i.createElement(u.Z,{key:e.time.toISOString()},i.createElement(p.Z,{name:"[".concat(e.time.toISOString(),"] ").concat("in"===e.direction?"<==":"==>"," ").concat(e.type),value:e.contents,color:"in"===e.direction?"error"===e.type?"error.main":"success.main":void 0}))})))))}var I=(0,Z.Y)((function(){return function(){return i.createElement("h1",{style:{alignItems:"center",color:"#fff",display:"flex",height:"90vh",justifyContent:"center",maxHeight:"600px"}},"Something went wrong")}}));c.render(i.createElement((function(){return y.b(I,[d.Z,{theme:E.yG}],C.Z,f.fC,w.z,k.zt,[i.Suspense,{fallback:i.createElement(v.Z,{color:"text.secondary"})}],R)}),null),document.getElementById("app"))}},e=>{e.O(0,[4789,8595],(()=>{return t=38751,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=embed-debug-harness.701970ee54ff11b7a704.js.map