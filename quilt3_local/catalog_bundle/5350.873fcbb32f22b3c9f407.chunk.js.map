{"version":3,"file":"5350.873fcbb32f22b3c9f407.chunk.js","mappings":"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","sources":["webpack://quilt-navigator/./app/containers/Bucket/Search.js","webpack://quilt-navigator/./app/utils/useEditableValue.js"],"sourcesContent":["import * as React from 'react'\nimport { useHistory, Link } from 'react-router-dom'\nimport * as M from '@material-ui/core'\n\nimport * as SearchResults from 'components/SearchResults'\nimport * as BucketConfig from 'utils/BucketConfig'\nimport * as Data from 'utils/Data'\nimport MetaTitle from 'utils/MetaTitle'\nimport * as NamedRoutes from 'utils/NamedRoutes'\nimport parseSearch from 'utils/parseSearch'\nimport useSearch from 'utils/search'\nimport useEditableValue from 'utils/useEditableValue'\n\nfunction Browse({ bucket }) {\n  const { urls } = NamedRoutes.use()\n  return (\n    <M.Button component={Link} to={urls.bucketRoot(bucket)} variant=\"outlined\">\n      Browse the bucket\n    </M.Button>\n  )\n}\n\nfunction Results({ data, bucket, query, page, scrollRef, makePageUrl, retryUrl }) {\n  return data.case({\n    _: () => (\n      // TODO: display scope instead of bucket when implemented\n      <SearchResults.Progress>\n        Searching s3://{bucket} for &quot;{query}&quot;\n      </SearchResults.Progress>\n    ),\n    Err: SearchResults.handleErr(retryUrl),\n    Ok: ({ total, hits }) =>\n      total ? (\n        <SearchResults.Hits {...{ hits, page, scrollRef, makePageUrl }} showBucket />\n      ) : (\n        <SearchResults.NothingFound>\n          <br />\n          <Browse bucket={bucket} />\n        </SearchResults.NothingFound>\n      ),\n  })\n}\n\nconst useQueryInputStyles = M.makeStyles((t) => ({\n  searchIcon: {\n    left: 8,\n    pointerEvents: 'none',\n    position: 'absolute',\n  },\n  input: {\n    paddingLeft: t.spacing(5),\n    paddingRight: t.spacing(1),\n    paddingBottom: 11,\n    paddingTop: 10,\n    [t.breakpoints.down('xs')]: {\n      paddingBottom: 15,\n      paddingTop: 14,\n    },\n  },\n}))\n\nfunction QueryInput({ query, bucket, onChange }) {\n  const classes = useQueryInputStyles()\n  const state = useEditableValue(query, onChange)\n  const { change, commit } = state\n\n  const handleChange = React.useCallback(\n    (e) => {\n      change(e.target.value)\n    },\n    [change],\n  )\n\n  const handleKeyDown = React.useCallback(\n    (e) => {\n      // eslint-disable-next-line default-case\n      switch (e.key) {\n        case 'Enter':\n          // suppress onSubmit (didn't actually find this to be a problem tho)\n          e.preventDefault()\n          commit()\n          e.target.blur()\n          break\n        case 'Escape':\n          e.target.blur()\n          break\n      }\n    },\n    [commit],\n  )\n\n  return (\n    <M.InputBase\n      value={state.value}\n      onFocus={state.edit}\n      onBlur={state.cancel}\n      onChange={handleChange}\n      onKeyDown={handleKeyDown}\n      placeholder={`Search s3://${bucket}`}\n      classes={{ input: classes.input }}\n      fullWidth\n      startAdornment={<M.Icon className={classes.searchIcon}>search</M.Icon>}\n    />\n  )\n}\n\nfunction SearchStats({ data }) {\n  return data.case({\n    _: () => '',\n    Ok: ({ total }) => (\n      <M.Typography variant=\"body1\" component=\"span\">\n        {total} results\n      </M.Typography>\n    ),\n  })\n}\n\nconst displayMode = (m) => {\n  if (m === 'packages') return 'packages'\n  if (m === 'objects') return 'objects'\n  return 'objects & packages'\n}\n\nconst useModeSelectDropdownStyles = M.makeStyles((t) => ({\n  btn: {\n    MozAppearance: 'none',\n    WebkitAppearance: 'none',\n    WebkitTapHighlightColor: 'transparent',\n    display: 'inline-flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: 'transparent',\n    outline: 0,\n    border: 0,\n    margin: 0,\n    borderRadius: 0,\n    padding: 0,\n    userSelect: 'none',\n\n    ...t.typography.body1,\n    cursor: 'pointer',\n  },\n}))\n\nfunction ModeSelectDropdown({ mode, onChange }) {\n  const classes = useModeSelectDropdownStyles()\n  const options = [undefined, 'objects', 'packages']\n\n  const [edited, setEdited] = React.useState(false)\n\n  const edit = React.useCallback(() => setEdited(true), [setEdited])\n  const close = React.useCallback(() => setEdited(false), [setEdited])\n\n  const anchorRef = React.useRef(null)\n\n  const handleSelect = (v) => () => {\n    onChange(v)\n    close()\n  }\n\n  return (\n    <>\n      <button type=\"button\" onClick={edit} className={classes.btn} ref={anchorRef}>\n        {displayMode(mode)}\n        <M.Icon fontSize=\"inherit\">expand_more</M.Icon>\n      </button>\n      <M.Menu\n        anchorEl={anchorRef.current}\n        open={edited}\n        onClose={close}\n        MenuListProps={{ dense: true }}\n      >\n        {options.map((o) => (\n          <M.MenuItem key={o || 'all'} onClick={handleSelect(o)} selected={mode === o}>\n            <M.ListItemText primary={displayMode(o)} />\n          </M.MenuItem>\n        ))}\n      </M.Menu>\n    </>\n  )\n}\n\nconst useModeSelectorStyles = M.makeStyles((t) => ({\n  overlay: {\n    background: t.palette.common.white,\n    bottom: 0,\n    display: 'flex',\n    justifyContent: 'space-between',\n    left: 44,\n    paddingRight: 4,\n    position: 'absolute',\n    right: 0,\n    top: 0,\n  },\n  controls: {\n    lineHeight: '48px',\n  },\n}))\n\nfunction ModeSelector({ mode, onChange }) {\n  const classes = useModeSelectorStyles()\n  const t = M.useTheme()\n  const xs = M.useMediaQuery(t.breakpoints.down('xs'))\n\n  const [controlsShown, setControlsShown] = React.useState(false)\n  const showControls = React.useCallback(() => setControlsShown(true), [setControlsShown])\n  const hideControls = React.useCallback(\n    () => setControlsShown(false),\n    [setControlsShown],\n  )\n\n  const controls = (\n    <>\n      {!xs && <M.Typography component=\"span\">Searching </M.Typography>}\n      <ModeSelectDropdown mode={mode} onChange={onChange} />\n    </>\n  )\n\n  return xs ? (\n    <>\n      <M.IconButton onClick={showControls}>\n        <M.Icon>menu</M.Icon>\n      </M.IconButton>\n      {controlsShown && (\n        <div className={classes.overlay}>\n          <div className={classes.controls}>{controls}</div>\n          <M.IconButton onClick={hideControls}>\n            <M.Icon>done</M.Icon>\n          </M.IconButton>\n        </div>\n      )}\n    </>\n  ) : (\n    controls\n  )\n}\n\nconst useSearchStyles = M.makeStyles((t) => ({\n  paper: {\n    paddingLeft: t.spacing(1.5),\n    paddingRight: t.spacing(1),\n    lineHeight: '40px',\n\n    [t.breakpoints.down('xs')]: {\n      borderRadius: 0,\n      boxShadow: 'none',\n      '&:first-child': {\n        paddingLeft: t.spacing(0.5),\n      },\n      '&:last-child': {\n        paddingRight: t.spacing(0.5),\n      },\n    },\n  },\n  stats: {\n    flexGrow: 1,\n    lineHeight: '40px',\n    padding: t.spacing(0, 3),\n    textAlign: 'right',\n    [t.breakpoints.down('xs')]: {\n      display: 'none',\n    },\n  },\n}))\n\nfunction Search({ bucket, query, page, mode, retry }) {\n  const { urls } = NamedRoutes.use()\n  const history = useHistory()\n  const classes = useSearchStyles()\n\n  const scrollRef = React.useRef(null)\n\n  const handleQueryChange = React.useCallback(\n    (newQuery) => {\n      history.push(urls.bucketSearch(bucket, { q: newQuery, mode }))\n    },\n    [history, urls, bucket, mode],\n  )\n\n  const handleModeChange = React.useCallback(\n    (newMode) => {\n      history.push(urls.bucketSearch(bucket, { q: query, mode: newMode }))\n    },\n    [history, urls, bucket, query],\n  )\n\n  const makePageUrl = React.useCallback(\n    (newP) =>\n      urls.bucketSearch(bucket, {\n        q: query,\n        p: newP !== 1 ? newP : undefined,\n        mode,\n        retry,\n      }),\n    [urls, bucket, query, mode, retry],\n  )\n\n  const retryUrl = urls.bucketSearch(bucket, { q: query, mode, retry: (retry || 0) + 1 })\n\n  const data = Data.use(\n    useSearch(),\n    { buckets: [bucket], mode, query, retry },\n    { noAutoFetch: !query },\n  )\n\n  return (\n    <>\n      <M.Box display=\"flex\" position=\"relative\" mt={{ xs: 0, sm: 3 }} ref={scrollRef}>\n        <M.Box\n          component={M.Paper}\n          className={classes.paper}\n          flexGrow={{ xs: 1, sm: 0 }}\n          position=\"relative\"\n        >\n          <QueryInput query={query || ''} bucket={bucket} onChange={handleQueryChange} />\n        </M.Box>\n        <div className={classes.stats}>{!!query && <SearchStats data={data} />}</div>\n        <M.Box component={M.Paper} className={classes.paper}>\n          <ModeSelector mode={mode} onChange={handleModeChange} />\n        </M.Box>\n      </M.Box>\n      {query ? (\n        <Results {...{ data, bucket, query, page, scrollRef, makePageUrl, retryUrl }} />\n      ) : (\n        // TODO: revise copy\n        <SearchResults.Alt>\n          <M.Typography variant=\"body1\">Search for anything</M.Typography>\n        </SearchResults.Alt>\n      )}\n    </>\n  )\n}\n\nexport default function BucketSearch({\n  match: {\n    params: { bucket },\n  },\n  location: l,\n}) {\n  const isInStack = BucketConfig.useIsInStack()\n  const { q: query = '', p, mode, ...params } = parseSearch(l.search)\n  const page = p && parseInt(p, 10)\n  const retry = (params.retry && parseInt(params.retry, 10)) || undefined\n\n  return (\n    <M.Box pb={{ xs: 0, sm: 5 }} mx={{ xs: -2, sm: 0 }}>\n      <MetaTitle>{[query || 'Search', bucket]}</MetaTitle>\n\n      {isInStack(bucket) ? (\n        <Search {...{ bucket, query, page, mode, retry }} />\n      ) : (\n        <M.Typography variant=\"body1\">Search unavailable</M.Typography>\n      )}\n    </M.Box>\n  )\n}\n","import * as R from 'ramda'\nimport * as React from 'react'\n\nimport tagged from 'utils/tagged'\nimport useMemoEq from 'utils/useMemoEq'\n\nconst State = tagged([\n  'Idle',\n  'Edited', // value\n])\n\nexport default function useEditableValue(externalValue, onCommit) {\n  const [state, setState] = React.useState(State.Idle())\n\n  const edit = React.useCallback(() => {\n    setState(State.Edited(externalValue))\n  }, [externalValue])\n\n  const cancel = React.useCallback(() => {\n    setState(State.Idle())\n  }, [])\n\n  const change = React.useCallback((v) => {\n    setState(State.mapCase({ Edited: () => v }))\n  }, [])\n\n  const commit = React.useCallback(() => {\n    State.case(\n      {\n        Edited: (v) => {\n          if (!R.equals(externalValue, v)) onCommit(v)\n          cancel()\n        },\n        _: () => {},\n      },\n      state,\n    )\n  }, [externalValue, onCommit, cancel, state])\n\n  const isEdited = State.Edited.is(state)\n  const commitValue = React.useCallback(\n    (v) => {\n      if (!isEdited) return\n      if (!R.equals(externalValue, v)) onCommit(v)\n      cancel()\n    },\n    [externalValue, onCommit, cancel, isEdited],\n  )\n\n  const value = useMemoEq([state, externalValue], () =>\n    State.case({ Idle: () => externalValue, Edited: (v) => v }, state),\n  )\n\n  const edited = useMemoEq(state, State.Edited.is)\n\n  return { value, edited, edit, cancel, change, commit, commitValue }\n}\n"],"names":["Browse","bucket","urls","component","Link","to","bucketRoot","variant","Results","data","query","page","scrollRef","makePageUrl","retryUrl","case","_","Err","Ok","total","hits","showBucket","useQueryInputStyles","t","searchIcon","left","pointerEvents","position","input","paddingLeft","spacing","paddingRight","paddingBottom","paddingTop","breakpoints","down","QueryInput","onChange","classes","state","change","commit","handleChange","e","target","value","handleKeyDown","key","preventDefault","blur","onFocus","edit","onBlur","cancel","onKeyDown","placeholder","fullWidth","startAdornment","className","SearchStats","displayMode","m","useModeSelectDropdownStyles","btn","MozAppearance","WebkitAppearance","WebkitTapHighlightColor","display","alignItems","justifyContent","backgroundColor","outline","border","margin","borderRadius","padding","userSelect","typography","body1","cursor","ModeSelectDropdown","mode","options","undefined","edited","setEdited","close","anchorRef","type","onClick","ref","fontSize","anchorEl","current","open","onClose","MenuListProps","dense","map","o","v","selected","primary","useModeSelectorStyles","overlay","background","palette","common","white","bottom","right","top","controls","lineHeight","ModeSelector","xs","controlsShown","setControlsShown","showControls","hideControls","useSearchStyles","paper","boxShadow","stats","flexGrow","textAlign","Search","retry","history","handleQueryChange","newQuery","push","bucketSearch","q","handleModeChange","newMode","newP","p","buckets","noAutoFetch","mt","sm","BucketSearch","l","isInStack","search","params","parseInt","pb","mx","State","useEditableValue","externalValue","onCommit","Idle","setState","Edited","mapCase","isEdited","is","commitValue"],"sourceRoot":""}