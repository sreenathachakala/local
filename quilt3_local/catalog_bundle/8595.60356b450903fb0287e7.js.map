{"version":3,"file":"8595.60356b450903fb0287e7.js","mappings":"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","sources":["webpack://quilt-navigator/./app/components/BucketIcon/bucket.svg","webpack://quilt-navigator/./app/components/Footer/icon-facebook.svg","webpack://quilt-navigator/./app/components/Footer/icon-github.svg","webpack://quilt-navigator/./app/components/Footer/icon-instagram.svg","webpack://quilt-navigator/./app/components/Footer/icon-linkedin.svg","webpack://quilt-navigator/./app/components/Footer/icon-slack.svg","webpack://quilt-navigator/./app/components/Footer/icon-twitter.svg","webpack://quilt-navigator/./app/components/Thumbnail/checkboard.svg","webpack://quilt-navigator/./app/components/Thumbnail/glacier.svg","webpack://quilt-navigator/./app/components/BucketIcon/BucketIcon.tsx","webpack://quilt-navigator/./app/components/Code/Code.tsx","webpack://quilt-navigator/./app/components/Collaborators/Table.tsx","webpack://quilt-navigator/./app/components/Collaborators/Popup.tsx","webpack://quilt-navigator/./app/components/Collaborators/Badge.tsx","webpack://quilt-navigator/./app/components/Collaborators/Avatars.tsx","webpack://quilt-navigator/./app/components/DataGrid.tsx","webpack://quilt-navigator/./app/components/JsonEditor/Toolbar.tsx","webpack://quilt-navigator/./app/components/JsonEditor/enter-values.webm","webpack://quilt-navigator/./app/components/JsonEditor/object-expand.webm","webpack://quilt-navigator/./app/components/JsonEditor/AddArrayItem.tsx","webpack://quilt-navigator/./app/components/JsonEditor/constants.ts","webpack://quilt-navigator/./app/components/JsonEditor/ContextMenu.tsx","webpack://quilt-navigator/./app/components/JsonEditor/utils.ts","webpack://quilt-navigator/./app/components/JsonEditor/PreviewValue.tsx","webpack://quilt-navigator/./app/components/JsonEditor/EnumSelect.tsx","webpack://quilt-navigator/./app/components/JsonEditor/Input.tsx","webpack://quilt-navigator/./app/components/JsonEditor/ButtonExpand.tsx","webpack://quilt-navigator/./app/utils/StyledTooltip.tsx","webpack://quilt-navigator/./app/components/JsonEditor/Note.tsx","webpack://quilt-navigator/./app/components/JsonEditor/Preview.tsx","webpack://quilt-navigator/./app/components/JsonEditor/Cell.tsx","webpack://quilt-navigator/./app/components/JsonEditor/AddRow.tsx","webpack://quilt-navigator/./app/components/JsonEditor/Breadcrumbs.tsx","webpack://quilt-navigator/./app/components/JsonEditor/EmptyRow.tsx","webpack://quilt-navigator/./app/components/JsonEditor/Row.tsx","webpack://quilt-navigator/./app/components/JsonEditor/State.ts","webpack://quilt-navigator/./app/components/JsonEditor/Column.tsx","webpack://quilt-navigator/./app/components/JsonEditor/JsonEditor.tsx","webpack://quilt-navigator/./app/components/JsonValidationErrors/JsonValidationErrors.tsx","webpack://quilt-navigator/./app/utils/HashLink.js","webpack://quilt-navigator/./app/components/Footer/bg.png","webpack://quilt-navigator/./app/components/Footer/Footer.js","webpack://quilt-navigator/./app/containers/NavBar/bg.png","webpack://quilt-navigator/./app/containers/NavBar/BucketSelect.js","webpack://quilt-navigator/./app/containers/NavBar/BucketCollaborators.generated.ts","webpack://quilt-navigator/./app/containers/NavBar/Collaborators.tsx","webpack://quilt-navigator/./app/containers/NavBar/Search.js","webpack://quilt-navigator/./app/containers/NavBar/Controls.js","webpack://quilt-navigator/./app/containers/NavBar/NavBar.tsx","webpack://quilt-navigator/./app/components/Layout/Layout.tsx","webpack://quilt-navigator/./app/components/Lock/Lock.tsx","webpack://quilt-navigator/./app/components/Logo/index.tsx","webpack://quilt-navigator/./app/components/Logo/quilt.png","webpack://quilt-navigator/./app/components/MetadataEditor/MetadataEditor.tsx","webpack://quilt-navigator/./app/components/Placeholder/Placeholder.tsx","webpack://quilt-navigator/./app/components/SelectDropdown/SelectDropdown.tsx","webpack://quilt-navigator/./app/components/Skeleton/Skeleton.tsx","webpack://quilt-navigator/./app/constants/quiltConfigs.ts","webpack://quilt-navigator/./app/containers/AddToPackage/Provider.tsx","webpack://quilt-navigator/./app/containers/Bookmarks/Provider.tsx","webpack://quilt-navigator/./app/containers/Bookmarks/Sidebar.tsx","webpack://quilt-navigator/./app/containers/Bucket/Download.tsx","webpack://quilt-navigator/./app/containers/Bucket/Listing.tsx","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/DialogError.tsx","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/DialogLoading.tsx","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/DialogSuccess.tsx","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/EditFileMeta.tsx","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/FilesInput.tsx","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/Layout.tsx","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/gql/Manifest.generated.ts","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/Manifest.ts","webpack://quilt-navigator/./app/utils/spreadsheets/spreadsheets.ts","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/MetaInput.tsx","webpack://quilt-navigator/./app/containers/Bucket/Upload.tsx","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/gql/PackageConstruct.generated.ts","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/PackageCreationForm.tsx","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/SelectWorkflow.tsx","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/gql/PackageExists.generated.ts","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/PackageDialog.tsx","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/S3FilePicker.tsx","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/Skeleton.tsx","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/SubmitSpinner.tsx","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/Uploads.tsx","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/gql/InvalidInputSelection.generated.ts","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/gql/OperationErrorSelection.generated.ts","webpack://quilt-navigator/./app/containers/Bucket/PackageDialog/gql/PackagePushSuccessSelection.generated.ts","webpack://quilt-navigator/./app/components/ButtonIcon/ButtonIcon.tsx","webpack://quilt-navigator/./app/containers/Bucket/Section.tsx","webpack://quilt-navigator/./app/containers/Bucket/Successors.tsx","webpack://quilt-navigator/./app/containers/Bucket/WorkflowsConfigLink.tsx","webpack://quilt-navigator/./app/containers/Bucket/errors.tsx","webpack://quilt-navigator/./app/containers/Bucket/requests/bucketListing.ts","webpack://quilt-navigator/./app/containers/Bucket/requests/package.ts","webpack://quilt-navigator/./app/containers/Bucket/requests/utils.ts","webpack://quilt-navigator/./app/containers/NavBar/Help.tsx","webpack://quilt-navigator/./app/global-styles.tsx","webpack://quilt-navigator/./app/utils/BucketConfigList.generated.ts","webpack://quilt-navigator/./app/utils/BucketConfig.ts","webpack://quilt-navigator/./app/utils/BucketPreferences/BucketPreferences.ts","webpack://quilt-navigator/./app/utils/BucketPreferences/LocalProvider.tsx","webpack://quilt-navigator/./app/utils/BucketPreferences/Provider.tsx","webpack://quilt-navigator/./app/utils/CatalogSettings.tsx","webpack://quilt-navigator/./app/utils/Config.ts","webpack://quilt-navigator/./app/utils/Delay.tsx","webpack://quilt-navigator/./app/utils/JSONPointer.ts","webpack://quilt-navigator/./app/utils/NamedRoutes.tsx","webpack://quilt-navigator/./app/utils/Resource.ts","webpack://quilt-navigator/./app/utils/Sentry.ts","webpack://quilt-navigator/./app/utils/StatusReportsBucket.generated.ts","webpack://quilt-navigator/./app/utils/StatusReportsBucket.tsx","webpack://quilt-navigator/./app/utils/StyledLink.tsx","webpack://quilt-navigator/./app/utils/assertNever.ts","webpack://quilt-navigator/./app/utils/defer.ts","webpack://quilt-navigator/./app/utils/dissocBy.ts","webpack://quilt-navigator/./app/utils/dragging.ts","webpack://quilt-navigator/./app/utils/electron/events.ts","webpack://quilt-navigator/./app/utils/electron/ipc-provider.tsx","webpack://quilt-navigator/./app/utils/error.ts","webpack://quilt-navigator/./app/utils/formTools.ts","webpack://quilt-navigator/./app/utils/json-schema/json-schema.ts","webpack://quilt-navigator/./app/utils/mkSearch.ts","webpack://quilt-navigator/./app/utils/packageHandle.ts","webpack://quilt-navigator/./app/utils/parseSearch.ts","webpack://quilt-navigator/./app/utils/reactTools.tsx","webpack://quilt-navigator/./app/utils/s3paths.ts","webpack://quilt-navigator/./app/utils/taggedV2.ts","webpack://quilt-navigator/./app/utils/useMemoEq.ts","webpack://quilt-navigator/./app/utils/PotentialCollaborators.generated.ts","webpack://quilt-navigator/./app/utils/usePotentialCollaborators.ts","webpack://quilt-navigator/./app/utils/usePrevious.ts","webpack://quilt-navigator/./app/utils/useQuery.ts","webpack://quilt-navigator/./app/utils/wait.ts","webpack://quilt-navigator/./app/utils/workflows.ts","webpack://quilt-navigator/./app/utils/yaml.ts","webpack://quilt-navigator/./app/components/BreadCrumbs/BreadCrumbs.js","webpack://quilt-navigator/./app/components/Intercom/Launcher.tsx","webpack://quilt-navigator/./app/components/Intercom/Intercom.js","webpack://quilt-navigator/./app/components/JsonDisplay/JsonDisplay.js","webpack://quilt-navigator/./app/components/Message/Message.js","webpack://quilt-navigator/./app/components/Pagination2/Pagination2.js","webpack://quilt-navigator/./app/components/Thumbnail/Thumbnail.js","webpack://quilt-navigator/./app/constants/style.js","webpack://quilt-navigator/./app/constants/urls.js","webpack://quilt-navigator/./app/containers/Auth/constants.js","webpack://quilt-navigator/./app/containers/Auth/selectors.js","webpack://quilt-navigator/./app/containers/Bucket/Meta.tsx","webpack://quilt-navigator/./app/containers/Bucket/FileView.js","webpack://quilt-navigator/./app/containers/Bucket/requests/requestsUntyped.js","webpack://quilt-navigator/./app/containers/Notifications/actions.js","webpack://quilt-navigator/./app/containers/Notifications/constants.js","webpack://quilt-navigator/./app/containers/Notifications/reducer.js","webpack://quilt-navigator/./app/containers/Notifications/selectors.js","webpack://quilt-navigator/./app/containers/Notifications/Notification.js","webpack://quilt-navigator/./app/containers/Notifications/index.js","webpack://quilt-navigator/./app/utils/APIConnector.js","webpack://quilt-navigator/./app/utils/AWS/Credentials.js","webpack://quilt-navigator/./app/utils/useMemoEqLazy.js","webpack://quilt-navigator/./app/utils/AWS/Config.js","webpack://quilt-navigator/./app/utils/AWS/Athena.tsx","webpack://quilt-navigator/./app/utils/AWS/S3.js","webpack://quilt-navigator/./app/utils/AWS/Signer.js","webpack://quilt-navigator/./app/utils/AsyncResult.js","webpack://quilt-navigator/./app/utils/Data.js","webpack://quilt-navigator/./app/utils/Dialogs.js","webpack://quilt-navigator/./app/utils/ErrorBoundary.js","webpack://quilt-navigator/./app/utils/Okta.js","webpack://quilt-navigator/./app/utils/ReducerInjector.js","webpack://quilt-navigator/./app/utils/ResourceCache.js","webpack://quilt-navigator/./app/utils/SagaInjector.js","webpack://quilt-navigator/./app/utils/Store.js","webpack://quilt-navigator/./app/utils/clipboard.js","webpack://quilt-navigator/./app/utils/immutableTools.js","webpack://quilt-navigator/./app/utils/pipeThru.js","webpack://quilt-navigator/./app/utils/reduxTools.js","webpack://quilt-navigator/./app/utils/router.js","webpack://quilt-navigator/./app/utils/sagaTools.js","webpack://quilt-navigator/./app/utils/storage.js","webpack://quilt-navigator/./app/utils/string.js","webpack://quilt-navigator/./app/utils/tagged.js","webpack://quilt-navigator/./app/utils/useConstant.js","webpack://quilt-navigator/./app/utils/validators.js"],"sourcesContent":["module.exports = \"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 149 149' style='enable-background:new 0 0 149 149' xml:space='preserve'%3e%3ccircle cx='74.5' cy='74.5' r='71' style='fill:%23fff'/%3e%3cpath d='M74.5 149C33.4 149 0 115.6 0 74.5S33.4 0 74.5 0 149 33.4 149 74.5 115.6 149 74.5 149zm0-142C37.3 7 7 37.3 7 74.5S37.3 142 74.5 142 142 111.7 142 74.5 111.8 7 74.5 7z' style='fill:%23d6d6d6'/%3e%3cpath d='m112 85-5.3-3.8 4.4-35.9c.1-1.1-.2-2.3-1-3.1-.8-.9-1.8-1.3-3-1.3H42.8c-1.1 0-2.2.5-3 1.3-.8.9-1.1 2-1 3.1l7.7 63.4c.2 2 1.9 3.5 4 3.5h48.8c2 0 3.7-1.5 4-3.5l2.2-18.4 1.8 1.3c.7.5 1.5.7 2.3.7 1.2 0 2.5-.6 3.3-1.7 1.3-1.9.9-4.4-.9-5.6zm-16.2 19.2H54.1l-6.7-55.4h55.3l-3.3 27.1-17.3-12.2v-.1c0-4.1-3.3-7.4-7.4-7.4s-7.4 3.3-7.4 7.4 3.3 7.4 7.4 7.4c1.1 0 2-.2 3-.6L98.1 85l-2.3 19.2z' style='fill:%23545454'/%3e%3c/svg%3e\"","module.exports = \"data:image/svg+xml,%3csvg fill='%23587cf1' xmlns='http://www.w3.org/2000/svg' width='10' height='19'%3e%3cpath d='M2.166 3.86c0-.125.017-.394.051-.806.037-.413.192-.845.47-1.3.276-.451.723-.857 1.344-1.216C4.651.18 5.544 0 6.711 0H10v3.604H7.592c-.238 0-.46.09-.66.268-.2.177-.302.346-.302.503v2.242H10a46.08 46.08 0 01-.12 1.278l-.133 1.089c-.053.368-.108.71-.161 1.023h-2.98V19h-4.44v-8.994H0V6.617h2.166V3.86z'/%3e%3c/svg%3e\"","module.exports = \"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='20' height='16.256'%3e%3cpath d='M18.38 4.176c.16-.4.68-1.99-.17-4.14 0 0-1.31-.39-4.3 1.61-1.25-.33-2.58-.38-3.91-.38-1.32 0-2.66.05-3.91.38C3.1-.384 1.79.036 1.79.036c-.85 2.15-.33 3.74-.16 4.14C.61 5.266 0 6.646 0 8.366c0 6.44 4.16 7.89 10 7.89 5.79 0 10-1.45 10-7.89 0-1.72-.61-3.1-1.62-4.19M10 15.026c-4.12 0-7.47-.19-7.47-4.19 0-.95.47-1.85 1.27-2.58 1.34-1.23 3.63-.58 6.2-.58 2.59 0 4.85-.65 6.2.58.8.73 1.3 1.62 1.3 2.58 0 3.99-3.37 4.19-7.5 4.19m-3.14-6.26c-.82 0-1.5 1-1.5 2.22 0 1.23.68 2.24 1.5 2.24.83 0 1.5-1 1.5-2.24 0-1.23-.67-2.22-1.5-2.22m6.28 0c-.83 0-1.5.99-1.5 2.22 0 1.24.67 2.24 1.5 2.24.82 0 1.5-1 1.5-2.24 0-1.23-.64-2.22-1.5-2.22z' fill='%23587cf1'/%3e%3c/svg%3e\"","module.exports = \"data:image/svg+xml,%3csvg fill='%23587cf1' width='24' height='24' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913a5.885 5.885 0 0 0 1.384 2.126A5.868 5.868 0 0 0 4.14 23.37c.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558a5.898 5.898 0 0 0 2.126-1.384 5.86 5.86 0 0 0 1.384-2.126c.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913a5.89 5.89 0 0 0-1.384-2.126A5.847 5.847 0 0 0 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227a3.81 3.81 0 0 1-.899 1.382 3.744 3.744 0 0 1-1.38.896c-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421a3.716 3.716 0 0 1-1.379-.899 3.644 3.644 0 0 1-.9-1.38c-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678a6.162 6.162 0 1 0 0 12.324 6.162 6.162 0 1 0 0-12.324zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405a1.441 1.441 0 0 1-2.88 0 1.44 1.44 0 0 1 2.88 0z'/%3e%3c/svg%3e\"","module.exports = \"data:image/svg+xml,%3csvg fill='%23587cf1' xmlns='http://www.w3.org/2000/svg' width='310' height='310'%3e%3cpath d='M72.16 99.73H9.927a5 5 0 0 0-5 5v199.928a5 5 0 0 0 5 5H72.16a5 5 0 0 0 5-5V104.73a5 5 0 0 0-5-5zM41.066.341C18.422.341 0 18.743 0 41.362 0 63.991 18.422 82.4 41.066 82.4c22.626 0 41.033-18.41 41.033-41.038C82.1 18.743 63.692.341 41.066.341zm189.388 94.42c-24.995 0-43.472 10.745-54.679 22.954V104.73a5 5 0 0 0-5-5h-59.599a5 5 0 0 0-5 5v199.928a5 5 0 0 0 5 5h62.097a5 5 0 0 0 5-5V205.74c0-33.333 9.054-46.319 32.29-46.319 25.306 0 27.317 20.818 27.317 48.034v97.204a5 5 0 0 0 5 5H305a5 5 0 0 0 5-5V194.995c0-49.565-9.451-100.234-79.546-100.234z'/%3e%3c/svg%3e\"","module.exports = \"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='%23587cf1' width='122.8' height='122.8'%3e%3cpath d='M25.8 77.6c0 7.1-5.8 12.9-12.9 12.9C5.8 90.5 0 84.7 0 77.6c0-7.1 5.8-12.9 12.9-12.9h12.9zm6.5 0c0-7.1 5.8-12.9 12.9-12.9 7.1 0 12.9 5.8 12.9 12.9v32.3c0 7.1-5.8 12.9-12.9 12.9-7.1 0-12.9-5.8-12.9-12.9zm12.9-51.8c-7.1 0-12.9-5.8-12.9-12.9C32.3 5.8 38.1 0 45.2 0c7.1 0 12.9 5.8 12.9 12.9v12.9zm0 6.5c7.1 0 12.9 5.8 12.9 12.9 0 7.1-5.8 12.9-12.9 12.9H12.9C5.8 58.1 0 52.3 0 45.2c0-7.1 5.8-12.9 12.9-12.9zM97 45.2c0-7.1 5.8-12.9 12.9-12.9 7.1 0 12.9 5.8 12.9 12.9 0 7.1-5.8 12.9-12.9 12.9H97zm-6.5 0c0 7.1-5.8 12.9-12.9 12.9-7.1 0-12.9-5.8-12.9-12.9V12.9C64.7 5.8 70.5 0 77.6 0c7.1 0 12.9 5.8 12.9 12.9zM77.6 97c7.1 0 12.9 5.8 12.9 12.9 0 7.1-5.8 12.9-12.9 12.9-7.1 0-12.9-5.8-12.9-12.9V97zm0-6.5c-7.1 0-12.9-5.8-12.9-12.9 0-7.1 5.8-12.9 12.9-12.9h32.3c7.1 0 12.9 5.8 12.9 12.9 0 7.1-5.8 12.9-12.9 12.9z'/%3e%3c/svg%3e\"","module.exports = \"data:image/svg+xml,%3csvg fill='%23587cf1' xmlns='http://www.w3.org/2000/svg' width='20' height='17'%3e%3cpath d='M19.41 2.402a8.486 8.486 0 01-.295.08c-.603.154-.658-.048-.222-.493a4.05 4.05 0 00.518-.65c.336-.525.044-.754-.527-.509a8.252 8.252 0 01-.622.238c-.59.199-1.425-.101-1.95-.435C15.649.21 14.896 0 14.052 0c-1.183 0-2.19.419-3.024 1.255-.833.837-1.25 1.848-1.25 3.035 0 .162.009.327.027.494.03.272-.426.469-1.041.381a11.796 11.796 0 01-3.796-1.214A12.174 12.174 0 011.82 1.627c-.434-.446-1.022-.408-1.185.195A4.314 4.314 0 00.49 2.948c0 .735.172 1.417.516 2.046.17.312.371.596.601.849.387.426.328.674-.21.522-.54-.151-.934-.376-.934-.362v.027c0 1.036.324 1.946.973 2.73a4.25 4.25 0 001.391 1.117c.557.277.817.432.505.472a4.401 4.401 0 01-.972.02c-.222-.02-.263.446.075.97.269.416.613.783 1.031 1.1.426.321.885.552 1.377.693.598.171.718.483.185.804-1.32.794-2.78 1.192-4.38 1.192-.18 0-.352-.005-.517-.012-.285-.014-.094.238.457.527C2.308 16.548 4.172 17 6.178 17c1.518 0 2.942-.241 4.274-.724 1.332-.482 2.47-1.129 3.414-1.939a12.96 12.96 0 002.441-2.795 12.492 12.492 0 001.528-3.3 12.238 12.238 0 00.5-3.726c-.003-.154.404-.571.857-.998.205-.193.4-.395.586-.608.411-.468.23-.683-.368-.508z'/%3e%3c/svg%3e\"","module.exports = \"data:image/svg+xml,%3csvg width='16' height='16' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='%23F5F5F6' d='M0 0h8v8H0zM8 8h8v8H8z'/%3e%3cpath fill='%23fff' d='M8 0h8v8H8zM0 8h8v8H0z'/%3e%3c/svg%3e\"","module.exports = \"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 91.1 295.357 437.8' width='1051.841' height='1272.088'%3e%3cpath d='M300.178 168.5v282.2l-90.1-20.6v-241z' fill='%238c3123'/%3e%3cpath d='M328.678 182v257.6l-28.5 11.1V168.5zm-180.2-90.9l65.6 33.9v370l-65.6 33.9z' fill='%23e05243'/%3e%3cpath d='M-33.322 185.1l29.2-17.4v284.6l-29.2-14.3z' fill='%238c3123'/%3e%3cpath d='M33.878 176.4l52.1 12.7v241.8l-90.1 21.4V167.7z' fill='%23e05243'/%3e%3cpath d='M82.078 125v370.7l66.4 33.2V91.1z' fill='%238c3123'/%3e%3c/svg%3e\"","import cx from 'classnames'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport bucketIcon from './bucket.svg'\n\nconst useStyles = M.makeStyles((t) => ({\n  root: {\n    height: t.spacing(4),\n    width: t.spacing(4),\n  },\n}))\n\ninterface BucketIconProps\n  extends React.DetailedHTMLProps<\n    React.ImgHTMLAttributes<HTMLImageElement>,\n    HTMLImageElement\n  > {\n  alt: string\n  className?: string\n  classes?: {\n    custom?: string\n    stub?: string\n  }\n  src: string\n}\n\nexport default function BucketIcon({\n  alt,\n  className: optClassName,\n  classes: optClasses,\n  src,\n  ...props\n}: BucketIconProps) {\n  const classes = useStyles()\n\n  const className = src\n    ? cx(classes.root, optClasses?.custom, optClassName)\n    : cx(classes.root, optClasses?.stub, optClassName)\n\n  return <img alt={alt} className={className} src={src || bucketIcon} {...props} />\n}\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nconst useCodeStyles = M.makeStyles((t) => ({\n  root: {\n    background: t.palette.grey[300],\n    borderRadius: '2px',\n    color: t.palette.text.primary,\n    fontFamily: (t.typography as $TSFixMe).monospace.fontFamily,\n    padding: '0 3px',\n    whiteSpace: 'pre-wrap',\n  },\n}))\n\ninterface CodeProps {\n  children: React.ReactNode\n  className?: string\n}\n\nexport default function Code({ className, children }: CodeProps) {\n  const classes = useCodeStyles()\n  return <code className={cx(classes.root, className)}>{children}</code>\n}\n","import * as R from 'ramda'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport * as Model from 'model'\n\ntype SortKey = 'email' | 'username' | 'permissionLevel'\ntype Sort = Record<SortKey, boolean> // TODO: only one key at a time is allowed\n\nfunction getSortProperty(key: SortKey) {\n  switch (key) {\n    case 'email':\n      return R.pathOr('', ['collaborator', 'email'])\n    case 'username':\n      return R.pathOr('', ['collaborator', 'username'])\n    case 'permissionLevel':\n      return R.prop('permissionLevel')\n  }\n}\n\ninterface TableProps {\n  collaborators: Model.Collaborators\n}\n\nexport default function Table({ collaborators }: TableProps) {\n  const [sorted, setSorted] = React.useState(collaborators)\n  const [sort, setSort] = React.useState<Sort | null>(null)\n  const toggleSort = React.useCallback(\n    (key: SortKey, currentDirection?: boolean) => {\n      const direction = currentDirection === undefined ? false : !currentDirection\n      setSort({ [key]: direction } as Sort)\n\n      const preSorted = R.sortBy(getSortProperty(key))(collaborators)\n      setSorted(direction ? preSorted.reverse() : preSorted)\n    },\n    [collaborators, setSort, setSorted],\n  )\n  const hasUnmanagedRole = React.useMemo(\n    () => collaborators.find(({ permissionLevel }) => !permissionLevel),\n    [collaborators],\n  )\n\n  return (\n    <M.Table size={collaborators.length > 20 ? 'small' : 'medium'}>\n      <M.TableHead>\n        <M.TableRow>\n          <M.TableCell />\n          <M.TableCell>\n            <M.TableSortLabel\n              active={sort?.username !== undefined}\n              direction={sort?.username ? 'asc' : 'desc'}\n              onClick={() => toggleSort('username', sort?.username)}\n            >\n              Username\n            </M.TableSortLabel>\n          </M.TableCell>\n          <M.TableCell>\n            <M.TableSortLabel\n              active={sort?.email !== undefined}\n              direction={sort?.email ? 'asc' : 'desc'}\n              onClick={() => toggleSort('email', sort?.email)}\n            >\n              Email\n            </M.TableSortLabel>\n          </M.TableCell>\n          <M.TableCell>\n            <M.TableSortLabel\n              active={sort?.permissionLevel !== undefined}\n              direction={sort?.permissionLevel ? 'asc' : 'desc'}\n              onClick={() => toggleSort('permissionLevel', sort?.permissionLevel)}\n            >\n              Permission\n            </M.TableSortLabel>\n          </M.TableCell>\n        </M.TableRow>\n      </M.TableHead>\n      <M.TableBody>\n        {sorted.map(\n          ({ collaborator: { email, username }, permissionLevel = 'UNKNOWN' }) => (\n            <M.TableRow>\n              <M.TableCell padding=\"checkbox\">\n                <M.Icon>account_circle</M.Icon>\n              </M.TableCell>\n              <M.TableCell>\n                {username}\n                {permissionLevel === 'UNKNOWN' ? <sup> *</sup> : ''}\n              </M.TableCell>\n              <M.TableCell>{email}</M.TableCell>\n              <M.TableCell>{permissionLevel}</M.TableCell>\n            </M.TableRow>\n          ),\n        )}\n        {hasUnmanagedRole && (\n          <M.TableRow>\n            <M.TableCell />\n            <M.TableCell colSpan={3}>\n              <sup>*</sup> User with a role not managed by Quilt who can potentially\n              access this bucket. Ask a Quilt administrator for details.\n            </M.TableCell>\n          </M.TableRow>\n        )}\n      </M.TableBody>\n    </M.Table>\n  )\n}\n","import * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport * as Model from 'model'\n\nimport Table from './Table'\n\nconst useStyles = M.makeStyles(() => ({\n  close: {\n    marginLeft: 'auto',\n  },\n\n  title: {\n    display: 'flex',\n    alignItems: 'center',\n  },\n}))\n\ninterface PopupProps {\n  open: boolean\n  bucket: string\n  onClose: () => void\n  collaborators: Model.Collaborators\n}\n\nexport default function Popup({ bucket, open, onClose, collaborators }: PopupProps) {\n  const classes = useStyles()\n  return (\n    <M.Dialog open={open} onClose={onClose} fullWidth maxWidth=\"lg\">\n      <M.DialogTitle>\n        <div className={classes.title}>\n          Collaborators on {bucket}{' '}\n          <M.IconButton className={classes.close} onClick={onClose}>\n            <M.Icon>close</M.Icon>\n          </M.IconButton>\n        </div>\n      </M.DialogTitle>\n      <M.DialogContent>\n        <Table collaborators={collaborators} />\n      </M.DialogContent>\n      <M.DialogActions>\n        <M.Button onClick={onClose}>Close</M.Button>\n      </M.DialogActions>\n    </M.Dialog>\n  )\n}\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport * as Model from 'model'\n\nconst useStyles = M.makeStyles((t) => ({\n  root: {\n    color: t.palette.text.hint,\n  },\n  clickable: {\n    cursor: 'pointer',\n  },\n}))\n\ninterface ComponentProps {\n  badgeContent?: string\n  onClick?: () => void\n  title: string\n  icon: string\n}\n\nfunction Component({ badgeContent, icon, onClick, title }: ComponentProps) {\n  const classes = useStyles()\n  return (\n    <M.Tooltip\n      className={cx(classes.root, { [classes.clickable]: !!onClick })}\n      title={title}\n    >\n      {badgeContent ? (\n        <M.Badge badgeContent={badgeContent} color=\"secondary\" onClick={onClick} max={99}>\n          <M.Icon>{icon}</M.Icon>\n        </M.Badge>\n      ) : (\n        <M.Icon>{icon}</M.Icon>\n      )}\n    </M.Tooltip>\n  )\n}\n\ninterface BadgeProps {\n  collaborators: Model.Collaborators\n  onClick: () => void\n}\n\nexport default function Badge({ collaborators, onClick }: BadgeProps) {\n  const knownNumber = collaborators.length\n  const hasUnmanagedRole = React.useMemo(\n    () => collaborators.find(({ permissionLevel }) => !permissionLevel),\n    [collaborators],\n  )\n  if (knownNumber) {\n    return (\n      <Component\n        onClick={onClick}\n        badgeContent={hasUnmanagedRole ? `${knownNumber}+` : `${knownNumber}`}\n        title=\"Click to view collaborators\"\n        icon=\"group\"\n      />\n    )\n  }\n\n  return <Component title=\"Only you can see this bucket\" icon=\"visibility_off\" />\n}\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\nimport { fade } from '@material-ui/core/styles'\n\nimport * as Model from 'model'\n\ninterface AvatarProps {\n  className: string\n  email: string\n  index: number\n}\n\nconst useAvatarStyles = M.makeStyles((t) => ({\n  root: ({ index }: { index: number }) => {\n    const backgroundColor = index % 2 ? t.palette.info.main : t.palette.info.light\n    const color = backgroundColor ? t.palette.getContrastText(backgroundColor) : undefined\n    return {\n      backgroundColor,\n      color,\n      fontSize: '13px',\n      height: '24px',\n      textTransform: 'uppercase',\n      width: '24px',\n    }\n  },\n}))\n\nfunction Avatar({ className, email, index }: AvatarProps) {\n  const classes = useAvatarStyles({ index })\n  const title =\n    email === '?'\n      ? 'User with a role not managed by Quilt who can potentially access this bucket'\n      : email\n  return (\n    <M.Tooltip title={title}>\n      <M.Avatar className={cx(classes.root, className)}>{email.substring(0, 2)}</M.Avatar>\n    </M.Tooltip>\n  )\n}\n\nconst useStyles = M.makeStyles((t) => ({\n  root: {\n    // NOTE: base background color should be the same as NavBar bg\n    background: `linear-gradient(to left, ${fade(\n      '#2a2d69',\n      0,\n    )} 0, #2a2d69 32px, #2a2d69 100%)`,\n    cursor: 'pointer',\n    display: 'flex',\n    height: '36px',\n    position: 'relative',\n    zIndex: 1,\n  },\n  more: {\n    color: t.palette.common.white,\n    lineHeight: '36px',\n    marginLeft: '12px',\n    padding: '0 16px 0 0',\n    position: 'relative',\n    transition: 'margin 0.3s ease',\n  },\n  userpic: {\n    marginTop: '6px',\n  },\n  avatarWrapper: {\n    display: 'flex',\n    flexDirection: 'row-reverse', // workaround for z-index\n    transition: 'margin 0.3s ease',\n    '& &': {\n      margin: '0 0 0 -8px',\n    },\n    '&:hover &': {\n      margin: '0 0 0 2px',\n    },\n    '&:hover $more': {\n      marginLeft: '4px',\n    },\n  },\n}))\n\ninterface AvatarsProps {\n  className?: string\n  collaborators: Model.Collaborators\n  onClick: () => void\n}\n\nexport default function Avatars({ className, collaborators, onClick }: AvatarsProps) {\n  const knownCollaborators = collaborators.filter(\n    ({ permissionLevel }) => !!permissionLevel,\n  )\n  const potentialCollaborators = collaborators.filter(\n    ({ permissionLevel }) => !permissionLevel,\n  )\n\n  const avatars = React.useMemo(() => {\n    if (!potentialCollaborators.length) return knownCollaborators.slice(0, 5)\n    return [potentialCollaborators[0], ...knownCollaborators.slice(0, 4)]\n  }, [knownCollaborators, potentialCollaborators])\n\n  const classes = useStyles()\n  const moreNum = React.useMemo(\n    () => collaborators.length - avatars.length,\n    [avatars, collaborators],\n  )\n\n  return (\n    <div className={cx(classes.root, className)} onClick={onClick}>\n      {avatars.reduce(\n        (memo, { collaborator: { email }, permissionLevel }, index) => (\n          <div className={classes.avatarWrapper}>\n            {memo}\n            <Avatar\n              key={`${email}_${index}`}\n              className={classes.userpic}\n              email={permissionLevel ? email : '?'}\n              index={index}\n            />\n          </div>\n        ),\n        <>\n          {moreNum > 0 && (\n            <div className={classes.avatarWrapper}>\n              <M.Tooltip title=\"Click to see more collaborators\">\n                <span className={classes.more}>{moreNum}+</span>\n              </M.Tooltip>\n            </div>\n          )}\n        </>,\n      )}\n    </div>\n  )\n}\n","import * as React from 'react'\nimport * as DG from '@material-ui/data-grid'\n\nexport * from '@material-ui/data-grid'\n\nexport type DataGridProps = Omit<DG.GridComponentProps, 'licenseStatus'>\n\nexport const DataGrid = React.memo(\n  React.forwardRef<HTMLDivElement, DataGridProps>(function DataGrid(inProps, ref) {\n    const props = DG.useThemeProps({ props: inProps, name: 'MuiDataGrid' })\n    return <DG.GridComponent ref={ref} {...props} licenseStatus=\"Valid\" />\n  }),\n)\n\n// monkey-patch MUI built-in colDef to better align checkboxes\nDG.gridCheckboxSelectionColDef.width = 32\n","import * as React from 'react'\n\nimport * as JSONPointer from 'utils/JSONPointer'\nimport type { JsonRecord } from 'utils/types'\n\nexport interface ToolbarProps {\n  columnPath: JSONPointer.Path\n  onChange: (func: (v: JsonRecord) => JsonRecord) => void\n}\n\ninterface ToolbarOptions {\n  Toolbar: React.FC<ToolbarProps>\n}\n\nconst Ctx = React.createContext<ToolbarOptions | null>(null)\n\ninterface ProviderProps {\n  children: React.ReactNode\n  value: ToolbarOptions\n}\n\nexport function Provider({ children, value }: ProviderProps) {\n  return <Ctx.Provider value={value}>{children}</Ctx.Provider>\n}\n\nexport const useToolbar = () => React.useContext(Ctx)\nexport const use = useToolbar\n","export default __webpack_public_path__ + \"a88e6e0b58b1b099ee041d050fcf8485.webm\";","export default __webpack_public_path__ + \"cf288c1bce2e802f69280e6ec971ae15.webm\";","import cx from 'classnames'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport * as JSONPointer from 'utils/JSONPointer'\n\nconst useStyles = M.makeStyles((t) => ({\n  buttonCell: {\n    border: `1px solid ${t.palette.grey[400]}`,\n    borderWidth: `1px 0 0`,\n    padding: t.spacing(1, 0),\n    width: t.spacing(20),\n  },\n  emptyCell: {\n    border: `1px solid ${t.palette.grey[400]}`,\n    borderWidth: `1px 0 0`,\n  },\n}))\n\ninterface AddArrayItemProps {\n  className?: string\n  columnPath: JSONPointer.Path\n  index: number\n  onAdd: (path: JSONPointer.Path, index: number, value: string) => void\n}\n\nexport default function AddArrayItem({\n  className,\n  columnPath,\n  index,\n  onAdd,\n}: AddArrayItemProps) {\n  const classes = useStyles()\n\n  const onClick = React.useCallback(() => {\n    onAdd(columnPath, index, '')\n  }, [columnPath, index, onAdd])\n\n  return (\n    <M.TableRow>\n      <M.TableCell className={cx(classes.buttonCell, className)}>\n        <M.Button variant=\"outlined\" size=\"small\" onClick={onClick}>\n          Add array item\n        </M.Button>\n      </M.TableCell>\n      <M.TableCell className={classes.emptyCell} />\n    </M.TableRow>\n  )\n}\n","import type { ErrorObject } from 'ajv'\n\nimport { JsonDictItem } from './State'\n\n// TODO: any JSON or EMPTY_VALUE\nexport type JsonValue = $TSFixMe\n\nexport type ValidationErrors = (Error | ErrorObject)[]\n\n// TODO: make different types for filled and empty rows\n// TODO: add `updateMyData: (path: string[], id: 'key' | 'value', value: JsonValue) => void`\nexport type RowData = JsonDictItem\n\n// TODO: use enum, when conversion to typescript will be done\nconst KEY: 'key' = 'key'\nconst VALUE: 'value' = 'value'\n\nexport const COLUMN_IDS = {\n  KEY,\n  VALUE,\n}\n\nexport const EMPTY_VALUE = Symbol('empty')\n","import * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport { JsonValue, EMPTY_VALUE } from './constants'\n\nconst isNumber = (v: any) => typeof v === 'number' && !Number.isNaN(v)\n\nconst useContextMenuStyles = M.makeStyles((t) => ({\n  group: {\n    padding: t.spacing(1, 2, 2),\n    '& + &': {\n      borderTop: `1px solid ${t.palette.divider}`,\n      paddingTop: t.spacing(2),\n    },\n  },\n  title: {\n    marginBottom: t.spacing(1),\n  },\n}))\n\ninterface ContextMenuProps {\n  anchorEl: HTMLElement\n  open: boolean\n  onChange: (value: JsonValue) => void\n  onClose: () => void\n  value: JsonValue\n}\n\nexport default function ContextMenu({\n  anchorEl,\n  open,\n  onChange,\n  onClose,\n  value,\n}: ContextMenuProps) {\n  const classes = useContextMenuStyles()\n\n  const bootstrapObject = React.useCallback(() => {\n    onChange({})\n    onClose()\n  }, [onChange, onClose])\n  const bootstrapArray = React.useCallback(() => {\n    onChange([])\n    onClose()\n  }, [onChange, onClose])\n  const convertToNumber = React.useCallback(() => {\n    onChange(Number(value))\n    onClose()\n  }, [onChange, onClose, value])\n  const convertToString = React.useCallback(() => {\n    onChange(`${value}`)\n    onClose()\n  }, [onChange, onClose, value])\n\n  const isConvertibleToNumber = React.useMemo(() => {\n    try {\n      return !isNumber(value) && isNumber(Number(value))\n    } catch (error) {\n      return false\n    }\n  }, [value])\n  const isConvertibleToString = React.useMemo(() => typeof value !== 'string', [value])\n  const isConvertible = React.useMemo(\n    () => value !== EMPTY_VALUE && (isConvertibleToNumber || isConvertibleToString),\n    [value, isConvertibleToNumber, isConvertibleToString],\n  )\n\n  return (\n    <M.Menu anchorEl={anchorEl} open={open} onClose={onClose}>\n      <div className={classes.group}>\n        <M.Typography className={classes.title} variant=\"subtitle1\">\n          Bootstrap value as:\n        </M.Typography>\n        <M.ButtonGroup variant=\"outlined\" size=\"small\">\n          <M.Button startIcon={<M.Icon>data_object</M.Icon>} onClick={bootstrapObject}>\n            Object\n          </M.Button>\n          <M.Button startIcon={<M.Icon>data_array</M.Icon>} onClick={bootstrapArray}>\n            Array\n          </M.Button>\n        </M.ButtonGroup>\n      </div>\n\n      {isConvertible && (\n        <div className={classes.group}>\n          <M.Typography className={classes.title} variant=\"subtitle1\">\n            Convert to:\n          </M.Typography>\n          <M.ButtonGroup variant=\"outlined\" size=\"small\">\n            {isConvertibleToNumber && (\n              <M.Button startIcon={<M.Icon>filter_1</M.Icon>} onClick={convertToNumber}>\n                Number\n              </M.Button>\n            )}\n            {isConvertibleToString && (\n              <M.Button startIcon={<M.Icon>abc</M.Icon>} onClick={convertToString}>\n                String\n              </M.Button>\n            )}\n          </M.ButtonGroup>\n        </div>\n      )}\n    </M.Menu>\n  )\n}\n","import { JsonValue } from './constants'\n\nexport const stringifyJSON = (obj: JsonValue) => JSON.stringify(obj, null, 2)\n\nexport function parseJSON(str: string) {\n  try {\n    return JSON.parse(str)\n  } catch (e) {\n    return str\n  }\n}\n","import * as R from 'ramda'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport { JsonValue, EMPTY_VALUE } from './constants'\nimport { stringifyJSON } from './utils'\n\nconst useArrayStyles = M.makeStyles((t) => ({\n  lbracket: {\n    color: t.palette.secondary.dark,\n    marginRight: t.spacing(0.5),\n  },\n  rbracket: {\n    color: t.palette.secondary.dark,\n    marginLeft: t.spacing(0.5),\n  },\n}))\n\nconst useObjectStyles = M.makeStyles((t) => ({\n  lbrace: {\n    color: t.palette.secondary.dark,\n    marginRight: t.spacing(0.5),\n  },\n  rbrace: {\n    color: t.palette.secondary.dark,\n    marginLeft: t.spacing(0.5),\n  },\n}))\n\ninterface PreviewArrayProps {\n  value: JsonValue[]\n}\n\nfunction PreviewArray({ value }: PreviewArrayProps) {\n  const classes = useArrayStyles()\n\n  const items = React.useMemo(\n    () =>\n      value.map((item, index) => ({\n        key: `${item}+${index}`,\n        value: item,\n        hasDelimiter: index < value.length - 1,\n      })),\n    [value],\n  )\n\n  return (\n    <span>\n      <span className={classes.lbracket}>[</span>\n      {items.map((item) => (\n        <span key={item.key}>\n          <PreviewValue value={item.value} />\n          {item.hasDelimiter && ', '}\n        </span>\n      ))}\n      <span className={classes.rbracket}>]</span>\n    </span>\n  )\n}\n\ninterface PreviewObjectProps {\n  value: JsonValue\n}\n\nfunction PreviewObject({ value }: PreviewObjectProps) {\n  const classes = useObjectStyles()\n\n  const hintText = React.useMemo(() => stringifyJSON(value), [value])\n\n  return (\n    <M.Tooltip title={hintText}>\n      <span>\n        <span className={classes.lbrace}>&#123;</span>\n        {Object.keys(value).join(', ')}\n        <span className={classes.rbrace}>&#125;</span>\n      </span>\n    </M.Tooltip>\n  )\n}\n\ninterface PreviewValueProps {\n  value: JsonValue\n}\n\nexport default function PreviewValue({ value }: PreviewValueProps) {\n  if (value === EMPTY_VALUE || value === undefined) return ''\n\n  if (Array.isArray(value)) return <PreviewArray value={value} />\n\n  if (R.is(Object, value)) return <PreviewObject value={value} />\n\n  if (value === null) return 'null'\n\n  if (R.is(String, value)) return <span>&quot;{value}&quot;</span>\n\n  return value.toString()\n}\n","import * as React from 'react'\nimport * as M from '@material-ui/core'\nimport * as Lab from '@material-ui/lab'\n\nimport { isSchemaEnum, findTypeInCompoundSchema } from 'utils/json-schema'\n\nimport PreviewValue from './PreviewValue'\nimport { JsonValue, EMPTY_VALUE, RowData } from './constants'\nimport { stringifyJSON } from './utils'\n\nconst useStyles = M.makeStyles((t) => ({\n  root: {\n    height: t.spacing(4),\n    position: 'relative',\n  },\n  select: {\n    ...t.typography.body2,\n    padding: t.spacing(0, 1),\n    outline: `2px solid ${t.palette.primary.light}`,\n  },\n}))\n\ninterface EnumSelectProps {\n  data: RowData\n  onChange: (value: JsonValue) => void\n  onContextMenu: React.MouseEventHandler<HTMLElement>\n  value: JsonValue\n}\n\nexport default function EnumSelect({\n  data,\n  onChange,\n  onContextMenu,\n  value,\n}: EnumSelectProps) {\n  const classes = useStyles()\n\n  const options = findTypeInCompoundSchema(isSchemaEnum, data.valueSchema)?.enum\n  if (!options) throw new Error('This is not enum')\n\n  const [innerValue, setInnerValue] = React.useState(() =>\n    value === EMPTY_VALUE ? '' : JSON.stringify(value),\n  )\n\n  const handleBlur = React.useCallback(() => onChange(innerValue), [innerValue, onChange])\n\n  return (\n    <div className={classes.root} onContextMenu={onContextMenu}>\n      <Lab.Autocomplete\n        className={classes.select}\n        freeSolo\n        getOptionLabel={(option) => {\n          if (option === EMPTY_VALUE) return ''\n          if (typeof option === 'string') return option\n          return stringifyJSON(option)\n        }}\n        inputValue={innerValue}\n        onChange={(e, newValue) => newValue !== null && onChange(newValue)}\n        onInputChange={(e, newValue) => setInnerValue(newValue)}\n        openOnFocus\n        options={options}\n        renderInput={({ InputProps, inputProps, ...rest }) => (\n          <M.TextField\n            autoFocus\n            {...rest}\n            InputProps={{\n              ...InputProps,\n              disableUnderline: true,\n            }}\n            // eslint-disable-next-line react/jsx-no-duplicate-props\n            inputProps={inputProps}\n            onBlur={handleBlur}\n          />\n        )}\n        renderOption={(option) => <PreviewValue value={option} />}\n        value={value}\n      />\n    </div>\n  )\n}\n","import * as R from 'ramda'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport { JsonSchema } from 'utils/json-schema'\n\nimport { JsonValue, COLUMN_IDS, EMPTY_VALUE, RowData } from './constants'\nimport { parseJSON, stringifyJSON } from './utils'\n\nconst useStyles = M.makeStyles((t) => ({\n  root: {\n    ...t.typography.body2,\n    outline: `2px solid ${t.palette.primary.light}`,\n    padding: t.spacing(0, 1),\n    position: 'relative',\n    width: '100%',\n    zIndex: 1,\n  },\n}))\n\nfunction getNormalizedValue(value: JsonValue, optSchema?: JsonSchema): JsonValue {\n  // TODO: use json-schema#getEmptyValueFromSchema\n  if (!optSchema && value === '') return EMPTY_VALUE // FIXME: think more on this\n\n  if (value !== EMPTY_VALUE) return value\n\n  if (!optSchema) return ''\n\n  if (optSchema.enum && optSchema.enum.length) return optSchema.enum[0]\n\n  if (optSchema.type) {\n    switch (optSchema.type) {\n      case 'string':\n        return ''\n      case 'number':\n        return 0\n      case 'object':\n        return {}\n      case 'null':\n        return null\n      case 'boolean':\n        return true\n      case 'array':\n        return []\n      // no default\n    }\n  }\n\n  return ''\n}\n\nfunction getNormalizedValueStr(value: JsonValue, optSchema?: JsonSchema) {\n  const normalizedValue = getNormalizedValue(value, optSchema)\n\n  // FIXME: think more on this\n  if (optSchema && (optSchema.type === 'null' || optSchema.type === 'boolean'))\n    return normalizedValue\n\n  if (normalizedValue === EMPTY_VALUE) return ''\n\n  if (normalizedValue === '\"') return '\"'\n\n  return stringifyJSON(normalizedValue)\n}\n\nfunction hasBrackets(valueStr: string) {\n  if (valueStr.length < 2) return false\n  return [\n    ['\"', '\"'],\n    ['[', ']'],\n    ['{', '}'],\n  ].some(([leftBracket, rightBracket]) =>\n    R.both(R.startsWith(leftBracket), R.endsWith(rightBracket))(valueStr),\n  )\n}\n\nconst willBeNullInJson = (value: JsonValue) =>\n  typeof value === 'number' && !Number.isFinite(value)\n\ninterface OnChange {\n  (value: JsonValue): void\n  (value: string): void\n}\n\ninterface InputProps {\n  columnId: 'key' | 'value'\n  data: RowData\n  onChange: OnChange\n  onContextMenu: React.MouseEventHandler<HTMLElement>\n  placeholder: string\n  value: JsonValue\n}\n\nexport default function Input({\n  columnId,\n  data,\n  onChange,\n  onContextMenu,\n  placeholder,\n  value: originalValue,\n}: InputProps) {\n  const classes = useStyles()\n\n  const [value, setValue] = React.useState(() =>\n    getNormalizedValue(originalValue, data.valueSchema),\n  )\n  const [valueStr, setValueStr] = React.useState(() =>\n    getNormalizedValueStr(originalValue, data.valueSchema),\n  )\n\n  const inputRef = React.useRef<HTMLInputElement | null>(null)\n  React.useEffect(() => {\n    if (!inputRef.current || !valueStr) return\n    if (hasBrackets(valueStr)) {\n      // Set cursor before closing bracket/quote/brace\n      inputRef.current.setSelectionRange(valueStr.length - 1, valueStr.length - 1)\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  const onChangeInternal = React.useCallback(\n    (event) => {\n      setValue(parseJSON(event.target.value))\n      setValueStr(event.target.value)\n    },\n    [setValue, setValueStr],\n  )\n\n  const onBlur = React.useCallback(() => {\n    if (R.is(String, value)) return onChange(value)\n    if (columnId === COLUMN_IDS.KEY) return onChange(valueStr)\n    if (willBeNullInJson(value)) return onChange(null)\n    return onChange(value)\n  }, [onChange, columnId, value, valueStr])\n\n  const onKeyDown = React.useCallback(\n    (event) => {\n      switch (event.key) {\n        case 'Escape':\n          event.stopPropagation() // avoid closing the dialog\n          break\n        case 'Enter':\n          event.preventDefault() // avoid submitting the form\n          onBlur()\n          break\n        // no default\n      }\n    },\n    [onBlur],\n  )\n\n  const handleContextMenu = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault()\n    onContextMenu(event)\n  }\n\n  return (\n    <M.InputBase\n      autoFocus\n      inputRef={inputRef}\n      className={classes.root}\n      value={valueStr}\n      onChange={onChangeInternal}\n      onContextMenu={handleContextMenu}\n      onBlur={onBlur}\n      onKeyDown={onKeyDown}\n      placeholder={placeholder}\n    />\n  )\n}\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nconst useStyles = M.makeStyles((t) => ({\n  root: {\n    cursor: 'pointer',\n    margin: t.spacing(0, 1, 0, 0),\n  },\n}))\n\ninterface ButtonExpandProps {\n  className?: string\n  onClick: () => void\n}\n\nexport default function ButtonExpand({ className, onClick }: ButtonExpandProps) {\n  const classes = useStyles()\n\n  return (\n    <M.InputAdornment\n      className={cx(classes.root, className)}\n      onClick={onClick}\n      position=\"start\"\n    >\n      <M.Icon fontSize=\"small\">arrow_right</M.Icon>\n    </M.InputAdornment>\n  )\n}\n","import * as React from 'react'\nimport * as M from '@material-ui/core'\n\nconst useStyles = M.makeStyles((t) => ({\n  tooltip: {\n    ...t.typography.body1,\n    backgroundColor: t.palette.common.white,\n    border: `1px solid ${t.palette.divider}`,\n    boxShadow: t.shadows[8],\n    color: t.palette.text.primary,\n    maxWidth: t.spacing(30),\n    padding: t.spacing(1),\n  },\n}))\n\nexport default function StyledTooltip(props: M.TooltipProps) {\n  const classes = useStyles()\n  return <M.Tooltip classes={classes} {...props} />\n}\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport Code from 'components/Code'\nimport StyledTooltip from 'utils/StyledTooltip'\nimport {\n  JsonSchema,\n  doesTypeMatchSchema,\n  schemaTypeToHumanString,\n} from 'utils/json-schema'\nimport { printObject } from 'utils/string'\n\nimport {\n  JsonValue,\n  COLUMN_IDS,\n  EMPTY_VALUE,\n  RowData,\n  ValidationErrors,\n} from './constants'\n\ninterface TypeHelpArgs {\n  errors: ValidationErrors\n  humanReadableSchema: string\n  mismatch: boolean\n  schema?: JsonSchema\n}\n\nfunction getExamples(examples: JsonValue[]) {\n  if (examples.length > 1)\n    return [\n      'Examples:',\n      ...examples.map((example) => <Code>{printObject(example)}</Code>),\n    ]\n  return ['Example:', <Code>{printObject(examples[0])}</Code>]\n}\n\nfunction getTypeHelps({ errors, humanReadableSchema, mismatch, schema }: TypeHelpArgs) {\n  const output: React.ReactNode[][] = []\n\n  if (errors.length) {\n    output.push(errors.filter(Boolean).map(({ message }) => message) as string[])\n  }\n\n  if (humanReadableSchema) {\n    if (humanReadableSchema === 'undefined') {\n      output.push(['Key/value is not restricted by schema'])\n    } else {\n      output.push([`${mismatch ? 'Required type' : 'Type'}: ${humanReadableSchema}`])\n    }\n  }\n\n  if (schema?.description) {\n    output.push([`Description: ${schema.description}`])\n  }\n\n  if (schema?.examples && schema.examples.length) {\n    output.push(getExamples(schema.examples))\n  }\n\n  return output\n}\n\nconst useTypeHelpStyles = M.makeStyles((t) => ({\n  group: {\n    '& + &': {\n      borderTop: `1px solid ${t.palette.divider}`,\n      marginTop: t.spacing(1),\n      paddingTop: t.spacing(1),\n    },\n  },\n  item: {\n    margin: t.spacing(0.5, 0, 0),\n  },\n}))\n\ninterface TypeHelpProps {\n  typeHelps: React.ReactNode[][]\n}\n\nfunction TypeHelp({ typeHelps: groups }: TypeHelpProps) {\n  const classes = useTypeHelpStyles()\n  return (\n    <div>\n      {groups.map((group, i) => (\n        <div className={classes.group} key={`typeHelp_group_${i}`}>\n          {group.map((typeHelp, j) => (\n            <p className={classes.item} key={`typeHelp_${i}_${j}`}>\n              {typeHelp}\n            </p>\n          ))}\n        </div>\n      ))}\n    </div>\n  )\n}\n\ninterface NoteValueProps {\n  errors: ValidationErrors\n  schema?: JsonSchema\n  value: JsonValue\n}\n\nconst useNoteValueStyles = M.makeStyles((t) => ({\n  default: {\n    color: t.palette.divider,\n    fontFamily: (t.typography as $TSFixMe).monospace.fontFamily,\n    fontSize: t.typography.caption.fontSize,\n    display: 'flex',\n    '&:hover': {\n      color: t.palette.text.disabled,\n    },\n  },\n  mismatch: {\n    color: t.palette.error.main,\n  },\n}))\n\nfunction NoteValue({ errors, schema, value }: NoteValueProps) {\n  const classes = useNoteValueStyles()\n\n  const humanReadableSchema = schemaTypeToHumanString(schema)\n  const mismatch = value !== EMPTY_VALUE && !doesTypeMatchSchema(value, schema)\n\n  const typeHelps = React.useMemo(\n    () => getTypeHelps({ errors, humanReadableSchema, mismatch, schema }),\n    [errors, humanReadableSchema, mismatch, schema],\n  )\n  if (!typeHelps.length) return null\n\n  return (\n    <StyledTooltip title={<TypeHelp typeHelps={typeHelps} />}>\n      <span\n        className={cx(classes.default, {\n          [classes.mismatch]: mismatch,\n        })}\n      >\n        {<M.Icon>info_outlined</M.Icon>}\n      </span>\n    </StyledTooltip>\n  )\n}\n\ninterface NoteProps {\n  columnId: 'key' | 'value'\n  data: RowData\n  value: JsonValue\n}\n\nexport default function Note({ columnId, data, value }: NoteProps) {\n  if (columnId === COLUMN_IDS.VALUE) {\n    return <NoteValue errors={data.errors} schema={data.valueSchema} value={value} />\n  }\n\n  return null\n}\n","import cx from 'classnames'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport { JsonSchema, isNestedType } from 'utils/json-schema'\n\nimport ButtonExpand from './ButtonExpand'\nimport Note from './Note'\nimport PreviewValue from './PreviewValue'\nimport { JsonValue, COLUMN_IDS, EMPTY_VALUE, RowData } from './constants'\n\nconst useStyles = M.makeStyles((t) => ({\n  root: {\n    ...t.typography.body2,\n    alignItems: 'center',\n    display: 'flex',\n    height: t.spacing(4),\n    lineHeight: `${t.spacing(4)}px`,\n    padding: t.spacing(0, 1),\n    position: 'relative',\n    width: '100%',\n  },\n  button: {\n    opacity: 0.3,\n    '&:hover': {\n      opacity: 1,\n    },\n  },\n  value: {\n    flexGrow: 1,\n    height: t.spacing(4),\n    lineHeight: `${t.spacing(4) - 2}px`,\n    marginRight: t.spacing(1),\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n  },\n  placeholder: {\n    color: t.palette.text.disabled,\n  },\n  required: {\n    fontWeight: t.typography.fontWeightBold,\n  },\n  menu: {\n    marginLeft: 'auto',\n  },\n}))\n\nconst isExpandable = (value: JsonValue, schema?: JsonSchema) =>\n  value === EMPTY_VALUE ? isNestedType(schema) : R.is(Object, value)\n\nconst hasDeleteButton = (\n  columnId: 'key' | 'value',\n  value: JsonValue,\n  schema?: JsonSchema,\n) => {\n  // Remove button is shown in key field\n  if (columnId !== COLUMN_IDS.KEY) return false\n  // Remove button is shown only when key is set\n  if (value === EMPTY_VALUE) return false\n  // No button if key is a placeholder from Schema and it's not array index\n  if (schema && typeof value !== 'number') return false\n  return true\n}\n\ninterface PreviewProps {\n  columnId: 'key' | 'value'\n  data: RowData // NOTE: react-table's row.original\n  onContextMenu: React.MouseEventHandler<HTMLElement>\n  onExpand: () => void\n  onRemove: () => void\n  placeholder: string\n  title: string\n  value: JsonValue\n}\n\nexport default function Preview({\n  columnId,\n  data,\n  onContextMenu,\n  onExpand,\n  onRemove,\n  placeholder,\n  title,\n  value,\n}: PreviewProps) {\n  const classes = useStyles()\n\n  const requiredKey = data.required && columnId === COLUMN_IDS.KEY\n  const isEmpty = React.useMemo(() => value === EMPTY_VALUE, [value])\n\n  return (\n    <div className={classes.root} onContextMenu={onContextMenu}>\n      {isExpandable(value, data.valueSchema) && <ButtonExpand onClick={onExpand} />}\n\n      <div className={classes.value} title={title}>\n        <span\n          className={cx({\n            [classes.required]: requiredKey,\n            [classes.placeholder]: isEmpty,\n          })}\n        >\n          {isEmpty ? placeholder : <PreviewValue value={value} />}\n        </span>\n      </div>\n\n      <Note {...{ columnId, data, value }} />\n\n      {hasDeleteButton(columnId, value, data.valueSchema) && (\n        <M.IconButton\n          className={classes.button}\n          onClick={onRemove}\n          size=\"small\"\n          title=\"Remove\"\n        >\n          <M.Icon fontSize=\"small\">delete</M.Icon>\n        </M.IconButton>\n      )}\n    </div>\n  )\n}\n","import cx from 'classnames'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport * as RTable from 'react-table'\nimport * as M from '@material-ui/core'\n\nimport * as JSONPointer from 'utils/JSONPointer'\nimport { isSchemaEnum } from 'utils/json-schema'\n\nimport ContextMenu from './ContextMenu'\nimport EnumSelect from './EnumSelect'\nimport Input from './Input'\nimport Preview from './Preview'\nimport { COLUMN_IDS, JsonValue, RowData, EMPTY_VALUE } from './constants'\nimport { parseJSON } from './utils'\n\nconst useStyles = M.makeStyles((t) => ({\n  root: {\n    '&:focus': {\n      outline: `1px solid ${t.palette.primary.light}`,\n    },\n  },\n  disabled: {\n    cursor: 'not-allowed',\n  },\n}))\n\nconst cellPlaceholders = {\n  [COLUMN_IDS.KEY]: 'Key',\n  [COLUMN_IDS.VALUE]: 'Value',\n}\n\ninterface CellProps {\n  column: RTable.Column<{ id: 'key' | 'value' }>\n  columnPath: JSONPointer.Path\n  contextMenuPath: JSONPointer.Path\n  editing: boolean\n  onContextMenu: (path: JSONPointer.Path) => void\n  onExpand: (path: JSONPointer.Path) => void\n  onRemove: (path: JSONPointer.Path) => void\n  row: Pick<RTable.Row<RowData>, 'original' | 'values'>\n  updateMyData: (path: JSONPointer.Path, id: 'key' | 'value', value: JsonValue) => void\n  value: JsonValue\n}\n\nexport default function Cell({\n  column,\n  columnPath,\n  contextMenuPath,\n  editing: editingInitial,\n  onContextMenu,\n  onExpand,\n  onRemove,\n  row,\n  updateMyData,\n  value: initialValue,\n}: CellProps) {\n  const classes = useStyles()\n\n  const [value, setValue] = React.useState(initialValue)\n\n  const [editing, setEditing] = React.useState(editingInitial)\n\n  const key = row.values[COLUMN_IDS.KEY]\n  const fieldPath = React.useMemo(() => columnPath.concat(key), [columnPath, key])\n  const hasKey = React.useMemo(() => key !== EMPTY_VALUE, [key])\n\n  const onChange = React.useCallback(\n    (newValue) => {\n      setValue(newValue)\n      updateMyData(fieldPath, column.id as 'key' | 'value', newValue)\n      setEditing(false)\n    },\n    [column.id, fieldPath, updateMyData],\n  )\n\n  const isKeyCell = column.id === COLUMN_IDS.KEY\n  const isValueCell = column.id === COLUMN_IDS.VALUE\n\n  const isEditable = React.useMemo(\n    () => !(isKeyCell && row.original.valueSchema),\n    [isKeyCell, row.original],\n  )\n\n  const isEnumCell = React.useMemo(\n    () => isValueCell && isSchemaEnum(row.original.valueSchema),\n    [isValueCell, row],\n  )\n\n  const onDoubleClick = React.useCallback(() => {\n    if (!isEditable) return\n    setEditing(true)\n  }, [isEditable, setEditing])\n\n  const onKeyPress = React.useCallback(\n    (event) => {\n      if (editing) return\n\n      // Chromium able to send key event to Input created after this key event.\n      // Avoid to send this key event to Input constistently with Firefox\n      event.preventDefault()\n\n      // Do nothing, if it's a key cell provided by schema\n      if (!isEditable) return\n\n      // When user start typing he enters first symbol.\n      // Preview is replaced by Input, this first symbol sets to Input and resets previous text\n      // If user hit Enter Preview is replaced by Input, and Input contains previous text\n      if (event.key.length !== 1 && event.key !== 'Enter') return\n\n      if (event.key.length === 1) {\n        switch (event.key) {\n          case '\"':\n            setValue('\"')\n            break\n          case '[':\n            setValue([])\n            break\n          case '{':\n            setValue({})\n            break\n          default:\n            setValue(parseJSON(event.key))\n            break\n        }\n      }\n      setEditing(true)\n    },\n    [editing, isEditable, setEditing],\n  )\n\n  const ValueComponent = React.useMemo(() => {\n    if (editing && isEnumCell) return EnumSelect\n    if (editing) return Input\n    return Preview\n  }, [editing, isEnumCell])\n\n  const addressPath = React.useMemo(() => [...columnPath, key], [columnPath, key])\n  const [anchorEl, setAnchorEl] = React.useState<HTMLDivElement | null>(null)\n  const handleContextMenu = React.useCallback(\n    (event) => {\n      event.preventDefault()\n      onContextMenu(addressPath)\n    },\n    [onContextMenu, addressPath],\n  )\n\n  return (\n    <div\n      className={cx(classes.root, { [classes.disabled]: !isEditable })}\n      onDoubleClick={onDoubleClick}\n      onKeyPress={onKeyPress}\n      ref={setAnchorEl}\n      role=\"textbox\"\n      tabIndex={isEditable ? 0 : undefined}\n    >\n      <ValueComponent\n        {...{\n          columnId: column.id as 'key' | 'value',\n          data: row.original,\n          onChange,\n          onContextMenu: handleContextMenu,\n          onExpand: React.useCallback(() => onExpand(fieldPath), [fieldPath, onExpand]),\n          onRemove: React.useCallback(() => onRemove(fieldPath), [fieldPath, onRemove]),\n          placeholder: cellPlaceholders[column.id as 'key' | 'value'],\n          title: isEditable ? 'Click to edit' : '',\n          value,\n        }}\n      />\n\n      {anchorEl && isValueCell && hasKey && (\n        <ContextMenu\n          onChange={onChange}\n          anchorEl={anchorEl}\n          open={R.equals(contextMenuPath, addressPath)}\n          onClose={() => onContextMenu([])}\n          value={value}\n        />\n      )}\n    </div>\n  )\n}\n","import * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport * as JSONPointer from 'utils/JSONPointer'\n\nimport Cell from './Cell'\nimport { COLUMN_IDS, EMPTY_VALUE, JsonValue } from './constants'\n\nconst useStyles = M.makeStyles((t) => ({\n  inputCell: {\n    border: `1px solid ${t.palette.grey[400]}`,\n    padding: 0,\n    width: '50%',\n    [t.breakpoints.up('lg')]: {\n      width: t.spacing(27),\n    },\n  },\n  emptyCell: {\n    border: `1px solid ${t.palette.grey[400]}`,\n    padding: 0,\n    width: '50%',\n    [t.breakpoints.up('lg')]: {\n      width: t.spacing(40),\n    },\n  },\n}))\n\nconst emptyKeyProps = {\n  column: {\n    id: COLUMN_IDS.KEY,\n  },\n  row: {\n    original: {\n      address: [],\n      errors: [],\n      key: '',\n      reactId: '',\n      required: false,\n      sortIndex: -1,\n      type: 'undefined',\n      updateMyData: () => {},\n      value: '',\n      valueSchema: undefined,\n    },\n    values: {\n      [COLUMN_IDS.KEY]: EMPTY_VALUE,\n      [COLUMN_IDS.VALUE]: EMPTY_VALUE,\n    },\n  },\n  value: EMPTY_VALUE,\n}\n\nconst emptyValueProps = {\n  column: {\n    id: COLUMN_IDS.VALUE,\n  },\n  row: {\n    original: {\n      address: [],\n      errors: [],\n      key: '',\n      reactId: '',\n      required: false,\n      sortIndex: -1,\n      type: 'undefined',\n      updateMyData: () => {},\n      value: '',\n      valueSchema: undefined,\n    },\n    values: {\n      [COLUMN_IDS.KEY]: EMPTY_VALUE,\n      [COLUMN_IDS.VALUE]: EMPTY_VALUE,\n    },\n  },\n  value: EMPTY_VALUE,\n}\n\ninterface AddRowProps {\n  columnPath: JSONPointer.Path\n  contextMenuPath: JSONPointer.Path\n  onAdd: (path: JSONPointer.Path, key: string, value: JsonValue) => void\n  onContextMenu: (path: JSONPointer.Path) => void\n  onExpand: (path: JSONPointer.Path) => void\n}\n\nexport default function AddRow({\n  columnPath,\n  contextMenuPath,\n  onAdd,\n  onContextMenu,\n  onExpand,\n}: AddRowProps) {\n  const classes = useStyles()\n\n  const [value, setValue] = React.useState('')\n\n  const onChangeKey = React.useCallback(\n    (_1, _2, key) => {\n      if (!key) return\n      onAdd(columnPath, key, value)\n    },\n    [columnPath, value, onAdd],\n  )\n\n  const onChangeValue = React.useCallback(\n    (_1, _2, newValue) => {\n      if (newValue === undefined || newValue === EMPTY_VALUE) return\n      setValue(newValue)\n    },\n    [setValue],\n  )\n\n  const onRemove = React.useCallback(() => {}, [])\n\n  return (\n    <M.TableRow>\n      <M.TableCell className={classes.inputCell}>\n        <Cell\n          {...{\n            ...emptyKeyProps,\n            columnPath,\n            contextMenuPath,\n            editing: false,\n            onContextMenu,\n            onExpand,\n            onRemove,\n            updateMyData: onChangeKey,\n          }}\n        />\n      </M.TableCell>\n\n      <M.TableCell className={classes.emptyCell}>\n        <Cell\n          {...{\n            ...emptyValueProps,\n            columnPath,\n            contextMenuPath,\n            editing: false,\n            onContextMenu,\n            onExpand,\n            onRemove,\n            updateMyData: onChangeValue,\n          }}\n        />\n      </M.TableCell>\n    </M.TableRow>\n  )\n}\n","import * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport * as JSONPointer from 'utils/JSONPointer'\n\nconst useOverrideStyles = M.makeStyles({\n  li: {\n    '&::before': {\n      position: 'absolute', // Workaround for sanitize.css a11y styles\n    },\n  },\n  separator: {\n    alignItems: 'center',\n  },\n})\n\nconst useItemStyles = M.makeStyles({\n  root: {\n    cursor: 'pointer',\n    display: 'flex',\n  },\n})\n\ninterface ItemProps {\n  children: React.ReactNode\n  index: number\n  onClick: (index: number) => void\n}\n\nfunction Item({ index, children, onClick }: ItemProps) {\n  const classes = useItemStyles()\n\n  return (\n    <M.Link\n      onClick={React.useCallback(() => onClick(index), [onClick, index])}\n      className={classes.root}\n      variant=\"subtitle2\"\n    >\n      {children}\n    </M.Link>\n  )\n}\n\ninterface CurrentItemProps {\n  children: React.ReactNode\n}\n\nfunction CurrentItem({ children }: CurrentItemProps) {\n  return <M.Typography variant=\"subtitle2\">{children}</M.Typography>\n}\n\nfunction BreadcrumbsDivider() {\n  return <M.Icon fontSize=\"small\">chevron_right</M.Icon>\n}\n\nfunction shoudShowItem(index: number, itemsNumber: number, tailOnly: boolean) {\n  if (!tailOnly) return true\n  return index > itemsNumber - 2\n}\n\ninterface BreadcrumbsProps {\n  items: JSONPointer.Path\n  onSelect: (path: JSONPointer.Path) => void\n  tailOnly: boolean\n}\n\nexport default function Breadcrumbs({ tailOnly, items, onSelect }: BreadcrumbsProps) {\n  const overrideClasses = useOverrideStyles()\n\n  const onBreadcrumb = React.useCallback(\n    (index) => {\n      if (index === items.length + 1) return\n      const path = items.slice(0, index)\n      onSelect(path)\n    },\n    [items, onSelect],\n  )\n\n  const ref = React.useRef<HTMLElement | null>(null)\n  React.useEffect(() => {\n    ref.current?.scrollIntoView()\n  }, [ref])\n\n  return (\n    <M.Breadcrumbs classes={overrideClasses} ref={ref} separator={<BreadcrumbsDivider />}>\n      {shoudShowItem(0, items.length, tailOnly) && (\n        <Item index={0} onClick={onBreadcrumb}>\n          <M.Icon fontSize=\"small\">home</M.Icon>\n        </Item>\n      )}\n\n      {items.map((item, index) => {\n        const actualIndex = index + 1\n\n        if (!shoudShowItem(actualIndex, items.length, tailOnly)) return null\n\n        if (index === items.length - 1)\n          return <CurrentItem key=\"last-breadcrumb\">{item}</CurrentItem>\n\n        return (\n          <Item key={`${item}_${actualIndex}`} index={actualIndex} onClick={onBreadcrumb}>\n            {item}\n          </Item>\n        )\n      })}\n    </M.Breadcrumbs>\n  )\n}\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nconst useStyles = M.makeStyles((t) => ({\n  cell: {\n    border: `1px solid ${t.palette.grey[300]}`,\n    padding: 0,\n    width: '50%',\n  },\n  key: {\n    [t.breakpoints.up('lg')]: {\n      width: t.spacing(27),\n    },\n  },\n  value: {\n    [t.breakpoints.up('lg')]: {\n      width: t.spacing(40),\n    },\n  },\n  cellContent: {\n    height: t.spacing(4),\n  },\n}))\n\nexport default function EmptyRow() {\n  const classes = useStyles()\n  return (\n    <M.TableRow>\n      <M.TableCell className={cx(classes.cell, classes.key)}>\n        <div className={classes.cellContent} />\n      </M.TableCell>\n      <M.TableCell className={cx(classes.cell, classes.value)}>\n        <div className={classes.cellContent} />\n      </M.TableCell>\n    </M.TableRow>\n  )\n}\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as RTable from 'react-table'\nimport * as M from '@material-ui/core'\n\nimport * as JSONPointer from 'utils/JSONPointer'\n\nimport { COLUMN_IDS, RowData } from './constants'\n\nconst useStyles = M.makeStyles((t) => ({\n  cell: {\n    border: `1px solid ${t.palette.grey[400]}`,\n    padding: 0,\n  },\n  error: {\n    borderColor: t.palette.error.main,\n  },\n  key: {\n    width: '50%',\n    [t.breakpoints.up('lg')]: {\n      width: t.spacing(27),\n    },\n  },\n  value: {\n    width: '50%',\n    [t.breakpoints.up('lg')]: {\n      width: t.spacing(40),\n    },\n  },\n}))\n\ninterface RowProps {\n  cells: RTable.Cell<RowData>[]\n  columnPath: JSONPointer.Path\n  contextMenuPath: JSONPointer.Path\n  fresh: boolean\n  onContextMenu: (path: JSONPointer.Path) => void\n  onExpand: (path: JSONPointer.Path) => void\n  onRemove: (path: JSONPointer.Path) => void\n}\n\nexport default function Row({\n  cells,\n  columnPath,\n  contextMenuPath,\n  fresh,\n  onContextMenu,\n  onExpand,\n  onRemove,\n}: RowProps) {\n  const classes = useStyles()\n\n  return (\n    <M.TableRow>\n      {cells.map((cell) => (\n        <M.TableCell\n          {...cell.getCellProps()}\n          className={cx(classes.cell, {\n            [classes.error]: cell.row.original.errors.length,\n            [classes.key]: cell.column.id === COLUMN_IDS.KEY,\n            [classes.value]: cell.column.id === COLUMN_IDS.VALUE,\n          })}\n        >\n          {cell.render('Cell', {\n            columnPath,\n            contextMenuPath,\n            editing: fresh && cell.column.id === COLUMN_IDS.VALUE,\n            onContextMenu,\n            onExpand,\n            onRemove,\n          })}\n        </M.TableCell>\n      ))}\n    </M.TableRow>\n  )\n}\n","import type { ErrorObject, JSONType } from 'ajv'\nimport * as FP from 'fp-ts'\nimport * as R from 'ramda'\nimport * as React from 'react'\n\nimport * as JSONPointer from 'utils/JSONPointer'\nimport { JsonSchema } from 'utils/json-schema'\nimport * as jsonSchemaUtils from 'utils/json-schema/json-schema'\nimport { Json, JsonRecord } from 'utils/types'\n\nimport { COLUMN_IDS, EMPTY_VALUE, ValidationErrors } from './constants'\n\nconst JSON_POINTER_PLACEHOLDER = '__*'\n\nconst getAddressPath = (key: ObjectKey, parentPath: JSONPointer.Path) =>\n  key === '' ? parentPath : (parentPath || []).concat(key)\n\nconst getSchemaType = (s: JsonSchema) => s.type as JSONType\n\ninterface SchemaItemArgs {\n  item: JsonSchema\n  sortIndex: number\n  key: string\n  parentPath: JSONPointer.Path\n  required: boolean\n}\n\ninterface SchemaItem {\n  address: JSONPointer.Path\n  required: boolean\n  valueSchema?: JsonSchema\n  sortIndex: number\n  type?: string\n}\n\ntype JsonDict = Record<JSONPointer.Pointer, SchemaItem>\n\nconst getSchemaItem = ({\n  item,\n  sortIndex,\n  key,\n  parentPath,\n  required,\n}: SchemaItemArgs): SchemaItem => ({\n  address: getAddressPath(key, parentPath),\n  required,\n  valueSchema: item,\n  sortIndex,\n  type: getSchemaType(item),\n})\n\nconst noKeys: string[] = []\n\nfunction getSchemaItemKeys(schemaItem: JsonSchema): string[] {\n  if (!schemaItem || !schemaItem.properties) return noKeys\n  const keys = Object.keys(schemaItem.properties)\n\n  if (!schemaItem.required) return keys\n\n  const sortOrder = schemaItem.required.reduce(\n    (memo: { [x: string]: number }, key: string, index: number) => ({\n      [key]: index,\n      ...memo,\n    }),\n    {} as { [x: string]: number },\n  )\n  const getSortIndex = (key: string) =>\n    R.ifElse(R.has(key), R.prop(key), R.always(Infinity))(sortOrder)\n  return R.sortBy(getSortIndex, keys)\n}\n\ntype SortOrder = React.MutableRefObject<{\n  counter: number\n  dict: Record<JSONPointer.Pointer, number>\n}>\n\n// TODO: consider to use 'json-schema-traverse'\n// NOTE: memo is mutated, sortOrder is React.ref and mutated too\nexport function iterateSchema(\n  schema: JsonSchema,\n  sortOrder: SortOrder,\n  parentPath: JSONPointer.Path,\n  memo: JsonDict,\n): JsonDict {\n  if (schema.additionalProperties || schema.items) {\n    const rawItem = schema.additionalProperties || schema.items\n    const item = getSchemaItem({\n      item: rawItem,\n      key: JSON_POINTER_PLACEHOLDER,\n      parentPath,\n      required: false,\n      sortIndex: sortOrder.current.counter,\n    })\n    // eslint-disable-next-line no-param-reassign\n    memo[JSONPointer.stringify(item.address)] = item\n    // eslint-disable-next-line no-param-reassign\n    sortOrder.current.counter += 1\n    iterateSchema(rawItem, sortOrder, item.address, memo)\n  }\n\n  if (!schema.properties) return memo\n\n  const requiredKeys = schema.required\n  getSchemaItemKeys(schema).forEach((key) => {\n    // eslint-disable-next-line no-param-reassign\n    sortOrder.current.counter += 1\n\n    const rawItem = schema.properties[key]\n    const required = requiredKeys ? requiredKeys.includes(key) : false\n    const item = getSchemaItem({\n      item: rawItem,\n      key,\n      parentPath,\n      required,\n      sortIndex: sortOrder.current.counter,\n    })\n    // eslint-disable-next-line no-param-reassign\n    memo[JSONPointer.stringify(item.address)] = item\n\n    // eslint-disable-next-line no-param-reassign\n    sortOrder.current.counter += 1\n    iterateSchema(rawItem, sortOrder, item.address, memo)\n  })\n\n  return memo\n}\n\nconst assocObjValue: (p: JSONPointer.Path, v: any, jsonObject: JsonRecord) => JsonRecord =\n  R.assocPath\n\nexport const getObjValue: (p: JSONPointer.Path, jsonObject: JsonRecord) => JsonRecord =\n  R.path\n\nexport const getJsonDictValue = (objPath: JSONPointer.Path, jsonDict: JsonDict) =>\n  R.prop(JSONPointer.stringify(objPath), jsonDict)\n\nconst dissocObjValue: (p: JSONPointer.Path, jsonObject: JsonRecord) => JsonRecord =\n  R.dissocPath\n\nfunction moveObjValue(\n  oldObjPath: JSONPointer.Path,\n  key: any,\n  obj: JsonRecord,\n): JsonRecord {\n  const oldItem = getObjValue(oldObjPath, obj)\n  const oldValue = oldItem === undefined ? EMPTY_VALUE : oldItem\n  return assocObjValue(\n    R.append(key, R.init(oldObjPath)),\n    oldValue,\n    dissocObjValue(oldObjPath, obj),\n  )\n}\n\nfunction calcReactId(valuePath: JSONPointer.Path, value?: Json): string {\n  const pathPrefix = JSONPointer.stringify(valuePath)\n  // TODO: store preview for value, and reuse it for Preview\n  return `${pathPrefix}+${JSON.stringify(value)}`\n}\n\nfunction getDefaultValue(jsonDictItem?: SchemaItem): Json | typeof EMPTY_VALUE {\n  if (!jsonDictItem?.valueSchema) return EMPTY_VALUE\n\n  const defaultFromSchema = jsonSchemaUtils.getDefaultValue(jsonDictItem?.valueSchema)\n  if (defaultFromSchema !== undefined) return defaultFromSchema\n\n  // TODO:\n  // get defaults from nested objects\n  // const setDefaults = jsonSchemaUtils.makeSchemaDefaultsSetter(jsonDictItem?.valueSchema)\n  // const nestedDefaultFromSchema = setDefaults()\n  // if (nestedDefaultFromSchema !== undefined) return nestedDefaultFromSchema\n\n  return EMPTY_VALUE\n}\n\nconst NO_ERRORS: ValidationErrors = []\n\nconst bigintError = new Error(\n  `We don't support numbers larger than ${Number.MAX_SAFE_INTEGER}.\n  Please consider converting it to string.`,\n)\n\nfunction collectErrors(\n  allErrors: ValidationErrors,\n  itemAddress: JSONPointer.Pointer,\n  value: Json | typeof EMPTY_VALUE,\n): ValidationErrors {\n  const errors = allErrors\n    ? allErrors.filter((error) => (error as ErrorObject).instancePath === itemAddress)\n    : NO_ERRORS\n\n  if (typeof value === 'number' && value > Number.MAX_SAFE_INTEGER) {\n    return errors.concat(bigintError)\n  }\n  return errors\n}\n\nfunction doesPlaceholderPathMatch(\n  placeholder: JSONPointer.Path,\n  path: JSONPointer.Path,\n): boolean {\n  if (placeholder.length !== path.length) return false\n  return placeholder.every(\n    (item, index) => item === path[index] || item === JSON_POINTER_PLACEHOLDER,\n  )\n}\n\ntype ObjectKey = number | string\n\nexport interface JsonDictItem extends SchemaItem {\n  errors: ValidationErrors\n  reactId: string\n  sortIndex: number\n\n  // TODO: use ./constants.ts module\n  key: ObjectKey\n  value: Json | typeof EMPTY_VALUE\n}\n\n// TODO: extend getJsonDictValue\n// TODO: return address too\nexport function getJsonDictItemRecursively(\n  jsonDict: JsonDict,\n  parentPath: JSONPointer.Path,\n  key?: ObjectKey,\n): SchemaItem | undefined {\n  const addressPath = getAddressPath(typeof key === 'undefined' ? '' : key, parentPath)\n  const itemAddress = JSONPointer.stringify(addressPath)\n  const item = jsonDict[itemAddress]\n  if (item) return item\n\n  let weight = 0\n  let placeholderItem = undefined\n  Object.entries(jsonDict).forEach(([path, value]) => {\n    if (doesPlaceholderPathMatch(JSONPointer.parse(path), addressPath)) {\n      if (weight < addressPath.length) {\n        weight = addressPath.length\n        placeholderItem = value\n      }\n    }\n  })\n  return placeholderItem\n}\n\nfunction getJsonDictItem(\n  jsonDict: JsonDict,\n  obj: JsonRecord,\n  parentPath: JSONPointer.Path,\n  key: ObjectKey,\n  sortOrder: SortOrder,\n  allErrors: ValidationErrors,\n): JsonDictItem {\n  const valuePath = getAddressPath(key, parentPath)\n  const itemAddress = JSONPointer.stringify(valuePath)\n  const item = getJsonDictItemRecursively(jsonDict, parentPath, key)\n  const storedValue: Json | undefined = R.path(valuePath, obj)\n  const value = storedValue === undefined ? getDefaultValue(item) : storedValue\n  const errors = collectErrors(allErrors, itemAddress, value)\n  return {\n    [COLUMN_IDS.KEY]: key,\n    [COLUMN_IDS.VALUE]: value,\n    errors,\n    reactId: calcReactId(valuePath, storedValue),\n    ...(item || {\n      address: valuePath,\n      required: false,\n      valueSchema: undefined,\n    }),\n    sortIndex: (item && item.sortIndex) || sortOrder.current.dict[itemAddress] || 0,\n  }\n}\n\nfunction getObjValueKeys(objValue?: Json): ObjectKey[] {\n  if (Array.isArray(objValue)) return R.range(0, objValue.length)\n  if (R.is(Object, objValue)) return Object.keys(objValue as JsonRecord)\n  return noKeys\n}\n\nfunction getObjValueKeysByPath(\n  obj: JsonRecord,\n  objPath: JSONPointer.Path,\n  rootKeys: ObjectKey[],\n): ObjectKey[] {\n  if (!objPath.length) return rootKeys\n\n  const objValue = R.path(objPath, obj)\n  return getObjValueKeys(objValue as Json | undefined)\n}\n\nfunction getSchemaItemKeysByPath(\n  jsonDict: JsonDict,\n  objPath: JSONPointer.Path,\n): ObjectKey[] {\n  const item = getJsonDictItemRecursively(jsonDict, objPath)\n  return item && item.valueSchema ? getSchemaItemKeys(item.valueSchema) : noKeys\n}\n\nfunction getSchemaAndObjKeys(\n  obj: JsonRecord,\n  jsonDict: JsonDict,\n  objPath: JSONPointer.Path,\n  rootKeys: ObjectKey[],\n) {\n  return R.uniq([\n    ...getSchemaItemKeysByPath(jsonDict, objPath),\n    ...getObjValueKeysByPath(obj, objPath, rootKeys),\n  ])\n}\n\nexport function mergeSchemaAndObjRootKeys(\n  schema: JsonSchema,\n  obj: JsonRecord,\n): ObjectKey[] {\n  const schemaKeys = getSchemaItemKeys(schema)\n  const objKeys = getObjValueKeys(obj)\n  return R.uniq([...schemaKeys, ...objKeys])\n}\n\ninterface Column {\n  items: JsonDictItem[]\n  parent?: Json\n}\n\n// TODO: refactor data, decrease number of arguments to three\nexport function iterateJsonDict(\n  jsonDict: JsonDict,\n  obj: JsonRecord,\n  fieldPath: JSONPointer.Path,\n  rootKeys: ObjectKey[],\n  sortOrder: SortOrder,\n  errors: ValidationErrors,\n): Column[] {\n  if (!fieldPath.length)\n    return [\n      FP.function.pipe(\n        rootKeys,\n        R.map((key) => getJsonDictItem(jsonDict, obj, fieldPath, key, sortOrder, errors)),\n        R.sortBy(R.prop('sortIndex')),\n        (items) => ({\n          parent: obj,\n          items,\n        }),\n      ),\n    ]\n\n  return ['', ...fieldPath].map((_, index) => {\n    const pathPart = R.slice(0, index, fieldPath)\n\n    const keys = getSchemaAndObjKeys(obj, jsonDict, pathPart, rootKeys)\n    return FP.function.pipe(\n      keys,\n      R.map((key) => getJsonDictItem(jsonDict, obj, pathPart, key, sortOrder, errors)),\n      R.sortBy(R.prop('sortIndex')),\n      (items) => ({\n        parent: R.path(pathPart, obj),\n        items,\n      }),\n    )\n  })\n}\n\nexport interface StateRenderProps {\n  addRow: (p: JSONPointer.Path, v: any, jsonObject: JsonRecord) => JsonRecord // Adds new key/value pair\n  changeValue: (oldObjPath: JSONPointer.Path, key: any, obj: JsonRecord) => JsonRecord // Changes existing key or value\n  columns: Column[] // Main source of truth for UI\n  fieldPath: JSONPointer.Path // Where is user's focus inside object\n  jsonDict: JsonDict // Stores sort order, required fields, types etc.\n  menuFieldPath: JSONPointer.Path // where does user open context menu\n  removeField: (p: JSONPointer.Path) => JsonRecord // Removes key/value pair\n  setFieldPath: (p: JSONPointer.Path) => void // Focus on that path inside object\n  setMenuFieldPath: (p: JSONPointer.Path) => void // Open context menu for that path inside object\n  transformer: (transform: (jsonObject: JsonRecord) => JsonRecord) => void\n}\n\ninterface JsonEditorStateProps {\n  children: (s: StateRenderProps) => React.ReactElement\n  errors: ValidationErrors\n  jsonObject: JsonRecord\n  schema: JsonSchema\n}\n\nexport default function JsonEditorState({\n  children,\n  errors,\n  jsonObject,\n  schema,\n}: JsonEditorStateProps) {\n  // NOTE: fieldPath is like URL for editor columns\n  //       `['a', 0, 'b']` means we are focused to `{ a: [ { b: %HERE% }, ... ], ... }`\n  const [fieldPath, setFieldPath] = React.useState<JSONPointer.Path>([])\n\n  // NOTE: similar to fieldPath, shows where to open ContextMenu\n  const [menuFieldPath, setMenuFieldPath] = React.useState<JSONPointer.Path>([])\n\n  // NOTE: incremented sortIndex counter,\n  //       and cache for sortIndexes: { [keyA]: sortIndexA, [keyB]: sortIndexB }\n  //       it's required to place new fields below existing ones\n  const sortOrder = React.useRef<{\n    counter: number\n    dict: Record<JSONPointer.Pointer, number>\n  }>({ counter: 0, dict: {} })\n\n  // NOTE: stores additional info about every object field besides value, like sortIndex, schema etc.\n  //       it's a main source of data after actual JSON object\n  const jsonDict = React.useMemo(() => {\n    sortOrder.current.counter = Number.MIN_SAFE_INTEGER\n    const result = iterateSchema(schema, sortOrder, [], {})\n    sortOrder.current.counter = 0\n    return result\n  }, [schema, sortOrder])\n\n  // NOTE: list of root object keys + root schema keys\n  const rootKeys = React.useMemo(\n    () => mergeSchemaAndObjRootKeys(schema, jsonObject),\n    [schema, jsonObject],\n  )\n\n  // NOTE: this data represents table columns shown to user\n  //       it's the main source of UI data\n  const columns = React.useMemo(\n    () => iterateJsonDict(jsonDict, jsonObject, fieldPath, rootKeys, sortOrder, errors),\n    [errors, jsonObject, jsonDict, fieldPath, rootKeys],\n  )\n\n  // TODO: Use `sortIndex: -1` to \"remove\" fields that cannot be removed,\n  //       like properties from JSON Schema\n  const removeField = React.useCallback(\n    (removingFieldPath) => dissocObjValue(removingFieldPath, jsonObject),\n    [jsonObject],\n  )\n\n  const changeValue = React.useCallback(\n    (editingFieldPath, columnId, str) => {\n      // TODO: str is not string, it's any value\n      // TODO: make this `safeStr` conversion inside component\n      const safeStr = str === EMPTY_VALUE ? '' : str\n      if (columnId === COLUMN_IDS.KEY) {\n        return moveObjValue(editingFieldPath, safeStr, jsonObject)\n      }\n\n      if (columnId === COLUMN_IDS.VALUE) {\n        return assocObjValue(editingFieldPath, safeStr, jsonObject)\n      }\n\n      return jsonObject\n    },\n    [jsonObject],\n  )\n\n  const addRow = React.useCallback(\n    (addFieldPath, key, value) => {\n      // NOTE: value can't be `Symbol('empty')`\n      //       because it's imposible to have `{ [newKey]: Symbol('empty') }` object\n      sortOrder.current.counter += 1\n\n      const newKeyPath = addFieldPath.concat([key])\n      const itemAddress = JSONPointer.stringify(newKeyPath)\n      sortOrder.current.dict[itemAddress] = sortOrder.current.counter\n      return assocObjValue(newKeyPath, value, jsonObject)\n    },\n    [jsonObject, sortOrder],\n  )\n\n  const transformer = React.useCallback(\n    (transform) => transform(jsonObject),\n    [jsonObject],\n  )\n\n  // `jsonDict` and `columns` are main state storages\n  return children({\n    addRow, // Adds new key/value pair\n    changeValue, // Changes existing key or value\n    columns, // Main source of truth for UI\n    fieldPath, // Where is user's focus inside object\n    jsonDict, // Stores sort order, required fields, types etc.\n    menuFieldPath, // where does user open context menu\n    removeField, // Removes key/value pair\n    setFieldPath, // Focus on that path inside object\n    setMenuFieldPath, // Open context menu for that path inside object\n    transformer,\n  })\n}\n","import type { JSONType } from 'ajv'\nimport cx from 'classnames'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport * as RTable from 'react-table'\nimport * as M from '@material-ui/core'\n\nimport * as JSONPointer from 'utils/JSONPointer'\nimport type { JsonRecord } from 'utils/types'\n\nimport AddArrayItem from './AddArrayItem'\nimport AddRow from './AddRow'\nimport Breadcrumbs from './Breadcrumbs'\nimport Cell from './Cell'\nimport EmptyRow from './EmptyRow'\nimport Row from './Row'\nimport { getJsonDictValue } from './State'\nimport * as Toolbar from './Toolbar'\nimport { COLUMN_IDS, JsonValue, RowData } from './constants'\n\nconst useStyles = M.makeStyles((t) => ({\n  root: {\n    flex: 'none',\n    padding: '1px 0', // NOTE: fit 2px border for input\n    position: 'relative',\n    width: '100%',\n  },\n  breadcrumbs: {\n    alignItems: 'center',\n    border: `1px solid ${t.palette.grey[400]}`,\n    borderWidth: '1px 1px 0',\n    color: t.palette.text.hint,\n    display: 'flex',\n    padding: '4px 8px',\n  },\n  sibling: {\n    flex: 1,\n\n    '& + &': {\n      marginLeft: '-1px',\n    },\n  },\n  siblingButton: {\n    paddingLeft: t.spacing(1),\n  },\n  scroll: {\n    maxHeight: `calc(100% - ${t.spacing(8)}px)`,\n    overflowY: 'auto',\n  },\n  table: {\n    tableLayout: 'fixed',\n  },\n  toolbar: {\n    marginLeft: 'auto',\n  },\n}))\n\nfunction getColumnType(\n  columnPath: JSONPointer.Path,\n  jsonDict: Record<string, JsonValue>,\n  parent?: JsonValue,\n) {\n  // TODO: use `getJsonDictItemRecursively`\n  const columnSchema = getJsonDictValue(columnPath, jsonDict)\n  if (columnSchema && !parent) return columnSchema.type as JSONType\n\n  if (Array.isArray(parent)) return 'array'\n\n  if (!columnSchema) return 'object'\n\n  return typeof parent as JSONType\n}\n\nconst useEmptyColumnStyles = M.makeStyles((t) => ({\n  root: {\n    border: `1px solid ${t.palette.grey[400]}`,\n    padding: t.spacing(1),\n  },\n}))\n\ninterface EmptyColumnProps {\n  columnType?: JSONType\n}\n\nfunction EmptyColumn({ columnType }: EmptyColumnProps) {\n  const classes = useEmptyColumnStyles()\n\n  if (columnType !== 'array') return null\n\n  return (\n    <M.TableRow className={classes.root}>\n      <M.TableCell colSpan={2}>\n        This array is empty. Add the first item or create array at the parent level\n      </M.TableCell>\n    </M.TableRow>\n  )\n}\n\nconst MIN_ROWS_NUMBER = 10\n\ninterface ColumnFillerProps {\n  hasSiblingColumn: boolean\n  filledRowsNumber: number\n}\n\nfunction ColumnFiller({ hasSiblingColumn, filledRowsNumber }: ColumnFillerProps) {\n  const emptyRows = React.useMemo(() => {\n    if (filledRowsNumber >= MIN_ROWS_NUMBER) return []\n    return R.range(0, MIN_ROWS_NUMBER - filledRowsNumber)\n  }, [filledRowsNumber])\n\n  if (!hasSiblingColumn) return null\n\n  return (\n    <>\n      {emptyRows.map((index) => (\n        <EmptyRow key={`empty_row_${index}`} />\n      ))}\n    </>\n  )\n}\n\ninterface ColumnProps {\n  hasSiblingColumn: boolean\n  className: string\n  columnPath: JSONPointer.Path\n  contextMenuPath: JSONPointer.Path\n  data: {\n    items: RowData[]\n    parent?: JsonValue\n  }\n  jsonDict: Record<string, JsonValue>\n  onAddRow: (path: JSONPointer.Path, key: string | number, value: JsonValue) => void\n  onBreadcrumb: (path: JSONPointer.Path) => void\n  onChange: (path: JSONPointer.Path, id: 'key' | 'value', value: JsonValue) => void\n  onContextMenu: (path: JSONPointer.Path) => void\n  onExpand: (path: JSONPointer.Path) => void\n  onRemove: (path: JSONPointer.Path) => void\n  onToolbar: (func: (v: JsonRecord) => JsonRecord) => void\n}\n\nexport default function Column({\n  className,\n  columnPath,\n  contextMenuPath,\n  data,\n  hasSiblingColumn,\n  jsonDict,\n  onAddRow,\n  onBreadcrumb,\n  onChange,\n  onContextMenu,\n  onExpand,\n  onRemove,\n  onToolbar,\n}: ColumnProps) {\n  const columns = React.useMemo(\n    () =>\n      [\n        {\n          accessor: COLUMN_IDS.KEY,\n        },\n        {\n          accessor: COLUMN_IDS.VALUE,\n        },\n      ] as RTable.Column<RowData>[],\n    [],\n  )\n\n  const classes = useStyles()\n\n  const [hasNewRow, setHasNewRow] = React.useState(false)\n  // TODO: rename to less tutorial-ish name\n  const updateMyData = React.useCallback(\n    (path: JSONPointer.Path, id: 'key' | 'value', value: JsonValue) => {\n      setHasNewRow(false)\n      onChange(path, id, value)\n    },\n    [onChange],\n  )\n\n  const tableInstance = RTable.useTable({\n    columns,\n    data: data.items,\n    defaultColumn: {\n      Cell,\n    },\n    updateMyData,\n  })\n  const { getTableProps, getTableBodyProps, rows, prepareRow } = tableInstance\n\n  const columnType = getColumnType(columnPath, jsonDict, data.parent)\n\n  const onAddRowInternal = React.useCallback(\n    (path: JSONPointer.Path, key: string | number, value: JsonValue) => {\n      setHasNewRow(true)\n      onAddRow(path, key, value)\n    },\n    [onAddRow],\n  )\n\n  const toolbar = Toolbar.use()\n\n  return (\n    <div className={cx(classes.root, { [classes.sibling]: hasSiblingColumn }, className)}>\n      {!!columnPath.length && (\n        <div className={classes.breadcrumbs}>\n          <Breadcrumbs\n            tailOnly={hasSiblingColumn}\n            items={columnPath}\n            onSelect={onBreadcrumb}\n          />\n          {toolbar && (\n            <div className={classes.toolbar}>\n              <toolbar.Toolbar columnPath={columnPath} onChange={onToolbar} />\n            </div>\n          )}\n        </div>\n      )}\n\n      <M.TableContainer className={cx({ [classes.scroll]: hasSiblingColumn })}>\n        <M.Table {...getTableProps({ className: classes.table })}>\n          <M.TableBody {...getTableBodyProps()}>\n            {rows.map((row, index: number) => {\n              const isLastRow = index === rows.length - 1\n\n              prepareRow(row)\n\n              const props = {\n                cells: row.cells,\n                columnPath,\n                contextMenuPath,\n                fresh: isLastRow && hasNewRow,\n                onContextMenu,\n                onExpand,\n                onRemove,\n                key: '',\n              }\n\n              if (row.original.reactId) {\n                props.key = row.original.reactId\n              }\n\n              return <Row {...row.getRowProps()} {...props} />\n            })}\n\n            {!rows.length && <EmptyColumn columnType={columnType} />}\n\n            {columnType === 'array' && (\n              <AddArrayItem\n                {...{\n                  className: hasSiblingColumn ? classes.siblingButton : undefined,\n                  columnPath,\n                  index: rows.length,\n                  onAdd: onAddRowInternal,\n                  key: `add_array_item_${rows.length}`,\n                }}\n              />\n            )}\n\n            {columnType !== 'array' && (\n              <AddRow\n                {...{\n                  columnPath,\n                  contextMenuPath,\n                  key: `add_row_${rows.length}`,\n                  onAdd: onAddRowInternal,\n                  onContextMenu,\n                  onExpand,\n                }}\n              />\n            )}\n\n            {columnType !== 'array' && (\n              <ColumnFiller\n                hasSiblingColumn={hasSiblingColumn}\n                filledRowsNumber={rows.length}\n              />\n            )}\n          </M.TableBody>\n        </M.Table>\n      </M.TableContainer>\n    </div>\n  )\n}\n","import cx from 'classnames'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport Code from 'components/Code'\nimport * as JSONPointer from 'utils/JSONPointer'\nimport { EMPTY_SCHEMA, JsonSchema } from 'utils/json-schema'\n\nimport illustrationEnterValues from './enter-values.webm'\nimport illustrationObjectExpand from './object-expand.webm'\nimport Column from './Column'\nimport State, { StateRenderProps } from './State'\nimport { JsonValue, RowData, ValidationErrors } from './constants'\n\ninterface EmptyStateCaseProps {\n  children: React.ReactNode\n  className: string\n  title: string\n  video: string\n}\n\nfunction EmptyStateCase({ children, className, title, video }: EmptyStateCaseProps) {\n  const videoRef = React.useRef<HTMLVideoElement | null>(null)\n  const togglePlayback = React.useCallback(() => {\n    const el = videoRef?.current\n    if (el?.paused) {\n      el?.play()\n    } else {\n      el?.pause()\n    }\n  }, [videoRef])\n  return (\n    <M.Card className={className}>\n      <M.CardContent>\n        <M.Typography variant=\"h5\">{title}</M.Typography>\n        <M.Typography variant=\"body1\">{children}</M.Typography>\n        <video\n          ref={videoRef}\n          src={video}\n          width=\"100%\"\n          autoPlay\n          loop\n          onClick={togglePlayback}\n        />\n      </M.CardContent>\n    </M.Card>\n  )\n}\n\ninterface EmptyStateProps {\n  className: string\n  noValue: boolean\n  notExpanded: boolean\n}\n\nfunction EmptyState({ className, noValue, notExpanded }: EmptyStateProps) {\n  if (noValue && notExpanded) {\n    return (\n      <EmptyStateCase\n        className={className}\n        title=\"JSON editor is empty\"\n        video={illustrationEnterValues}\n      >\n        Start filling empty rows as in Excel. You can enter values by hand. Type{' '}\n        <Code>{`{}`}</Code> to create an object, or <Code>{`[]`}</Code> to create an\n        array, and then traverse it to enter properties.\n      </EmptyStateCase>\n    )\n  }\n\n  if (notExpanded) {\n    return (\n      <EmptyStateCase\n        className={className}\n        title=\"There is more data here\"\n        video={illustrationObjectExpand}\n      >\n        Try to expand object values\n      </EmptyStateCase>\n    )\n  }\n\n  return null\n}\n\ninterface ColumnData {\n  items: RowData[]\n  parent?: JsonValue\n}\n\nfunction shouldSqueezeColumn(columnIndex: number, columns: ColumnData[]) {\n  return columns.length > 2 && columnIndex > 0 && columnIndex < columns.length - 1\n}\n\nconst useSqueezeStyles = M.makeStyles((t) => ({\n  root: {\n    alignSelf: 'flex-start',\n    cursor: 'pointer',\n    margin: t.spacing(0, 2),\n    padding: '5px 0',\n\n    '& + &': {\n      marginLeft: 0,\n    },\n  },\n}))\n\ninterface SqueezeProps {\n  columnPath: JSONPointer.Path\n  onClick: () => void\n}\n\nfunction Squeeze({ columnPath, onClick }: SqueezeProps) {\n  const classes = useSqueezeStyles()\n  return (\n    <div\n      className={classes.root}\n      title={`# > ${columnPath.join(' > ')}`}\n      onClick={onClick}\n    >\n      <M.Icon>more_horiz</M.Icon>\n    </div>\n  )\n}\n\nconst useStyles = M.makeStyles<any, { multiColumned: boolean }>((t) => ({\n  root: {\n    height: ({ multiColumned }) => (multiColumned ? '100%' : 'auto'),\n    position: 'relative',\n  },\n  disabled: {\n    position: 'relative',\n    '&:after': {\n      background: 'rgba(255,255,255,0.9)',\n      bottom: 0,\n      content: '\"\"',\n      cursor: 'not-allowed',\n      left: 0,\n      position: 'absolute',\n      right: 0,\n      top: 0,\n      zIndex: 1,\n    },\n  },\n  inner: {\n    display: 'flex',\n    height: ({ multiColumned }) => (multiColumned ? '100%' : 'auto'),\n    overflow: 'auto',\n    position: 'relative',\n  },\n  column: {\n    height: ({ multiColumned }) => (multiColumned ? '100%' : 'auto'),\n    maxWidth: t.spacing(76),\n    overflowY: 'auto',\n  },\n  help: {\n    position: 'absolute',\n    right: 0,\n    top: 0,\n    width: t.spacing(60),\n  },\n}))\n\ninterface JsonEditorProps extends StateRenderProps {\n  className?: string\n  disabled?: boolean\n  multiColumned: boolean\n  onChange: (value: JsonValue) => JsonValue\n}\n\nconst JsonEditor = React.forwardRef<HTMLDivElement, JsonEditorProps>(function JsonEditor(\n  {\n    addRow,\n    changeValue,\n    className,\n    columns,\n    disabled,\n    fieldPath,\n    jsonDict,\n    menuFieldPath,\n    multiColumned,\n    onChange,\n    removeField,\n    setFieldPath,\n    setMenuFieldPath,\n    transformer,\n  },\n  ref,\n) {\n  const classes = useStyles({ multiColumned })\n  const t = M.useTheme()\n  const md = M.useMediaQuery(t.breakpoints.down('md'))\n\n  const handleRowAdd = React.useCallback(\n    (path: JSONPointer.Path, key: string | number, value: JsonValue) => {\n      const newData = addRow(path, key, value)\n      if (newData) onChange(newData)\n    },\n    [addRow, onChange],\n  )\n\n  const handleRowRemove = React.useCallback(\n    (path: JSONPointer.Path) => {\n      const newData = removeField(path)\n      if (newData) onChange(newData)\n    },\n    [removeField, onChange],\n  )\n\n  const handleValueChange = React.useCallback(\n    (path: JSONPointer.Path, key: 'key' | 'value', value: JsonValue | string) => {\n      const newData = changeValue(path, key, value)\n      if (newData) onChange(newData)\n    },\n    [changeValue, onChange],\n  )\n\n  const handleToolbar = React.useCallback(\n    (transform) => {\n      onChange(transformer(transform))\n    },\n    [onChange, transformer],\n  )\n\n  if (!columns.length) throw new Error('No column data')\n\n  const columnsView = React.useMemo(\n    () => (multiColumned ? columns : ([R.last(columns)] as ColumnData[])),\n    [columns, multiColumned],\n  )\n\n  return (\n    <div className={cx(classes.root, { [classes.disabled]: disabled }, className)}>\n      <div className={classes.inner} ref={ref}>\n        {columnsView.map((columnData, index) => {\n          const columnPath = multiColumned ? fieldPath.slice(0, index) : fieldPath\n          return shouldSqueezeColumn(index, columns) ? (\n            <Squeeze\n              columnPath={columnPath}\n              key={columnPath.join(',')}\n              onClick={() => setFieldPath(columnPath)}\n            />\n          ) : (\n            <Column\n              className={classes.column}\n              columnPath={columnPath}\n              contextMenuPath={menuFieldPath}\n              data={columnData}\n              hasSiblingColumn={multiColumned}\n              jsonDict={jsonDict}\n              key={columnPath.join(',')}\n              onAddRow={handleRowAdd}\n              onBreadcrumb={setFieldPath}\n              onChange={handleValueChange}\n              onContextMenu={setMenuFieldPath}\n              onExpand={setFieldPath}\n              onRemove={handleRowRemove}\n              onToolbar={handleToolbar}\n            />\n          )\n        })}\n      </div>\n      {multiColumned && !md && (\n        <EmptyState\n          className={classes.help}\n          noValue={!columns[0].parent || R.isEmpty(columns[0].parent)}\n          notExpanded={columnsView.length < 2}\n        />\n      )}\n    </div>\n  )\n})\n\ninterface JsonEditorWrapperProps {\n  className?: string\n  disabled?: boolean\n  errors: ValidationErrors\n  multiColumned?: boolean\n  onChange: (value: JsonValue) => void\n  schema?: JsonSchema\n  value: JsonValue\n}\n\nexport default React.forwardRef<HTMLDivElement, JsonEditorWrapperProps>(\n  function JsonEditorWrapper(\n    { className, disabled, errors, multiColumned, onChange, schema: optSchema, value },\n    ref,\n  ) {\n    const schema = optSchema || EMPTY_SCHEMA\n\n    return (\n      <State errors={errors} jsonObject={value} schema={schema}>\n        {(stateProps: StateRenderProps) => (\n          <JsonEditor\n            {...{\n              className,\n              disabled,\n              onChange,\n              multiColumned: !!multiColumned,\n              ref,\n            }}\n            {...stateProps}\n          />\n        )}\n      </State>\n    )\n  },\n)\n","import type { ErrorObject } from 'ajv'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\nimport * as Lab from '@material-ui/lab'\n\nconst useSingleErrorStyles = M.makeStyles((t) => ({\n  code: {\n    backgroundColor: t.palette.error.light,\n    border: `1px solid ${t.palette.error.dark}`,\n    borderRadius: '2px',\n    color: t.palette.error.contrastText,\n    marginRight: '6px',\n    padding: '1px 2px',\n  },\n}))\n\ntype Err = Error | ErrorObject\n\ninterface SingleErrorProps {\n  className?: string\n  error: Err\n}\n\nfunction SingleError({ className, error }: SingleErrorProps) {\n  const classes = useSingleErrorStyles()\n\n  return (\n    <Lab.Alert severity=\"error\" className={className}>\n      {!!(error as ErrorObject).instancePath && (\n        <code className={classes.code}>{(error as ErrorObject).instancePath}</code>\n      )}\n      {error.message}\n    </Lab.Alert>\n  )\n}\n\nconst useStyles = M.makeStyles((t) => ({\n  item: {\n    '& + &': {\n      marginTop: t.spacing(1),\n    },\n  },\n}))\n\ninterface JsonValidationErrorsProps {\n  className: string\n  error: Err[] | Err | null\n}\n\nexport default function JsonValidationErrors({\n  className,\n  error,\n}: JsonValidationErrorsProps) {\n  const classes = useStyles()\n\n  if (!error) return null\n\n  return (\n    <div className={className}>\n      {Array.isArray(error) ? (\n        error.map((e, index) => (\n          <SingleError\n            className={classes.item}\n            error={e}\n            key={(e as ErrorObject).instancePath + e.message + index}\n          />\n        ))\n      ) : (\n        <SingleError error={error} />\n      )}\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { Link } from 'react-router-dom'\nimport { genericHashLink } from 'react-router-hash-link'\n\nexport default React.forwardRef((props, ref) => genericHashLink({ ...props, ref }, Link))\n","export default __webpack_public_path__ + \"c250e10248bd91f9d6cc00bd9c3be5e2.png\";","import cx from 'classnames'\nimport * as React from 'react'\nimport { Link } from 'react-router-dom'\nimport * as M from '@material-ui/core'\n\nimport * as Intercom from 'components/Intercom'\nimport Logo from 'components/Logo'\nimport * as style from 'constants/style'\nimport * as URLS from 'constants/urls'\nimport * as Notifications from 'containers/Notifications'\nimport * as CatalogSettings from 'utils/CatalogSettings'\nimport * as Config from 'utils/Config'\nimport HashLink from 'utils/HashLink'\nimport * as NamedRoutes from 'utils/NamedRoutes'\nimport copyToClipboard from 'utils/clipboard'\n\nimport bg from './bg.png'\nimport iconFacebook from './icon-facebook.svg'\nimport iconGithub from './icon-github.svg'\nimport iconInstagram from './icon-instagram.svg'\nimport iconLinkedin from './icon-linkedin.svg'\nimport iconSlack from './icon-slack.svg'\nimport iconTwitter from './icon-twitter.svg'\n\nconst useVersionStyles = M.makeStyles((t) => ({\n  revision: {\n    color: t.palette.secondary.main,\n    cursor: 'pointer',\n    opacity: 0.3,\n    '&:hover': {\n      opacity: 1,\n    },\n  },\n}))\n\nfunction Version() {\n  const classes = useVersionStyles()\n  const { push } = Notifications.use()\n  const handleCopy = React.useCallback(() => {\n    copyToClipboard(process.env.REVISION_HASH)\n    push('Product revision hash has been copied to clipboard')\n  }, [push])\n  return (\n    <div>\n      <M.Typography\n        className={classes.revision}\n        onClick={handleCopy}\n        title=\"Copy product revision hash to clipboard\"\n        variant=\"caption\"\n      >\n        Revision: {process.env.REVISION_HASH.substring(0, 8)}\n      </M.Typography>\n    </div>\n  )\n}\n\nconst FooterLogo = () => <Logo height=\"29px\" width=\"76.5px\" />\n\nconst NavLink = (props) => (\n  <M.Link\n    variant=\"button\"\n    underline=\"none\"\n    color=\"textPrimary\"\n    component={props.to ? HashLink : undefined}\n    {...props}\n  />\n)\n\nconst NavSpacer = () => <M.Box ml={{ xs: 2, sm: 3 }} />\n\nconst NavIcon = ({ icon, ...props }) => (\n  <M.Box component=\"a\" {...props}>\n    <M.Box component=\"img\" height={18} src={icon} alt=\"\" display=\"block\" />\n  </M.Box>\n)\n\nconst useStyles = M.makeStyles((t) => ({\n  padded: {},\n  root: {\n    background: `left / 64px url(${bg})`,\n    boxShadow: [\n      '0px -12px 24px 0px rgba(25, 22, 59, 0.05)',\n      '0px -16px 40px 0px rgba(25, 22, 59, 0.07)',\n      '0px -24px 88px 0px rgba(25, 22, 59, 0.16)',\n    ],\n    height: 230,\n    paddingTop: t.spacing(6),\n    position: 'relative',\n    [t.breakpoints.down('xs')]: {\n      alignItems: 'center',\n      display: 'flex',\n      paddingTop: 0,\n    },\n    // padding for marketing CTA\n    '&$padded': {\n      [t.breakpoints.down('sm')]: {\n        backgroundSize: 'contain',\n        height: 230 + 64,\n        paddingBottom: 64,\n      },\n    },\n  },\n  container: {\n    alignItems: 'center',\n    display: 'grid',\n    [t.breakpoints.up('sm')]: {\n      gridRowGap: t.spacing(6),\n      gridTemplateColumns: 'auto 1fr auto',\n      gridTemplateRows: '36px auto',\n      gridTemplateAreas: `\n        \"logo . links\"\n        \"copy . icons\"\n      `,\n    },\n    [t.breakpoints.down('xs')]: {\n      gridRowGap: t.spacing(3),\n      gridTemplateColumns: '1fr',\n      gridTemplateRows: '36px auto auto auto',\n      gridTemplateAreas: `\n        \"logo\"\n        \"links\"\n        \"icons\"\n        \"copy\"\n      `,\n    },\n  },\n}))\n\nexport default function Footer() {\n  const cfg = Config.useConfig()\n  const settings = CatalogSettings.use()\n  const classes = useStyles()\n  const { urls } = NamedRoutes.use()\n  const intercom = Intercom.use()\n  const year = React.useMemo(() => new Date().getFullYear(), [])\n  const reservedSpaceForIntercom = !intercom.dummy && !intercom.isCustom\n  return (\n    <M.MuiThemeProvider theme={style.navTheme}>\n      <footer\n        className={cx(classes.root, { [classes.padded]: cfg.mode === 'MARKETING' })}\n      >\n        <M.Container maxWidth=\"lg\" className={classes.container}>\n          <M.Box\n            style={{ gridArea: 'logo' }}\n            display=\"flex\"\n            justifyContent={{ xs: 'center', sm: 'flex-start' }}\n          >\n            {settings?.logo?.url ? (\n              <a href={URLS.homeMarketing}>\n                <FooterLogo />\n              </a>\n            ) : (\n              <M.Box component={Link} to={urls.home()} display=\"block\">\n                <FooterLogo />\n              </M.Box>\n            )}\n          </M.Box>\n\n          <M.Box\n            component=\"nav\"\n            display=\"flex\"\n            alignItems=\"center\"\n            justifyContent={{ xs: 'center', sm: 'flex-end' }}\n            style={{ gridArea: 'links' }}\n          >\n            <NavLink href={URLS.docs} target=\"_blank\">\n              Docs\n            </NavLink>\n            {cfg.mode === 'MARKETING' && (\n              <>\n                <NavSpacer />\n                <NavLink to={`${urls.home()}#pricing`}>Pricing</NavLink>\n              </>\n            )}\n            <NavSpacer />\n            <NavLink href={URLS.blog} target=\"_blank\">\n              Blog\n            </NavLink>\n            {(cfg.mode === 'MARKETING' || cfg.mode === 'OPEN') && (\n              <>\n                <NavSpacer />\n                <NavLink href={URLS.jobs} target=\"_blank\">\n                  Jobs\n                </NavLink>\n              </>\n            )}\n            {cfg.mode === 'MARKETING' && (\n              <>\n                <NavSpacer />\n                <NavLink to={urls.about()}>About</NavLink>\n              </>\n            )}\n          </M.Box>\n\n          <M.Box\n            style={{ gridArea: 'copy' }}\n            display=\"flex\"\n            justifyContent={{ xs: 'center', sm: 'flex-start' }}\n          >\n            <M.Typography color=\"textSecondary\">\n              &copy;&nbsp;{year} Quilt Data, Inc.\n            </M.Typography>\n          </M.Box>\n\n          <M.Box\n            component=\"nav\"\n            display=\"flex\"\n            justifyContent={{ xs: 'center', sm: 'flex-end' }}\n            style={{ gridArea: 'icons' }}\n          >\n            <NavIcon icon={iconFacebook} href={URLS.facebook} target=\"_blank\" />\n            <NavIcon icon={iconTwitter} href={URLS.twitter} target=\"_blank\" ml={4} />\n            <NavIcon icon={iconGithub} href={URLS.gitWeb} target=\"_blank\" ml={4} />\n            <NavIcon icon={iconSlack} href={URLS.slackInvite} target=\"_blank\" ml={4} />\n            <NavIcon icon={iconInstagram} href={URLS.instagram} target=\"_blank\" ml={4} />\n            <NavIcon icon={iconLinkedin} href={URLS.linkedin} target=\"_blank\" ml={4} />\n            {reservedSpaceForIntercom && (\n              <M.Box ml={4} width={60} display={{ xs: 'none', sm: 'block' }} />\n            )}\n          </M.Box>\n        </M.Container>\n        <M.Container maxWidth=\"lg\">\n          <Version />\n        </M.Container>\n      </footer>\n    </M.MuiThemeProvider>\n  )\n}\n","export default \"data:image/png;base64,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\"","import { push } from 'connected-react-router/esm/immutable'\nimport deburr from 'lodash/deburr'\nimport { matchSorter } from 'match-sorter'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport AutosizeInput from 'react-input-autosize'\nimport * as redux from 'react-redux'\nimport * as M from '@material-ui/core'\nimport Autocomplete from '@material-ui/lab/Autocomplete'\n\nimport BucketIcon from 'components/BucketIcon'\nimport * as style from 'constants/style'\nimport * as BucketConfig from 'utils/BucketConfig'\nimport Delay from 'utils/Delay'\nimport * as NamedRoutes from 'utils/NamedRoutes'\n\nconst normalizeBucket = R.pipe(\n  deburr,\n  R.toLower,\n  R.replace(/^[^a-z0-9]+/g, ''),\n  R.replace(/[^a-z0-9-.]+/g, '-'),\n  R.replace(/[^a-z0-9]+$/g, ''),\n)\n\nfunction WrappedAutosizeInput({ className, ...props }) {\n  return <AutosizeInput inputClassName={className} placeholderIsMinWidth {...props} />\n}\n\nconst useNavInputStyles = M.makeStyles((t) => ({\n  input: {\n    fontSize: t.typography.button.fontSize,\n    fontWeight: t.typography.button.fontWeight,\n    height: 18,\n    letterSpacing: t.typography.button.letterSpacing,\n    lineHeight: '18px',\n    maxWidth: 200,\n    paddingBottom: 7,\n    paddingTop: 7,\n  },\n  underline: {\n    '&:after': {\n      borderBottomColor: t.palette.primary.main,\n    },\n  },\n}))\n\nconst NavInput = React.forwardRef(function NavInput(\n  { InputProps, InputLabelProps, ...props },\n  ref,\n) {\n  const classes = useNavInputStyles()\n  return (\n    <M.Input\n      ref={ref}\n      classes={classes}\n      inputComponent={WrappedAutosizeInput}\n      {...InputProps}\n      {...props}\n    />\n  )\n})\n\nconst useBucketStyles = M.makeStyles((t) => ({\n  root: {\n    display: 'flex',\n    maxWidth: '100%',\n    alignItems: 'center',\n  },\n  icon: {\n    flexShrink: 0,\n  },\n  text: {\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    overflow: 'hidden',\n    paddingLeft: t.spacing(1),\n    '& > *': {\n      overflow: 'hidden',\n      textOverflow: 'ellipsis',\n      whiteSpace: 'nowrap',\n    },\n  },\n  title: {\n    ...t.typography.body1,\n    lineHeight: '20px',\n  },\n  desc: {\n    ...t.typography.body2,\n    color: t.palette.text.secondary,\n  },\n}))\n\nfunction Bucket({ iconUrl, name, title, description }) {\n  const classes = useBucketStyles()\n  return (\n    <div className={classes.root} title={description}>\n      <BucketIcon alt={title} className={classes.icon} src={iconUrl} />\n      <div className={classes.text}>\n        <div className={classes.title}>\n          {title} (s3://{name})\n        </div>\n        <div className={classes.desc}>{description}</div>\n      </div>\n    </div>\n  )\n}\n\nfunction CustomPopper({ style: css, ...props }) {\n  return (\n    <M.Popper\n      {...props}\n      style={{ ...css, width: 'auto', maxWidth: 'min(calc(100vw - 8px), 680px)' }}\n      placement=\"bottom-start\"\n    />\n  )\n}\n\nfunction BucketSelect({ cancel, forwardedRef, ...props }) {\n  const currentBucket = BucketConfig.useCurrentBucket()\n  // XXX: consider using graphql directly\n  const bucketConfigs = BucketConfig.useRelevantBucketConfigs()\n  const dispatch = redux.useDispatch()\n  const { urls } = NamedRoutes.use()\n\n  const [inputValue, setInputValue] = React.useState('')\n  const inputRef = React.useRef()\n\n  React.useImperativeHandle(forwardedRef, () => ({\n    focus: () => {\n      if (inputRef.current) inputRef.current.focus()\n    },\n  }))\n\n  return (\n    <M.Box {...props}>\n      <M.MuiThemeProvider theme={style.appTheme}>\n        <Autocomplete\n          PopperComponent={CustomPopper}\n          freeSolo\n          disableClearable\n          openOnFocus\n          options={bucketConfigs}\n          value=\"\"\n          inputValue={inputValue}\n          onInputChange={(event, newValue) => setInputValue(newValue)}\n          onChange={(event, newValue, reason) => {\n            if (reason === 'select-option' || reason === 'create-option') {\n              const to =\n                typeof newValue === 'string' ? normalizeBucket(newValue) : newValue.name\n              if (to && currentBucket !== to) {\n                dispatch(push(urls.bucketRoot(to)))\n              }\n            }\n          }}\n          onClose={() => {\n            if (inputRef.current) inputRef.current.blur()\n          }}\n          filterOptions={(options, params) => {\n            const filtered = params.inputValue\n              ? matchSorter(options, params.inputValue, {\n                  keys: [\n                    'name',\n                    'title',\n                    {\n                      key: 'tags',\n                      threshold: matchSorter.rankings.WORD_STARTS_WITH,\n                    },\n                    {\n                      key: 'description',\n                      maxRanking: matchSorter.rankings.STARTS_WITH,\n                      threshold: matchSorter.rankings.ACRONYM,\n                    },\n                  ],\n                })\n              : options\n\n            if (\n              normalizeBucket(params.inputValue) !== '' &&\n              !filtered.find((b) => b.name === params.inputValue)\n            ) {\n              filtered.unshift(params.inputValue)\n            }\n\n            return filtered\n          }}\n          getOptionLabel={(option) => (typeof option === 'string' ? option : option.name)}\n          renderOption={(option) =>\n            typeof option === 'string' ? (\n              <>\n                <M.Box display=\"flex\" pr={1} fontSize={40}>\n                  <M.Icon fontSize=\"inherit\">arrow_forward</M.Icon>\n                </M.Box>\n                <span>\n                  Go to <b>s3://{normalizeBucket(option)}</b>\n                </span>\n              </>\n            ) : (\n              <Bucket {...option} />\n            )\n          }\n          renderInput={(inputProps) => (\n            <M.MuiThemeProvider theme={style.navTheme}>\n              <NavInput\n                {...inputProps}\n                onBlur={() => {\n                  if (cancel) cancel()\n                  setTimeout(() => {\n                    setInputValue('')\n                  }, 100)\n                }}\n                placeholder=\"Go to bucket\"\n                inputRef={inputRef}\n              />\n            </M.MuiThemeProvider>\n          )}\n        />\n      </M.MuiThemeProvider>\n    </M.Box>\n  )\n}\n\nexport default React.forwardRef(function BucketSelectSuspended(props, ref) {\n  return (\n    <React.Suspense fallback={<Delay>{() => <M.CircularProgress />}</Delay>}>\n      <BucketSelect {...props} forwardedRef={ref} />\n    </React.Suspense>\n  )\n})\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport type { TypedDocumentNode as DocumentNode } from '@graphql-typed-document-node/core'\nimport * as Types from '../../model/graphql/types.generated'\n\nexport type containers_NavBar_BucketCollaboratorsQueryVariables = Types.Exact<{\n  bucket: Types.Scalars['String']\n}>\n\nexport type containers_NavBar_BucketCollaboratorsQuery = {\n  readonly __typename: 'Query'\n} & {\n  readonly bucketConfig: Types.Maybe<\n    { readonly __typename: 'BucketConfig' } & Pick<Types.BucketConfig, 'name'> & {\n        readonly collaborators: ReadonlyArray<\n          { readonly __typename: 'CollaboratorBucketConnection' } & Pick<\n            Types.CollaboratorBucketConnection,\n            'permissionLevel'\n          > & {\n              readonly collaborator: { readonly __typename: 'Collaborator' } & Pick<\n                Types.Collaborator,\n                'email' | 'username'\n              >\n            }\n        >\n      }\n  >\n}\n\nexport const containers_NavBar_BucketCollaboratorsDocument = {\n  kind: 'Document',\n  definitions: [\n    {\n      kind: 'OperationDefinition',\n      operation: 'query',\n      name: { kind: 'Name', value: 'containers_NavBar_BucketCollaborators' },\n      variableDefinitions: [\n        {\n          kind: 'VariableDefinition',\n          variable: { kind: 'Variable', name: { kind: 'Name', value: 'bucket' } },\n          type: {\n            kind: 'NonNullType',\n            type: { kind: 'NamedType', name: { kind: 'Name', value: 'String' } },\n          },\n        },\n      ],\n      selectionSet: {\n        kind: 'SelectionSet',\n        selections: [\n          {\n            kind: 'Field',\n            name: { kind: 'Name', value: 'bucketConfig' },\n            arguments: [\n              {\n                kind: 'Argument',\n                name: { kind: 'Name', value: 'name' },\n                value: { kind: 'Variable', name: { kind: 'Name', value: 'bucket' } },\n              },\n            ],\n            selectionSet: {\n              kind: 'SelectionSet',\n              selections: [\n                { kind: 'Field', name: { kind: 'Name', value: 'name' } },\n                {\n                  kind: 'Field',\n                  name: { kind: 'Name', value: 'collaborators' },\n                  selectionSet: {\n                    kind: 'SelectionSet',\n                    selections: [\n                      {\n                        kind: 'Field',\n                        name: { kind: 'Name', value: 'collaborator' },\n                        selectionSet: {\n                          kind: 'SelectionSet',\n                          selections: [\n                            { kind: 'Field', name: { kind: 'Name', value: 'email' } },\n                            { kind: 'Field', name: { kind: 'Name', value: 'username' } },\n                          ],\n                        },\n                      },\n                      { kind: 'Field', name: { kind: 'Name', value: 'permissionLevel' } },\n                    ],\n                  },\n                },\n              ],\n            },\n          },\n        ],\n      },\n    },\n  ],\n} as unknown as DocumentNode<\n  containers_NavBar_BucketCollaboratorsQuery,\n  containers_NavBar_BucketCollaboratorsQueryVariables\n>\n\nexport { containers_NavBar_BucketCollaboratorsDocument as default }\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as urql from 'urql'\nimport * as M from '@material-ui/core'\n\nimport { Avatars, Popup } from 'components/Collaborators'\nimport * as style from 'constants/style'\nimport * as Model from 'model'\nimport usePotentialCollaborators from 'utils/usePotentialCollaborators'\n\nimport BUCKET_COLLABORATORS from './BucketCollaborators.generated'\n\nconst NO_COLLABORATORS: ReadonlyArray<Model.GQLTypes.CollaboratorBucketConnection> = []\n\nconst useStyles = M.makeStyles((t) => ({\n  avatars: {\n    marginLeft: t.spacing(2),\n    transition: 'opacity 0.3s ease',\n  },\n  hidden: {\n    opacity: 0,\n    zIndex: 0,\n  },\n}))\n\ninterface CollaboratorsProps {\n  bucket: string\n  hidden: boolean\n}\n\nexport default function Collaborators({ bucket, hidden }: CollaboratorsProps) {\n  const classes = useStyles()\n\n  const [{ data }] = urql.useQuery({\n    query: BUCKET_COLLABORATORS,\n    variables: { bucket },\n  })\n  const collaborators = data?.bucketConfig?.collaborators || NO_COLLABORATORS\n  const potentialCollaborators = usePotentialCollaborators()\n  const allCollaborators: Model.Collaborators = React.useMemo(\n    () => [\n      ...collaborators,\n      ...potentialCollaborators.map((collaborator) => ({\n        collaborator,\n        permissionLevel: undefined,\n      })),\n    ],\n    [collaborators, potentialCollaborators],\n  )\n\n  const [open, setOpen] = React.useState(false)\n  const handleOpen = React.useCallback(() => setOpen(true), [setOpen])\n  const handleClose = React.useCallback(() => setOpen(false), [setOpen])\n\n  if (!allCollaborators?.length) return null\n\n  return (\n    <M.MuiThemeProvider theme={style.appTheme}>\n      <Popup\n        bucket={bucket}\n        collaborators={allCollaborators}\n        onClose={handleClose}\n        open={open}\n      />\n      <Avatars\n        className={cx(classes.avatars, { [classes.hidden]: hidden })}\n        collaborators={allCollaborators}\n        onClick={handleOpen}\n      />\n    </M.MuiThemeProvider>\n  )\n}\n","import cx from 'classnames'\n// TODO: use history instead\nimport { push } from 'connected-react-router/esm/immutable'\nimport * as React from 'react'\nimport * as redux from 'react-redux'\nimport * as M from '@material-ui/core'\nimport { fade } from '@material-ui/core/styles/colorManipulator'\nimport * as Lab from '@material-ui/lab'\n\nimport * as style from 'constants/style'\nimport * as Config from 'utils/Config'\nimport * as BucketConfig from 'utils/BucketConfig'\nimport Delay from 'utils/Delay'\nimport * as NamedRoutes from 'utils/NamedRoutes'\nimport parse from 'utils/parseSearch'\nimport { useRoute } from 'utils/router'\n\nimport SearchHelp from './Help'\n\nconst expandAnimationDuration = 200\n\nconst useStyles = M.makeStyles((t) => ({\n  root: {\n    background: fade(t.palette.common.white, 0),\n    borderRadius: t.shape.borderRadius,\n    overflow: 'hidden',\n    padding: `0 ${t.spacing(1)}px 0 0`,\n    position: 'absolute',\n    right: 0,\n    transition: [\n      `background-color ${expandAnimationDuration}ms`,\n      `opacity ${expandAnimationDuration}ms`,\n      `width ${expandAnimationDuration}ms`,\n    ],\n    width: t.spacing(24),\n    '&:not($iconized)': {\n      background: fade(t.palette.common.white, 0.1),\n    },\n    '&:not($disabled):not($iconized):hover': {\n      background: fade(t.palette.common.white, 0.2),\n    },\n  },\n  iconized: {\n    width: t.spacing(4),\n  },\n  disabled: {\n    opacity: 0.8,\n  },\n  help: {\n    maxHeight: t.spacing(50),\n    overflowY: 'auto',\n    padding: t.spacing(0, 4),\n    [t.breakpoints.down('xs')]: {\n      padding: t.spacing(0, 1),\n    },\n  },\n  helpWrapper: {\n    left: 0,\n    position: 'absolute',\n    right: 0,\n    top: t.spacing(5),\n    [t.breakpoints.down('xs')]: {\n      left: '-43px',\n      right: '-36px',\n    },\n  },\n  hidden: {\n    opacity: 0,\n  },\n  expanded: {\n    background: `${fade(t.palette.common.white, 0.2)} !important`,\n    width: '100%',\n  },\n  input: {\n    paddingLeft: t.spacing(1),\n    paddingTop: 8,\n    paddingBottom: 9,\n    textOverflow: 'ellipsis',\n    transition: ['opacity 200ms'],\n    '$iconized:not($expanded) &': {\n      opacity: 0,\n    },\n  },\n  inputIcon: {\n    cursor: 'pointer',\n  },\n  inputOptions: {\n    borderRadius: 0,\n    borderWidth: '0 1px 0 0',\n    paddingLeft: t.spacing(1.25),\n    paddingRight: t.spacing(0.25),\n  },\n  wrapper: {\n    position: 'absolute',\n    right: 0,\n    top: 0,\n    width: '100%',\n  },\n}))\n\nfunction SearchBox({\n  bucket,\n  disabled,\n  iconized,\n  hidden,\n  expanded,\n  onHelpOpen,\n  onHelpClose,\n  onCollapse,\n  onToggleOptions,\n  onQuery,\n  helpOpened,\n  ...props\n}) {\n  const {\n    disabled: disabledCls,\n    expanded: expandedCls,\n    helpWrapper: helpWrapperCls,\n    help: helpCls,\n    hidden: hiddenCls,\n    iconized: iconizedCls,\n    inputIcon: inputIconCls,\n    inputOptions: inputOptionsCls,\n    wrapper: wrapperCls,\n    ...classes\n  } = useStyles()\n\n  const onClickAway = React.useCallback(() => {\n    if (expanded || helpOpened) {\n      onHelpClose()\n    }\n  }, [helpOpened, expanded, onHelpClose])\n\n  return (\n    <M.ClickAwayListener onClickAway={onClickAway}>\n      <div className={wrapperCls}>\n        <M.MuiThemeProvider theme={style.appTheme}>\n          <M.Fade in={helpOpened}>\n            <M.Paper className={helpWrapperCls}>\n              <SearchHelp className={helpCls} onQuery={onQuery} />\n            </M.Paper>\n          </M.Fade>\n        </M.MuiThemeProvider>\n\n        <M.InputBase\n          startAdornment={\n            <M.InputAdornment>\n              {iconized && !expanded ? (\n                <M.Icon className={inputIconCls} onClick={onToggleOptions}>\n                  search\n                </M.Icon>\n              ) : (\n                <Lab.ToggleButton\n                  className={inputOptionsCls}\n                  size=\"small\"\n                  value=\"help\"\n                  selected={helpOpened}\n                  onChange={onToggleOptions}\n                >\n                  <M.Icon size=\"small\">search</M.Icon>\n                  <M.Icon size=\"small\">\n                    {helpOpened ? 'arrow_drop_up' : 'arrow_drop_down'}\n                  </M.Icon>\n                </Lab.ToggleButton>\n              )}\n            </M.InputAdornment>\n          }\n          classes={classes}\n          className={cx({\n            [expandedCls]: expanded,\n            [disabledCls]: disabled,\n            [iconizedCls]: iconized,\n            [hiddenCls]: hidden,\n          })}\n          placeholder={\n            expanded ? `Search ${bucket ? `s3://${bucket}` : 'all buckets'}` : 'Search'\n          }\n          disabled={disabled}\n          {...props}\n        />\n      </div>\n    </M.ClickAwayListener>\n  )\n}\n\nfunction State({ query, makeUrl, children, onFocus, onBlur }) {\n  const dispatch = redux.useDispatch()\n\n  const [value, change] = React.useState(null)\n  const [expanded, setExpanded] = React.useState(false)\n  const [helpOpened, setHelpOpened] = React.useState(false)\n\n  const onChange = React.useCallback((evt) => {\n    change(evt.target.value)\n  }, [])\n\n  const handleExpand = React.useCallback(() => {\n    if (expanded) {\n      return\n    }\n\n    change(query)\n    setExpanded(true)\n    if (onFocus) onFocus()\n  }, [expanded, query, onFocus])\n\n  const handleCollapse = React.useCallback(() => {\n    change(null)\n    setExpanded(false)\n    setHelpOpened(false)\n    if (onBlur) onBlur()\n  }, [onBlur])\n\n  const handleHelpOpen = React.useCallback(() => setHelpOpened(true), [])\n\n  const handleHelpClose = React.useCallback(() => setHelpOpened(false), [])\n\n  const handleQuery = React.useCallback(\n    (strPart) => change(`${value} ${strPart}`),\n    [value],\n  )\n\n  const handleToggleOptions = React.useCallback(() => {\n    if (helpOpened) {\n      handleHelpClose()\n      return\n    }\n    if (expanded) {\n      handleHelpOpen()\n    } else {\n      handleExpand()\n      const animationDelay = expandAnimationDuration + 100\n      setTimeout(handleHelpOpen, animationDelay)\n    }\n  }, [expanded, helpOpened, handleExpand, handleHelpClose, handleHelpOpen])\n\n  const onKeyDown = React.useCallback(\n    (evt) => {\n      // eslint-disable-next-line default-case\n      switch (evt.key) {\n        case 'Enter':\n          /* suppress onSubmit (didn't actually find this to be a problem tho) */\n          evt.preventDefault()\n          if (query !== value) {\n            dispatch(push(makeUrl(value)))\n          }\n          handleCollapse()\n          evt.target.blur()\n          break\n        case 'Tab':\n        case 'Escape':\n          handleCollapse()\n          evt.target.blur()\n          break\n        case 'ArrowDown':\n          handleHelpOpen()\n          break\n      }\n    },\n    [dispatch, makeUrl, value, query, handleCollapse, handleHelpOpen],\n  )\n\n  return children({\n    value: value === null ? query : value,\n    onChange,\n    onKeyDown,\n    onFocus: handleExpand,\n    onToggleOptions: handleToggleOptions,\n    onHelpOpen: handleHelpOpen,\n    onHelpClose: handleCollapse,\n    onCollapse: handleCollapse,\n    onQuery: handleQuery,\n    expanded,\n    helpOpened,\n  })\n}\n\nfunction BucketSearch({ bucket, onFocus, onBlur, disabled, ...props }) {\n  const isInStack = BucketConfig.useIsInStack()\n  const { paths, urls } = NamedRoutes.use()\n  const { location: l, match } = useRoute(paths.bucketSearch)\n  const query = (match && parse(l.search).q) || ''\n  const makeUrl = React.useCallback(\n    (q) => urls.bucketSearch(bucket, { q }),\n    [urls, bucket],\n  )\n  return isInStack(bucket) && !disabled ? (\n    <State {...{ query, makeUrl, onFocus, onBlur }}>\n      {(state) => <SearchBox {...{ bucket, ...state, ...props }} />}\n    </State>\n  ) : (\n    <SearchBox disabled value=\"Search not available\" {...props} />\n  )\n}\n\nfunction GlobalSearch({ onFocus, onBlur, disabled, ...props }) {\n  const cfg = Config.useConfig()\n  const { paths, urls } = NamedRoutes.use()\n  const { location: l, match } = useRoute(paths.search)\n  const { q: query = '', buckets } = match ? parse(l.search) : {}\n  const makeUrl = React.useCallback((q) => urls.search({ q, buckets }), [urls, buckets])\n  if (cfg.disableNavigator) return null\n  return disabled ? (\n    <SearchBox disabled value=\"Search not available\" {...props} />\n  ) : (\n    <State {...{ query, makeUrl, onFocus, onBlur }}>\n      {(state) => <SearchBox {...state} {...props} />}\n    </State>\n  )\n}\n\nfunction DelayedProgress({\n  TransitionComponent = M.Fade,\n  ProgressComponent = M.CircularProgress,\n  progressProps,\n  transitionProps,\n  ...props\n}) {\n  return (\n    <Delay alwaysRender {...props}>\n      {(ready) => (\n        <TransitionComponent in={ready} {...transitionProps}>\n          <ProgressComponent {...progressProps} />\n        </TransitionComponent>\n      )}\n    </Delay>\n  )\n}\n\nexport default (props) => (\n  <React.Suspense fallback={<DelayedProgress />}>\n    {props.bucket ? <BucketSearch {...props} /> : <GlobalSearch {...props} />}\n  </React.Suspense>\n)\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport * as Config from 'utils/Config'\n\nimport BucketSelect from './BucketSelect'\nimport Collaborators from './Collaborators'\nimport Search from './Search'\n\nconst useBucketDisplayStyles = M.makeStyles((t) => ({\n  root: {\n    textTransform: 'none !important',\n    transition: ['opacity 200ms'],\n  },\n  locked: {\n    opacity: 0,\n  },\n  s3: {\n    opacity: 0.7,\n  },\n  bucket: {\n    maxWidth: 160,\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    [t.breakpoints.down('xs')]: {\n      maxWidth: 'calc(100vw - 220px)',\n    },\n  },\n}))\n\nfunction BucketDisplay({ bucket, select, locked = false, ...props }) {\n  const classes = useBucketDisplayStyles()\n  return (\n    <M.Box position=\"relative\" {...props}>\n      <M.Button\n        color=\"inherit\"\n        className={cx(classes.root, { [classes.locked]: locked })}\n        onClick={select}\n      >\n        <span className={classes.s3}>s3://</span>\n        <span className={classes.bucket}>{bucket}</span>\n        <M.Icon>expand_more</M.Icon>\n      </M.Button>\n      {locked && <M.Box position=\"absolute\" top={0} bottom={0} left={0} right={0} />}\n    </M.Box>\n  )\n}\n\nconst Container = (props) => (\n  <M.Box\n    height=\"36px\"\n    display=\"flex\"\n    alignItems=\"center\"\n    position=\"relative\"\n    flexGrow={1}\n    {...props}\n  />\n)\n\nfunction GlobalControls({ iconized, disableSearch }) {\n  const [state, setState] = React.useState(null)\n  const search = React.useCallback(() => {\n    setState('search')\n  }, [setState])\n  const cancel = React.useCallback(() => {\n    setState(null)\n  }, [setState])\n\n  return (\n    <Container pr={{ xs: 6, sm: 0 }}>\n      <BucketSelect display={state === 'search' ? 'none' : undefined} />\n      <Search\n        onFocus={search}\n        onBlur={cancel}\n        iconized={iconized}\n        disabled={disableSearch}\n      />\n    </Container>\n  )\n}\n\nfunction BucketControls({ bucket, iconized, disableSearch }) {\n  const [state, setState] = React.useState(null)\n  const cfg = Config.use()\n  const select = React.useCallback(() => {\n    setState('select')\n  }, [setState])\n  const search = React.useCallback(() => {\n    setState('search')\n  }, [setState])\n  const cancel = React.useCallback(() => {\n    setState(null)\n  }, [setState])\n\n  const selectRef = React.useRef()\n  const focusSelect = React.useCallback(() => {\n    if (selectRef.current) selectRef.current.focus()\n  }, [])\n\n  return (\n    <Container>\n      <BucketDisplay bucket={bucket} select={select} locked={!!state} ml={-1} />\n      {cfg.mode === 'PRODUCT' && (\n        <Collaborators bucket={bucket} hidden={state === 'search'} />\n      )}\n      <Search\n        bucket={bucket}\n        onFocus={search}\n        onBlur={cancel}\n        hidden={state === 'select'}\n        iconized={iconized}\n        disabled={disableSearch}\n      />\n      <M.Fade in={state === 'select'} onEnter={focusSelect}>\n        <BucketSelect cancel={cancel} position=\"absolute\" left={0} ref={selectRef} />\n      </M.Fade>\n    </Container>\n  )\n}\n\nexport default function Controls({ bucket, disableSearch }) {\n  const t = M.useTheme()\n  const iconized = M.useMediaQuery(t.breakpoints.down('xs'))\n  return bucket ? (\n    <BucketControls {...{ bucket, iconized, disableSearch }} />\n  ) : (\n    <GlobalControls {...{ iconized, disableSearch }} />\n  )\n}\n","import * as R from 'ramda'\nimport * as React from 'react'\nimport * as redux from 'react-redux'\nimport { Link } from 'react-router-dom'\nimport { createStructuredSelector } from 'reselect'\nimport { sanitizeUrl } from '@braintree/sanitize-url'\nimport * as M from '@material-ui/core'\n\nimport * as Intercom from 'components/Intercom'\nimport Logo from 'components/Logo'\nimport * as Bookmarks from 'containers/Bookmarks'\nimport * as style from 'constants/style'\nimport * as URLS from 'constants/urls'\nimport * as authSelectors from 'containers/Auth/selectors'\nimport * as BucketConfig from 'utils/BucketConfig'\nimport * as CatalogSettings from 'utils/CatalogSettings'\nimport * as Config from 'utils/Config'\nimport HashLink from 'utils/HashLink'\nimport * as NamedRoutes from 'utils/NamedRoutes'\nimport { useRoute } from 'utils/router'\n\nimport bg from './bg.png'\n\nimport Controls from './Controls'\n\nconst useLogoLinkStyles = M.makeStyles((t) => ({\n  bgQuilt: {\n    background: `${t.palette.secondary.dark} left / 64px url(${bg})`,\n  },\n  bgCustom: {\n    alignItems: 'center',\n    // TODO: make UI component with this background, and DRY\n    background: ({ backgroundColor }: { backgroundColor?: string }) =>\n      backgroundColor || `${t.palette.secondary.dark} left / 64px url(${bg})`,\n    borderRadius: t.spacing(0, 0, 2, 0),\n    display: 'flex',\n    justifyContent: 'center',\n    minHeight: t.spacing(8),\n    paddingRight: ({ backgroundColor }: { backgroundColor?: string }) =>\n      backgroundColor ? t.spacing(4) : t.spacing(2),\n  },\n}))\n\nfunction LogoLink() {\n  const settings = CatalogSettings.use()\n  const t = M.useTheme()\n  const xs = M.useMediaQuery(t.breakpoints.down('xs'))\n  const cfg = Config.useConfig()\n  const wide = cfg.mode === 'MARKETING' && xs\n  const classes = useLogoLinkStyles({\n    backgroundColor: settings?.theme?.palette?.primary?.main,\n  })\n  const { urls } = NamedRoutes.use()\n  return (\n    <div className={classes.bgQuilt}>\n      <div className={classes.bgCustom}>\n        <Link to={urls.home()}>\n          <Logo\n            width={wide ? '76.5px' : '27px'}\n            height={wide ? '29px' : '27px'}\n            src={settings?.logo?.url}\n          />\n        </Link>\n      </div>\n    </div>\n  )\n}\n\ninterface QuiltLinkProps {\n  className?: string\n}\n\nfunction QuiltLink({ className }: QuiltLinkProps) {\n  return (\n    <a\n      className={className}\n      href={URLS.homeMarketing}\n      target=\"_blank\"\n      title=\"Where data comes together\"\n    >\n      <Logo width=\"27px\" height=\"27px\" />\n    </a>\n  )\n}\n\nconst useItemStyles = M.makeStyles({\n  root: {\n    display: 'inline-flex',\n    maxWidth: '400px',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n  },\n})\n\n// type ItemProps = (LinkProps | { href: string }) & M.MenuItemProps\ninterface ItemProps extends M.MenuItemProps {\n  to?: string\n  href?: string\n}\n\n// FIXME: doesn't compile with Ref<unknown>\n// const Item = React.forwardRef((props: ItemProps, ref: React.Ref<unknown>) => (\nconst Item = React.forwardRef(\n  ({ children, ...props }: ItemProps, ref: React.Ref<any>) => {\n    const classes = useItemStyles()\n    return (\n      <M.MenuItem\n        // @ts-expect-error\n        // eslint-disable-next-line no-nested-ternary\n        component={props.to ? Link : props.href ? 'a' : undefined}\n        ref={ref}\n        {...props}\n      >\n        <span className={classes.root}>{children}</span>\n      </M.MenuItem>\n    )\n  },\n)\n\nconst selectUser = createStructuredSelector({\n  name: authSelectors.username,\n  isAdmin: authSelectors.isAdmin,\n})\n\nconst userDisplay = (user: $TSFixMe) => (\n  <>\n    {user.isAdmin && (\n      <>\n        <M.Icon fontSize=\"small\">security</M.Icon>\n        &nbsp;\n      </>\n    )}\n    {user.name}\n  </>\n)\n\nconst useBadgeStyles = M.makeStyles({\n  root: {\n    alignItems: 'inherit',\n  },\n  badge: {\n    top: '4px',\n  },\n})\n\ninterface BadgeProps extends M.BadgeProps {}\n\nfunction Badge({ children, color, invisible, ...props }: BadgeProps) {\n  const classes = useBadgeStyles()\n  return (\n    <M.Badge\n      classes={classes}\n      color={color}\n      variant=\"dot\"\n      invisible={invisible}\n      {...props}\n    >\n      {children}\n    </M.Badge>\n  )\n}\n\nfunction UserDropdown() {\n  const cfg = Config.useConfig()\n  const user = redux.useSelector(selectUser)\n  const { urls, paths } = NamedRoutes.use()\n  const bookmarks = Bookmarks.use()\n  const isProfile = !!useRoute(paths.profile, { exact: true }).match\n  const isAdmin = !!useRoute(paths.admin).match\n  const [anchor, setAnchor] = React.useState(null)\n  const [visible, setVisible] = React.useState(true)\n\n  const open = React.useCallback(\n    (evt) => {\n      setAnchor(evt.target)\n    },\n    [setAnchor],\n  )\n\n  const close = React.useCallback(() => {\n    setVisible(false)\n    setAnchor(null)\n  }, [setAnchor])\n\n  const showBookmarks = React.useCallback(() => {\n    bookmarks?.show()\n    close()\n  }, [bookmarks, close])\n\n  React.useEffect(() => {\n    if (bookmarks?.hasUpdates !== visible) setVisible(!!bookmarks?.hasUpdates)\n  }, [bookmarks?.hasUpdates, visible])\n\n  return (\n    <>\n      <M.Button variant=\"text\" color=\"inherit\" onClick={open}>\n        <Badge color=\"primary\" invisible={!visible}>\n          {userDisplay(user)}\n        </Badge>{' '}\n        <M.Icon>expand_more</M.Icon>\n      </M.Button>\n\n      <M.MuiThemeProvider theme={style.appTheme}>\n        <M.Menu anchorEl={anchor} open={!!anchor} onClose={close}>\n          <Item onClick={showBookmarks}>\n            <Badge color=\"secondary\" invisible={!visible}>\n              <M.Icon fontSize=\"small\">bookmarks_outlined</M.Icon>\n            </Badge>\n            &nbsp;Bookmarks\n          </Item>\n          {user.isAdmin && (\n            <Item to={urls.admin()} onClick={close} selected={isAdmin} divider>\n              <M.Icon fontSize=\"small\">security</M.Icon>&nbsp;Admin settings\n            </Item>\n          )}\n          {cfg.mode === 'OPEN' && (\n            <Item to={urls.profile()} onClick={close} selected={isProfile}>\n              Profile\n            </Item>\n          )}\n          <Item to={urls.signOut()} onClick={close}>\n            Sign Out\n          </Item>\n        </M.Menu>\n      </M.MuiThemeProvider>\n    </>\n  )\n}\n\nfunction useHam() {\n  const [anchor, setAnchor] = React.useState(null)\n\n  const open = React.useCallback(\n    (evt) => {\n      setAnchor(evt.target)\n    },\n    [setAnchor],\n  )\n\n  const close = React.useCallback(() => {\n    setAnchor(null)\n  }, [setAnchor])\n\n  const render = (children: React.ReactNode) => (\n    <>\n      <M.IconButton onClick={open} aria-label=\"Menu\" edge=\"end\">\n        <M.Icon>menu</M.Icon>\n      </M.IconButton>\n      <M.MuiThemeProvider theme={style.appTheme}>\n        <M.Menu\n          anchorEl={anchor}\n          open={!!anchor}\n          onClose={close}\n          MenuListProps={\n            {\n              component: 'nav',\n              style: { minWidth: 120 },\n            } as M.MenuListProps\n          }\n        >\n          {children}\n        </M.Menu>\n      </M.MuiThemeProvider>\n    </>\n  )\n\n  return { open, close, render }\n}\n\ninterface AuthHamburgerProps {\n  authenticated: boolean\n  waiting: boolean\n  error: boolean\n}\n\nfunction AuthHamburger({ authenticated, waiting, error }: AuthHamburgerProps) {\n  const cfg = Config.useConfig()\n  const user = redux.useSelector(selectUser)\n  const { urls, paths } = NamedRoutes.use()\n  const isProfile = !!useRoute(paths.profile, { exact: true }).match\n  const isAdmin = !!useRoute(paths.admin).match\n  const ham = useHam()\n  const links = useLinks()\n  return ham.render([\n    ...// eslint-disable-next-line no-nested-ternary\n    (authenticated\n      ? [\n          <M.MenuItem key=\"user\" component=\"div\">\n            {userDisplay(user)}\n          </M.MenuItem>,\n          user.isAdmin && (\n            <Item key=\"admin\" to={urls.admin()} onClick={ham.close} selected={isAdmin}>\n              <M.Box component=\"span\" pr={2} />\n              <M.Icon fontSize=\"small\">security</M.Icon>\n              &nbsp;Admin settings\n            </Item>\n          ),\n          cfg.mode === 'OPEN' && (\n            <Item\n              key=\"profile\"\n              to={urls.profile()}\n              onClick={ham.close}\n              selected={isProfile}\n            >\n              <M.Box component=\"span\" pr={2} />\n              Profile\n            </Item>\n          ),\n          <Item key=\"signout\" to={urls.signOut()} onClick={ham.close}>\n            <M.Box component=\"span\" pr={2} />\n            Sign Out\n          </Item>,\n        ]\n      : waiting\n      ? [\n          <Item onClick={ham.close} key=\"progress\">\n            <M.CircularProgress />\n          </Item>,\n        ]\n      : [\n          <Item to={urls.signIn()} onClick={ham.close} key=\"sign-in\">\n            {error && (\n              <>\n                <M.Icon>error_outline</M.Icon>{' '}\n              </>\n            )}\n            Sign In\n          </Item>,\n        ]),\n    <M.Divider key=\"divider\" />,\n    ...links.map(({ label, ...rest }) => (\n      <Item key={`${label}:${rest.to || rest.href}`} {...rest} onClick={ham.close}>\n        {label}\n      </Item>\n    )),\n  ])\n}\n\nfunction LinksHamburger() {\n  const ham = useHam()\n  return ham.render(\n    useLinks().map(({ label, ...rest }) => (\n      <Item key={`${label}:${rest.to || rest.href}`} {...rest} onClick={ham.close}>\n        {label}\n      </Item>\n    )),\n  )\n}\n\nconst useSignInStyles = M.makeStyles((t) => ({\n  icon: {\n    marginRight: t.spacing(1),\n  },\n}))\n\ninterface AuthError {\n  message: string\n}\n\ninterface SignInProps {\n  error?: AuthError\n  waiting: boolean\n}\n\nfunction SignIn({ error, waiting }: SignInProps) {\n  const classes = useSignInStyles()\n  const { urls } = NamedRoutes.use()\n  if (waiting) {\n    return <M.CircularProgress color=\"inherit\" />\n  }\n  return (\n    <>\n      {error && (\n        <M.Icon\n          title={`${error.message}\\n${JSON.stringify(error)}`}\n          className={classes.icon}\n        >\n          error_outline\n        </M.Icon>\n      )}\n      <M.Button component={Link} to={urls.signIn()} variant=\"contained\" color=\"primary\">\n        Sign In\n      </M.Button>\n    </>\n  )\n}\n\nconst useAppBarStyles = M.makeStyles((t) => ({\n  root: {\n    zIndex: t.zIndex.appBar + 1,\n  },\n  bgWrapper: {\n    bottom: 0,\n    display: 'flex',\n    left: 0,\n    position: 'absolute',\n    right: 0,\n    top: 0,\n  },\n  bgCustom: {\n    background: ({ backgroundColor }: { backgroundColor?: string }) =>\n      backgroundColor || `${t.palette.secondary.dark} left / 64px url(${bg})`,\n    flex: '50%',\n  },\n  bgQuilt: {\n    background: `${t.palette.secondary.dark} left / 64px url(${bg})`,\n    flex: '50%',\n  },\n}))\n\ninterface AppBarProps {\n  children: React.ReactNode\n}\n\nconst AppBar = React.forwardRef<HTMLDivElement, AppBarProps>(function AppBar(\n  { children },\n  ref,\n) {\n  const settings = CatalogSettings.use()\n  const classes = useAppBarStyles({\n    backgroundColor: settings?.theme?.palette?.primary?.main,\n  })\n  return (\n    <M.AppBar className={classes.root} ref={ref}>\n      <div className={classes.bgWrapper}>\n        <div className={classes.bgCustom} />\n        <div className={classes.bgQuilt} />\n      </div>\n      {children}\n    </M.AppBar>\n  )\n})\n\nconst useContainerStyles = M.makeStyles((t) => ({\n  container: {\n    display: 'flex',\n    alignItems: 'center',\n  },\n  main: {\n    alignItems: 'center',\n    background: `${t.palette.secondary.dark} left / 64px url(${bg})`,\n    borderRadius: '16px 0 0 0',\n    display: 'flex',\n    flexGrow: 1,\n    minHeight: '64px',\n    paddingLeft: ({ customBg }: { customBg: boolean }) => (customBg ? '32px' : undefined),\n  },\n}))\n\ninterface ContainerProps {\n  children?: React.ReactNode\n}\n\nexport function Container({ children }: ContainerProps) {\n  const trigger = M.useScrollTrigger()\n  const settings = CatalogSettings.use()\n  const classes = useContainerStyles({\n    customBg: !!settings?.theme?.palette?.primary?.main,\n  })\n  return (\n    <M.MuiThemeProvider theme={style.navTheme}>\n      <M.Box>\n        <M.Toolbar />\n        <M.Slide appear={false} direction=\"down\" in={!trigger}>\n          <AppBar>\n            <M.Toolbar disableGutters>\n              <M.Container className={classes.container} maxWidth=\"lg\">\n                <LogoLink />\n                <div className={classes.main}>{children}</div>\n              </M.Container>\n            </M.Toolbar>\n          </AppBar>\n        </M.Slide>\n      </M.Box>\n    </M.MuiThemeProvider>\n  )\n}\n\ninterface NavLinkOwnProps {\n  to?: string\n  path?: string\n}\n\ntype NavLinkProps = NavLinkOwnProps & M.BoxProps\n\nconst NavLink = React.forwardRef((props: NavLinkProps, ref: React.Ref<unknown>) => {\n  const isActive = !!useRoute(props.path, { exact: true }).match\n  return (\n    <M.Box\n      component={props.to ? HashLink : 'a'}\n      color={isActive ? 'text.disabled' : 'text.secondary'}\n      fontSize=\"body2.fontSize\"\n      maxWidth={64}\n      whiteSpace=\"nowrap\"\n      overflow=\"hidden\"\n      textOverflow=\"ellipsis\"\n      title={\n        typeof props.children === 'string' && props.children.length > 10\n          ? props.children\n          : undefined\n      }\n      {...props}\n      ref={ref}\n    />\n  )\n})\n\ninterface LinkDescriptor {\n  label: string\n  to?: string\n  href?: string\n  target?: '_blank'\n}\n\nfunction useLinks(): LinkDescriptor[] {\n  const { paths, urls } = NamedRoutes.use()\n  const cfg = Config.useConfig()\n  const settings = CatalogSettings.use()\n  const customNavLink: LinkDescriptor | null = React.useMemo(() => {\n    if (!settings?.customNavLink) return null\n    const href = sanitizeUrl(settings.customNavLink.url)\n    if (href === 'about:blank') return null\n    return {\n      href,\n      label: settings.customNavLink.label,\n      target: '_blank',\n    }\n  }, [settings?.customNavLink])\n\n  return [\n    process.env.NODE_ENV === 'development' && {\n      to: urls.example(),\n      label: 'Example',\n    },\n    customNavLink,\n    cfg.mode !== 'MARKETING' && {\n      to: urls.uriResolver(),\n      label: 'URI',\n      path: paths.uriResolver,\n    },\n    { href: URLS.docs, label: 'Docs' },\n    cfg.mode === 'MARKETING' && { to: `${urls.home()}#pricing`, label: 'Pricing' },\n    (cfg.mode === 'MARKETING' || cfg.mode === 'OPEN') && {\n      href: URLS.jobs,\n      label: 'Jobs',\n    },\n    cfg.mode !== 'PRODUCT' && { href: URLS.blog, label: 'Blog' },\n    cfg.mode === 'MARKETING' && { to: urls.about(), label: 'About' },\n  ].filter(Boolean) as LinkDescriptor[]\n}\n\nconst selector = createStructuredSelector(\n  R.pick(['error', 'waiting', 'authenticated'], authSelectors),\n)\n\nconst useNavBarStyles = M.makeStyles((t) => ({\n  nav: {\n    alignItems: 'center',\n    display: 'flex',\n    marginLeft: t.spacing(3),\n    marginRight: t.spacing(2),\n  },\n  navItem: {\n    '& + &': {\n      marginLeft: t.spacing(2),\n    },\n  },\n  quiltLogo: {\n    margin: '0 0 3px 8px',\n  },\n  spacer: {\n    flexGrow: 1,\n  },\n}))\n\nexport function NavBar() {\n  const cfg = Config.use()\n  const settings = CatalogSettings.use()\n  const bucket = BucketConfig.useCurrentBucket()\n  const { paths } = NamedRoutes.use()\n  const isSignIn = !!useRoute(paths.signIn, { exact: true }).match\n  const { error, waiting, authenticated } = redux.useSelector(selector)\n  const t = M.useTheme()\n  const useHamburger = M.useMediaQuery(t.breakpoints.down('sm'))\n  const links = useLinks()\n  const intercom = Intercom.use()\n  const classes = useNavBarStyles()\n  return (\n    <Container>\n      {cfg.disableNavigator || (cfg.alwaysRequiresAuth && isSignIn) ? (\n        <div className={classes.spacer} />\n      ) : (\n        <Controls {...{ bucket, disableSearch: cfg.mode === 'LOCAL' }} />\n      )}\n\n      {!useHamburger && (\n        <nav className={classes.nav}>\n          {links.map(({ label, ...rest }) => (\n            <NavLink\n              key={`${label}:${rest.to || rest.href}`}\n              className={classes.navItem}\n              {...rest}\n            >\n              {label}\n            </NavLink>\n          ))}\n          {!intercom.dummy && intercom.isCustom && (\n            <Intercom.Launcher className={classes.navItem} />\n          )}\n        </nav>\n      )}\n\n      {!cfg.disableNavigator &&\n        cfg.mode !== 'LOCAL' &&\n        !useHamburger &&\n        (authenticated ? (\n          <UserDropdown />\n        ) : (\n          !isSignIn && <SignIn error={error} waiting={waiting} />\n        ))}\n\n      {useHamburger &&\n        (cfg.disableNavigator || cfg.mode === 'LOCAL' ? (\n          <LinksHamburger />\n        ) : (\n          <AuthHamburger {...{ authenticated, error, waiting }} />\n        ))}\n\n      {settings?.logo?.url && <QuiltLink className={classes.quiltLogo} />}\n    </Container>\n  )\n}\n\nexport default NavBar\n","import * as React from 'react'\nimport { useRouteMatch } from 'react-router-dom'\nimport * as M from '@material-ui/core'\n\nimport Footer from 'components/Footer'\nimport * as Bookmarks from 'containers/Bookmarks'\nimport * as NavBar from 'containers/NavBar'\nimport * as NamedRoutes from 'utils/NamedRoutes'\n\nconst useRootStyles = M.makeStyles({\n  root: {\n    overflowX: 'hidden',\n    position: 'relative',\n  },\n})\n\ninterface RootProps {\n  dark?: boolean\n  children: React.ReactNode\n}\n\nexport function Root({ dark = false, ...props }: RootProps) {\n  const classes = useRootStyles()\n  return (\n    <M.Box\n      className={classes.root}\n      bgcolor={dark ? 'primary.main' : 'background.default'}\n      display=\"flex\"\n      flexDirection=\"column\"\n      minHeight=\"100vh\"\n      {...props}\n    />\n  )\n}\n\nexport interface LayoutProps {\n  bare?: boolean\n  dark?: boolean\n  children?: React.ReactNode\n  pre?: React.ReactNode\n}\n\nexport function Layout({ bare = false, dark = false, children, pre }: LayoutProps) {\n  const { paths } = NamedRoutes.use()\n  const isHomepage = useRouteMatch(paths.home)\n  const bucketRoute = useRouteMatch(paths.bucketRoot)\n  const { bucket } = (bucketRoute?.params as { bucket?: string }) || {}\n  return (\n    <Root dark={dark}>\n      {bare ? <NavBar.Container /> : <NavBar.NavBar />}\n      {!!pre && pre}\n      {!!children && <M.Box p={4}>{children}</M.Box>}\n      <M.Box flexGrow={1} />\n      {!!isHomepage && isHomepage.isExact && <Footer />}\n      <Bookmarks.Sidebar bucket={bucket} />\n    </Root>\n  )\n}\n\nexport default Layout\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\nimport { fade } from '@material-ui/core/styles'\n\nconst useStyles = M.makeStyles((t) => ({\n  root: {\n    background: fade(t.palette.background.paper, 0.5),\n    bottom: 0,\n    left: 0,\n    position: 'absolute',\n    right: 0,\n    top: 0,\n    zIndex: 1,\n  },\n}))\n\ninterface LockProps {\n  className?: string\n}\n\nexport default function Lock({ className }: LockProps) {\n  const classes = useStyles()\n  return <div className={cx(classes.root, className)} />\n}\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport * as AWS from 'utils/AWS'\nimport * as s3paths from 'utils/s3paths'\n\nimport quilt from './quilt.png'\n\ninterface LogoProps {\n  className?: string\n  src?: string\n  height: string\n  width: string\n}\n\nconst useStyles = M.makeStyles(({}) => ({\n  custom: ({ height }: { height: string }) => ({\n    height,\n  }),\n  quilt: ({ height, width }: { height: string; width: string }) => ({\n    height,\n    width,\n    // HACK: hardcoded increased height, because there is the tall \"l\" in logo\n    backgroundSize:\n      height === width ? `auto ${Number.parseInt(height) + 2}px` : `auto ${height}`,\n    backgroundImage: `url(${quilt})`,\n    backgroundPosition: '0 100%',\n    backgroundRepeat: 'no-repeat',\n  }),\n}))\n\nfunction QuiltLogo({ className, height, width }: LogoProps) {\n  const classes = useStyles({ height, width })\n  return <div className={cx(classes.quilt, className)} />\n}\n\nfunction CustomLogo({ className, src, height, width }: LogoProps) {\n  const sign = AWS.Signer.useS3Signer()\n  const parsedSrc = React.useMemo(() => {\n    if (!src || !s3paths.isS3Url(src)) return src\n    return sign(s3paths.parseS3Url(src))\n  }, [sign, src])\n  const classes = useStyles({ height, width })\n  return <img src={parsedSrc} className={cx(classes.custom, className)} />\n}\n\nexport default function Logo({ src, ...rest }: LogoProps) {\n  return src ? <CustomLogo src={src} {...rest} /> : <QuiltLogo {...rest} />\n}\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJkAAAA6CAMAAACUCgvIAAAAz1BMVEX///////////////////////////////9HcEz////////////////////////////////////////////////////////////////////////////////////////////qiSH////////////////riiP////////////////qiiLriiP////////riiPriiPqiiPriyL////////////piSPriiPqiiPpiiPqiSPsiiLqiSLqiiH////tjSP////riiL6kyXxjiT1kCTtiyOhqsouAAAAP3RSTlME0FPwx94P+wAJ1ui9T9rjMiKZwmFB9SegGR2EuKttaBKTE0ex5lrLcnqJmIwt02WqTkumODjwxlwqeGxEfx0wqmdVAAAGB0lEQVRo3tWaCX+iOhDAg6gJitIWUet9V3vf3e4VUb//Z1pIJgeHXe2Dvveyv3ZxHJI/M2GSmRSRf6UVKaY0+ClZBO1RQf8zMqTaf4ksRpML3CfIOEf5ZroYDoaLaaucD9zRZCEC8rq2E94XNuzYvzyUPduxZMGHzsrgSLyxa2N1nvWrchxZcHk+NgUU56P8yrzOmC1JlnjjIldLzkWjjUnMQaZox9gMkY4dUtC0FortToZoCTLrHJoVJ0Pk0ZRcWG+SreplhxYjQ6SGTdbwo3Sv+K9BKda8F/Uln3O0kRlagqwgxqtFyRAZCjAGUrXHy8aisRy7VSpdnCVa0mbixYuSIbLQwHC/di67mBT6WEMrZISWYjPMh4iQIXKCqRy8faO9xOHlzZPEpvgkG7TDyBAp10GOad1jVPraTohXB7NhWrEyQTuUrC3B+lZyIQoE5ZlEO/s6MkQ8PiwOh1XjjkYjLbScSZ1MYseB86xIpT1A/PvH/e38dX57f/dbaAm70mK+8+xRc9UCzEFdABtdvfr+drPZbH3/9XIEaG78qZAFLWZDIbY+kOwnK5Cy7NUFLROWn4e5v1uLtvPnDxzt1AQ9G8zYqtTDVql2o/5tV8MvKiW3LB5h5jCJ00N/J3N4r/W6mmV0yDv6vt2s9bbZ/uAkA+iNPvP35kSE7XaUzAWxKckqICkhobmPjKrlB5ExKF3we+78dbxt7/gABmheA5lYWGOvq83DOXUk2QVIjL/aTFuzkVUHpQXTedntEmS73QssrVzTiITnNDImrkoy8UiVA8iUzU6YBYMn5Dq323Wy+W/s7rLDVdlCkBeZstkw0n2KL5k/vxEVkTFb2PO32Rno8LX6bZtO9qbdjuk4T5s1oSGbe6jZClXe17tUst36ncUJzJV7uc0zTAfnNy3WUIkPVmeJ5bd0Z3J3qolm5Eg2lWuAyQfja87lPjL/kn1/wZVLbN3Ph6xGLNiBgYAH9qu9ZFcQRPl7XM7PZmpFh8jbO5IM5U/W5IO5B3mzCN78EpvBpK6wfcCPvWRsgeLrBV8E8icDM/CNxstuD9n6heXKmoHzJxNxfcoXp00q1+aW3T4F3XZukVYnW4IO32R9T3en/53d3gXd5ZeQeVRFz2A7O08z2mY+UiNAKpA/GcR1kXmkLun+N+FMGTS+gIw8gdKMi5Ih7RWCGelp0+wryGADIdO1+ziaf090k8HNGllst13Mikxuag3YpV9u9K3QdnMJeamhb2l1slmkPjhxMiJDZCWEYxA+3G79TRjZdht/+/YTRhzLfQp0diPI3Eil8JlmRiYeEqsi1MP9fB3km+v5/YMYcCBSLEg8gjSvSSMSUOyKMY4iq6VWD4ZCGqKBfPT+8+Hn+0jii8KfxNefyNNKl/xdP5rsMdY9JOWyfEBT68RhbVmCuXpiCbInzQPXMnE8isyjkYgvakEwY8JfT5PYsUT4YfIkwfiuPDbzwiQCym2qdnkcWQurtJd3hUQmKepUTgPpR2LhdcNRXy80xxVk6QoXuKx8raq9x5GV5dQY6sdMzAdibGoMOprNOgODqi+7+lwvV1XK3294XuE6TCrwJ95NGZ/D+/uNx9pw1kWqCKUqyKb9q/DcOm09F7q2qVeQx9Hp11UG0irhJaA7hgyRZayw0UckjiYMFKR8WH2EYB89DZpU9cyaYQVZ2JB+hqxjyhp20JqCLPy6SyMnFdEL1k0/cYBW080FvzzvM95E5JdugyAxUfOZ1Ez9kALj2AlU8F6uEmiDyIFQeLlkL8YBtSAmqWsF6Z42fBCd9BXvdJZ2IKah0TaKozWwViShtLkg8jhEtxlvdXnzBUgcS1vA+3pXRvQU8fEi5sL4uZjRiqO1+prGrKWOkHBdkrkgKcp7bZAYlhaFSMNQXbkodm5X6OHEmZh4jPCfOY16NLg+6bols2k6xetn9tk6hSb1OiBQ0ei8FZfwoO+t2j3X7bVX0wlKnCnerOwq/cCjscnGImK50zqd/PMDd/ThCT97Iq/RPevPZr2e7brF4oVhVOolx6lWQwfQJ2vP3yqgvce7B0i0Ixv+9R+fxR4vTBoMLAAAAABJRU5ErkJggg==\"","import Ajv from 'ajv'\nimport brace from 'brace'\nimport { JsonEditor as ReactJsonEditor } from 'jsoneditor-react'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport JsonEditor from 'components/JsonEditor'\nimport { JsonValue, ValidationErrors } from 'components/JsonEditor/constants'\nimport JsonValidationErrors from 'components/JsonValidationErrors'\nimport { JsonSchema, makeSchemaValidator } from 'utils/json-schema'\n\nimport 'brace/mode/json'\nimport 'brace/theme/eclipse'\nimport 'jsoneditor-react/es/editor.min.css'\n\nconst ajv = new Ajv({ allErrors: true, verbose: true })\n\nconst editorHtmlProps = {\n  style: { flexGrow: 1 },\n}\n\nconst useStyles = M.makeStyles((t) => ({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n  },\n  error: {\n    margin: t.spacing(1, 0, 0),\n  },\n}))\n\ninterface MetadataEditorProps {\n  isRaw: boolean\n  multiColumned: boolean\n  onChange: (value: JsonValue) => void\n  schema?: JsonSchema\n  value: JsonValue\n}\n\nexport default function MetadataEditor({\n  isRaw,\n  multiColumned,\n  onChange,\n  schema,\n  value,\n}: MetadataEditorProps) {\n  const classes = useStyles()\n  const schemaValidator = React.useMemo(() => makeSchemaValidator(schema), [schema])\n  const [errors, setErrors] = React.useState<ValidationErrors>(() =>\n    schemaValidator(value),\n  )\n\n  const handleChange = React.useCallback(\n    (newValue: JsonValue) => {\n      setErrors(schemaValidator(newValue))\n      onChange(newValue)\n    },\n    [onChange, schemaValidator],\n  )\n  return (\n    <div className={classes.root}>\n      {isRaw ? (\n        <ReactJsonEditor\n          ace={brace}\n          ajv={ajv}\n          htmlElementProps={editorHtmlProps}\n          mainMenuBar={false}\n          mode=\"code\"\n          navigationBar={false}\n          onChange={onChange}\n          onError={(e) => setErrors([e])}\n          onValidationError={setErrors}\n          schema={schema}\n          search={false}\n          statusBar={true}\n          theme=\"ace/theme/eclipse\"\n          value={value || {}}\n        />\n      ) : (\n        <JsonEditor\n          errors={errors}\n          multiColumned={multiColumned}\n          onChange={handleChange}\n          schema={schema}\n          value={value}\n        />\n      )}\n\n      <JsonValidationErrors className={classes.error} error={errors} />\n    </div>\n  )\n}\n","import * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport Delay from 'utils/Delay'\n\ninterface PlaceholderProps extends M.BoxProps {\n  delay?: number\n}\n\nexport default function Placeholder({ delay, ...props }: PlaceholderProps) {\n  return (\n    <M.Box\n      alignItems=\"center\"\n      display=\"flex\"\n      justifyContent=\"center\"\n      minHeight=\"20rem\"\n      color=\"common.white\"\n      {...props}\n    >\n      <Delay ms={delay}>{() => <M.CircularProgress size={120} color=\"inherit\" />}</Delay>\n    </M.Box>\n  )\n}\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nconst useStyles = M.makeStyles((t) => ({\n  root: {\n    display: 'inline-flex',\n    [t.breakpoints.down('sm')]: {\n      borderRadius: 0,\n      boxShadow: 'none',\n    },\n  },\n  button: {\n    ...t.typography.body1,\n    textTransform: 'none',\n  },\n  disabled: {\n    cursor: 'not-allowed',\n  },\n  expand: {\n    fontSize: 'inherit',\n    marginLeft: t.spacing(0.25),\n  },\n  progress: {\n    margin: t.spacing(0, 1),\n  },\n}))\n\nexport interface ValueBase {\n  // TODO: use getOptionLabel(): string  similar to M.Autocomplete\n  toString: () => string\n  // TODO: use isOptionEqualToValue(): bool similar to M.Autocomplete\n  valueOf: () => string | number | boolean\n}\n\ninterface SelectDropdownProps<Value extends ValueBase> {\n  ButtonProps?: M.ButtonProps\n  children?: React.ReactNode\n  disabled?: boolean\n  emptySlot?: React.ReactNode\n  loading?: boolean\n  onChange: (selected: Value) => void\n  onClose?: () => void\n  onOpen?: () => void\n  options: Value[]\n  value: ValueBase\n}\n\nexport default function SelectDropdown<Value extends ValueBase>({\n  ButtonProps,\n  children,\n  className,\n  disabled = false,\n  emptySlot,\n  loading,\n  onChange,\n  onClose,\n  onOpen,\n  options,\n  value,\n  ...props\n}: M.PaperProps & SelectDropdownProps<Value>) {\n  const classes = useStyles()\n\n  const [anchorEl, setAnchorEl] = React.useState<HTMLElement | null>(null)\n\n  const handleOpen = React.useCallback(\n    (event) => {\n      if (disabled) return\n      if (onOpen) onOpen()\n      setAnchorEl(event.currentTarget)\n    },\n    [disabled, onOpen, setAnchorEl],\n  )\n\n  const handleClose = React.useCallback(() => {\n    if (onClose) onClose()\n    setAnchorEl(null)\n  }, [onClose])\n\n  const handleSelect = React.useCallback(\n    (selected: Value) => () => {\n      setAnchorEl(null)\n      onChange(selected)\n    },\n    [onChange],\n  )\n\n  const t = M.useTheme()\n  const aboveSm = M.useMediaQuery(t.breakpoints.up('sm'))\n  const { className: buttonClassName, ...buttonProps } = ButtonProps || {}\n\n  return (\n    <M.Paper\n      className={cx(className, classes.root, { [classes.disabled]: disabled })}\n      elevation={0}\n      {...props}\n    >\n      <M.Button\n        className={cx(classes.button, buttonClassName)}\n        onClick={handleOpen}\n        size=\"small\"\n        variant=\"outlined\"\n        disabled={disabled}\n        {...buttonProps}\n      >\n        {children}\n        {aboveSm && (\n          <>\n            {value.toString()}\n            {loading && (\n              <M.CircularProgress\n                className={classes.progress}\n                color=\"inherit\"\n                size={16}\n              />\n            )}\n            <M.Icon className={classes.expand}>expand_more</M.Icon>\n          </>\n        )}\n      </M.Button>\n\n      <M.Menu\n        anchorEl={anchorEl}\n        open={!!anchorEl && !loading}\n        onClose={handleClose}\n        MenuListProps={{ dense: true }}\n      >\n        {options.length\n          ? options.map((item) => (\n              <M.MenuItem\n                key={item.toString()}\n                onClick={handleSelect(item)}\n                selected={value.valueOf() === item.valueOf()}\n              >\n                <M.ListItemText primary={item.toString()} />\n              </M.MenuItem>\n            ))\n          : emptySlot}\n      </M.Menu>\n    </M.Paper>\n  )\n}\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\nimport { fade } from '@material-ui/core/styles'\n\nconst shimmerSize = '200px'\n\nconst useStyles = M.makeStyles((t) => ({\n  root: {\n    background: t.palette.action.hover,\n  },\n  '@keyframes wave': {\n    '0%': {\n      backgroundPosition: `-${shimmerSize} 0`,\n    },\n    '100%': {\n      backgroundPosition: `calc(${shimmerSize} + 100%) 0`,\n    },\n  },\n  animate: {\n    animation: '$wave 3s infinite',\n    backgroundImage: `linear-gradient(\n      90deg,\n      ${fade(t.palette.common.white, 0)},\n      ${fade(t.palette.common.white, 0.7)},\n      ${fade(t.palette.common.white, 0)}\n    )`,\n    backgroundRepeat: 'no-repeat',\n    backgroundSize: `${shimmerSize} 100%`,\n  },\n}))\n\nexport interface SkeletonProps extends M.BoxProps {\n  animate?: boolean\n}\n\nexport default React.forwardRef(function Skeleton(\n  { className, animate = true, ...props }: SkeletonProps,\n  ref,\n) {\n  const classes = useStyles()\n  return (\n    <M.Box\n      className={cx(className, classes.root, animate && classes.animate)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\n","export const bucketPreferences = [\n  '.quilt/catalog/config.yaml',\n  '.quilt/catalog/config.yml',\n]\n\nexport const esQueries = '.quilt/queries/config.yaml'\n\n// TODO: enable this when backend is ready\n// const workflows = [\n//   '.quilt/workflows/config.yaml',\n//   '.quilt/workflows/config.yml',\n// ]\nexport const workflows = '.quilt/workflows/config.yml'\n\nexport const all = [...bucketPreferences, esQueries, workflows]\n","import * as R from 'ramda'\nimport * as React from 'react'\n\nimport type * as Model from 'model'\n\nconst Ctx = React.createContext<{\n  append: (logicalKey: string, file: Model.S3File) => void\n  clear: () => void\n  entries: Record<string, Model.S3File>\n  merge: (entries: Record<string, Model.S3File>) => void\n} | null>(null)\n\ninterface ProviderProps {\n  children: React.ReactNode\n}\n\n/** @deprecated Use Bookmarks.Provider and 'addToPackage' GroupName */\nexport function Provider({ children }: ProviderProps) {\n  const [entries, setEntries] = React.useState({})\n  const append = React.useCallback((logicalKey, s3File) => {\n    setEntries(\n      R.mergeLeft({\n        [logicalKey]: s3File,\n      }),\n    )\n  }, [])\n  const clear = React.useCallback(() => setEntries({}), [])\n  const merge = React.useCallback((files) => setEntries(R.mergeLeft(files)), [])\n\n  const value = React.useMemo(\n    () => ({ append, clear, entries, merge }),\n    [append, clear, entries, merge],\n  )\n\n  return <Ctx.Provider value={value}>{children}</Ctx.Provider>\n}\n\n/** @deprecated Use useBookmarks and 'addToPackage' GroupName */\nconst useAddToPackage = () => React.useContext(Ctx)\n\n/** @deprecated Use Bookmarks.use and 'addToPackage' GroupName */\nexport const use = useAddToPackage\n","import * as R from 'ramda'\nimport * as React from 'react'\n\n// TODO: rename all variables 'file' to 'handle'\nimport { S3HandleBase, handleToS3Url } from 'utils/s3paths'\nimport mkStorage from 'utils/storage'\n\nconst STORAGE_KEYS = {\n  BOOKMARKS: 'BOOKMARKS',\n}\nconst storage = mkStorage({\n  [STORAGE_KEYS.BOOKMARKS]: STORAGE_KEYS.BOOKMARKS,\n})\n\ntype GroupName = 'main'\n\ninterface BookmarksGroup {\n  entries: Record<string, S3HandleBase>\n}\n\ntype BookmarksGroups = Record<GroupName, BookmarksGroup>\n\nconst Ctx = React.createContext<{\n  append: (groupName: GroupName, file: S3HandleBase | S3HandleBase[]) => void\n  clear: (groupName: GroupName) => void\n  groups: BookmarksGroups\n  hasUpdates: boolean\n  hide: () => void\n  isBookmarked: (groupName: GroupName, file: S3HandleBase) => boolean\n  isOpened: boolean\n  remove: (groupName: GroupName, file: S3HandleBase) => void\n  show: () => void\n  toggle: (groupName: GroupName, file: S3HandleBase) => void\n} | null>(null)\n\ninterface ProviderProps {\n  children: React.ReactNode\n}\n\nconst initialBookmarks = { main: { entries: {} } }\n\nconst keyResolver = (file: S3HandleBase) => handleToS3Url(file)\n\ntype StateUpdaterFunction = (input: BookmarksGroups) => BookmarksGroups\n\nfunction createAppendUpdater(\n  groupName: GroupName,\n  s3File: S3HandleBase | S3HandleBase[],\n): StateUpdaterFunction {\n  if (Array.isArray(s3File)) {\n    const entries = s3File.reduce(\n      (memo, entry) => ({\n        ...memo,\n        [keyResolver(entry)]: entry,\n      }),\n      {},\n    )\n    return R.over(R.lensPath([groupName, 'entries']), R.mergeLeft(entries))\n  }\n  return R.set(R.lensPath([groupName, 'entries', keyResolver(s3File)]), s3File)\n}\n\nfunction createRemoveUpdater(\n  groupName: GroupName,\n  s3File: S3HandleBase,\n): StateUpdaterFunction {\n  return R.over(R.lensPath([groupName, 'entries']), R.dissoc(keyResolver(s3File)))\n}\n\nfunction createClearUpdater(groupName: GroupName): StateUpdaterFunction {\n  return R.assocPath([groupName, 'entries'], {})\n}\n\nexport function Provider({ children }: ProviderProps) {\n  const [hasUpdates, setUpdates] = React.useState(false)\n  const [isOpened, setOpened] = React.useState(false)\n  const [groups, setGroups] = React.useState(() => {\n    try {\n      return storage.get(STORAGE_KEYS.BOOKMARKS) || initialBookmarks\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e)\n      return initialBookmarks\n    }\n  })\n  const updateGroups = React.useCallback(\n    (updater: StateUpdaterFunction) => {\n      const newGroups = updater(groups)\n      setGroups(newGroups)\n      storage.set(STORAGE_KEYS.BOOKMARKS, newGroups)\n    },\n    [groups],\n  )\n  const append = React.useCallback(\n    (groupName: GroupName, s3File: S3HandleBase | S3HandleBase[]) => {\n      updateGroups(createAppendUpdater(groupName, s3File))\n      if (!isOpened) setUpdates(true)\n    },\n    [isOpened, updateGroups],\n  )\n  const remove = React.useCallback(\n    (groupName: GroupName, s3File: S3HandleBase) => {\n      const isLastBookmark =\n        R.pipe(R.path([groupName, 'entries']), R.keys, R.length)(groups) === 1\n      updateGroups(createRemoveUpdater(groupName, s3File))\n      if (isLastBookmark) {\n        setUpdates(false)\n      } else if (!isOpened) {\n        setUpdates(true)\n      }\n    },\n    [groups, isOpened, updateGroups],\n  )\n  const clear = React.useCallback(\n    (groupName: GroupName) => {\n      updateGroups(createClearUpdater(groupName))\n      setUpdates(false)\n    },\n    [updateGroups],\n  )\n  const isBookmarked = React.useCallback(\n    (groupName: GroupName, s3File: S3HandleBase) =>\n      R.hasPath([groupName, 'entries', keyResolver(s3File)], groups),\n    [groups],\n  )\n  const toggle = React.useCallback(\n    (groupName: GroupName, s3File: S3HandleBase) =>\n      isBookmarked(groupName, s3File)\n        ? remove(groupName, s3File)\n        : append(groupName, s3File),\n    [isBookmarked, remove, append],\n  )\n  const hide = React.useCallback(() => {\n    setOpened(false)\n    setUpdates(false)\n  }, [])\n\n  const value = React.useMemo(\n    () => ({\n      append,\n      clear,\n      groups,\n      hasUpdates,\n      hide,\n      isBookmarked,\n      isOpened,\n      remove,\n      show: () => setOpened(true),\n      toggle,\n    }),\n    [append, clear, groups, hasUpdates, hide, isBookmarked, isOpened, remove, toggle],\n  )\n\n  return <Ctx.Provider value={value}>{children}</Ctx.Provider>\n}\n\nexport const useBookmarks = () => React.useContext(Ctx)\n\nexport const use = useBookmarks\n","import path from 'path'\n\nimport type { S3 } from 'aws-sdk'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\nimport * as Lab from '@material-ui/lab'\n\nimport * as style from 'constants/style'\nimport * as AddToPackage from 'containers/AddToPackage'\nimport { usePackageCreationDialog } from 'containers/Bucket/PackageDialog/PackageCreationForm'\nimport {\n  useBucketListing,\n  BucketListingResult,\n} from 'containers/Bucket/requests/bucketListing'\nimport type * as Model from 'model'\nimport * as AWS from 'utils/AWS'\nimport * as NamedRoutes from 'utils/NamedRoutes'\nimport StyledLink from 'utils/StyledLink'\nimport * as s3paths from 'utils/s3paths'\nimport { trimCenter } from 'utils/string'\n\nimport { useBookmarks } from './Provider'\n\nconst useBookmarksItemStyles = M.makeStyles((t) => ({\n  iconWrapper: {\n    minWidth: t.spacing(4),\n  },\n}))\n\ninterface BookmarkItemProps {\n  handle: s3paths.S3HandleBase\n  onRemove: () => void\n}\n\nfunction BookmarkItem({ handle, onRemove }: BookmarkItemProps) {\n  const classes = useBookmarksItemStyles()\n  const { urls } = NamedRoutes.use()\n  const to = urls.bucketFile(handle.bucket, handle.key)\n  const title = `s3://${handle.bucket}/${handle.key}`\n  return (\n    <M.ListItem>\n      <M.ListItemIcon className={classes.iconWrapper}>\n        <M.Icon fontSize=\"small\">\n          {s3paths.isDir(handle.key) ? 'folder_open' : 'insert_drive_file'}\n        </M.Icon>\n      </M.ListItemIcon>\n      <M.ListItemText>\n        <StyledLink to={to}>{trimCenter(title, 66)}</StyledLink>\n      </M.ListItemText>\n      <M.ListItemSecondaryAction>\n        <M.IconButton size=\"small\" edge=\"end\" onClick={onRemove}>\n          <M.Icon fontSize=\"inherit\">clear</M.Icon>\n        </M.IconButton>\n      </M.ListItemSecondaryAction>\n    </M.ListItem>\n  )\n}\n\nconst useNoBookmarksStyles = M.makeStyles((t) => ({\n  root: {\n    padding: t.spacing(2, 3),\n  },\n  desc: {\n    marginTop: t.spacing(1),\n  },\n}))\n\nfunction NoBookmarks() {\n  const classes = useNoBookmarksStyles()\n  return (\n    <div className={classes.root}>\n      <M.Typography variant=\"h5\">No bookmarks selected</M.Typography>\n      <M.Typography className={classes.desc}>\n        For topping up bookmarks you can navigate to \"Bucket\" tab, select files or\n        directories and click \"Add to bookmarks\"\n      </M.Typography>\n    </div>\n  )\n}\n\n// TODO: add entry with size from <Listing /> but try to re-use existing types\nfunction useHeadFile() {\n  const s3: S3 = AWS.S3.use()\n  return React.useCallback(\n    async ({ bucket, key, version }: s3paths.S3HandleBase): Promise<Model.S3File> => {\n      const { ContentLength: size } = await s3\n        .headObject({ Bucket: bucket, Key: key, VersionId: version })\n        .promise()\n      return { bucket, key, size: size || 0, version }\n    },\n    [s3],\n  )\n}\n\nfunction isBucketListingResult(\n  r: BucketListingResult | Model.S3File,\n): r is BucketListingResult {\n  return !!(r as BucketListingResult).files\n}\n\nfunction useHandlesToS3Files(\n  bucketListing: (r: $TSFixMe) => Promise<BucketListingResult>,\n  headFile: (h: s3paths.S3HandleBase) => Promise<Model.S3File>,\n) {\n  return React.useCallback(\n    async (handles: s3paths.S3HandleBase[]) => {\n      const requests = handles.map((handle) =>\n        s3paths.isDir(handle.key)\n          ? bucketListing({\n              bucket: handle.bucket,\n              path: s3paths.ensureNoSlash(handle.key),\n              delimiter: false,\n              drain: true,\n            })\n          : headFile(handle),\n      )\n      const responses = await Promise.all(requests)\n      return responses.reduce(\n        (memo, response) =>\n          isBucketListingResult(response)\n            ? response.files.reduce(\n                (acc, file) => ({\n                  ...acc,\n                  [path.relative(path.join(response.path, '..'), file.key)]: file,\n                }),\n                memo,\n              )\n            : {\n                ...memo,\n                // TODO: handle the same key from another bucket\n                [path.basename(response.key)]: response,\n              },\n        {} as Record<string, Model.S3File>,\n      )\n    },\n    [bucketListing, headFile],\n  )\n}\n\nconst useDrawerStyles = M.makeStyles((t) => ({\n  root: {\n    maxWidth: '60vw',\n    padding: t.spacing(4),\n  },\n  actions: {\n    margin: t.spacing(3, 0, 0),\n  },\n  button: {\n    '& + &': {\n      marginLeft: t.spacing(1),\n    },\n  },\n  error: {\n    margin: t.spacing(1, 0, 2),\n  },\n  listWrapper: {\n    margin: t.spacing(2, 0, 0),\n    maxHeight: '80vh',\n    overflowY: 'auto',\n  },\n}))\n\ninterface DrawerProps {\n  error: Error | null\n  handles: s3paths.S3HandleBase[]\n  loading: boolean\n  onClose?: () => void\n  onPackage?: () => void\n  open?: boolean\n  onRemove: (handle: s3paths.S3HandleBase) => void\n  onClear: () => void\n}\n\nfunction Drawer({\n  error,\n  handles,\n  loading,\n  onClear,\n  onClose,\n  onPackage,\n  onRemove,\n  open,\n}: DrawerProps) {\n  const classes = useDrawerStyles()\n  return (\n    <M.Drawer anchor=\"left\" open={open} onClose={onClose}>\n      <div className={classes.root}>\n        <M.Typography variant=\"h4\">Bookmarks</M.Typography>\n        <M.Paper className={classes.listWrapper}>\n          {handles.length ? (\n            <M.List dense>\n              {handles.map((handle) => (\n                <BookmarkItem handle={handle} onRemove={() => onRemove(handle)} />\n              ))}\n            </M.List>\n          ) : (\n            <NoBookmarks />\n          )}\n        </M.Paper>\n        {error && (\n          <Lab.Alert className={classes.error} severity=\"error\">\n            <Lab.AlertTitle>{error.name}</Lab.AlertTitle>\n            {error.message}\n          </Lab.Alert>\n        )}\n        <div className={classes.actions}>\n          <M.Button\n            className={classes.button}\n            color=\"primary\"\n            disabled={loading || !handles.length}\n            onClick={onClear}\n            variant=\"outlined\"\n          >\n            Clear bookmarks\n          </M.Button>\n          <M.Button\n            className={classes.button}\n            color=\"primary\"\n            disabled={loading || !handles.length || !onPackage}\n            onClick={onPackage}\n            startIcon={loading && <M.CircularProgress size={16} />}\n            variant=\"contained\"\n          >\n            Create package\n          </M.Button>\n        </div>\n      </div>\n    </M.Drawer>\n  )\n}\n\ninterface SidebarProps {\n  bucket?: string\n}\n\nexport default function Sidebar({ bucket = '' }: SidebarProps) {\n  const bookmarks = useBookmarks()\n  const addToPackage = AddToPackage.use()\n  const entries = bookmarks?.groups.main.entries\n  const handles: s3paths.S3HandleBase[] = React.useMemo(\n    () => (entries ? Object.values(entries) : []),\n    [entries],\n  )\n  const [error, setError] = React.useState<Error | null>(null)\n  const [traversing, setTraversing] = React.useState(false)\n  const bucketListing = useBucketListing()\n  const headFile = useHeadFile()\n  const handlesToS3Files = useHandlesToS3Files(bucketListing, headFile)\n  const createDialog = usePackageCreationDialog({\n    bucket,\n    delayHashing: true,\n    disableStateDisplay: true,\n  })\n  const handleRemove = React.useCallback(\n    (handle: s3paths.S3HandleBase) => {\n      const isLastBookmark = handles.length === 1\n      bookmarks?.remove('main', handle)\n      if (isLastBookmark) bookmarks?.hide()\n    },\n    [bookmarks, handles],\n  )\n  const handleClear = React.useCallback(() => {\n    bookmarks?.clear('main')\n    bookmarks?.hide()\n  }, [bookmarks])\n  const handleSubmit = React.useCallback(async () => {\n    if (!addToPackage) throw new Error('Add to Package is not ready')\n    setTraversing(true)\n    try {\n      const files = await handlesToS3Files(handles)\n      addToPackage?.merge(files)\n      setTraversing(false)\n      createDialog.open()\n      bookmarks?.hide()\n    } catch (e) {\n      if (e instanceof Error) {\n        setTraversing(false)\n        setError(e)\n      } else {\n        throw e\n      }\n    }\n  }, [addToPackage, bookmarks, createDialog, handlesToS3Files, handles])\n  return (\n    <M.MuiThemeProvider theme={style.appTheme}>\n      <Drawer\n        error={error}\n        handles={handles}\n        loading={traversing}\n        onClose={bookmarks?.hide}\n        onPackage={bucket ? handleSubmit : undefined}\n        onRemove={handleRemove}\n        onClear={handleClear}\n        open={bookmarks?.isOpened}\n      />\n      {createDialog.render({\n        successTitle: 'Package created',\n        successRenderMessage: ({ packageLink }) => (\n          <>Package {packageLink} successfully created</>\n        ),\n        title: 'Create package',\n      })}\n    </M.MuiThemeProvider>\n  )\n}\n","import * as React from 'react'\n\nimport * as Config from 'utils/Config'\nimport mkStorage from 'utils/storage'\n\nimport * as FileView from './FileView'\n\ninterface DownloadButtonProps {\n  className: string\n  label?: string\n  onClick: () => void\n  path?: string\n}\n\nexport function DownloadButton({ className, label, onClick, path }: DownloadButtonProps) {\n  const { desktop, noDownload }: { desktop: boolean; noDownload: boolean } = Config.use()\n\n  if (noDownload) return null\n\n  if (desktop) {\n    return (\n      <FileView.AdaptiveButtonLayout\n        className={className}\n        label={label}\n        icon=\"archive\"\n        type=\"submit\"\n        onClick={onClick}\n      />\n    )\n  }\n\n  return <FileView.ZipDownloadForm className={className} label={label} suffix={path} />\n}\n\nconst STORAGE_KEYS = {\n  LOCAL_FOLDER: 'LOCAL_FOLDER',\n}\nconst storage = mkStorage({\n  [STORAGE_KEYS.LOCAL_FOLDER]: STORAGE_KEYS.LOCAL_FOLDER,\n})\n\nexport function useLocalFolder(): [string, (v: string) => void] {\n  const [value, setValue] = React.useState(() => {\n    try {\n      return storage.get(STORAGE_KEYS.LOCAL_FOLDER) || ''\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(error)\n      return ''\n    }\n  })\n  const onChange = React.useCallback(\n    (path) => {\n      storage.set(STORAGE_KEYS.LOCAL_FOLDER, path)\n      setValue(path)\n    },\n    [setValue],\n  )\n  return React.useMemo(() => [value, onChange], [value, onChange])\n}\n","import cx from 'classnames'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport AutosizeInput from 'react-input-autosize'\nimport type { AutosizeInputProps } from 'react-input-autosize'\nimport { Link } from 'react-router-dom'\nimport * as M from '@material-ui/core'\nimport { fade } from '@material-ui/core/styles'\n\nimport * as DG from 'components/DataGrid'\nimport { renderPageRange } from 'components/Pagination2'\nimport type { S3HandleBase } from 'utils/s3paths'\nimport { readableBytes } from 'utils/string'\nimport usePrevious from 'utils/usePrevious'\n\nconst EMPTY = <i>{'<EMPTY>'}</i>\n\nconst TIP_DELAY = 1000\n\nconst TOOLBAR_INNER_HEIGHT = 28\n\nexport interface Item {\n  type: 'dir' | 'file'\n  name: string\n  to: string\n  size?: number\n  modified?: Date\n  archived?: boolean\n  handle?: S3HandleBase\n}\n\nfunction maxPartial<T extends R.Ord>(a: T | undefined, b: T | undefined) {\n  if (a) return b ? R.max(a, b) : a\n  return b\n}\n\nconst computeStats = R.reduce(\n  (acc, i: Item) => ({\n    files: i.type === 'file' ? acc.files + 1 : acc.files,\n    dirs: i.type === 'dir' && i.name !== '..' ? acc.dirs + 1 : acc.dirs,\n    size: i.size ? acc.size + i.size : acc.size,\n    modified: maxPartial(i.modified, acc.modified),\n  }),\n  {\n    dirs: 0,\n    files: 0,\n    size: 0,\n    modified: undefined as Date | undefined,\n  },\n)\n\ninterface WrappedAutosizeInputProps extends Omit<AutosizeInputProps, 'ref'> {\n  className?: string\n}\n\nfunction WrappedAutosizeInput({ className, ...props }: WrappedAutosizeInputProps) {\n  return <AutosizeInput inputClassName={className} {...props} />\n}\n\nconst usePrefixFilterStyles = M.makeStyles((t) => ({\n  root: {\n    height: TOOLBAR_INNER_HEIGHT,\n    position: 'relative',\n    zIndex: 1, // to be rendered above the lock\n  },\n  input: {\n    fontSize: 14,\n    height: 20,\n    lineHeight: '20px',\n    padding: 0,\n  },\n  btn: {\n    fontSize: 11,\n    lineHeight: '22px',\n    marginLeft: t.spacing(0.75),\n    minWidth: 'auto',\n    paddingBottom: 0,\n    paddingTop: 2,\n  },\n  clearIcon: {\n    fontSize: '16px !important',\n    lineHeight: '15px',\n    marginLeft: -6,\n  },\n  searchIcon: {\n    fontSize: 20,\n    marginLeft: -2,\n    marginRight: t.spacing(0.5) - 2,\n  },\n}))\n\ninterface PrefixFilterProps {\n  prefix?: string\n  setPrefix: (prefix: string) => void\n}\n\nexport function PrefixFilter({ prefix = '', setPrefix }: PrefixFilterProps) {\n  const classes = usePrefixFilterStyles()\n\n  const inputRef = React.useRef<{ blur: () => void }>()\n  const [prefixValue, setPrefixValue] = React.useState(prefix)\n\n  const blur = React.useCallback(() => {\n    inputRef.current?.blur?.()\n  }, [inputRef])\n\n  const apply = React.useCallback(() => {\n    if (prefix === prefixValue) return\n    setPrefix(prefixValue)\n  }, [prefix, prefixValue, setPrefix])\n\n  const clear = React.useCallback(() => {\n    if (prefixValue) setPrefixValue('')\n    if (prefix) setPrefix('')\n  }, [prefix, prefixValue, setPrefix, setPrefixValue])\n\n  const handleKeyDown = React.useCallback(\n    (e) => {\n      if (e.key === 'Escape') {\n        clear()\n        blur()\n      } else if (e.key === 'Enter') {\n        apply()\n        blur()\n      }\n    },\n    [blur, apply, clear],\n  )\n\n  const handleChange = React.useCallback(\n    (e) => {\n      setPrefixValue(e.target.value)\n    },\n    [setPrefixValue],\n  )\n  return (\n    <M.InputBase\n      value={prefixValue}\n      onChange={handleChange}\n      onKeyDown={handleKeyDown}\n      placeholder=\"Filter current directory by prefix\"\n      classes={{ root: classes.root, input: classes.input }}\n      inputComponent={WrappedAutosizeInput}\n      inputRef={inputRef}\n      startAdornment={<M.Icon className={classes.searchIcon}>search</M.Icon>}\n      endAdornment={\n        <>\n          <M.Button\n            className={classes.btn}\n            size=\"small\"\n            variant=\"contained\"\n            color=\"primary\"\n            onClick={apply}\n          >\n            Filter\n          </M.Button>\n          {(!!prefixValue || !!prefix) && (\n            <M.Button\n              className={classes.btn}\n              size=\"small\"\n              variant=\"text\"\n              color=\"primary\"\n              onClick={clear}\n              endIcon={<M.Icon className={classes.clearIcon}>clear</M.Icon>}\n            >\n              Clear\n            </M.Button>\n          )}\n        </>\n      }\n    />\n  )\n}\n\nconst optionsSelector = (state: DG.GridState) => state.options\n\nconst usePaginationStyles = M.makeStyles((t) => ({\n  root: {\n    alignItems: 'center',\n    display: 'flex',\n    flexGrow: 1,\n    height: TOOLBAR_INNER_HEIGHT,\n  },\n  select: {\n    alignItems: 'center',\n    display: 'flex',\n    height: 24,\n    paddingBottom: 0,\n    paddingLeft: t.spacing(0.5),\n    paddingTop: 0,\n  },\n  input: {\n    fontSize: 'inherit',\n    marginRight: t.spacing(0.5),\n\n    [t.breakpoints.down('xs')]: {\n      display: 'none',\n    },\n  },\n  button: {\n    color: t.palette.action.active,\n    minWidth: 'auto',\n    paddingBottom: 1,\n    paddingTop: 1,\n  },\n  current: {\n    color: t.palette.text.primary,\n    fontWeight: t.typography.fontWeightBold,\n  },\n}))\n\ninterface PaginationProps {\n  truncated?: boolean\n  loadMore?: () => void\n}\n\nfunction Pagination({ truncated, loadMore }: PaginationProps) {\n  const classes = usePaginationStyles()\n\n  const apiRef = React.useContext(DG.GridApiContext)\n  const paginationState = DG.useGridSelector(apiRef, DG.gridPaginationSelector)\n  const options = DG.useGridSelector(apiRef, optionsSelector)\n\n  const page = paginationState.page + 1\n  const pages = Math.ceil(paginationState.rowCount / paginationState.pageSize)\n\n  const rowsPerPageOptions =\n    options.rowsPerPageOptions &&\n    options.rowsPerPageOptions.indexOf(paginationState.pageSize) > -1\n      ? options.rowsPerPageOptions\n      : []\n\n  const onPageSizeChange = React.useCallback(\n    (event: React.ChangeEvent<{ value: unknown }>) => {\n      const newPageSize = Number(event.target.value)\n      apiRef!.current!.setPageSize(newPageSize)\n      // TODO: go to new last page if old last page became out of bounds\n    },\n    [apiRef],\n  )\n\n  // MUI pages are 0-based\n  const setPage = (p: number) => apiRef!.current!.setPage(p - 1)\n\n  const renderPage = (p: number) => (\n    <M.Button\n      key={`page:${p}`}\n      size=\"small\"\n      className={cx(classes.button, page === p && classes.current)}\n      onClick={() => setPage(p)}\n    >\n      {p}\n    </M.Button>\n  )\n\n  const renderGap = (i: number) => (\n    <M.Button key={`gap:${i}`} size=\"small\" className={classes.button} disabled>\n      &hellip;\n    </M.Button>\n  )\n\n  if (!pages) return <M.Box flexGrow={1} />\n\n  return (\n    <div className={classes.root}>\n      <M.Box flexGrow={1} />\n      {rowsPerPageOptions.length > 1 && (\n        <M.Select\n          classes={{ select: classes.select }}\n          input={<M.InputBase className={classes.input} />}\n          value={paginationState.pageSize}\n          onChange={onPageSizeChange}\n        >\n          {rowsPerPageOptions.map((option) => (\n            <M.MenuItem key={option} value={option}>\n              {option} per page\n            </M.MenuItem>\n          ))}\n        </M.Select>\n      )}\n      <M.IconButton size=\"small\" disabled={page === 1} onClick={() => setPage(page - 1)}>\n        <M.Icon fontSize=\"small\">chevron_left</M.Icon>\n      </M.IconButton>\n      {renderPageRange({ page, pages, renderPage, renderGap, max: 10 })}\n      {truncated && !!loadMore && (\n        <M.Button\n          size=\"small\"\n          className={classes.button}\n          onClick={loadMore}\n          title=\"Load more\"\n        >\n          &hellip;\n        </M.Button>\n      )}\n      <M.IconButton\n        size=\"small\"\n        disabled={page === pages}\n        onClick={() => setPage(page + 1)}\n      >\n        <M.Icon fontSize=\"small\">chevron_right</M.Icon>\n      </M.IconButton>\n    </div>\n  )\n}\n\nfunction ActiveFilters() {\n  const apiRef = React.useContext(DG.GridApiContext)\n  const activeFilters = DG.useGridSelector(apiRef, DG.activeGridFilterItemsSelector)\n  const lookup = DG.useGridSelector(apiRef, DG.gridColumnLookupSelector)\n  const counter = DG.useGridSelector(apiRef, DG.filterGridItemsCounterSelector)\n\n  return (\n    <>\n      {apiRef!.current.getLocaleText('toolbarFiltersTooltipActive')(counter)}\n      <ul>\n        {activeFilters.map((item) => ({\n          ...(lookup[item.columnField!] && (\n            <li key={item.id}>\n              {lookup[item.columnField!].headerName || item.columnField}{' '}\n              {item.operatorValue} {item.value}\n            </li>\n          )),\n        }))}\n      </ul>\n    </>\n  )\n}\n\nfunction FilterToolbarButton() {\n  const apiRef = React.useContext(DG.GridApiContext)\n  const counter = DG.useGridSelector(apiRef, DG.filterGridItemsCounterSelector)\n  const preferencePanel = DG.useGridSelector(apiRef, DG.gridPreferencePanelStateSelector)\n\n  const tooltipContentNode = React.useMemo(() => {\n    if (preferencePanel.open) {\n      return apiRef!.current.getLocaleText(\n        'toolbarFiltersTooltipHide',\n      ) as React.ReactElement\n    }\n    if (counter === 0) {\n      return apiRef!.current.getLocaleText(\n        'toolbarFiltersTooltipShow',\n      ) as React.ReactElement\n    }\n    return <ActiveFilters />\n  }, [apiRef, preferencePanel.open, counter])\n\n  const toggleFilter = React.useCallback(() => {\n    const { open, openedPanelValue } = preferencePanel\n    if (open && openedPanelValue === DG.GridPreferencePanelsValue.filters) {\n      apiRef!.current.hideFilterPanel()\n    } else {\n      apiRef!.current.showFilterPanel()\n    }\n  }, [apiRef, preferencePanel])\n\n  return (\n    <M.Tooltip title={tooltipContentNode} arrow enterDelay={TIP_DELAY}>\n      <M.IconButton\n        onClick={toggleFilter}\n        size=\"small\"\n        edge=\"end\"\n        color=\"primary\"\n        aria-label={apiRef!.current.getLocaleText('toolbarFiltersLabel')}\n      >\n        <M.Badge badgeContent={counter} color=\"secondary\" overlap=\"circle\" variant=\"dot\">\n          <M.Icon fontSize=\"small\">filter_list</M.Icon>\n        </M.Badge>\n      </M.IconButton>\n    </M.Tooltip>\n  )\n}\n\nconst useToolbarStyles = M.makeStyles((t) => ({\n  root: {\n    alignItems: 'center',\n    borderBottom: `1px solid ${t.palette.divider}`,\n    display: 'flex',\n    flexWrap: 'wrap',\n    padding: t.spacing(0.5, 1),\n    position: 'relative',\n  },\n  icon: {\n    fontSize: t.typography.body1.fontSize,\n    marginRight: t.spacing(0.5),\n  },\n  truncated: {\n    ...t.typography.body2,\n    alignItems: 'center',\n    color: t.palette.text.secondary,\n    display: 'flex',\n    height: TOOLBAR_INNER_HEIGHT,\n    marginLeft: t.spacing(1),\n  },\n  lock: {\n    background: fade(t.palette.background.paper, 0.5),\n    bottom: 0,\n    left: 0,\n    position: 'absolute',\n    right: 0,\n    top: 0,\n  },\n  loadMore: {\n    font: 'inherit',\n  },\n  progress: {\n    marginLeft: t.spacing(0.5),\n  },\n}))\n\ninterface ToolbarProps {\n  children?: React.ReactNode\n  truncated?: boolean\n  locked?: boolean\n  loadMore?: () => void\n  items: Item[]\n}\n\nfunction Toolbar({\n  truncated = false,\n  locked = false,\n  loadMore,\n  items,\n  children,\n}: ToolbarProps) {\n  const classes = useToolbarStyles()\n  return (\n    <div className={classes.root}>\n      {children}\n      {truncated && (\n        <div className={classes.truncated}>\n          <M.Icon className={classes.icon}>warning</M.Icon>\n          Showing first {items.length} objects\n          {!!loadMore && (\n            <>\n              <> &rarr;&nbsp;</>\n              <M.Link\n                onClick={loadMore}\n                className={classes.loadMore}\n                component=\"button\"\n                underline=\"always\"\n              >\n                load more\n              </M.Link>\n              {locked && <M.CircularProgress size={16} className={classes.progress} />}\n            </>\n          )}\n        </div>\n      )}\n      <Pagination truncated={truncated} loadMore={loadMore} />\n      <FilterToolbarButton />\n      {locked && <div className={classes.lock} />}\n    </div>\n  )\n}\n\nconst usePanelStyles = M.makeStyles((t) => ({\n  root: {\n    zIndex: 2,\n    '& select, & input': {\n      boxSizing: 'content-box',\n    },\n  },\n  paper: {\n    backgroundColor: t.palette.background.paper,\n    minWidth: 300,\n    maxHeight: 450,\n    display: 'flex',\n  },\n}))\n\nfunction Panel({ children, open }: DG.GridPanelProps) {\n  const classes = usePanelStyles()\n  const apiRef = React.useContext(DG.GridApiContext)\n\n  const getPopperModifiers = () => ({ flip: { enabled: false } })\n\n  const handleClickAway = React.useCallback(() => {\n    apiRef!.current.hidePreferences()\n  }, [apiRef])\n\n  const handleKeyDown = React.useCallback(\n    (event) => {\n      if (event.key === 'Escape') {\n        apiRef!.current.hidePreferences()\n      }\n    },\n    [apiRef],\n  )\n\n  const anchorEl = apiRef?.current?.columnHeadersElementRef?.current\n\n  if (!anchorEl) return null\n\n  return (\n    <M.Popper\n      placement=\"bottom-end\"\n      open={open}\n      anchorEl={anchorEl}\n      modifiers={getPopperModifiers()}\n      className={classes.root}\n      disablePortal\n    >\n      <M.ClickAwayListener onClickAway={handleClickAway}>\n        <M.Paper className={classes.paper} elevation={8} onKeyDown={handleKeyDown}>\n          {children}\n        </M.Paper>\n      </M.ClickAwayListener>\n    </M.Popper>\n  )\n}\n\nfunction ColumnMenu({\n  hideMenu,\n  currentColumn,\n  open,\n  id,\n  labelledby,\n}: DG.GridColumnMenuProps) {\n  const handleListKeyDown = React.useCallback(\n    (event: React.KeyboardEvent) => {\n      if (event.key === 'Tab') event.preventDefault()\n      if (event.key === 'Tab' || event.key === 'Escape') hideMenu()\n    },\n    [hideMenu],\n  )\n  return (\n    <M.MenuList\n      id={id}\n      className=\"MuiDataGrid-gridMenuList\"\n      aria-labelledby={labelledby}\n      onKeyDown={handleListKeyDown}\n      autoFocus={open}\n    >\n      <DG.SortGridMenuItems onClick={hideMenu} column={currentColumn!} />\n      <DG.GridFilterMenuItem onClick={hideMenu} column={currentColumn!} />\n    </M.MenuList>\n  )\n}\n\nconst useFooterStyles = M.makeStyles((t) => ({\n  root: {\n    alignItems: 'center',\n    borderTop: `1px solid ${t.palette.divider}`,\n    color: t.palette.text.secondary,\n    display: 'flex',\n    height: 36,\n    position: 'relative',\n  },\n  lock: {\n    background: fade(t.palette.background.paper, 0.5),\n    bottom: 0,\n    left: 0,\n    position: 'absolute',\n    right: 0,\n    top: 0,\n  },\n  group: {\n    ...t.typography.body2,\n    alignItems: 'center',\n    display: 'flex',\n\n    '& + &': {\n      marginLeft: t.spacing(1.5),\n    },\n  },\n  icon: {\n    fontSize: t.typography.body1.fontSize,\n    marginRight: t.spacing(0.5),\n  },\n  loadMore: {\n    font: 'inherit',\n  },\n  progress: {\n    marginLeft: t.spacing(0.5),\n  },\n  truncationWarning: {\n    alignItems: 'inherit',\n    display: 'inherit',\n\n    [t.breakpoints.down('xs')]: {\n      display: 'none',\n    },\n  },\n  cellFirst: {\n    alignItems: 'center',\n    display: 'flex',\n    padding: t.spacing(0, 1),\n  },\n  spacer: {\n    flexGrow: 1,\n  },\n  cellSecond: {\n    paddingLeft: t.spacing(1),\n    paddingRight: t.spacing(1),\n    textAlign: 'right',\n  },\n  cellLast: {\n    overflow: 'hidden',\n    paddingLeft: t.spacing(1),\n    paddingRight: t.spacing(1),\n    textAlign: 'right',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    width: COL_MODIFIED_W,\n    [t.breakpoints.down('sm')]: {\n      width: COL_MODIFIED_W_SM,\n    },\n  },\n}))\n\ninterface FooterProps {\n  truncated?: boolean\n  locked?: boolean\n  loadMore?: () => void\n  items: Item[]\n}\n\nfunction Footer({ truncated = false, locked = false, loadMore, items }: FooterProps) {\n  const { state } = DG.useGridSlotComponentProps()\n  const classes = useFooterStyles()\n\n  const apiRef = React.useContext(DG.GridApiContext)\n  const filterCount = DG.useGridSelector(apiRef, DG.filterGridItemsCounterSelector)\n\n  const stats = React.useMemo(() => computeStats(items), [items])\n\n  const filteredStats = React.useMemo(() => {\n    if (!filterCount) return undefined\n    const visibleItems = (state.visibleRows.visibleRows || []).map(\n      (id) => state.rows.idRowsLookup[id],\n    ) as unknown as Item[]\n    return computeStats(visibleItems)\n  }, [filterCount, state.visibleRows.visibleRows, state.rows.idRowsLookup])\n\n  const modified = filteredStats ? filteredStats.modified : stats.modified\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.cellFirst}>\n        <M.Tooltip title=\"Directories\" arrow enterDelay={TIP_DELAY}>\n          <div className={classes.group}>\n            <M.Icon className={classes.icon}>folder_open</M.Icon>\n            {filteredStats && <>{filteredStats.dirs} / </>}\n            {stats.dirs}\n            {truncated && '+'}\n          </div>\n        </M.Tooltip>\n\n        <M.Tooltip title=\"Files\" arrow enterDelay={TIP_DELAY}>\n          <div className={classes.group}>\n            <M.Icon className={classes.icon}>insert_drive_file</M.Icon>\n            {filteredStats && <>{filteredStats.files} / </>}\n            {stats.files}\n            {truncated && '+'}\n          </div>\n        </M.Tooltip>\n\n        {!!filterCount && (\n          <M.Tooltip title={<ActiveFilters />} arrow enterDelay={TIP_DELAY}>\n            <div className={classes.group}>\n              <M.Icon className={classes.icon}>filter_list</M.Icon>\n              {filterCount}\n            </div>\n          </M.Tooltip>\n        )}\n\n        {truncated && (\n          // TODO: show tooltip with detailed description?\n          <div className={classes.group}>\n            <M.Icon className={classes.icon}>warning</M.Icon>\n            <span className={classes.truncationWarning}>\n              Showing first {items.length} objects\n              {!!loadMore && (\n                <>\n                  <> &rarr;&nbsp;</>\n                  <M.Link\n                    onClick={loadMore}\n                    className={classes.loadMore}\n                    component=\"button\"\n                    underline=\"always\"\n                  >\n                    load more\n                  </M.Link>\n                  {locked && (\n                    <M.CircularProgress size={16} className={classes.progress} />\n                  )}\n                </>\n              )}\n            </span>\n          </div>\n        )}\n      </div>\n      <div className={classes.spacer} />\n      <div className={classes.cellSecond}>\n        {filteredStats && <>{readableBytes(filteredStats.size)} / </>}\n        {readableBytes(stats.size, truncated ? '+' : '')}\n      </div>\n      <div className={classes.cellLast}>\n        {modified && `${truncated ? '~' : ''}${modified.toLocaleString()}`}\n      </div>\n      {locked && <div className={classes.lock} />}\n    </div>\n  )\n}\n\nfunction FilteredOverlay() {\n  return (\n    <DG.GridOverlay>\n      <M.Tooltip title={<ActiveFilters />} arrow enterDelay={TIP_DELAY}>\n        <span>No files / directories satisfying active filters</span>\n      </M.Tooltip>\n    </DG.GridOverlay>\n  )\n}\n\nexport type CellProps = React.PropsWithChildren<{\n  item: Item\n  title?: string\n  className?: string\n}>\n\nfunction Cell({ item, ...props }: CellProps) {\n  return <Link to={item.to} {...props} />\n}\n\nfunction compareBy<T, V extends R.Ord>(a: T, b: T, getValue: (arg: T) => V) {\n  const va = getValue(a)\n  const vb = getValue(b)\n  // eslint-disable-next-line no-nested-ternary\n  return va < vb ? -1 : va > vb ? 1 : 0\n}\n\n// workaround to always have folders at the top and .. at the very top\n// example when sorting in ascending order:\n// 0 (dir \"..\")\n// 1:dirA (dir \"dirA\")\n// 1:dirB (dir \"dirB\")\n// 2:fileA (file \"fileA\")\n// 2:fileB (file \"fileB\")\nconst getNameSortValueAsc = (row: DG.GridRowModel) => {\n  const i = row as unknown as Item\n  if (i.type === 'dir' && i.name === '..') return '0'\n  return `${i.type === 'dir' ? 1 : 2}:${i.name}`\n}\n\n// example when sorting in descending order:\n// 2 (dir \"..\")\n// 1:dirB (dir \"dirB\")\n// 1:dirA (dir \"dirA\")\n// 0:fileB (file \"fileB\")\n// 0:fileA (file \"fileA\")\nconst getNameSortValueDesc = (row: DG.GridRowModel) => {\n  const i = row as unknown as Item\n  if (i.type === 'dir' && i.name === '..') return '2'\n  return `${i.type === 'dir' ? 1 : 0}:${i.name}`\n}\n\nconst localeText = {\n  columnMenuSortAsc: 'Sort ascending',\n  columnMenuSortDesc: 'Sort descending',\n}\n\nconst COL_SIZE_W = 114\nconst COL_SIZE_W_SM = COL_SIZE_W / 1.3\nconst COL_MODIFIED_W = 176\nconst COL_MODIFIED_W_SM = COL_MODIFIED_W / 1.2\n\nconst useStyles = M.makeStyles((t) => ({\n  '@global': {\n    '.MuiDataGridMenu-root': {\n      zIndex: t.zIndex.modal + 1, // show it over modals\n    },\n  },\n  root: {\n    position: 'relative',\n    zIndex: 1, // to prevent receiveing shadow from footer\n    [t.breakpoints.down('xs')]: {\n      borderRadius: 0,\n    },\n  },\n  grid: {\n    border: 'none',\n\n    '& .MuiDataGrid-overlay': {\n      background: fade(t.palette.background.paper, 0.5),\n      zIndex: 1,\n    },\n    '& .MuiDataGrid-checkboxInput': {\n      padding: 7,\n      '& svg': {\n        fontSize: 18,\n      },\n    },\n    '& .MuiDataGrid-cell': {\n      border: 'none',\n      outline: 'none !important',\n      padding: 0,\n    },\n    '& .MuiDataGrid-colCell': {\n      padding: t.spacing(0, 1),\n      '& .MuiDataGrid-colCellTitleContainer': {\n        flex: 'none',\n      },\n      '& .MuiDataGrid-menuIcon': {\n        margin: 0,\n      },\n      '& .MuiDataGrid-iconButtonContainer': {\n        padding: 0,\n        '& > div': {\n          alignItems: 'center',\n          display: 'flex',\n          height: '100%',\n        },\n      },\n      '& .MuiDataGrid-sortIcon': {\n        fontSize: 20,\n      },\n      '& .MuiDataGrid-columnSeparator': {\n        pointerEvents: 'none',\n      },\n      // \"Size\" column\n      '&:nth-child(3)': {\n        justifyContent: 'flex-end',\n      },\n      // \"Last modified\" column\n      '&:nth-child(4)': {\n        justifyContent: 'flex-end',\n        '& .MuiDataGrid-colCellTitleContainer': {\n          order: 1,\n        },\n        '& .MuiDataGrid-colCellTitle': {\n          order: 1,\n        },\n        '& .MuiDataGrid-columnSeparator': {\n          display: 'none',\n        },\n      },\n    },\n  },\n  locked: {\n    '& .MuiDataGrid-columnsContainer': {\n      position: 'absolute',\n\n      '&::after': {\n        background: fade(t.palette.background.paper, 0.5),\n        bottom: 0,\n        content: '\"\"',\n        left: 0,\n        position: 'absolute',\n        right: 0,\n        top: 0,\n      },\n    },\n  },\n  link: {\n    padding: t.spacing(0, 1),\n    width: '100%',\n  },\n  linkFlex: {\n    alignItems: 'center',\n    display: 'flex',\n  },\n  ellipsis: {\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n  },\n  icon: {\n    fontSize: t.typography.body1.fontSize,\n    marginRight: t.spacing(0.5),\n  },\n  archived: {\n    opacity: 0.5,\n  },\n}))\n\ninterface ListingProps {\n  items: Item[]\n  truncated?: boolean\n  locked?: boolean\n  prefixFilter?: string\n  toolbarContents?: React.ReactNode\n  loadMore?: () => void\n  selection?: DG.GridRowId[]\n  onSelectionChange?: (newSelection: DG.GridRowId[]) => void\n  CellComponent?: React.ComponentType<CellProps>\n  RootComponent?: React.ElementType<{ className: string }>\n  className?: string\n  dataGridProps?: Partial<DG.DataGridProps>\n}\n\nexport function Listing({\n  items,\n  truncated = false,\n  locked = false,\n  toolbarContents,\n  prefixFilter,\n  loadMore,\n  selection,\n  onSelectionChange,\n  CellComponent = Cell,\n  RootComponent = M.Paper,\n  className,\n  dataGridProps,\n}: ListingProps) {\n  const classes = useStyles()\n  const t = M.useTheme()\n  const sm = M.useMediaQuery(t.breakpoints.down('sm'))\n\n  const [filteredToZero, setFilteredToZero] = React.useState(false)\n\n  const handleFilterModelChange = React.useCallback(\n    (params: DG.GridFilterModelParams) => {\n      setFilteredToZero(!!params.rows.size && !params.visibleRows.size)\n    },\n    [setFilteredToZero],\n  )\n\n  const [page, setPage] = React.useState(0)\n  const [pageSize, setPageSize] = React.useState(25)\n\n  const handlePageChange = React.useCallback(\n    ({ page: newPage }: DG.GridPageChangeParams) => {\n      setPage(newPage)\n    },\n    [],\n  )\n\n  const handlePageSizeChange = React.useCallback(\n    ({ pageSize: newPageSize }: DG.GridPageChangeParams) => {\n      setPageSize(newPageSize)\n    },\n    [],\n  )\n\n  usePrevious(items, (prevItems?: Item[]) => {\n    if (!prevItems) return\n    const itemsOnPrevPages = page * pageSize\n    // reset page if items on previous pages change\n    if (!R.equals(R.take(itemsOnPrevPages, items), R.take(itemsOnPrevPages, prevItems))) {\n      setPage(0)\n    }\n  })\n\n  // NOTE: after dependencies change fourth empty column appears\n  const columns: DG.GridColumns = React.useMemo(\n    () => [\n      {\n        field: 'name',\n        headerName: 'Name',\n        type: 'string',\n        width: 80,\n        flex: 1,\n        sortComparator: (\n          _v1: unknown,\n          _v2: unknown,\n          p1: DG.GridSortCellParams,\n          p2: DG.GridSortCellParams,\n        ) => {\n          // we only support one-column sorting, so assuming the first sortItem is the one we need\n          const [{ sort }] = (p1.api as DG.GridApi).state.sorting.sortModel\n          return compareBy(\n            p1.row,\n            p2.row,\n            sort === 'desc' ? getNameSortValueDesc : getNameSortValueAsc,\n          )\n        },\n        renderCell: (params: DG.GridCellParams) => {\n          const i = params.row as unknown as Item\n          return (\n            <CellComponent\n              item={i}\n              title={i.archived ? 'Object archived' : undefined}\n              className={cx(\n                classes.link,\n                classes.linkFlex,\n                i.archived && classes.archived,\n              )}\n            >\n              <M.Icon className={classes.icon}>\n                {i.type === 'file' ? 'insert_drive_file' : 'folder_open'}\n              </M.Icon>\n              <span className={classes.ellipsis}>{i.name || EMPTY}</span>\n            </CellComponent>\n          )\n        },\n      },\n      // TODO: uncomment this after implementing custom filter operators\n      // {\n      //   field: 'type',\n      //   headerName: 'Type',\n      //   type: 'string',\n      //   hide: true,\n      //   // TODO: custom filter operators\n      //   // filterOperators: GridFilterOperator[]\n      // },\n      {\n        field: 'size',\n        headerName: 'Size',\n        type: 'number',\n        width: sm ? COL_SIZE_W_SM : COL_SIZE_W,\n        renderCell: (params: DG.GridCellParams) => {\n          const i = params.row as unknown as Item\n          return (\n            <CellComponent\n              item={i}\n              className={cx(classes.link, i.archived && classes.archived)}\n              title={i.archived ? 'Object archived' : undefined}\n            >\n              {i.size == null ? <>&nbsp;</> : readableBytes(i.size)}\n            </CellComponent>\n          )\n        },\n      },\n      {\n        field: 'modified',\n        headerName: 'Last modified',\n        type: 'dateTime',\n        align: 'right',\n        width: sm ? COL_MODIFIED_W_SM : COL_MODIFIED_W,\n        renderCell: (params: DG.GridCellParams) => {\n          const i = params.row as unknown as Item\n          return (\n            <CellComponent\n              item={i}\n              className={cx(\n                classes.link,\n                i.archived && classes.archived,\n                classes.ellipsis,\n              )}\n              title={i.archived ? 'Object archived' : undefined}\n            >\n              {i.modified == null ? <>&nbsp;</> : i.modified.toLocaleString()}\n            </CellComponent>\n          )\n        },\n      },\n    ],\n    [classes, CellComponent, sm],\n  )\n\n  const noRowsLabel = `No files / directories${\n    prefixFilter ? ` starting with \"${prefixFilter}\"` : ''\n  }`\n\n  // abuse loading overlay to show warning when all the items are filtered-out\n  const LoadingOverlay = !locked && filteredToZero ? FilteredOverlay : undefined\n\n  const handleSelectionModelChange = React.useCallback(\n    (newSelection: DG.GridSelectionModelChangeParams) => {\n      if (onSelectionChange) onSelectionChange(newSelection.selectionModel)\n    },\n    [onSelectionChange],\n  )\n\n  // TODO: control page, pageSize, filtering and sorting via props\n  return (\n    <RootComponent className={cx(classes.root, className)}>\n      <DG.DataGrid\n        onFilterModelChange={handleFilterModelChange}\n        className={cx(classes.grid, locked && classes.locked)}\n        rows={items}\n        columns={columns}\n        autoHeight\n        components={{ Toolbar, Footer, Panel, ColumnMenu, LoadingOverlay }}\n        componentsProps={{\n          toolbar: { truncated, locked, loadMore, items, children: toolbarContents },\n          footer: { truncated, locked, loadMore, items },\n        }}\n        getRowId={(row) => row.name.replaceAll(\"'\", \"\\\\'\")}\n        pagination\n        pageSize={pageSize}\n        onPageSizeChange={handlePageSizeChange}\n        page={page}\n        onPageChange={handlePageChange}\n        loading={locked || filteredToZero}\n        headerHeight={36}\n        rowHeight={36}\n        disableSelectionOnClick\n        disableColumnSelector\n        disableColumnResize\n        disableColumnReorder\n        disableMultipleSelection\n        disableMultipleColumnsSorting\n        localeText={{ noRowsLabel, ...localeText }}\n        // selection-related props\n        checkboxSelection={!!onSelectionChange}\n        selectionModel={selection}\n        onSelectionModelChange={handleSelectionModelChange}\n        {...dataGridProps}\n      />\n    </RootComponent>\n  )\n}\n\nexport default Listing\n","import * as R from 'ramda'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\nimport { fade } from '@material-ui/core/styles'\n\nimport StyledLink from 'utils/StyledLink'\nimport { docs } from 'constants/urls'\n\nimport WorkflowsConfigLink from '../WorkflowsConfigLink'\nimport * as ERRORS from '../errors'\n\nconst useStyles = M.makeStyles((t) => ({\n  content: {\n    paddingTop: 0,\n    position: 'relative',\n  },\n  overlay: {\n    background: fade(t.palette.common.white, 0.4),\n    bottom: 0,\n    display: 'flex',\n    flexDirection: 'column',\n    left: 0,\n    padding: t.spacing(2, 3, 4),\n    position: 'absolute',\n    right: 0,\n    top: 0,\n  },\n}))\n\nconst errorDisplay = R.cond([\n  [\n    R.is(ERRORS.WorkflowsConfigInvalid),\n    (e: ERRORS.WorkflowsConfigInvalid, bucket) => (\n      <>\n        <M.Typography variant=\"h6\" gutterBottom>\n          Invalid workflows config\n        </M.Typography>\n        <M.Typography gutterBottom>\n          Error: <code>{e.message}</code>\n        </M.Typography>\n        <M.Typography>\n          Please fix the{' '}\n          <WorkflowsConfigLink bucket={bucket}>workflows config</WorkflowsConfigLink>{' '}\n          according to{' '}\n          <StyledLink href={`${docs}/advanced/workflows`} target=\"_blank\">\n            the documentation\n          </StyledLink>\n          .\n        </M.Typography>\n      </>\n    ),\n  ],\n  [\n    R.is(ERRORS.ManifestTooLarge),\n    (e: ERRORS.ManifestTooLarge) => (\n      <>\n        <M.Typography variant=\"h6\" gutterBottom>\n          Package manifest too large\n        </M.Typography>\n        <M.Typography gutterBottom>\n          This package is not editable via the web UI&mdash;it cannot handle package\n          manifests with more than {e.max} entries.\n        </M.Typography>\n        <M.Typography>Please use Quilt CLI to edit this package.</M.Typography>\n      </>\n    ),\n  ],\n  [\n    R.T,\n    () => (\n      <>\n        <M.Typography variant=\"h6\" gutterBottom>\n          Unexpected error\n        </M.Typography>\n        <M.Typography gutterBottom>\n          Something went wrong. Please contact Quilt support.\n        </M.Typography>\n        <M.Typography>You can also use Quilt CLI to edit this package.</M.Typography>\n      </>\n    ),\n  ],\n])\n\ninterface DialogErrorProps {\n  bucket: string\n  cancelText?: React.ReactNode\n  error: any\n  onCancel: () => void\n  skeletonElement: React.ReactNode\n  submitText?: React.ReactNode\n  title: React.ReactNode\n}\n\nexport default function DialogError({\n  bucket,\n  cancelText,\n  error,\n  onCancel,\n  skeletonElement,\n  submitText,\n  title,\n}: DialogErrorProps) {\n  const classes = useStyles()\n  return (\n    <>\n      <M.DialogTitle>{title}</M.DialogTitle>\n      <M.DialogContent className={classes.content}>\n        {skeletonElement}\n        <div className={classes.overlay}>{errorDisplay(error, bucket)}</div>\n      </M.DialogContent>\n      <M.DialogActions>\n        <M.Button onClick={onCancel}>{cancelText || 'Cancel'}</M.Button>\n        <M.Button variant=\"contained\" color=\"primary\" disabled>\n          {submitText || 'Push'}\n        </M.Button>\n      </M.DialogActions>\n    </>\n  )\n}\n","import * as React from 'react'\nimport * as M from '@material-ui/core'\n\nconst useStyles = M.makeStyles({\n  content: {\n    paddingTop: 0,\n  },\n})\n\ninterface DialogLoadingProps {\n  cancelText?: React.ReactNode\n  onCancel: () => void\n  skeletonElement: React.ReactNode\n  submitText?: React.ReactNode\n  title: React.ReactNode\n}\n\nexport default function DialogLoading({\n  cancelText,\n  onCancel,\n  skeletonElement,\n  submitText,\n  title,\n}: DialogLoadingProps) {\n  const classes = useStyles()\n  return (\n    <>\n      <M.DialogTitle>{title}</M.DialogTitle>\n      <M.DialogContent className={classes.content}>{skeletonElement}</M.DialogContent>\n      <M.DialogActions>\n        <M.Button onClick={onCancel}>{cancelText || 'Cancel'}</M.Button>\n        <M.Button variant=\"contained\" color=\"primary\" disabled>\n          {submitText || 'Push'}\n        </M.Button>\n      </M.DialogActions>\n    </>\n  )\n}\n","import * as R from 'ramda'\nimport * as React from 'react'\nimport { Link } from 'react-router-dom'\nimport * as M from '@material-ui/core'\n\nimport * as NamedRoutes from 'utils/NamedRoutes'\nimport StyledLink from 'utils/StyledLink'\n\nconst useStyles = M.makeStyles({\n  content: {\n    paddingTop: 0,\n  },\n})\n\nexport interface DialogSuccessRenderMessageProps {\n  bucketLink: React.ReactNode\n  packageLink: React.ReactNode\n}\n\nconst defaultRenderMessage = (props: DialogSuccessRenderMessageProps) => (\n  <>\n    Pushed to {props.bucketLink} as {props.packageLink}\n  </>\n)\n\ninterface DialogSuccessProps {\n  browseText?: React.ReactNode\n  bucket: string\n  hash?: string\n  name: string\n  onClose: () => void\n  renderMessage?: (props: DialogSuccessRenderMessageProps) => React.ReactNode\n  title?: React.ReactNode\n}\n\n// TODO: use the same API as for DialogError and DialogLoading\nexport default function DialogSuccess({\n  browseText,\n  bucket,\n  hash,\n  name,\n  onClose,\n  renderMessage,\n  title,\n}: DialogSuccessProps) {\n  const classes = useStyles()\n  const { urls } = NamedRoutes.use()\n\n  // TODO: return full revision from quilt3 CLI\n  const isFullHash = hash && hash.length >= 10\n  const packageUrl = isFullHash\n    ? urls.bucketPackageTree(bucket, name, hash)\n    : urls.bucketPackageRevisions(bucket, name)\n  const packageLink = (\n    <StyledLink to={packageUrl}>{hash ? `${name}@${R.take(10, hash)}` : name}</StyledLink>\n  )\n  const bucketLink = (\n    <StyledLink to={urls.bucketOverview(bucket)}>s3://{bucket}</StyledLink>\n  )\n  const defaultBrowseText = isFullHash ? 'Browse package' : 'Browse package revisions'\n  return (\n    <>\n      <M.DialogTitle>{title || 'Push complete'}</M.DialogTitle>\n      <M.DialogContent className={classes.content}>\n        <M.Typography>\n          {(renderMessage || defaultRenderMessage)({ bucketLink, packageLink })}\n        </M.Typography>\n      </M.DialogContent>\n      <M.DialogActions>\n        <M.Button onClick={onClose}>Close</M.Button>\n        <M.Button\n          onClick={onClose}\n          component={Link}\n          to={packageUrl}\n          variant=\"contained\"\n          color=\"primary\"\n        >\n          {browseText || defaultBrowseText}\n        </M.Button>\n      </M.DialogActions>\n    </>\n  )\n}\n","import * as R from 'ramda'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport { JsonValue } from 'components/JsonEditor/constants'\nimport MetadataEditor from 'components/MetadataEditor'\n\nconst useDialogStyles = M.makeStyles({\n  paper: {\n    height: '100vh',\n  },\n})\n\nconst useStyles = M.makeStyles({\n  switch: {\n    marginRight: 'auto',\n  },\n})\n\ninterface DialogProps {\n  name: string\n  onChange: (value: JsonValue) => void\n  onClose: () => void\n  open: boolean\n  value: JsonValue\n}\n\nfunction Dialog({ name, onChange, onClose, open, value }: DialogProps) {\n  // TODO: add button to reset innerValue\n  const [innerValue, setInnerValue] = React.useState(value)\n  const classes = useStyles()\n  const dialogClasses = useDialogStyles()\n  const [isRaw, setRaw] = React.useState(false)\n  const handleSubmit = React.useCallback(() => {\n    onChange(innerValue)\n    onClose()\n  }, [innerValue, onChange, onClose])\n  const handleCancel = React.useCallback(() => {\n    setInnerValue(value)\n    onClose()\n  }, [onClose, value])\n  return (\n    <M.Dialog\n      fullWidth\n      maxWidth=\"xl\"\n      onClose={handleCancel}\n      open={open}\n      classes={dialogClasses}\n    >\n      <M.DialogTitle>Object-level metadata for \"{name}\"</M.DialogTitle>\n      <M.DialogContent>\n        <MetadataEditor\n          multiColumned\n          isRaw={isRaw}\n          value={innerValue}\n          onChange={setInnerValue}\n        />\n      </M.DialogContent>\n      <M.DialogActions>\n        <M.FormControlLabel\n          className={classes.switch}\n          control={<M.Switch checked={isRaw} onChange={() => setRaw(!isRaw)} />}\n          label=\"Edit as JSON\"\n        />\n        <M.Button onClick={handleCancel}>Discard</M.Button>\n        <M.Button onClick={handleSubmit} variant=\"contained\" color=\"primary\">\n          Save\n        </M.Button>\n      </M.DialogActions>\n    </M.Dialog>\n  )\n}\n\ninterface MetadataIconProps {\n  color: M.PropTypes.Color | 'disabled'\n}\n\nfunction MetadataIcon({ color }: MetadataIconProps) {\n  return (\n    <M.Icon fontSize=\"inherit\" color={color}>\n      list\n    </M.Icon>\n  )\n}\n\ninterface EditMetaProps {\n  disabled?: boolean\n  name: string\n  onChange?: (value: JsonValue) => void\n  value: JsonValue\n}\n\nexport default function EditFileMeta({ disabled, name, value, onChange }: EditMetaProps) {\n  // TODO: show \"modified\" state\n  //       possible solution: store value and its state in one object `metaValue = { value, state }`\n  const [open, setOpen] = React.useState(false)\n  const closeEditor = React.useCallback(() => setOpen(false), [setOpen])\n  const openEditor = React.useCallback(() => setOpen(true), [setOpen])\n  // TODO: simplify R.isEmpty when meta will be normalized to null\n  const color = React.useMemo(() => (R.isEmpty(value) ? 'inherit' : 'primary'), [value])\n\n  if (!onChange) return null\n\n  if (disabled) {\n    return (\n      <M.IconButton size=\"small\" disabled>\n        <MetadataIcon color=\"disabled\" />\n      </M.IconButton>\n    )\n  }\n\n  return (\n    <>\n      <M.IconButton onClick={openEditor} title=\"Edit meta\" size=\"small\">\n        <MetadataIcon color={color} />\n      </M.IconButton>\n\n      <Dialog\n        name={name}\n        onChange={onChange}\n        onClose={closeEditor}\n        open={open}\n        value={value}\n      />\n    </>\n  )\n}\n","import cx from 'classnames'\nimport pLimit from 'p-limit'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport { useDropzone, FileWithPath } from 'react-dropzone'\nimport * as M from '@material-ui/core'\nimport * as Lab from '@material-ui/lab'\nimport { fade } from '@material-ui/core/styles'\n\nimport * as urls from 'constants/urls'\nimport * as Model from 'model'\nimport StyledLink from 'utils/StyledLink'\nimport assertNever from 'utils/assertNever'\nimport dissocBy from 'utils/dissocBy'\nimport useDragging from 'utils/dragging'\nimport { withoutPrefix } from 'utils/s3paths'\nimport { readableBytes } from 'utils/string'\nimport * as tagged from 'utils/taggedV2'\nimport useMemoEq from 'utils/useMemoEq'\nimport * as Types from 'utils/types'\n\nimport EditFileMeta from './EditFileMeta'\nimport * as PD from './PackageDialog'\nimport * as S3FilePicker from './S3FilePicker'\n\nconst COLORS = {\n  default: M.colors.grey[900],\n  added: M.colors.green[900],\n  modified: M.darken(M.colors.yellow[900], 0.2),\n  deleted: M.colors.red[900],\n}\n\ninterface FileWithHash extends File {\n  hash: {\n    ready: boolean\n    value?: string\n    error?: Error\n    promise: Promise<string | undefined>\n  }\n  meta?: Types.JsonRecord\n}\n\nconst hasHash = (f: File): f is FileWithHash => !!f && !!(f as FileWithHash).hash\n\nconst hashLimit = pLimit(2)\n\nexport function computeHash(f: File) {\n  if (hasHash(f)) return f\n  const hashP = hashLimit(PD.hashFile, f)\n  const fh = f as FileWithHash\n  fh.hash = { ready: false } as any\n  fh.hash.promise = hashP\n    .catch((e) => {\n      // eslint-disable-next-line no-console\n      console.log(`Error hashing file \"${fh.name}\":`)\n      // eslint-disable-next-line no-console\n      console.error(e)\n      fh.hash.error = e\n      fh.hash.ready = true\n      return undefined\n    })\n    .then((hash) => {\n      fh.hash.value = hash\n      fh.hash.ready = true\n      return hash\n    })\n  return fh\n}\n\nexport const FilesAction = tagged.create(\n  'app/containers/Bucket/PackageDialog/FilesInput:FilesAction' as const,\n  {\n    Add: (v: { files: FileWithHash[]; prefix?: string }) => v,\n    AddFromS3: (v: { files: Model.S3File[]; basePrefix: string; prefix?: string }) => v,\n    Delete: (path: string) => path,\n    DeleteDir: (prefix: string) => prefix,\n    Meta: (v: { path: string; meta: Types.JsonRecord }) => v,\n    Revert: (path: string) => path,\n    RevertDir: (prefix: string) => prefix,\n    Reset: () => {},\n  },\n)\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport type FilesAction = tagged.InstanceOf<typeof FilesAction>\n\nexport type LocalFile = FileWithPath & FileWithHash\n\nexport interface FilesState {\n  added: Record<string, LocalFile | Model.S3File>\n  deleted: Record<string, true>\n  existing: Record<string, Model.PackageEntry>\n  // XXX: workaround used to re-trigger validation and dependent computations\n  // required due to direct mutations of File objects\n  counter?: number\n}\n\nconst addMetaToFile = (\n  file: Model.PackageEntry | LocalFile | Model.S3File,\n  meta: Types.JsonRecord,\n) => {\n  if (file instanceof window.File) {\n    const fileCopy = new window.File([file as File], (file as File).name, {\n      type: (file as File).type,\n    })\n    Object.defineProperty(fileCopy, 'meta', {\n      value: meta,\n    })\n    Object.defineProperty(fileCopy, 'hash', {\n      value: (file as FileWithHash).hash,\n    })\n    return fileCopy\n  }\n  return R.assoc('meta', meta, file)\n}\n\nconst handleFilesAction = FilesAction.match<\n  (state: FilesState) => FilesState,\n  [{ initial: FilesState }]\n>({\n  Add:\n    ({ files, prefix }) =>\n    (state) =>\n      files.reduce((acc, file) => {\n        const path = (prefix || '') + PD.getNormalizedPath(file)\n        return R.evolve(\n          {\n            added: R.assoc(path, file),\n            deleted: R.dissoc(path),\n          },\n          acc,\n        )\n      }, state),\n  AddFromS3:\n    ({ files, basePrefix, prefix }) =>\n    (state) =>\n      files.reduce((acc, file) => {\n        const path = (prefix || '') + withoutPrefix(basePrefix, file.key)\n        return R.evolve(\n          {\n            added: R.assoc(path, file),\n            deleted: R.dissoc(path),\n          },\n          acc,\n        )\n      }, state),\n  Delete: (path) =>\n    R.evolve({\n      added: R.dissoc(path),\n      deleted: R.assoc(path, true as const),\n    }),\n  // add all descendants from existing to deleted\n  DeleteDir:\n    (prefix) =>\n    ({ existing, added, deleted, ...rest }) => ({\n      existing,\n      added: dissocBy(R.startsWith(prefix))(added),\n      deleted: R.mergeLeft(\n        Object.keys(existing).reduce(\n          (acc, k) => (k.startsWith(prefix) ? { ...acc, [k]: true } : acc),\n          {},\n        ),\n        deleted,\n      ),\n      ...rest,\n    }),\n  Meta: ({ path, meta }) => {\n    const mkSetMeta =\n      <T extends Model.PackageEntry | LocalFile | Model.S3File>() =>\n      (filesDict: Record<string, T>) => {\n        const file = filesDict[path]\n        if (!file) return filesDict\n        return R.assoc(path, addMetaToFile(file, meta), filesDict)\n      }\n    return R.evolve({\n      added: mkSetMeta<LocalFile | Model.S3File>(),\n      existing: mkSetMeta<Model.PackageEntry>(),\n    })\n  },\n  Revert: (path) => R.evolve({ added: R.dissoc(path), deleted: R.dissoc(path) }),\n  // remove all descendants from added and deleted\n  RevertDir: (prefix) =>\n    R.evolve({\n      added: dissocBy(R.startsWith(prefix)),\n      deleted: dissocBy(R.startsWith(prefix)),\n    }),\n  Reset:\n    (_, { initial }) =>\n    () =>\n      initial,\n})\n\ninterface DispatchFilesAction {\n  (action: FilesAction): void\n}\n\ntype FilesEntryState = 'deleted' | 'modified' | 'unchanged' | 'hashing' | 'added'\n\ntype FilesEntryType = 's3' | 'local'\n\nconst FilesEntryTag = 'app/containers/Bucket/PackageDialog/FilesInput:FilesEntry' as const\n\nconst FilesEntry = tagged.create(FilesEntryTag, {\n  Dir: (v: {\n    name: string\n    state: FilesEntryState\n    childEntries: tagged.Instance<typeof FilesEntryTag>[]\n  }) => v,\n  File: (v: {\n    name: string\n    state: FilesEntryState\n    type: FilesEntryType\n    size: number\n    meta?: Types.JsonRecord | null\n  }) => v,\n})\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\ntype FilesEntry = tagged.InstanceOf<typeof FilesEntry>\ntype FilesEntryDir = ReturnType<typeof FilesEntry.Dir>\n\nconst insertIntoDir = (path: string[], file: FilesEntry, dir: FilesEntryDir) => {\n  const { name, childEntries } = FilesEntry.Dir.unbox(dir)\n  const newChildren = insertIntoTree(path, file, childEntries)\n  const state = newChildren\n    .map(FilesEntry.match({ Dir: R.prop('state'), File: R.prop('state') }))\n    .reduce((acc, entryState) => {\n      if (entryState === 'hashing' || acc === 'hashing') return 'hashing'\n      if (acc === entryState) return acc\n      return 'modified'\n    })\n  return FilesEntry.Dir({ name, state, childEntries: newChildren })\n}\n\n// eslint-disable-next-line @typescript-eslint/default-param-last\nconst insertIntoTree = (path: string[] = [], file: FilesEntry, entries: FilesEntry[]) => {\n  let inserted = file\n  let restEntries = entries\n  if (path.length) {\n    const [current, ...rest] = path\n    const state = FilesEntry.match({ File: (f) => f.state, Dir: (d) => d.state }, file)\n    let baseDir = FilesEntry.Dir({ name: current, state, childEntries: [] })\n    const existingDir = entries.find(\n      FilesEntry.match({\n        File: () => false,\n        Dir: R.propEq('name', current),\n      }),\n    )\n    if (existingDir) {\n      restEntries = R.without([existingDir], entries)\n      baseDir = existingDir as FilesEntryDir\n    }\n    inserted = insertIntoDir(rest, file, baseDir)\n  }\n  const sort = R.sortWith([\n    R.ascend(FilesEntry.match({ Dir: () => 0, File: () => 1 })),\n    R.ascend(FilesEntry.match({ Dir: (d) => d.name, File: (f) => f.name })),\n  ])\n  return sort([inserted, ...restEntries])\n}\n\ninterface IntermediateEntry {\n  state: FilesEntryState\n  type: FilesEntryType\n  path: string\n  size: number\n  meta?: Types.JsonRecord | null\n}\n\nconst computeEntries = ({ added, deleted, existing }: FilesState) => {\n  const existingEntries: IntermediateEntry[] = Object.entries(existing).map(\n    ([path, { size, hash, meta }]) => {\n      if (path in deleted) {\n        return { state: 'deleted' as const, type: 'local' as const, path, size, meta }\n      }\n      if (path in added) {\n        const a = added[path]\n        let state: FilesEntryState\n        let type: FilesEntryType\n        if (S3FilePicker.isS3File(a)) {\n          type = 's3' as const\n          state = 'modified' as const\n        } else {\n          type = 'local' as const\n          // eslint-disable-next-line no-nested-ternary\n          state = !a.hash.ready\n            ? ('hashing' as const)\n            : a.hash.value === hash\n            ? ('unchanged' as const)\n            : ('modified' as const)\n        }\n        return { state, type, path, size: a.size, meta }\n      }\n      return { state: 'unchanged' as const, type: 'local' as const, path, size, meta }\n    },\n  )\n  const addedEntries = Object.entries(added).reduce((acc, [path, f]) => {\n    if (path in existing) return acc\n    const type = S3FilePicker.isS3File(f) ? ('s3' as const) : ('local' as const)\n    return acc.concat({ state: 'added', type, path, size: f.size, meta: f.meta })\n  }, [] as IntermediateEntry[])\n  const entries: IntermediateEntry[] = [...existingEntries, ...addedEntries]\n  return entries.reduce((children, { path, ...rest }) => {\n    const parts = path.split('/')\n    const prefixPath = R.init(parts).map((p) => `${p}/`)\n    const name = R.last(parts)!\n    const file = FilesEntry.File({ name, ...rest })\n    return insertIntoTree(prefixPath, file, children)\n  }, [] as FilesEntry[])\n}\n\nexport const HASHING = 'hashing'\nexport const HASHING_ERROR = 'hashingError'\n\nexport const validateHashingComplete = (state: FilesState) => {\n  const files = Object.values(state.added).filter(\n    (f) => !S3FilePicker.isS3File(f),\n  ) as FileWithHash[]\n  if (files.some((f) => f.hash.ready && !f.hash.value)) return HASHING_ERROR\n  if (files.some((f) => !f.hash.ready)) return HASHING\n  return undefined\n}\n\nexport const EMPTY_SELECTION = 'emptySelection'\n\nexport const validateNonEmptySelection = (state: FilesSelectorState) => {\n  if (state.every(R.propEq('selected', false))) return EMPTY_SELECTION\n  return undefined\n}\n\nconst useEntryIconStyles = M.makeStyles((t) => ({\n  root: {\n    position: 'relative',\n  },\n  icon: {\n    boxSizing: 'content-box',\n    display: 'block',\n    fontSize: 18,\n    padding: 3,\n  },\n  overlay: {\n    alignItems: 'center',\n    bottom: 0,\n    color: t.palette.background.paper,\n    display: 'flex',\n    fontFamily: t.typography.fontFamily,\n    fontSize: 8,\n    justifyContent: 'center',\n    left: 0,\n    position: 'absolute',\n    right: 0,\n    top: 0,\n  },\n  stateContainer: {\n    alignItems: 'center',\n    background: 'currentColor',\n    border: `1px solid ${t.palette.background.paper}`,\n    borderRadius: '100%',\n    bottom: 0,\n    display: 'flex',\n    height: 12,\n    justifyContent: 'center',\n    left: 0,\n    position: 'absolute',\n    width: 12,\n  },\n  state: {\n    fontFamily: t.typography.fontFamily,\n    fontWeight: t.typography.fontWeightBold,\n    fontSize: 9,\n    color: t.palette.background.paper,\n  },\n  hashProgress: {\n    color: t.palette.background.paper,\n  },\n}))\n\ntype EntryIconProps = React.PropsWithChildren<{\n  state: FilesEntryState\n  overlay?: React.ReactNode\n}>\n\nfunction EntryIcon({ state, overlay, children }: EntryIconProps) {\n  const classes = useEntryIconStyles()\n  const stateContents = {\n    added: '+',\n    deleted: <>&ndash;</>,\n    modified: '~',\n    hashing: 'hashing',\n    unchanged: undefined,\n  }[state]\n  return (\n    <div className={classes.root}>\n      <M.Icon className={classes.icon}>{children}</M.Icon>\n      {!!overlay && <div className={classes.overlay}>{overlay}</div>}\n      {!!stateContents && (\n        <div className={classes.stateContainer}>\n          {stateContents === 'hashing' ? (\n            <M.CircularProgress size={8} thickness={6} className={classes.hashProgress} />\n          ) : (\n            <div className={classes.state}>{stateContents}</div>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n\nconst useFileStyles = M.makeStyles((t) => ({\n  added: {},\n  modified: {},\n  hashing: {},\n  deleted: {},\n  unchanged: {},\n  interactive: {},\n  root: {\n    alignItems: 'center',\n    color: COLORS.default,\n    cursor: 'default',\n    display: 'flex',\n    opacity: 0.7,\n    outline: 'none',\n    '&:hover': {\n      opacity: 1,\n    },\n    '&$added': {\n      color: COLORS.added,\n    },\n    '&$modified': {\n      color: COLORS.modified,\n    },\n    '&$hashing': {\n      color: COLORS.modified,\n    },\n    '&$deleted': {\n      color: COLORS.deleted,\n    },\n    '&$interactive': {\n      cursor: 'pointer',\n    },\n  },\n  inner: {\n    alignItems: 'center',\n    display: 'flex',\n    flexGrow: 1,\n    overflow: 'hidden',\n  },\n  faint: {\n    opacity: 0.5,\n  },\n  name: {\n    ...t.typography.body2,\n    flexGrow: 1,\n    marginRight: t.spacing(1),\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n  },\n  size: {\n    ...t.typography.body2,\n    marginRight: t.spacing(0.5),\n    opacity: 0.6,\n  },\n}))\n\ninterface FileProps extends React.HTMLAttributes<HTMLDivElement> {\n  name: string\n  state?: FilesEntryState\n  type?: FilesEntryType\n  size?: number\n  action?: React.ReactNode\n  meta?: Types.JsonRecord | null\n  metaDisabled?: boolean\n  onMeta?: (value: Types.JsonRecord) => void\n  interactive?: boolean\n  faint?: boolean\n  disableStateDisplay?: boolean\n}\n\nfunction File({\n  name,\n  state = 'unchanged',\n  type = 'local',\n  size,\n  action,\n  meta,\n  metaDisabled,\n  onMeta,\n  interactive = false,\n  faint = false,\n  className,\n  disableStateDisplay = false,\n  ...props\n}: FileProps) {\n  const classes = useFileStyles()\n  const stateDisplay = disableStateDisplay ? 'unchanged' : state\n\n  // XXX: reset EditFileMeta state when file is reverted\n  const metaKey = React.useMemo(() => JSON.stringify(meta), [meta])\n\n  return (\n    <div\n      className={cx(\n        className,\n        classes.root,\n        classes[stateDisplay],\n        interactive && classes.interactive,\n      )}\n      {...props}\n    >\n      <div className={cx(classes.inner, faint && classes.faint)}>\n        <EntryIcon state={stateDisplay} overlay={type === 's3' ? 'S3' : undefined}>\n          insert_drive_file\n        </EntryIcon>\n        <div className={classes.name} title={name}>\n          {name}\n        </div>\n        {size != null && <div className={classes.size}>{readableBytes(size)}</div>}\n      </div>\n      <EditFileMeta\n        disabled={metaDisabled}\n        key={metaKey}\n        name={name}\n        onChange={onMeta}\n        value={meta}\n      />\n      {action}\n    </div>\n  )\n}\n\nconst useDirStyles = M.makeStyles((t) => ({\n  added: {},\n  modified: {},\n  hashing: {},\n  deleted: {},\n  unchanged: {},\n  active: {},\n  root: {\n    cursor: 'pointer',\n    outline: 'none',\n    position: 'relative',\n  },\n  head: {\n    alignItems: 'center',\n    color: COLORS.default,\n    display: 'flex',\n    opacity: 0.7,\n    outline: 'none',\n    '$active > &, &:hover': {\n      opacity: 1,\n    },\n    '$added > &': {\n      color: COLORS.added,\n    },\n    '$modified > &': {\n      color: COLORS.modified,\n    },\n    '$hashing > &': {\n      color: COLORS.modified,\n    },\n    '$deleted > &': {\n      color: COLORS.deleted,\n    },\n  },\n  headInner: {\n    alignItems: 'center',\n    display: 'flex',\n    flexGrow: 1,\n    overflow: 'hidden',\n  },\n  faint: {\n    opacity: 0.5,\n  },\n  name: {\n    ...t.typography.body2,\n    flexGrow: 1,\n    marginRight: t.spacing(1),\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n  },\n  body: {\n    paddingLeft: 20,\n  },\n  bar: {\n    bottom: 0,\n    left: 0,\n    opacity: 0.3,\n    position: 'absolute',\n    top: 24,\n    width: 24,\n    '$active > $head > &, $head:hover > &': {\n      opacity: 0.4,\n    },\n    '&::before': {\n      background: 'currentColor',\n      borderRadius: 2,\n      bottom: 4,\n      content: '\"\"',\n      left: 10,\n      position: 'absolute',\n      top: 4,\n      width: 4,\n    },\n  },\n  emptyDummy: {\n    height: 24,\n  },\n  empty: {\n    ...t.typography.body2,\n    bottom: 0,\n    fontStyle: 'italic',\n    left: 24,\n    lineHeight: '24px',\n    opacity: 0.6,\n    overflow: 'hidden',\n    position: 'absolute',\n    right: 0,\n    top: 24,\n  },\n}))\n\ninterface DirProps extends React.HTMLAttributes<HTMLDivElement> {\n  name: string\n  state?: FilesEntryState\n  disableStateDisplay?: boolean\n  active?: boolean\n  empty?: boolean\n  expanded?: boolean\n  faint?: boolean\n  onChangeExpanded?: (expanded: boolean) => void\n  action?: React.ReactNode\n  onHeadClick?: React.MouseEventHandler<HTMLDivElement>\n}\n\nexport const Dir = React.forwardRef<HTMLDivElement, DirProps>(function Dir(\n  {\n    name,\n    state = 'unchanged',\n    disableStateDisplay = false,\n    active = false,\n    empty = false,\n    expanded = false,\n    faint = false,\n    action,\n    className,\n    onHeadClick,\n    children,\n    ...props\n  },\n  ref,\n) {\n  const classes = useDirStyles()\n  const stateDisplay = disableStateDisplay ? 'unchanged' : state\n\n  return (\n    <div\n      className={cx(className, classes.root, classes[stateDisplay], {\n        [classes.active]: active,\n      })}\n      ref={ref}\n      {...props}\n    >\n      {/* eslint-disable-next-line jsx-a11y/click-events-have-key-events */}\n      <div onClick={onHeadClick} className={classes.head} role=\"button\" tabIndex={0}>\n        <div className={cx(classes.headInner, faint && classes.faint)}>\n          <EntryIcon state={stateDisplay}>\n            {expanded ? 'folder_open' : 'folder'}\n          </EntryIcon>\n          <div className={classes.name}>{name}</div>\n        </div>\n        {action}\n        {(!!children || empty) && (\n          <>\n            <div className={classes.bar} />\n            {empty && <div className={classes.empty}>{'<EMPTY DIRECTORY>'}</div>}\n          </>\n        )}\n      </div>\n      {(!!children || empty) && (\n        <M.Collapse in={expanded} mountOnEnter unmountOnExit>\n          <div className={classes.body}>\n            {children || <div className={classes.emptyDummy} />}\n          </div>\n        </M.Collapse>\n      )}\n    </div>\n  )\n})\n\nconst useDropzoneMessageStyles = M.makeStyles((t) => ({\n  root: {\n    ...t.typography.body2,\n    alignItems: 'center',\n    background: t.palette.action.hover,\n    cursor: 'pointer',\n    display: 'flex',\n    flexGrow: 1,\n    justifyContent: 'center',\n    padding: t.spacing(6, 0),\n    textAlign: 'center',\n  },\n  error: {\n    color: t.palette.error.main,\n  },\n  warning: {\n    color: t.palette.warning.dark,\n  },\n}))\n\ninterface DropzoneMessageProps {\n  label?: React.ReactNode\n  error: React.ReactNode\n  warn: { upload: boolean; s3: boolean; count: boolean }\n}\n\nexport function DropzoneMessage({\n  label: defaultLabel,\n  error,\n  warn,\n}: DropzoneMessageProps) {\n  const classes = useDropzoneMessageStyles()\n\n  const label = React.useMemo(() => {\n    if (error) return <span>{error}</span>\n    if (!warn.s3 && !warn.count && !warn.upload) {\n      return <span>{defaultLabel || 'Drop files here or click to browse'}</span>\n    }\n    return (\n      <div>\n        {warn.upload && (\n          <p>\n            Total size of local files exceeds recommended maximum of{' '}\n            {readableBytes(PD.MAX_UPLOAD_SIZE)}.\n          </p>\n        )}\n        {warn.s3 && (\n          <p>\n            Total size of files from S3 exceeds recommended maximum of{' '}\n            {readableBytes(PD.MAX_S3_SIZE)}.\n          </p>\n        )}\n        {warn.count && (\n          <p>Total number of files exceeds recommended maximum of {PD.MAX_FILE_COUNT}.</p>\n        )}\n      </div>\n    )\n  }, [defaultLabel, error, warn.upload, warn.s3, warn.count])\n\n  return (\n    <div\n      className={cx(classes.root, {\n        [classes.error]: error,\n        [classes.warning]: !error && (warn.upload || warn.s3 || warn.count),\n      })}\n    >\n      {label}\n    </div>\n  )\n}\n\nconst useRootStyles = M.makeStyles({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n  },\n})\n\nexport function Root({\n  className,\n  ...props\n}: React.PropsWithChildren<{ className?: string }>) {\n  const classes = useRootStyles()\n  return <div className={cx(classes.root, className)} {...props} />\n}\n\nconst useHeaderStyles = M.makeStyles({\n  root: {\n    display: 'flex',\n    height: 24,\n  },\n})\n\nexport function Header(props: React.PropsWithChildren<{}>) {\n  const classes = useHeaderStyles()\n  return <div className={classes.root} {...props} />\n}\n\nconst useHeaderTitleStyles = M.makeStyles((t) => ({\n  root: {\n    ...t.typography.body1,\n    alignItems: 'center',\n    display: 'flex',\n    overflow: 'hidden',\n    whiteSpace: 'nowrap',\n  },\n  regular: {},\n  disabled: {\n    color: t.palette.text.secondary,\n  },\n  error: {\n    color: t.palette.error.main,\n  },\n  warn: {\n    color: t.palette.warning.dark,\n  },\n}))\n\ntype HeaderTitleState = 'disabled' | 'error' | 'warn' | 'regular'\n\nexport function HeaderTitle({\n  state = 'regular',\n  ...props\n}: React.PropsWithChildren<{ state?: HeaderTitleState }>) {\n  const classes = useHeaderTitleStyles()\n  return <div className={cx(classes.root, classes[state])} {...props} />\n}\n\nconst PROGRESS_EMPTY = { total: 0, loaded: 0, percent: 0 }\n\nconst useLockStyles = M.makeStyles((t) => ({\n  root: {\n    alignItems: 'center',\n    background: 'rgba(255,255,255,0.9)',\n    border: `1px solid ${t.palette.action.disabled}`,\n    borderRadius: t.shape.borderRadius,\n    bottom: 0,\n    cursor: 'not-allowed',\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    left: 0,\n    position: 'absolute',\n    right: 0,\n    top: 0,\n  },\n  progressContainer: {\n    display: 'flex',\n    position: 'relative',\n  },\n  progressPercent: {\n    ...t.typography.h5,\n    alignItems: 'center',\n    bottom: 0,\n    display: 'flex',\n    justifyContent: 'center',\n    left: 0,\n    position: 'absolute',\n    right: 0,\n    top: 0,\n  },\n  progressSize: {\n    ...t.typography.body2,\n    color: t.palette.text.secondary,\n    marginTop: t.spacing(1),\n  },\n}))\n\nexport function Lock({\n  progress,\n}: {\n  progress?: {\n    total: number\n    loaded: number\n    percent: number\n  }\n}) {\n  const classes = useLockStyles()\n  return (\n    <div className={classes.root}>\n      {!!progress && (\n        <>\n          <div className={classes.progressContainer}>\n            <M.CircularProgress\n              size={80}\n              value={progress.total ? progress.percent : undefined}\n              variant={progress.total ? 'determinate' : 'indeterminate'}\n            />\n            {!!progress.total && (\n              <div className={classes.progressPercent}>{progress.percent}%</div>\n            )}\n          </div>\n          {!!progress.total && (\n            <div className={classes.progressSize}>\n              {readableBytes(progress.loaded)}\n              {' / '}\n              {readableBytes(progress.total)}\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  )\n}\n\nconst useFilesContainerStyles = M.makeStyles((t) => ({\n  root: {\n    direction: 'rtl', // show the scrollbar on the left\n    overflowX: 'hidden',\n    overflowY: 'auto',\n  },\n  border: {\n    borderBottom: `1px solid ${t.palette.action.disabled}`,\n  },\n  err: {\n    borderColor: t.palette.error.main,\n  },\n  warn: {\n    borderColor: t.palette.warning.dark,\n  },\n  inner: {\n    direction: 'ltr',\n  },\n}))\n\ntype FilesContainerProps = React.PropsWithChildren<{\n  error?: boolean\n  warn?: boolean\n  noBorder?: boolean\n}>\n\nexport function FilesContainer({ error, warn, noBorder, children }: FilesContainerProps) {\n  const classes = useFilesContainerStyles()\n  return (\n    <div\n      className={cx(\n        classes.root,\n        !noBorder && classes.border,\n        error && classes.err,\n        !error && warn && classes.warn,\n      )}\n    >\n      <div className={classes.inner}>{children}</div>\n    </div>\n  )\n}\n\nconst useContentsContainerStyles = M.makeStyles((t) => ({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    flexGrow: 1,\n    marginTop: t.spacing(2),\n    overflowY: 'auto',\n    position: 'relative',\n  },\n  outlined: {\n    outline: `2px dashed ${t.palette.primary.light}`,\n    outlineOffset: '-2px',\n  },\n}))\n\ntype ContentsContainerProps = {\n  outlined?: boolean\n} & React.HTMLAttributes<HTMLDivElement>\n\nexport function ContentsContainer({\n  outlined,\n  className,\n  ...props\n}: ContentsContainerProps) {\n  const classes = useContentsContainerStyles()\n  return (\n    <div\n      className={cx(className, classes.root, outlined && classes.outlined)}\n      {...props}\n    />\n  )\n}\n\nconst useContentsStyles = M.makeStyles((t) => ({\n  root: {\n    border: `1px solid ${t.palette.action.disabled}`,\n    borderRadius: t.shape.borderRadius,\n    display: 'flex',\n    flexDirection: 'column',\n    flexGrow: 1,\n    minHeight: 80,\n    outline: 'none',\n    overflow: 'hidden',\n    position: 'relative',\n  },\n  interactive: {\n    cursor: 'pointer',\n  },\n  active: {\n    background: t.palette.action.selected,\n  },\n  err: {\n    borderColor: t.palette.error.main,\n  },\n  warn: {\n    borderColor: t.palette.warning.dark,\n  },\n}))\n\ninterface ContentsProps extends React.HTMLAttributes<HTMLDivElement> {\n  interactive?: boolean\n  active?: boolean\n  error?: boolean\n  warn?: boolean\n}\n\nexport const Contents = React.forwardRef<HTMLDivElement, ContentsProps>(function Contents(\n  { interactive, active, error, warn, className, ...props },\n  ref,\n) {\n  const classes = useContentsStyles()\n  return (\n    <div\n      className={cx(\n        className,\n        classes.root,\n        interactive && classes.interactive,\n        active && classes.active,\n        error && classes.err,\n        !error && warn && classes.warn,\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\n\ntype FileUploadProps = tagged.ValueOf<typeof FilesEntry.File> & {\n  prefix?: string\n  disableStateDisplay?: boolean\n  dispatch: DispatchFilesAction\n}\n\nfunction FileUpload({\n  name,\n  state,\n  type,\n  size,\n  prefix,\n  disableStateDisplay,\n  dispatch,\n  meta,\n}: FileUploadProps) {\n  const path = (prefix || '') + name\n\n  // eslint-disable-next-line consistent-return\n  const action = React.useMemo(() => {\n    const handle = (a: FilesAction) => (e: React.MouseEvent) => {\n      // stop click from propagating to the root element and triggering its handler\n      e.stopPropagation()\n      dispatch(a)\n    }\n    switch (state) {\n      case 'added':\n        return {\n          hint: 'Remove',\n          icon: 'clear',\n          handler: handle(FilesAction.Revert(path)),\n        }\n      case 'modified':\n        return {\n          hint: 'Revert',\n          icon: 'undo',\n          handler: handle(FilesAction.Revert(path)),\n        }\n      case 'hashing':\n        return {\n          hint: 'Revert',\n          icon: 'undo',\n          handler: handle(FilesAction.Revert(path)),\n        }\n      case 'deleted':\n        return {\n          hint: 'Restore',\n          icon: 'undo',\n          handler: handle(FilesAction.Revert(path)),\n        }\n      case 'unchanged':\n        return {\n          hint: 'Delete',\n          icon: 'clear',\n          handler: handle(FilesAction.Delete(path)),\n        }\n      default:\n        assertNever(state)\n    }\n  }, [state, dispatch, path])\n\n  const onClick = React.useCallback((e: React.MouseEvent) => {\n    // stop click from propagating to parent elements and triggering their handlers\n    e.stopPropagation()\n  }, [])\n\n  const onMeta = React.useCallback(\n    (m: Types.JsonRecord) => dispatch(FilesAction.Meta({ path, meta: m })),\n    [dispatch, path],\n  )\n\n  return (\n    // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n    <File\n      onClick={onClick}\n      role=\"button\"\n      tabIndex={0}\n      state={state}\n      disableStateDisplay={disableStateDisplay}\n      type={type}\n      name={name}\n      size={size}\n      meta={meta}\n      metaDisabled={state === 'deleted'}\n      onMeta={onMeta}\n      action={\n        <M.IconButton onClick={action.handler} title={action.hint} size=\"small\">\n          <M.Icon fontSize=\"inherit\">{action.icon}</M.Icon>\n        </M.IconButton>\n      }\n    />\n  )\n}\n\ntype DirUploadProps = tagged.ValueOf<typeof FilesEntry.Dir> & {\n  prefix?: string\n  dispatch: DispatchFilesAction\n  delayHashing: boolean\n  disableStateDisplay?: boolean\n}\n\nfunction DirUpload({\n  name,\n  state,\n  childEntries,\n  prefix,\n  dispatch,\n  delayHashing,\n  disableStateDisplay,\n}: DirUploadProps) {\n  const [expanded, setExpanded] = React.useState(false)\n\n  const toggleExpanded = React.useCallback(\n    (e) => {\n      // stop click from propagating to the root element and triggering its handler\n      e.stopPropagation()\n      setExpanded((x) => !x)\n    },\n    [setExpanded],\n  )\n\n  const onClick = React.useCallback((e: React.MouseEvent) => {\n    // stop click from propagating to parent elements and triggering their handlers\n    e.stopPropagation()\n  }, [])\n\n  const path = (prefix || '') + name\n\n  const onDrop = React.useCallback(\n    (files: File[]) => {\n      dispatch(FilesAction.Add({ prefix: path, files: files.map(computeHash) }))\n    },\n    [dispatch, path],\n  )\n\n  const { getRootProps, isDragActive } = useDropzone({\n    onDrop,\n    noDragEventsBubbling: true,\n    noClick: true,\n  })\n\n  // eslint-disable-next-line consistent-return\n  const action = React.useMemo(() => {\n    const handle = (a: FilesAction) => (e: React.MouseEvent) => {\n      // stop click from propagating to the root element and triggering its handler\n      e.stopPropagation()\n      dispatch(a)\n    }\n    switch (state) {\n      case 'added':\n        return {\n          hint: 'Remove',\n          icon: 'clear',\n          handler: handle(FilesAction.RevertDir(path)),\n        }\n      case 'modified':\n        return {\n          hint: 'Revert',\n          icon: 'undo',\n          handler: handle(FilesAction.RevertDir(path)),\n        }\n      case 'hashing':\n        return {\n          hint: 'Revert',\n          icon: 'undo',\n          handler: handle(FilesAction.RevertDir(path)),\n        }\n      case 'deleted':\n        return {\n          hint: 'Restore',\n          icon: 'undo',\n          handler: handle(FilesAction.RevertDir(path)),\n        }\n      case 'unchanged':\n        return {\n          hint: 'Delete',\n          icon: 'clear',\n          handler: handle(FilesAction.DeleteDir(path)),\n        }\n      default:\n        assertNever(state)\n    }\n  }, [state, dispatch, path])\n\n  return (\n    <Dir\n      {...getRootProps({ onClick })}\n      active={isDragActive}\n      onHeadClick={toggleExpanded}\n      expanded={expanded}\n      name={name}\n      state={state}\n      disableStateDisplay={disableStateDisplay}\n      action={\n        <M.IconButton onClick={action.handler} title={action.hint} size=\"small\">\n          <M.Icon fontSize=\"inherit\">{action.icon}</M.Icon>\n        </M.IconButton>\n      }\n      empty={!childEntries.length}\n    >\n      {!!childEntries.length &&\n        childEntries.map(\n          FilesEntry.match({\n            Dir: (ps) => (\n              <DirUpload\n                {...ps}\n                key={ps.name}\n                prefix={path}\n                dispatch={dispatch}\n                delayHashing={delayHashing}\n                disableStateDisplay={disableStateDisplay}\n              />\n            ),\n            File: (ps) => (\n              <FileUpload\n                {...ps}\n                key={ps.name}\n                prefix={path}\n                dispatch={dispatch}\n                disableStateDisplay={disableStateDisplay}\n              />\n            ),\n          }),\n        )}\n    </Dir>\n  )\n}\n\nconst DOCS_URL_SOURCE_BUCKETS = `${urls.docsMaster}/catalog/preferences#properties`\n\nconst useFilesInputStyles = M.makeStyles((t) => ({\n  hashing: {\n    marginLeft: t.spacing(1),\n  },\n  actions: {\n    display: 'flex',\n    marginTop: t.spacing(1),\n  },\n  action: {\n    flexGrow: 1,\n    '& + &': {\n      marginLeft: t.spacing(1),\n    },\n  },\n  warning: {\n    marginLeft: t.spacing(1),\n  },\n}))\n\ninterface FilesInputProps {\n  initialS3Path?: string\n  input: {\n    value: FilesState\n    onChange: (value: FilesState) => void\n  }\n  className?: string\n  disabled?: boolean\n  errors?: Record<string, React.ReactNode>\n  meta: {\n    submitting: boolean\n    submitSucceeded: boolean\n    submitFailed: boolean\n    dirty: boolean\n    error?: string\n    submitError?: string\n    initial: FilesState\n  }\n  onFilesAction?: (\n    action: FilesAction,\n    oldValue: FilesState,\n    newValue: FilesState,\n  ) => void\n  title: React.ReactNode\n  totalProgress: {\n    total: number\n    loaded: number\n    percent: number\n  }\n  bucket: string\n  buckets?: string[]\n  selectBucket?: (bucket: string) => void\n  delayHashing?: boolean\n  disableStateDisplay?: boolean\n  ui?: {\n    reset?: React.ReactNode\n  }\n}\n\nexport function FilesInput({\n  input: { value, onChange },\n  className,\n  disabled = false,\n  errors = {},\n  meta,\n  onFilesAction,\n  title,\n  totalProgress,\n  bucket,\n  buckets,\n  selectBucket,\n  delayHashing = false,\n  disableStateDisplay = false,\n  ui = {},\n  initialS3Path,\n}: FilesInputProps) {\n  const classes = useFilesInputStyles()\n\n  const pRef = React.useRef<Promise<any>>()\n  const scheduleUpdate = (waitFor: Promise<any>[]) => {\n    const p = waitFor.length ? Promise.all(waitFor) : undefined\n    pRef.current = p\n    if (p) {\n      p.then(() => {\n        if (p === pRef.current) {\n          const v = ref.current!.value\n          onChange({ ...v, counter: (v.counter || 0) + 1 }) // trigger field validation\n        }\n      })\n    }\n  }\n\n  const submitting = meta.submitting || meta.submitSucceeded\n  const error = meta.submitFailed && (meta.error || meta.submitError)\n\n  const refProps = {\n    value,\n    disabled: disabled || submitting,\n    initial: meta.initial,\n    onChange,\n    onFilesAction,\n    scheduleUpdate,\n  }\n  const ref = React.useRef<typeof refProps>()\n  ref.current = refProps\n  const { current: dispatch } = React.useRef((action: FilesAction) => {\n    const cur = ref.current!\n    if (cur.disabled) return\n\n    const newValue = handleFilesAction(action, { initial: cur.initial })(cur.value)\n    // XXX: maybe observe value and trigger this when it changes,\n    // regardless of the source of change (e.g. new value supplied directly via the prop)\n    const waitFor = Object.values(newValue.added).reduce(\n      (acc, f) =>\n        S3FilePicker.isS3File(f) || f.hash.ready\n          ? acc\n          : acc.concat(f.hash.promise.catch(() => {})),\n      [] as Promise<any>[],\n    )\n    cur.scheduleUpdate(waitFor)\n\n    cur.onChange(newValue)\n    if (cur.onFilesAction) cur.onFilesAction(action, cur.value, newValue)\n  })\n\n  const onDrop = React.useCallback(\n    (files) => {\n      dispatch(FilesAction.Add({ files: files.map(computeHash) }))\n    },\n    [dispatch],\n  )\n\n  const resetFiles = React.useCallback(() => {\n    dispatch(FilesAction.Reset())\n  }, [dispatch])\n\n  const isDragging = useDragging()\n  const { getRootProps, getInputProps, isDragActive, open } = useDropzone({\n    disabled,\n    onDrop,\n  })\n\n  const computedEntries = useMemoEq(value, computeEntries)\n\n  const stats = useMemoEq(value, ({ added, existing }) => ({\n    upload: Object.entries(added).reduce(\n      (acc, [path, f]) => {\n        if (S3FilePicker.isS3File(f)) return acc // dont count s3 files\n        const e = existing[path]\n        if (e && (!f.hash.ready || f.hash.value === e.hash)) return acc\n        return R.evolve({ count: R.inc, size: R.add(f.size) }, acc)\n      },\n      { count: 0, size: 0 },\n    ),\n    s3: Object.entries(added).reduce(\n      (acc, [, f]) =>\n        S3FilePicker.isS3File(f)\n          ? R.evolve({ count: R.inc, size: R.add(f.size) }, acc)\n          : acc,\n      { count: 0, size: 0 },\n    ),\n    hashing: Object.values(added).reduce(\n      (acc, f) => acc || (!S3FilePicker.isS3File(f) && !f.hash.ready),\n      false,\n    ),\n  }))\n\n  const warn = {\n    upload: stats.upload.size > PD.MAX_UPLOAD_SIZE,\n    s3: stats.s3.size > PD.MAX_S3_SIZE,\n    count: stats.upload.count + stats.s3.count > PD.MAX_FILE_COUNT,\n  }\n\n  const [s3FilePickerOpen, setS3FilePickerOpen] = React.useState(initialS3Path != null)\n\n  const closeS3FilePicker = React.useCallback(\n    (reason: S3FilePicker.CloseReason) => {\n      if (!!reason && typeof reason === 'object') {\n        dispatch(FilesAction.AddFromS3({ files: reason.files, basePrefix: reason.path }))\n      }\n      setS3FilePickerOpen(false)\n    },\n    [dispatch, setS3FilePickerOpen],\n  )\n\n  const handleS3Btn = React.useCallback(() => {\n    setS3FilePickerOpen(true)\n  }, [])\n\n  const isS3FilePickerEnabled = !!buckets?.length\n\n  return (\n    <Root className={className}>\n      {isS3FilePickerEnabled && (\n        <S3FilePicker.Dialog\n          bucket={bucket}\n          buckets={buckets}\n          selectBucket={selectBucket}\n          open={s3FilePickerOpen}\n          onClose={closeS3FilePicker}\n          initialPath={initialS3Path}\n        />\n      )}\n      <Header>\n        <HeaderTitle\n          state={\n            submitting || disabled // eslint-disable-line no-nested-ternary\n              ? 'disabled'\n              : error // eslint-disable-line no-nested-ternary\n              ? 'error'\n              : warn.upload || warn.s3 || warn.count\n              ? 'warn'\n              : undefined\n          }\n        >\n          {title}\n          {(!!stats.upload.count || !!stats.s3.count) && (\n            <M.Box\n              ml={1}\n              color={warn.upload || warn.s3 ? 'warning.dark' : 'text.secondary'}\n              component=\"span\"\n            >\n              (\n              {!!stats.upload.count && (\n                <M.Box\n                  color={warn.upload ? 'warning.dark' : 'text.secondary'}\n                  component=\"span\"\n                >\n                  {readableBytes(stats.upload.size)} to upload\n                </M.Box>\n              )}\n              {!!stats.upload.count && !!stats.s3.count && (\n                <M.Box\n                  color={!warn.upload || !warn.s3 ? 'text.secondary' : undefined}\n                  component=\"span\"\n                >\n                  {', '}\n                </M.Box>\n              )}\n              {!!stats.s3.count && (\n                <M.Box\n                  color={warn.s3 ? 'warning.dark' : 'text.secondary'}\n                  component=\"span\"\n                >\n                  {readableBytes(stats.s3.size)} from S3\n                </M.Box>\n              )}\n              )\n            </M.Box>\n          )}\n          {(warn.upload || warn.s3 || warn.count) && (\n            <M.Icon style={{ marginLeft: 6 }} fontSize=\"small\">\n              error_outline\n            </M.Icon>\n          )}\n          {!delayHashing && stats.hashing && (\n            <M.CircularProgress\n              className={classes.hashing}\n              size={16}\n              title=\"Hashing files\"\n            />\n          )}\n        </HeaderTitle>\n        <M.Box flexGrow={1} />\n        {meta.dirty && (\n          <M.Button\n            onClick={resetFiles}\n            disabled={ref.current.disabled}\n            size=\"small\"\n            endIcon={<M.Icon fontSize=\"small\">undo</M.Icon>}\n          >\n            {ui.reset || 'Clear files'}\n          </M.Button>\n        )}\n      </Header>\n\n      <ContentsContainer outlined={isDragging && !ref.current.disabled}>\n        <Contents\n          {...getRootProps()}\n          interactive\n          active={isDragActive && !ref.current.disabled}\n          error={!!error}\n          warn={warn.upload || warn.s3 || warn.count}\n        >\n          <input {...getInputProps()} />\n\n          {!!computedEntries.length && (\n            <FilesContainer error={!!error} warn={warn.upload || warn.s3 || warn.count}>\n              {computedEntries.map(\n                FilesEntry.match({\n                  Dir: (ps) => (\n                    <DirUpload\n                      {...ps}\n                      key={`dir:${ps.name}`}\n                      dispatch={dispatch}\n                      delayHashing={delayHashing}\n                      disableStateDisplay={disableStateDisplay}\n                    />\n                  ),\n                  File: (ps) => (\n                    <FileUpload\n                      {...ps}\n                      key={`file:${ps.name}`}\n                      dispatch={dispatch}\n                      disableStateDisplay={disableStateDisplay}\n                    />\n                  ),\n                }),\n              )}\n            </FilesContainer>\n          )}\n\n          <DropzoneMessage error={error && (errors[error] || error)} warn={warn} />\n        </Contents>\n        {submitting && <Lock progress={totalProgress} />}\n      </ContentsContainer>\n      <div className={classes.actions}>\n        <M.Button\n          onClick={open}\n          disabled={submitting || disabled}\n          className={classes.action}\n          variant=\"outlined\"\n          size=\"small\"\n        >\n          Add local files\n        </M.Button>\n        {isS3FilePickerEnabled ? (\n          <M.Button\n            onClick={handleS3Btn}\n            disabled={submitting || disabled}\n            className={classes.action}\n            variant=\"outlined\"\n            size=\"small\"\n          >\n            Add files from bucket\n          </M.Button>\n        ) : (\n          <Lab.Alert className={classes.warning} severity=\"info\">\n            <StyledLink href={DOCS_URL_SOURCE_BUCKETS} target=\"_blank\">\n              Learn how to add files from a bucket\n            </StyledLink>\n          </Lab.Alert>\n        )}\n      </div>\n    </Root>\n  )\n}\n\nconst useFilesSelectorStyles = M.makeStyles((t) => ({\n  checkbox: {\n    color: `${t.palette.action.active} !important`,\n    padding: 3,\n    '&:hover': {\n      backgroundColor: `${fade(\n        t.palette.action.active,\n        t.palette.action.hoverOpacity,\n      )} !important`,\n    },\n    '& svg': {\n      fontSize: '18px',\n    },\n  },\n}))\n\ninterface FilesSelectorEntry {\n  type: 'dir' | 'file'\n  name: string\n  selected: boolean\n  size?: number\n  meta?: Types.JsonRecord\n}\n\nexport type FilesSelectorState = FilesSelectorEntry[]\n\ninterface FilesSelectorProps {\n  input: {\n    value: FilesSelectorState\n    onChange: (value: FilesSelectorState) => void\n  }\n  className?: string\n  disabled?: boolean\n  errors?: Record<string, React.ReactNode>\n  meta: {\n    submitting: boolean\n    submitSucceeded: boolean\n    submitFailed: boolean\n    dirty: boolean\n    error?: string\n    submitError?: string\n    initial: FilesSelectorState\n  }\n  title: React.ReactNode\n  truncated?: boolean\n}\n\nexport function FilesSelector({\n  input: { value, onChange },\n  className,\n  disabled = false,\n  errors = {},\n  meta,\n  title,\n  truncated = false,\n}: FilesSelectorProps) {\n  const classes = useFilesSelectorStyles()\n\n  const submitting = meta.submitting || meta.submitSucceeded\n  const error = meta.submitFailed && (meta.error || meta.submitError)\n\n  const selected = React.useMemo(\n    () => value.reduce((m, i) => (i.selected ? m + 1 : m), 0),\n    [value],\n  )\n\n  const toggleAll = React.useCallback(() => {\n    onChange(value.map(R.assoc('selected', selected < value.length)))\n  }, [onChange, value, selected])\n\n  const handleItemClick = React.useCallback(\n    (e: React.MouseEvent<HTMLDivElement>) => {\n      e.stopPropagation()\n      const idx = value.findIndex(R.propEq('name', e.currentTarget.dataset.name!))\n      if (idx < 0) return\n      onChange(R.adjust(idx, R.evolve({ selected: R.not }), value))\n    },\n    [onChange, value],\n  )\n\n  return (\n    <Root className={className}>\n      <Header>\n        <HeaderTitle\n          state={\n            submitting || disabled // eslint-disable-line no-nested-ternary\n              ? 'disabled'\n              : error // eslint-disable-line no-nested-ternary\n              ? 'error'\n              : truncated\n              ? 'warn'\n              : undefined\n          }\n        >\n          {title}\n          {truncated && (\n            // TODO: adjust copy\n            <M.Tooltip title=\"Only the first 1000 items are shown, but the folder contains more\">\n              <M.Icon style={{ marginLeft: 6 }} fontSize=\"small\">\n                error_outline\n              </M.Icon>\n            </M.Tooltip>\n          )}\n        </HeaderTitle>\n        <M.Box flexGrow={1} />\n        {value.length > 0 && (\n          <M.Button\n            onClick={toggleAll}\n            disabled={disabled || submitting}\n            size=\"small\"\n            endIcon={\n              <M.Icon fontSize=\"small\">\n                {selected === value.length // eslint-disable-line no-nested-ternary\n                  ? 'check_box'\n                  : !selected\n                  ? 'check_box_outline_blank'\n                  : 'indeterminate_check_box_icon'}\n              </M.Icon>\n            }\n          >\n            Select {selected < value.length ? 'all' : 'none'}\n          </M.Button>\n        )}\n      </Header>\n\n      <ContentsContainer>\n        <Contents error={!!error} warn={truncated}>\n          {value.length ? (\n            <FilesContainer noBorder>\n              {value.map(({ type, name, selected: sel, size }) =>\n                type === 'dir' ? (\n                  <Dir\n                    key={`dir:${name}`}\n                    name={name}\n                    action={<M.Checkbox className={classes.checkbox} checked={sel} />}\n                    onClick={handleItemClick}\n                    data-name={name}\n                    faint={!sel}\n                  />\n                ) : (\n                  <File\n                    key={`file:${name}`}\n                    name={name}\n                    size={size}\n                    action={<M.Checkbox className={classes.checkbox} checked={sel} />}\n                    onClick={handleItemClick}\n                    data-name={name}\n                    faint={!sel}\n                    interactive\n                  />\n                ),\n              )}\n            </FilesContainer>\n          ) : (\n            // TODO: adjust copy\n            <M.Box\n              display=\"flex\"\n              flexGrow={1}\n              alignItems=\"center\"\n              justifyContent=\"center\"\n            >\n              <M.Typography align=\"center\" color={error ? 'error' : undefined}>\n                Current directory is empty\n              </M.Typography>\n            </M.Box>\n          )}\n          {submitting && <Lock progress={PROGRESS_EMPTY} />}\n        </Contents>\n      </ContentsContainer>\n\n      {!!error && (\n        <M.FormHelperText error margin=\"dense\">\n          {errors[error] || error}\n        </M.FormHelperText>\n      )}\n    </Root>\n  )\n}\n","import * as M from '@material-ui/core'\nimport * as React from 'react'\nimport cx from 'classnames'\n\n// TODO: use grid\nconst useContainerStyles = M.makeStyles({\n  root: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    height: '100%',\n  },\n})\n\nexport function Container({ children }: React.PropsWithChildren<{}>) {\n  const classes = useContainerStyles()\n\n  return <div className={classes.root}>{children}</div>\n}\n\nconst GAP = 3\n\nconst useColumnStyles = M.makeStyles((t) => ({\n  root: {\n    display: 'flex',\n    flexBasis: '100%',\n    flexDirection: 'column',\n    flexGrow: 0,\n    overflowY: 'auto',\n    [t.breakpoints.down('xs')]: {\n      paddingBottom: t.spacing(3),\n    },\n    [t.breakpoints.up('sm')]: {\n      height: '100%',\n      flexBasis: '50%',\n      maxWidth: `calc(50% - ${t.spacing(GAP / 2)}px)`,\n    },\n  },\n}))\n\nexport function Column({\n  children,\n  className,\n}: React.PropsWithChildren<{ className?: string }>) {\n  const classes = useColumnStyles()\n  return <div className={cx(classes.root, className)}>{children}</div>\n}\n\nexport const RightColumn = Column\n\nconst useLeftColumnStyles = M.makeStyles((t) => ({\n  root: {\n    [t.breakpoints.up('sm')]: {\n      marginRight: t.spacing(GAP),\n    },\n  },\n}))\n\nexport function LeftColumn(props: React.PropsWithChildren<{}>) {\n  const classes = useLeftColumnStyles()\n  return <Column className={classes.root} {...props} />\n}\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport type { TypedDocumentNode as DocumentNode } from '@graphql-typed-document-node/core'\nimport * as Types from '../../../../model/graphql/types.generated'\n\nexport type containers_Bucket_PackageDialog_gql_ManifestQueryVariables = Types.Exact<{\n  bucket: Types.Scalars['String']\n  name: Types.Scalars['String']\n  hashOrTag: Types.Scalars['String']\n  max: Types.Scalars['Int']\n  skipEntries: Types.Scalars['Boolean']\n}>\n\nexport type containers_Bucket_PackageDialog_gql_ManifestQuery = {\n  readonly __typename: 'Query'\n} & {\n  readonly package: Types.Maybe<\n    { readonly __typename: 'Package' } & Pick<Types.Package, 'bucket' | 'name'> & {\n        readonly revision: Types.Maybe<\n          { readonly __typename: 'PackageRevision' } & Types.MakeMaybe<\n            Pick<Types.PackageRevision, 'hash' | 'userMeta' | 'contentsFlatMap'>,\n            'contentsFlatMap'\n          > & {\n              readonly workflow: Types.Maybe<\n                { readonly __typename: 'PackageWorkflow' } & Pick<\n                  Types.PackageWorkflow,\n                  'id'\n                >\n              >\n            }\n        >\n      }\n  >\n}\n\nexport const containers_Bucket_PackageDialog_gql_ManifestDocument = {\n  kind: 'Document',\n  definitions: [\n    {\n      kind: 'OperationDefinition',\n      operation: 'query',\n      name: { kind: 'Name', value: 'containers_Bucket_PackageDialog_gql_Manifest' },\n      variableDefinitions: [\n        {\n          kind: 'VariableDefinition',\n          variable: { kind: 'Variable', name: { kind: 'Name', value: 'bucket' } },\n          type: {\n            kind: 'NonNullType',\n            type: { kind: 'NamedType', name: { kind: 'Name', value: 'String' } },\n          },\n        },\n        {\n          kind: 'VariableDefinition',\n          variable: { kind: 'Variable', name: { kind: 'Name', value: 'name' } },\n          type: {\n            kind: 'NonNullType',\n            type: { kind: 'NamedType', name: { kind: 'Name', value: 'String' } },\n          },\n        },\n        {\n          kind: 'VariableDefinition',\n          variable: { kind: 'Variable', name: { kind: 'Name', value: 'hashOrTag' } },\n          type: {\n            kind: 'NonNullType',\n            type: { kind: 'NamedType', name: { kind: 'Name', value: 'String' } },\n          },\n        },\n        {\n          kind: 'VariableDefinition',\n          variable: { kind: 'Variable', name: { kind: 'Name', value: 'max' } },\n          type: {\n            kind: 'NonNullType',\n            type: { kind: 'NamedType', name: { kind: 'Name', value: 'Int' } },\n          },\n        },\n        {\n          kind: 'VariableDefinition',\n          variable: { kind: 'Variable', name: { kind: 'Name', value: 'skipEntries' } },\n          type: {\n            kind: 'NonNullType',\n            type: { kind: 'NamedType', name: { kind: 'Name', value: 'Boolean' } },\n          },\n        },\n      ],\n      selectionSet: {\n        kind: 'SelectionSet',\n        selections: [\n          {\n            kind: 'Field',\n            name: { kind: 'Name', value: 'package' },\n            arguments: [\n              {\n                kind: 'Argument',\n                name: { kind: 'Name', value: 'bucket' },\n                value: { kind: 'Variable', name: { kind: 'Name', value: 'bucket' } },\n              },\n              {\n                kind: 'Argument',\n                name: { kind: 'Name', value: 'name' },\n                value: { kind: 'Variable', name: { kind: 'Name', value: 'name' } },\n              },\n            ],\n            selectionSet: {\n              kind: 'SelectionSet',\n              selections: [\n                { kind: 'Field', name: { kind: 'Name', value: 'bucket' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'name' } },\n                {\n                  kind: 'Field',\n                  name: { kind: 'Name', value: 'revision' },\n                  arguments: [\n                    {\n                      kind: 'Argument',\n                      name: { kind: 'Name', value: 'hashOrTag' },\n                      value: {\n                        kind: 'Variable',\n                        name: { kind: 'Name', value: 'hashOrTag' },\n                      },\n                    },\n                  ],\n                  selectionSet: {\n                    kind: 'SelectionSet',\n                    selections: [\n                      { kind: 'Field', name: { kind: 'Name', value: 'hash' } },\n                      { kind: 'Field', name: { kind: 'Name', value: 'userMeta' } },\n                      {\n                        kind: 'Field',\n                        name: { kind: 'Name', value: 'workflow' },\n                        selectionSet: {\n                          kind: 'SelectionSet',\n                          selections: [\n                            { kind: 'Field', name: { kind: 'Name', value: 'id' } },\n                          ],\n                        },\n                      },\n                      {\n                        kind: 'Field',\n                        name: { kind: 'Name', value: 'contentsFlatMap' },\n                        arguments: [\n                          {\n                            kind: 'Argument',\n                            name: { kind: 'Name', value: 'max' },\n                            value: {\n                              kind: 'Variable',\n                              name: { kind: 'Name', value: 'max' },\n                            },\n                          },\n                        ],\n                        directives: [\n                          {\n                            kind: 'Directive',\n                            name: { kind: 'Name', value: 'skip' },\n                            arguments: [\n                              {\n                                kind: 'Argument',\n                                name: { kind: 'Name', value: 'if' },\n                                value: {\n                                  kind: 'Variable',\n                                  name: { kind: 'Name', value: 'skipEntries' },\n                                },\n                              },\n                            ],\n                          },\n                        ],\n                      },\n                    ],\n                  },\n                },\n              ],\n            },\n          },\n        ],\n      },\n    },\n  ],\n} as unknown as DocumentNode<\n  containers_Bucket_PackageDialog_gql_ManifestQuery,\n  containers_Bucket_PackageDialog_gql_ManifestQueryVariables\n>\n\nexport { containers_Bucket_PackageDialog_gql_ManifestDocument as default }\n","import * as React from 'react'\n\nimport * as Model from 'model'\nimport AR from 'utils/AsyncResult'\nimport * as Types from 'utils/types'\nimport useQuery from 'utils/useQuery'\n\nimport * as errors from '../errors'\nimport MANIFEST_QUERY from './gql/Manifest.generated'\n\nconst MANIFEST_LIMIT = 10000\n\nexport const EMPTY_MANIFEST_ENTRIES: Model.PackageContentsFlatMap = {}\n\n// XXX: use typeof MANIFEST_QUERY\nexport interface Manifest {\n  entries?: Model.PackageContentsFlatMap\n  meta?: Types.JsonRecord\n  workflowId?: string\n}\n\ninterface UseManifestParams {\n  bucket: string\n  name: string\n  hash?: string | undefined\n  skipEntries?: boolean\n  pause?: boolean\n}\n\nexport function useManifest({\n  bucket,\n  name,\n  hash,\n  skipEntries = false,\n  pause = false,\n}: UseManifestParams) {\n  const res = useQuery({\n    query: MANIFEST_QUERY,\n    variables: {\n      bucket,\n      name,\n      hashOrTag: hash || 'latest',\n      max: MANIFEST_LIMIT,\n      skipEntries,\n    },\n    pause: pause,\n  })\n  const { case: doCase } = res\n  const pausedNoData = !res.data && pause\n  const result = React.useMemo(() => {\n    // XXX: use RemoteData?\n    if (pausedNoData) return AR.Pending()\n    return doCase({\n      data: (data) => {\n        const r = data.package?.revision\n        // TODO: more appropriate error?\n        if (!r) return AR.Err(new Error('no data'))\n        if (!r.contentsFlatMap && !skipEntries)\n          return AR.Err(\n            new errors.ManifestTooLarge({\n              bucket,\n              hash: r.hash,\n              max: MANIFEST_LIMIT,\n            }),\n          )\n        return AR.Ok({\n          entries: r.contentsFlatMap ?? undefined,\n          meta: r.userMeta ?? undefined,\n          workflowId: r.workflow?.id ?? undefined,\n        })\n      },\n      error: AR.Err,\n      fetching: AR.Pending,\n    })\n  }, [pausedNoData, doCase, bucket, skipEntries])\n\n  return React.useMemo(\n    () => ({\n      result,\n      case: (cases: $TSFixMe, ...args: $TSFixMe) => AR.case(cases, result, ...args),\n    }),\n    [result],\n  )\n}\n","import * as dateFns from 'date-fns'\nimport * as R from 'ramda'\nimport * as xlsx from 'xlsx'\n\nimport * as jsonSchema from 'utils/json-schema'\nimport pipeThru from 'utils/pipeThru'\n\ntype MetadataValue = $TSFixMe\n\ntype JsonSchema = $TSFixMe\n\nexport function rowsToJson(rows: MetadataValue[][]) {\n  return pipeThru(rows)(\n    R.map(([key, ...values]) => {\n      if ((key === null || key === undefined) && process.env.NODE_ENV !== 'test') {\n        // eslint-disable-next-line no-console\n        console.warn(\"Column's key is empty\", [key, ...values])\n      }\n      const columnName = key === undefined ? 'null' : key\n      // Array spread fills empty items with `undefined`\n      const columnValues = [...values].map((value) =>\n        value === undefined ? null : value,\n      )\n      return [columnName, columnValues]\n    }),\n    R.fromPairs,\n  )\n}\n\nexport function parseSpreadsheet(\n  sheet: xlsx.WorkSheet,\n  transpose: boolean,\n): Record<string, MetadataValue> {\n  const rows = xlsx.utils.sheet_to_json<MetadataValue>(sheet, {\n    header: 1,\n  })\n  const maxSize = rows.reduce((memo, row) => R.max(memo, row.length), 0)\n  return pipeThru(rows)(\n    R.without([[]]),\n    R.map((row: any[]) => {\n      const nullsTail = R.repeat(null, maxSize - row.length)\n      return R.concat(row, nullsTail)\n    }),\n    transpose ? R.transpose : R.identity,\n    rowsToJson,\n  )\n}\n\nexport function readSpreadsheet(file: File): Promise<xlsx.WorkSheet> {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader()\n    reader.onabort = () => {\n      reject(new Error('abort'))\n    }\n    reader.onerror = () => {\n      reject(reader.error)\n    }\n    reader.onload = () => {\n      const workbook = xlsx.read(reader.result, { type: 'array', cellDates: true })\n      resolve(workbook.Sheets[workbook.SheetNames[0]])\n    }\n    reader.readAsArrayBuffer(file)\n  })\n}\n\nexport const scoreObjectDiff = (obj1: {}, obj2: {}): number =>\n  R.intersection(Object.keys(obj1), Object.keys(obj2)).length\n\nfunction parseJSON(str: string | number | boolean) {\n  if (typeof str !== 'string') return str\n\n  try {\n    return JSON.parse(str)\n  } catch (e) {\n    return str\n  }\n}\n\nconst isDate = (value: MetadataValue, schema?: JsonSchema) =>\n  value instanceof Date ||\n  (schema && schema.type === 'string' && schema.format === 'date' && value)\n\nconst isArrayOfDates = (value: MetadataValue, schema?: JsonSchema) =>\n  isDate(value, schema?.items) || isDate(value, schema?.contains)\n\nconst isArray = (value: MetadataValue, schema?: JsonSchema) =>\n  schema && jsonSchema.isSchemaArray(schema) && typeof value === 'string'\n\nconst isArrayOfArrays = (value: MetadataValue, schema?: JsonSchema) =>\n  isArray(value, schema?.items) || isArray(value, schema?.contains)\n\nconst isBoolean = (value: MetadataValue, schema?: JsonSchema) =>\n  schema && jsonSchema.isSchemaBoolean(schema) && (value === 1 || value === 0)\n\nconst isArrayOfBooleans = (value: MetadataValue, schema?: JsonSchema) =>\n  isBoolean(value, schema?.items) || isBoolean(value, schema?.contains)\n\nconst isObject = (value: MetadataValue) => R.is(Object, value)\n\nconst getSchemaItem = (key: string, schema?: JsonSchema) =>\n  schema && schema.properties && schema.properties[key]\n\nexport function postProcessValue(\n  value: MetadataValue,\n  schema?: JsonSchema,\n): MetadataValue {\n  if (Array.isArray(value) && value.length === 1)\n    return postProcessValue(value[0], schema)\n\n  if (isDate(value, schema)) return dateFns.formatISO(value, { representation: 'date' })\n\n  if (isArray(value, schema)) return value.split(',').map(parseJSON)\n\n  if (isBoolean(value, schema)) return Boolean(value)\n\n  if (isObject(value)) return postProcess(value, schema)\n\n  return parseJSON(value)\n}\n\nexport function postProcessArrayValue(\n  value: MetadataValue,\n  schema?: JsonSchema,\n): MetadataValue {\n  if (isArrayOfDates(value, schema))\n    return dateFns.formatISO(value, { representation: 'date' })\n\n  if (isArrayOfArrays(value, schema)) return value.split(',').map(parseJSON)\n\n  if (isArrayOfBooleans(value, schema)) return Boolean(value)\n\n  return parseJSON(value)\n}\n\nfunction isArrayValue(value: MetadataValue, schema?: JsonSchema): value is unknown[] {\n  if (!Array.isArray(value)) return false\n  if (value.length > 1) return true\n  if (schema && jsonSchema.isSchemaArray(schema)) return true\n  return false\n}\n\nexport function postProcess(\n  obj: Record<string, MetadataValue>,\n  schema?: JsonSchema,\n): Record<string, MetadataValue> {\n  if (Array.isArray(obj)) return obj.map((v) => postProcess(v, schema?.items))\n  return R.mapObjIndexed(\n    (value: MetadataValue, key: string) =>\n      isArrayValue(value, getSchemaItem(key, schema))\n        ? value.map((v) => postProcessArrayValue(v, getSchemaItem(key, schema)))\n        : postProcessValue(value, getSchemaItem(key, schema)),\n    obj,\n  )\n}\n\nexport function parseSpreadsheetAgainstSchema(\n  sheet: xlsx.WorkSheet,\n  schema?: JsonSchema,\n): Record<string, MetadataValue> {\n  const verticalObj = parseSpreadsheet(sheet, true)\n  const schemaRoot =\n    schema?.type === 'array' ? schema?.items?.properties : schema?.properties\n  if (schemaRoot) {\n    const horizontalObj = parseSpreadsheet(sheet, false)\n    if (\n      scoreObjectDiff(\n        schema?.type === 'array' ? horizontalObj[0] : horizontalObj,\n        schemaRoot,\n      ) >\n      scoreObjectDiff(schema?.type === 'array' ? verticalObj[0] : verticalObj, schemaRoot)\n    ) {\n      return postProcess(horizontalObj, schema)\n    }\n  }\n  return postProcess(verticalObj, schema)\n}\n\nexport async function readSpreadsheetAgainstSchema(\n  file: File,\n  schema: JsonSchema,\n): Promise<MetadataValue> {\n  const sheet = await readSpreadsheet(file)\n  return parseSpreadsheetAgainstSchema(sheet, schema)\n}\n\nexport const parse = parseSpreadsheet\n\nexport const readAgainstSchema = readSpreadsheetAgainstSchema\n","import cx from 'classnames'\nimport mime from 'mime-types'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport { useDropzone } from 'react-dropzone'\nimport type * as RF from 'react-final-form'\nimport { fade } from '@material-ui/core/styles'\nimport * as M from '@material-ui/core'\n\nimport JsonEditor from 'components/JsonEditor'\nimport { JsonValue, ValidationErrors } from 'components/JsonEditor/constants'\nimport JsonValidationErrors from 'components/JsonValidationErrors'\nimport MetadataEditor from 'components/MetadataEditor'\nimport * as Notifications from 'containers/Notifications'\nimport Delay from 'utils/Delay'\nimport useDragging from 'utils/dragging'\nimport { JsonSchema } from 'utils/json-schema'\nimport * as spreadsheets from 'utils/spreadsheets'\nimport { readableBytes } from 'utils/string'\nimport { JsonRecord } from 'utils/types'\n\nconst MAX_META_FILE_SIZE = 10 * 1000 * 1000 // 10MB\n\nconst useDialogStyles = M.makeStyles({\n  paper: {\n    height: '100vh',\n  },\n})\n\nconst useStyles = M.makeStyles({\n  content: {\n    height: '100%',\n  },\n  switch: {\n    marginRight: 'auto',\n  },\n})\n\ninterface DialogProps {\n  onChange: (value: JsonValue) => void\n  onClose: () => void\n  open: boolean\n  value: JsonValue\n  schema?: JsonSchema\n}\n\nfunction Dialog({ onChange, onClose, open, schema, value }: DialogProps) {\n  const [innerValue, setInnerValue] = React.useState(value)\n  const classes = useStyles()\n  const dialogClasses = useDialogStyles()\n  const [isRaw, setRaw] = React.useState(false)\n  const handleSubmit = React.useCallback(() => {\n    onChange(innerValue)\n    onClose()\n  }, [innerValue, onChange, onClose])\n  const handleCancel = React.useCallback(() => {\n    setInnerValue(value)\n    onClose()\n  }, [onClose, value])\n  return (\n    <M.Dialog\n      fullWidth\n      maxWidth=\"xl\"\n      onClose={handleCancel}\n      open={open}\n      classes={dialogClasses}\n    >\n      <M.DialogTitle>Package-level metadata</M.DialogTitle>\n      <M.DialogContent className={classes.content}>\n        <MetadataEditor\n          multiColumned\n          isRaw={isRaw}\n          value={innerValue}\n          onChange={setInnerValue}\n          schema={schema}\n        />\n      </M.DialogContent>\n      <M.DialogActions>\n        <M.FormControlLabel\n          className={classes.switch}\n          control={<M.Switch checked={isRaw} onChange={() => setRaw(!isRaw)} />}\n          label=\"Edit as JSON\"\n        />\n        <M.Button onClick={handleCancel}>Discard</M.Button>\n        <M.Button onClick={handleSubmit} variant=\"contained\" color=\"primary\">\n          Save\n        </M.Button>\n      </M.DialogActions>\n    </M.Dialog>\n  )\n}\n\nconst readTextFile = (file: File): Promise<string> =>\n  new Promise((resolve, reject) => {\n    const reader = new FileReader()\n    reader.onabort = () => {\n      reject(new Error('abort'))\n    }\n    reader.onerror = () => {\n      reject(reader.error)\n    }\n    reader.onload = () => {\n      resolve(reader.result as string)\n    }\n    reader.readAsText(file)\n  })\n\nconst readFile = (file: File, schema?: JsonSchema): Promise<string | {}> => {\n  const mimeType = mime.extension(file.type)\n  if (mimeType && /ods|odt|csv|xlsx|xls/.test(mimeType))\n    return spreadsheets.readAgainstSchema(file, schema)\n  return readTextFile(file)\n}\n\nconst useMetaInputStyles = M.makeStyles((t) => ({\n  header: {\n    alignItems: 'center',\n    display: 'flex',\n    marginBottom: t.spacing(2),\n    height: 24,\n  },\n  btn: {\n    fontSize: 11,\n    height: 24,\n    paddingBottom: 0,\n    paddingLeft: 7,\n    paddingRight: 7,\n    paddingTop: 0,\n  },\n  errors: {\n    marginTop: t.spacing(1),\n  },\n  add: {\n    marginTop: t.spacing(2),\n  },\n  row: {\n    alignItems: 'center',\n    display: 'flex',\n    marginTop: t.spacing(1),\n  },\n  sep: {\n    ...t.typography.body1,\n    marginLeft: t.spacing(1),\n    marginRight: t.spacing(1),\n  },\n  json: {\n    alignItems: 'flex-start',\n    display: 'flex',\n  },\n  jsonTrigger: {\n    marginLeft: 'auto',\n  },\n  key: {\n    flexBasis: 100,\n    flexGrow: 1,\n  },\n  value: {\n    flexBasis: 100,\n    flexGrow: 2,\n  },\n  dropzone: {\n    display: 'flex',\n    flexDirection: 'column',\n    overflowY: 'auto',\n    position: 'relative',\n  },\n  metaContent: {\n    display: 'flex',\n    flexDirection: 'column',\n  },\n  outlined: {\n    bottom: '1px',\n    left: 0,\n    outline: `2px dashed ${t.palette.primary.light}`,\n    outlineOffset: '-2px',\n    position: 'absolute',\n    right: 0,\n    top: '1px',\n    zIndex: 1,\n  },\n  overlay: {\n    background: 'rgba(255,255,255,0.6)',\n    bottom: 0,\n    left: 0,\n    position: 'absolute',\n    right: 0,\n    top: 0,\n    transition: 'background 0.15s ease',\n    zIndex: 1,\n  },\n  overlayDraggable: {\n    bottom: '3px',\n    left: '2px',\n    right: '2px',\n    top: '3px',\n  },\n  overlayDragActive: {\n    background: fade(t.palette.grey[200], 0.8),\n  },\n  overlayContents: {\n    alignItems: 'center',\n    display: 'flex',\n    height: '100%',\n    justifyContent: 'center',\n    maxHeight: 120,\n  },\n  overlayText: {\n    ...t.typography.body1,\n    color: t.palette.text.secondary,\n  },\n  overlayProgress: {\n    marginRight: t.spacing(1),\n  },\n}))\n\nexport const EMPTY_META_VALUE = {}\n\ninterface MetaInputProps {\n  className?: string\n  schemaError: React.ReactNode\n  input: RF.FieldInputProps<{}>\n  meta: RF.FieldMetaState<{}>\n  schema?: JsonSchema\n}\n\nexport const MetaInput = React.forwardRef<HTMLDivElement, MetaInputProps>(\n  function MetaInput(\n    { className, schemaError, input: { value, onChange }, meta, schema },\n    ref,\n  ) {\n    const classes = useMetaInputStyles()\n    const errors: ValidationErrors =\n      schemaError || ((meta.modified || meta.submitFailed) && meta.error)\n    const disabled = meta.submitting || meta.submitSucceeded\n\n    const [open, setOpen] = React.useState(false)\n    const closeEditor = React.useCallback(() => setOpen(false), [setOpen])\n    const openEditor = React.useCallback(() => setOpen(true), [setOpen])\n\n    const onChangeFullscreen = React.useCallback(\n      (json: JsonRecord) => {\n        setJsonInlineEditorKey(R.inc)\n        // NOTE: `json` may have `target` field and make react-final-form think it's an event not value\n        //       so, let's create \"event\" voluntarily\n        //       https://final-form.org/docs/react-final-form/types/FieldRenderProps#inputonchange\n        onChange({ target: { value: json } })\n      },\n      [onChange],\n    )\n\n    const onChangeInline = React.useCallback(\n      (json: JsonRecord) => {\n        setJsonFullscreenEditorKey(R.inc)\n        // NOTE: `json` may have `target` field and make react-final-form think it's an event not value\n        //       so, let's create \"event\" voluntarily\n        //       https://final-form.org/docs/react-final-form/types/FieldRenderProps#inputonchange\n        onChange({ target: { value: json } })\n      },\n      [onChange],\n    )\n\n    const { push: notify } = Notifications.use()\n    const [locked, setLocked] = React.useState(false)\n\n    // used to force json editor re-initialization\n    const [jsonInlineEditorKey, setJsonInlineEditorKey] = React.useState(1)\n    const [jsonFullscreenEditorKey, setJsonFullscreenEditorKey] = React.useState(1)\n\n    const onDrop = React.useCallback(\n      ([file]) => {\n        if (file.size > MAX_META_FILE_SIZE) {\n          notify(\n            <>\n              File too large ({readableBytes(file.size)}), must be under{' '}\n              {readableBytes(MAX_META_FILE_SIZE)}.\n            </>,\n          )\n          return\n        }\n        setLocked(true)\n        readFile(file, schema)\n          .then((contents: string | {}) => {\n            if (R.is(Object, contents)) {\n              onChange(contents)\n            } else {\n              try {\n                JSON.parse(contents as string)\n              } catch (e) {\n                notify('The file does not contain valid JSON')\n              }\n              // FIXME: show error\n            }\n            // force json editor to re-initialize\n            setJsonInlineEditorKey(R.inc)\n            setJsonFullscreenEditorKey(R.inc)\n          })\n          .catch((e) => {\n            if (e.message === 'abort') return\n            // eslint-disable-next-line no-console\n            console.log('Error reading file')\n            // eslint-disable-next-line no-console\n            console.error(e)\n            notify(\"Couldn't read that file\")\n          })\n          .finally(() => {\n            setLocked(false)\n          })\n      },\n      [\n        schema,\n        setLocked,\n        onChange,\n        setJsonInlineEditorKey,\n        setJsonFullscreenEditorKey,\n        notify,\n      ],\n    )\n\n    const isDragging = useDragging()\n\n    const { getRootProps, isDragActive } = useDropzone({ onDrop })\n\n    return (\n      <div className={className}>\n        <div className={classes.header}>\n          {/* eslint-disable-next-line no-nested-ternary */}\n          <M.Typography color={disabled ? 'textSecondary' : errors ? 'error' : undefined}>\n            Metadata\n          </M.Typography>\n          <M.Button\n            className={classes.jsonTrigger}\n            disabled={disabled}\n            onClick={openEditor}\n            size=\"small\"\n            title=\"Expand JSON editor\"\n            variant=\"outlined\"\n            endIcon={\n              <M.Icon fontSize=\"inherit\" color=\"primary\">\n                fullscreen\n              </M.Icon>\n            }\n          >\n            Expand\n          </M.Button>\n        </div>\n\n        <Dialog\n          schema={schema}\n          key={jsonFullscreenEditorKey}\n          onChange={onChangeFullscreen}\n          onClose={closeEditor}\n          open={open}\n          value={value}\n        />\n\n        <div {...getRootProps({ className: classes.dropzone })} tabIndex={undefined}>\n          <div className={classes.metaContent} ref={ref}>\n            {isDragging && <div className={classes.outlined} />}\n\n            <div className={classes.json}>\n              <JsonEditor\n                disabled={disabled}\n                errors={errors}\n                key={jsonInlineEditorKey}\n                onChange={onChangeInline}\n                schema={schema}\n                value={value}\n              />\n            </div>\n\n            <JsonValidationErrors className={classes.errors} error={errors} />\n          </div>\n\n          {locked && (\n            <div className={classes.overlay}>\n              <Delay ms={500} alwaysRender>\n                {(ready) => (\n                  <M.Fade in={ready}>\n                    <div className={classes.overlayContents}>\n                      <M.CircularProgress size={20} className={classes.overlayProgress} />\n                      <div className={classes.overlayText}>Reading file contents</div>\n                    </div>\n                  </M.Fade>\n                )}\n              </Delay>\n            </div>\n          )}\n\n          {isDragging && (\n            <div\n              className={cx(classes.overlay, classes.overlayDraggable, {\n                [classes.overlayDragActive]: isDragActive,\n              })}\n            >\n              <div className={classes.overlayContents}>\n                <div className={classes.overlayText}>\n                  Drop metadata file (XLSX, CSV, JSON)\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    )\n  },\n)\n","import { basename } from 'path'\n\nimport * as React from 'react'\nimport { DropEvent, useDropzone } from 'react-dropzone'\nimport type * as RF from 'react-final-form'\n\nimport { JsonValue } from 'components/JsonEditor/constants'\nimport useDragging from 'utils/dragging'\nimport * as IPC from 'utils/electron/ipc-provider'\nimport { JsonSchema } from 'utils/json-schema'\nimport * as workflows from 'utils/workflows'\nimport { getMetaValue, getWorkflowApiParam } from 'containers/Bucket/requests/package'\n\nimport * as FI from './PackageDialog/FilesInput'\n\nconst fakeProgress = { loaded: 0, percent: 0, total: 0 }\n\ninterface UploadPackagePayload {\n  message: string\n  meta: JsonValue\n  workflow: workflows.Workflow\n  entry: string\n}\n\ninterface UploadPackageTarget {\n  bucket: string\n  name: string\n}\n\nexport function useUploadPackage() {\n  const ipc = IPC.use()\n  return React.useCallback(\n    (payload: UploadPackagePayload, target: UploadPackageTarget, schema?: JsonSchema) => {\n      const body = {\n        ...payload,\n        meta: getMetaValue(payload.meta, schema),\n        workflow: getWorkflowApiParam(payload.workflow.slug),\n      }\n      return ipc.invoke(IPC.EVENTS.UPLOAD_PACKAGE, body, target)\n    },\n    [ipc],\n  )\n}\n\nfunction isDroppedDirectory(event: DropEvent) {\n  try {\n    // @ts-expect-error DropEvent type is incorrect\n    const dt = event.dataTransfer\n    const entry = dt.items[0].webkitGetAsEntry()\n    return entry.isDirectory\n  } catch (error) {\n    return false\n  }\n}\n\nfunction getFilesFromEvent(event: DropEvent) {\n  if (isDroppedDirectory(event)) {\n    // @ts-expect-error DropEvent type is incorrect\n    return Promise.resolve([event.dataTransfer.files[0]])\n  }\n  return Promise.resolve([])\n}\n\ninterface LocalFolderInputProps {\n  className?: string\n  disabled?: boolean\n  errors?: Record<string, React.ReactNode>\n  input: RF.FieldInputProps<string>\n  meta: RF.FieldMetaState<string>\n  title: React.ReactNode\n}\n\nexport function LocalFolderInput({\n  className,\n  disabled = false,\n  errors = {},\n  input: { onChange, value },\n  meta,\n  title,\n}: LocalFolderInputProps) {\n  const ipc = IPC.use()\n\n  const submitting = meta.submitting || meta.submitSucceeded\n  const error = meta.submitFailed && meta.error\n\n  const disabledInternal = disabled || submitting\n  const handleClick = React.useCallback(async () => {\n    if (disabledInternal) return\n    const newLocalPath = await ipc.invoke(IPC.EVENTS.LOCALPATH_REQUEST)\n    if (!newLocalPath) return\n    onChange(newLocalPath)\n  }, [disabledInternal, ipc, onChange])\n\n  const onDrop = React.useCallback((files) => onChange(files[0].path), [onChange])\n\n  const isDragging = useDragging()\n  const { getRootProps, isDragActive } = useDropzone({\n    onDrop,\n    disabled: disabledInternal,\n    getFilesFromEvent,\n    maxFiles: 1,\n  })\n\n  return (\n    <FI.Root className={className}>\n      <FI.Header>\n        <FI.HeaderTitle\n          state={\n            disabledInternal // eslint-disable-line no-nested-ternary\n              ? 'disabled'\n              : error // eslint-disable-line no-nested-ternary\n              ? 'error'\n              : undefined\n          }\n        >\n          {title}\n        </FI.HeaderTitle>\n      </FI.Header>\n      <FI.ContentsContainer className={className} outlined={isDragging}>\n        <FI.Contents\n          {...getRootProps({ onClick: handleClick })}\n          active={isDragActive}\n          error={!!error}\n        >\n          <FI.FilesContainer error={!!error} noBorder>\n            {value && <FI.Dir name={basename(value)} />}\n          </FI.FilesContainer>\n          <FI.DropzoneMessage\n            label=\"Drop directory or click to browse\"\n            error={error && (errors[error] || error)}\n            warn={{ upload: false, s3: false, count: false }}\n          />\n          {submitting && <FI.Lock progress={fakeProgress} />}\n        </FI.Contents>\n      </FI.ContentsContainer>\n    </FI.Root>\n  )\n}\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport type { TypedDocumentNode as DocumentNode } from '@graphql-typed-document-node/core'\nimport * as Types from '../../../../model/graphql/types.generated'\n\nimport {\n  PackagePushSuccessSelectionFragment,\n  PackagePushSuccessSelectionFragmentDoc,\n} from './PackagePushSuccessSelection.generated'\nimport {\n  InvalidInputSelectionFragment,\n  InvalidInputSelectionFragmentDoc,\n} from './InvalidInputSelection.generated'\nimport {\n  OperationErrorSelectionFragment,\n  OperationErrorSelectionFragmentDoc,\n} from './OperationErrorSelection.generated'\n\nexport type containers_Bucket_PackageDialog_gql_PackageConstructMutationVariables =\n  Types.Exact<{\n    params: Types.PackagePushParams\n    src: Types.PackageConstructSource\n  }>\n\nexport type containers_Bucket_PackageDialog_gql_PackageConstructMutation = {\n  readonly __typename: 'Mutation'\n} & {\n  readonly packageConstruct:\n    | ({\n        readonly __typename: 'PackagePushSuccess'\n      } & PackagePushSuccessSelectionFragment)\n    | ({ readonly __typename: 'InvalidInput' } & InvalidInputSelectionFragment)\n    | ({ readonly __typename: 'OperationError' } & OperationErrorSelectionFragment)\n}\n\nexport const containers_Bucket_PackageDialog_gql_PackageConstructDocument = {\n  kind: 'Document',\n  definitions: [\n    {\n      kind: 'OperationDefinition',\n      operation: 'mutation',\n      name: {\n        kind: 'Name',\n        value: 'containers_Bucket_PackageDialog_gql_PackageConstruct',\n      },\n      variableDefinitions: [\n        {\n          kind: 'VariableDefinition',\n          variable: { kind: 'Variable', name: { kind: 'Name', value: 'params' } },\n          type: {\n            kind: 'NonNullType',\n            type: {\n              kind: 'NamedType',\n              name: { kind: 'Name', value: 'PackagePushParams' },\n            },\n          },\n        },\n        {\n          kind: 'VariableDefinition',\n          variable: { kind: 'Variable', name: { kind: 'Name', value: 'src' } },\n          type: {\n            kind: 'NonNullType',\n            type: {\n              kind: 'NamedType',\n              name: { kind: 'Name', value: 'PackageConstructSource' },\n            },\n          },\n        },\n      ],\n      selectionSet: {\n        kind: 'SelectionSet',\n        selections: [\n          {\n            kind: 'Field',\n            name: { kind: 'Name', value: 'packageConstruct' },\n            arguments: [\n              {\n                kind: 'Argument',\n                name: { kind: 'Name', value: 'params' },\n                value: { kind: 'Variable', name: { kind: 'Name', value: 'params' } },\n              },\n              {\n                kind: 'Argument',\n                name: { kind: 'Name', value: 'src' },\n                value: { kind: 'Variable', name: { kind: 'Name', value: 'src' } },\n              },\n            ],\n            selectionSet: {\n              kind: 'SelectionSet',\n              selections: [\n                { kind: 'Field', name: { kind: 'Name', value: '__typename' } },\n                {\n                  kind: 'FragmentSpread',\n                  name: { kind: 'Name', value: 'PackagePushSuccessSelection' },\n                },\n                {\n                  kind: 'FragmentSpread',\n                  name: { kind: 'Name', value: 'InvalidInputSelection' },\n                },\n                {\n                  kind: 'FragmentSpread',\n                  name: { kind: 'Name', value: 'OperationErrorSelection' },\n                },\n              ],\n            },\n          },\n        ],\n      },\n    },\n    ...PackagePushSuccessSelectionFragmentDoc.definitions,\n    ...InvalidInputSelectionFragmentDoc.definitions,\n    ...OperationErrorSelectionFragmentDoc.definitions,\n  ],\n} as unknown as DocumentNode<\n  containers_Bucket_PackageDialog_gql_PackageConstructMutation,\n  containers_Bucket_PackageDialog_gql_PackageConstructMutationVariables\n>\n\nexport { containers_Bucket_PackageDialog_gql_PackageConstructDocument as default }\n","import type { ErrorObject } from 'ajv'\nimport cx from 'classnames'\nimport * as FF from 'final-form'\nimport * as FP from 'fp-ts'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport * as RF from 'react-final-form'\nimport * as urql from 'urql'\nimport * as M from '@material-ui/core'\n\nimport * as Intercom from 'components/Intercom'\nimport JsonValidationErrors from 'components/JsonValidationErrors'\nimport * as AddToPackage from 'containers/AddToPackage'\nimport * as Model from 'model'\nimport * as AWS from 'utils/AWS'\nimport AsyncResult from 'utils/AsyncResult'\nimport * as BucketPreferences from 'utils/BucketPreferences'\nimport * as Config from 'utils/Config'\nimport * as Data from 'utils/Data'\nimport * as Dialogs from 'utils/Dialogs'\nimport assertNever from 'utils/assertNever'\nimport { mkFormError, mapInputErrors } from 'utils/formTools'\nimport * as s3paths from 'utils/s3paths'\nimport * as tagged from 'utils/taggedV2'\nimport * as Types from 'utils/types'\nimport * as validators from 'utils/validators'\nimport * as workflows from 'utils/workflows'\n\nimport * as Download from '../Download'\nimport * as Successors from '../Successors'\nimport * as Upload from '../Upload'\nimport * as requests from '../requests'\n\nimport DialogError from './DialogError'\nimport DialogLoading from './DialogLoading'\nimport DialogSuccess, { DialogSuccessRenderMessageProps } from './DialogSuccess'\nimport * as FI from './FilesInput'\nimport * as Layout from './Layout'\nimport * as MI from './MetaInput'\nimport * as PD from './PackageDialog'\nimport { isS3File } from './S3FilePicker'\nimport { FormSkeleton, MetaInputSkeleton } from './Skeleton'\nimport SubmitSpinner from './SubmitSpinner'\nimport { useUploads } from './Uploads'\nimport PACKAGE_CONSTRUCT from './gql/PackageConstruct.generated'\nimport { Manifest, EMPTY_MANIFEST_ENTRIES, useManifest } from './Manifest'\n\nconst CANCEL = 'cancel'\nconst README_PATH = 'README.md'\n\ntype PartialPackageEntry = Types.AtLeast<Model.PackageEntry, 'physicalKey'>\n\n// TODO: use tree as the main data model / source of truth?\nexport interface LocalEntry {\n  path: string\n  file: FI.LocalFile\n}\n\nexport interface S3Entry {\n  path: string\n  file: Model.S3File\n}\n\nexport interface PackageCreationSuccess {\n  name: string\n  hash?: string\n}\n\nfunction createReadmeFile(name: string) {\n  const contents = [\n    `# ${name}`,\n    '\\n\\n',\n    `Stub README for the **${name}** package generated by Quilt Catalog`,\n    '\\n',\n  ]\n  const f = new File(contents, README_PATH, { type: 'text/markdown' })\n  return FI.computeHash(f) as FI.LocalFile\n}\n\n// XXX: move to dialogs module\ninterface DialogsOpenProps {\n  close: (reason?: string) => void\n}\n\nfunction ConfirmReadme({ close }: DialogsOpenProps) {\n  return (\n    <>\n      <M.DialogTitle>Add a README file?</M.DialogTitle>\n      <M.DialogContent>\n        <M.DialogContentText>\n          You are about to push an empty package.\n          <br />\n          Would you like to add a stub <b>README.md</b> file?\n        </M.DialogContentText>\n      </M.DialogContent>\n      <M.DialogActions>\n        <M.Button onClick={() => close('cancel')} color=\"primary\">\n          Cancel\n        </M.Button>\n        <M.Button onClick={() => close('empty')} color=\"primary\" variant=\"outlined\">\n          Continue with empty package\n        </M.Button>\n        <M.Button onClick={() => close('readme')} color=\"primary\" variant=\"contained\">\n          Add README.md\n        </M.Button>\n      </M.DialogActions>\n    </>\n  )\n}\n\ninterface FormErrorProps {\n  submitting: boolean\n  error: React.ReactNode\n}\n\nfunction FormError({ submitting, error }: FormErrorProps) {\n  if (submitting || !error || error === CANCEL) return null\n  return (\n    <M.Box flexGrow={1} display=\"flex\" alignItems=\"center\" pl={2}>\n      <M.Icon color=\"error\">error_outline</M.Icon>\n      <M.Box pl={1} />\n      <M.Typography variant=\"body2\" color=\"error\">\n        {error}\n      </M.Typography>\n    </M.Box>\n  )\n}\n\nconst useStyles = M.makeStyles((t) => ({\n  files: {\n    height: '100%',\n  },\n  filesWithError: {\n    height: `calc(90% - ${t.spacing()}px)`,\n  },\n  filesError: {\n    marginTop: t.spacing(),\n    maxHeight: t.spacing(9),\n    overflowY: 'auto',\n  },\n  form: {\n    height: '100%',\n  },\n  meta: {\n    display: 'flex',\n    flexDirection: 'column',\n    paddingTop: t.spacing(3),\n    overflowY: 'auto',\n  },\n}))\n\ninterface PackageCreationFormProps {\n  bucket: string\n  close: () => void\n  initial?: {\n    name?: string\n    meta?: Types.JsonRecord\n    workflowId?: string\n    entries?: Model.PackageContentsFlatMap\n    path?: string\n  }\n  successor: workflows.Successor\n  onSuccessor: (successor: workflows.Successor) => void\n  setSubmitting: (submitting: boolean) => void\n  setSuccess: (success: PackageCreationSuccess) => void\n  setWorkflow: (workflow: workflows.Workflow) => void\n  sourceBuckets: BucketPreferences.SourceBuckets\n  workflowsConfig: workflows.WorkflowsConfig\n  delayHashing: boolean\n  disableStateDisplay: boolean\n  ui?: {\n    title?: React.ReactNode\n    submit?: React.ReactNode\n    resetFiles?: React.ReactNode\n  }\n}\n\nfunction PackageCreationForm({\n  bucket,\n  close,\n  initial,\n  successor,\n  onSuccessor,\n  responseError,\n  schema,\n  schemaLoading,\n  selectedWorkflow,\n  setSubmitting,\n  setSuccess,\n  setWorkflow,\n  sourceBuckets,\n  validate: validateMetaInput,\n  workflowsConfig,\n  delayHashing,\n  disableStateDisplay,\n  ui = {},\n}: PackageCreationFormProps & PD.SchemaFetcherRenderProps) {\n  const addToPackage = AddToPackage.use()\n  const nameValidator = PD.useNameValidator(selectedWorkflow)\n  const nameExistence = PD.useNameExistence(successor.slug)\n  const [nameWarning, setNameWarning] = React.useState<React.ReactNode>('')\n  const [metaHeight, setMetaHeight] = React.useState(0)\n  const { desktop }: { desktop: boolean } = Config.use()\n  const classes = useStyles()\n  const dialogContentClasses = PD.useContentStyles({ metaHeight })\n  const validateWorkflow = PD.useWorkflowValidator(workflowsConfig)\n\n  const dialogs = Dialogs.use()\n\n  const [entriesError, setEntriesError] = React.useState<(Error | ErrorObject)[] | null>(\n    null,\n  )\n\n  const [selectedBucket, selectBucket] = React.useState(sourceBuckets.getDefault)\n\n  const existingEntries = initial?.entries ?? EMPTY_MANIFEST_ENTRIES\n\n  const initialFiles: FI.FilesState = React.useMemo(\n    () => ({\n      existing: existingEntries,\n      added: addToPackage?.entries || {},\n      deleted: {},\n    }),\n    [existingEntries, addToPackage],\n  )\n\n  const uploads = useUploads()\n\n  const onFilesAction = React.useMemo(\n    () =>\n      FI.FilesAction.match({\n        _: () => {},\n        Revert: uploads.remove,\n        RevertDir: uploads.removeByPrefix,\n        Reset: uploads.reset,\n      }),\n    [uploads],\n  )\n\n  const [, constructPackage] = urql.useMutation(PACKAGE_CONSTRUCT)\n  const validateEntries = PD.useEntriesValidator(selectedWorkflow)\n\n  const uploadPackage = Upload.useUploadPackage()\n\n  interface SubmitArgs {\n    name: string\n    msg: string\n    meta: {}\n    localFolder?: string\n    workflow: workflows.Workflow\n  }\n  interface SubmitWebArgs extends SubmitArgs {\n    files: FI.FilesState\n  }\n  interface SubmitElectronArgs extends SubmitArgs {\n    localFolder: string\n  }\n\n  const onSubmitElectron = React.useCallback(\n    async ({ name, msg, localFolder, meta, workflow }: SubmitElectronArgs) => {\n      const payload = {\n        entry: localFolder || '',\n        message: msg,\n        meta,\n        workflow,\n      }\n      const uploadResult = await uploadPackage(\n        payload,\n        { name, bucket: successor.slug },\n        schema,\n      )\n      setSuccess({ name, hash: uploadResult?.hash })\n      return null\n    },\n    [successor.slug, schema, setSuccess, uploadPackage],\n  )\n\n  const onSubmitWeb = async ({ name, msg, files, meta, workflow }: SubmitWebArgs) => {\n    const addedS3Entries: S3Entry[] = []\n    const addedLocalEntries: LocalEntry[] = []\n    Object.entries(files.added).forEach(([path, file]) => {\n      if (isS3File(file)) {\n        addedS3Entries.push({ path, file })\n      } else {\n        addedLocalEntries.push({ path, file })\n      }\n    })\n\n    const toUpload = addedLocalEntries.filter(({ path, file }) => {\n      const e = files.existing[path]\n      return !e || e.hash !== file.hash.value\n    })\n\n    const entries = FP.function.pipe(\n      R.mergeLeft(files.added, files.existing),\n      R.omit(Object.keys(files.deleted)),\n      Object.entries,\n      R.map(([path, file]) => ({\n        logical_key: path,\n        size: file.size,\n      })),\n    )\n\n    if (!entries.length) {\n      const reason = await dialogs.open((props: DialogsOpenProps) => (\n        <ConfirmReadme {...props} />\n      ))\n      if (reason === 'cancel') return mkFormError(CANCEL)\n      if (reason === 'readme') {\n        const file = createReadmeFile(name)\n        entries.push({ logical_key: README_PATH, size: file.size })\n        toUpload.push({ path: README_PATH, file })\n      }\n    }\n\n    const error = await validateEntries(entries)\n    if (error && error.length) {\n      setEntriesError(error)\n      return {\n        files: 'schema',\n      }\n    }\n\n    let uploadedEntries\n    try {\n      uploadedEntries = await uploads.upload({\n        files: toUpload,\n        bucket: successor.slug,\n        prefix: name,\n        getMeta: (path) => files.existing[path]?.meta || files.added[path]?.meta,\n      })\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error('Error uploading files:')\n      // eslint-disable-next-line no-console\n      console.error(e)\n      return mkFormError(PD.ERROR_MESSAGES.UPLOAD)\n    }\n\n    const s3Entries = FP.function.pipe(\n      addedS3Entries,\n      R.map(\n        ({ path, file }) =>\n          [path, { physicalKey: s3paths.handleToS3Url(file) }] as R.KeyValuePair<\n            string,\n            PartialPackageEntry\n          >,\n      ),\n      R.fromPairs,\n    )\n\n    const allEntries = FP.function.pipe(\n      files.existing,\n      R.omit(Object.keys(files.deleted)),\n      R.mergeLeft(uploadedEntries),\n      R.mergeLeft(s3Entries),\n      R.toPairs,\n      R.map(([logicalKey, data]: [string, PartialPackageEntry]) => ({\n        logicalKey,\n        physicalKey: data.physicalKey,\n        hash: data.hash ?? null,\n        meta: data.meta ?? null,\n        size: data.size ?? null,\n      })),\n      R.sortBy(R.prop('logicalKey')),\n    )\n\n    try {\n      const res = await constructPackage({\n        params: {\n          bucket: successor.slug,\n          name,\n          message: msg,\n          userMeta: requests.getMetaValue(meta, schema) ?? null,\n          workflow:\n            // eslint-disable-next-line no-nested-ternary\n            workflow.slug === workflows.notAvailable\n              ? null\n              : workflow.slug === workflows.notSelected\n              ? ''\n              : workflow.slug,\n        },\n        src: {\n          entries: allEntries,\n        },\n      })\n      if (res.error) throw res.error\n      if (!res.data) throw new Error('No data returned by the API')\n      const r = res.data.packageConstruct\n      switch (r.__typename) {\n        case 'PackagePushSuccess':\n          setSuccess({ name, hash: r.revision.hash })\n          return\n        case 'OperationError':\n          return mkFormError(r.message)\n        case 'InvalidInput':\n          return mapInputErrors(r.errors, { 'src.entries': 'files' })\n        default:\n          assertNever(r)\n      }\n    } catch (e: any) {\n      // eslint-disable-next-line no-console\n      console.error('Error creating manifest:')\n      // eslint-disable-next-line no-console\n      console.error(e)\n      return mkFormError(\n        e.message ? `Unexpected error: ${e.message}` : PD.ERROR_MESSAGES.MANIFEST,\n      )\n    }\n  }\n\n  const onSubmitWrapped = async (args: SubmitWebArgs | SubmitElectronArgs) => {\n    setSubmitting(true)\n    try {\n      if (desktop) {\n        return await onSubmitElectron(args as SubmitElectronArgs)\n      }\n      return await onSubmitWeb(args as SubmitWebArgs)\n    } finally {\n      addToPackage?.clear()\n      setSubmitting(false)\n    }\n  }\n\n  const handleNameChange = React.useCallback(\n    async (name) => {\n      const nameExists = await nameExistence.validate(name)\n      const warning = <PD.PackageNameWarning exists={!!nameExists} />\n\n      if (warning !== nameWarning) {\n        setNameWarning(warning)\n      }\n    },\n    [nameWarning, nameExistence],\n  )\n\n  const [editorElement, setEditorElement] = React.useState<HTMLDivElement | null>(null)\n  const resizeObserver = React.useMemo(\n    () =>\n      new window.ResizeObserver((entries) => {\n        const { height } = entries[0]!.contentRect\n        setMetaHeight(height)\n      }),\n    [setMetaHeight],\n  )\n  const onFormChange = React.useCallback(\n    async ({ dirtyFields, values }) => {\n      if (dirtyFields?.name) handleNameChange(values.name)\n      if (dirtyFields?.files) setEntriesError(null)\n    },\n    [handleNameChange],\n  )\n\n  React.useEffect(() => {\n    if (editorElement) resizeObserver.observe(editorElement)\n    return () => {\n      if (editorElement) resizeObserver.unobserve(editorElement)\n    }\n  }, [editorElement, resizeObserver])\n\n  const validateFiles = React.useMemo(\n    () => (delayHashing ? () => {} : FI.validateHashingComplete),\n    [delayHashing],\n  )\n\n  // HACK: FIXME: it triggers name validation with correct workflow\n  const [hideMeta, setHideMeta] = React.useState(false)\n\n  // TODO: move useLocalFolder to its own component shared by Download and Upload\n  const [defaultLocalFolder] = Download.useLocalFolder()\n\n  return (\n    <RF.Form\n      onSubmit={onSubmitWrapped}\n      subscription={{\n        error: true,\n        hasValidationErrors: true,\n        submitError: true,\n        submitFailed: true,\n        submitting: true,\n      }}\n      validate={PD.useCryptoApiValidation()}\n    >\n      {({\n        error,\n        hasValidationErrors,\n        submitError,\n        submitFailed,\n        submitting,\n        handleSubmit,\n      }) => (\n        <>\n          {dialogs.render({ fullWidth: true, maxWidth: 'sm' })}\n          <M.DialogTitle>\n            {ui.title || 'Create package'} in{' '}\n            <Successors.Dropdown\n              bucket={bucket || ''}\n              successor={successor}\n              onChange={onSuccessor}\n            />{' '}\n            bucket\n          </M.DialogTitle>\n          <M.DialogContent classes={dialogContentClasses}>\n            <form className={classes.form} onSubmit={handleSubmit}>\n              <RF.FormSpy\n                subscription={{ dirtyFields: true, values: true }}\n                onChange={onFormChange}\n              />\n\n              <RF.FormSpy\n                subscription={{ modified: true, values: true }}\n                onChange={({ modified, values }) => {\n                  if (modified!.workflow && values.workflow !== selectedWorkflow) {\n                    setWorkflow(values.workflow)\n\n                    // HACK: FIXME: it triggers name validation with correct workflow\n                    setHideMeta(true)\n                    setTimeout(() => {\n                      setHideMeta(false)\n                    }, 300)\n                  }\n                }}\n              />\n\n              <Layout.Container>\n                <Layout.LeftColumn>\n                  <RF.Field\n                    component={PD.WorkflowInput}\n                    bucket={bucket}\n                    name=\"workflow\"\n                    workflowsConfig={workflowsConfig}\n                    initialValue={selectedWorkflow}\n                    validate={validateWorkflow}\n                    validateFields={['meta', 'workflow']}\n                    errors={{\n                      required: 'Workflow is required for this bucket.',\n                    }}\n                  />\n\n                  <RF.Field\n                    component={PD.PackageNameInput}\n                    workflow={selectedWorkflow || workflowsConfig}\n                    initialValue={initial?.name}\n                    name=\"name\"\n                    validate={validators.composeAsync(\n                      validators.required,\n                      nameValidator.validate,\n                    )}\n                    validateFields={['name']}\n                    errors={{\n                      required: 'Enter a package name',\n                      invalid: 'Invalid package name',\n                      pattern: `Name should match ${selectedWorkflow?.packageNamePattern}`,\n                    }}\n                    helperText={nameWarning}\n                    validating={nameValidator.processing}\n                  />\n\n                  <RF.Field\n                    component={PD.CommitMessageInput}\n                    name=\"msg\"\n                    validate={validators.required as FF.FieldValidator<string>}\n                    validateFields={['msg']}\n                    errors={{\n                      required: 'Enter a commit message',\n                    }}\n                  />\n\n                  {schemaLoading || hideMeta ? (\n                    <MetaInputSkeleton className={classes.meta} ref={setEditorElement} />\n                  ) : (\n                    <RF.Field\n                      className={classes.meta}\n                      component={MI.MetaInput}\n                      name=\"meta\"\n                      bucket={bucket}\n                      schema={schema}\n                      schemaError={responseError}\n                      validate={validateMetaInput}\n                      validateFields={['meta']}\n                      isEqual={R.equals}\n                      initialValue={initial?.meta || MI.EMPTY_META_VALUE}\n                      ref={setEditorElement}\n                    />\n                  )}\n                </Layout.LeftColumn>\n\n                <Layout.RightColumn>\n                  {desktop ? (\n                    <RF.Field\n                      className={cx(classes.files, {\n                        [classes.filesWithError]: !!entriesError,\n                      })}\n                      component={Upload.LocalFolderInput}\n                      initialValue={defaultLocalFolder}\n                      name=\"localFolder\"\n                      title=\"Local directory\"\n                      errors={{\n                        required: 'Add directory to create a package',\n                      }}\n                      validate={validators.required as FF.FieldValidator<string>}\n                    />\n                  ) : (\n                    <RF.Field\n                      className={cx(classes.files, {\n                        [classes.filesWithError]: !!entriesError,\n                      })}\n                      // @ts-expect-error\n                      component={FI.FilesInput}\n                      name=\"files\"\n                      validate={validateFiles as FF.FieldValidator<$TSFixMe>}\n                      validateFields={['files']}\n                      errors={{\n                        schema: 'Files should match schema',\n                        [FI.HASHING]: 'Please wait while we hash the files',\n                        [FI.HASHING_ERROR]:\n                          'Error hashing files, probably some of them are too large. Please try again or contact support.',\n                      }}\n                      totalProgress={uploads.progress}\n                      title=\"Files\"\n                      onFilesAction={onFilesAction}\n                      isEqual={R.equals}\n                      initialValue={initialFiles}\n                      bucket={selectedBucket}\n                      buckets={sourceBuckets.list}\n                      selectBucket={selectBucket}\n                      delayHashing={delayHashing}\n                      disableStateDisplay={disableStateDisplay}\n                      ui={{ reset: ui.resetFiles }}\n                      initialS3Path={initial?.path}\n                    />\n                  )}\n\n                  <JsonValidationErrors\n                    className={classes.filesError}\n                    error={entriesError}\n                  />\n                </Layout.RightColumn>\n              </Layout.Container>\n\n              <input type=\"submit\" style={{ display: 'none' }} />\n            </form>\n          </M.DialogContent>\n          <M.DialogActions>\n            {submitting && (\n              <SubmitSpinner value={uploads.progress.percent}>\n                {uploads.progress.percent < 100 ? 'Uploading files' : 'Writing manifest'}\n              </SubmitSpinner>\n            )}\n\n            <FormError submitting={submitting} error={error || submitError} />\n\n            <M.Button onClick={close} disabled={submitting}>\n              Cancel\n            </M.Button>\n            <M.Button\n              onClick={handleSubmit}\n              variant=\"contained\"\n              color=\"primary\"\n              disabled={submitting || (submitFailed && hasValidationErrors)}\n            >\n              {ui.submit || 'Create'}\n            </M.Button>\n          </M.DialogActions>\n        </>\n      )}\n    </RF.Form>\n  )\n}\n\nfunction prependSourceBucket(\n  buckets: BucketPreferences.SourceBuckets,\n  bucket: string,\n): BucketPreferences.SourceBuckets {\n  return {\n    getDefault: () => bucket,\n    list: R.prepend(bucket, buckets.list),\n  }\n}\n\nconst DialogState = tagged.create(\n  'app/containers/Bucket/PackageDialog/PackageCreationForm:DialogState' as const,\n  {\n    Closed: () => {},\n    Loading: () => {},\n    Error: (e: Error) => e,\n    Form: (v: {\n      manifest?: Manifest\n      workflowsConfig: workflows.WorkflowsConfig\n      sourceBuckets: BucketPreferences.SourceBuckets\n    }) => v,\n    Success: (v: PackageCreationSuccess) => v,\n  },\n)\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\ntype DialogState = tagged.InstanceOf<typeof DialogState>\n\nconst EMPTY_MANIFEST_RESULT = AsyncResult.Ok()\n\ninterface PackageCreationDialogUIOptions {\n  resetFiles?: React.ReactNode\n  submit?: React.ReactNode\n  successBrowse?: React.ReactNode\n  successRenderMessage?: (props: DialogSuccessRenderMessageProps) => React.ReactNode\n  successTitle?: React.ReactNode\n  title?: React.ReactNode\n}\n\ninterface UsePackageCreationDialogProps {\n  bucket: string\n  src?: {\n    name: string\n    hash?: string\n  }\n  initialOpen?: boolean\n  delayHashing?: boolean\n  disableStateDisplay?: boolean\n}\n\n// TODO: package can be created from some `src`:\n//         * s3 directory\n//         * existing package\n//       and pushed to `dst` (or maybe just `successor`):\n//         * successor\nexport function usePackageCreationDialog({\n  bucket, // TODO: put it to dst; and to src if needed (as PackageHandle)\n  src,\n  initialOpen,\n  delayHashing = false,\n  disableStateDisplay = false,\n}: UsePackageCreationDialogProps) {\n  const [isOpen, setOpen] = React.useState(initialOpen || false)\n  const [exited, setExited] = React.useState(!isOpen)\n  // TODO: put it to src as S3Handle\n  const [s3Path, setS3Path] = React.useState<string | undefined>()\n  const [success, setSuccess] = React.useState<PackageCreationSuccess | false>(false)\n  const [submitting, setSubmitting] = React.useState(false)\n  const [workflow, setWorkflow] = React.useState<workflows.Workflow>()\n  // TODO: move to props: { dst: { successor }, onSuccessorChange }\n  const [successor, setSuccessor] = React.useState({\n    slug: bucket,\n  } as workflows.Successor)\n  const addToPackage = AddToPackage.use()\n\n  const s3 = AWS.S3.use()\n  const workflowsData = Data.use(\n    requests.workflowsConfig,\n    { s3, bucket: successor.slug },\n    { noAutoFetch: !bucket },\n  )\n  // XXX: use AsyncResult\n  const { preferences } = BucketPreferences.use()\n\n  const manifestData = useManifest({\n    bucket,\n    // this only gets passed when src is defined, so it should be always non-null when the query gets executed\n    name: src?.name!,\n    hash: src?.hash,\n    pause: !(src && isOpen),\n  })\n\n  const manifestResult = src ? manifestData.result : EMPTY_MANIFEST_RESULT\n\n  // AsyncResult<Model.PackageContentsFlatMap | undefined>\n  const data = React.useMemo(\n    () =>\n      workflowsData.case({\n        Ok: (workflowsConfig: workflows.WorkflowsConfig) =>\n          AsyncResult.case(\n            {\n              Ok: (manifest: Manifest | undefined) =>\n                preferences\n                  ? AsyncResult.Ok({\n                      manifest,\n                      workflowsConfig,\n                      sourceBuckets:\n                        s3Path === undefined\n                          ? preferences.ui.sourceBuckets\n                          : prependSourceBucket(preferences.ui.sourceBuckets, bucket),\n                    })\n                  : AsyncResult.Pending(),\n              _: R.identity,\n            },\n            manifestResult,\n          ),\n        _: R.identity,\n      }),\n    [bucket, s3Path, workflowsData, manifestResult, preferences],\n  )\n\n  const open = React.useCallback(\n    (initial?: { successor?: workflows.Successor; path?: string }) => {\n      if (initial?.successor) {\n        setSuccessor(initial?.successor)\n      }\n      if (initial?.path !== undefined) {\n        setS3Path(initial?.path)\n      }\n\n      setOpen(true)\n      setExited(false)\n    },\n    [setOpen, setExited],\n  )\n\n  const close = React.useCallback(() => {\n    if (submitting) return\n    setOpen(false)\n    setWorkflow(undefined) // TODO: is this necessary?\n    addToPackage?.clear()\n  }, [addToPackage, submitting, setOpen])\n\n  const handleExited = React.useCallback(() => {\n    setExited(true)\n    setSuccess(false)\n  }, [setExited, setSuccess])\n\n  Intercom.usePauseVisibilityWhen(isOpen)\n\n  const state = React.useMemo<DialogState>(() => {\n    if (exited) return DialogState.Closed()\n    if (success) return DialogState.Success(success)\n    return AsyncResult.case(\n      {\n        Ok: DialogState.Form,\n        Err: DialogState.Error,\n        _: DialogState.Loading,\n      },\n      data,\n    )\n  }, [exited, success, data])\n\n  const render = (ui: PackageCreationDialogUIOptions = {}) => (\n    <PD.DialogWrapper\n      exited={exited}\n      fullWidth\n      maxWidth={success ? 'sm' : 'lg'}\n      onClose={close}\n      onExited={handleExited}\n      open={isOpen}\n      scroll=\"body\"\n    >\n      {DialogState.match(\n        {\n          Closed: () => null,\n          Loading: () => (\n            <DialogLoading\n              skeletonElement={<FormSkeleton />}\n              title=\"Fetching package manifest. One moment…\"\n              submitText={ui.submit}\n              onCancel={close}\n            />\n          ),\n          Error: (e) => (\n            <DialogError\n              bucket={bucket}\n              error={e}\n              skeletonElement={<FormSkeleton animate={false} />}\n              title={ui.title || 'Create package'}\n              submitText={ui.submit}\n              onCancel={close}\n            />\n          ),\n          Form: ({ manifest, workflowsConfig, sourceBuckets }) => (\n            <PD.SchemaFetcher\n              initialWorkflowId={manifest?.workflowId}\n              workflowsConfig={workflowsConfig}\n              workflow={workflow}\n            >\n              {(schemaProps) => (\n                <PackageCreationForm\n                  {...schemaProps}\n                  {...{\n                    bucket,\n                    successor,\n                    close,\n                    setSubmitting,\n                    setSuccess,\n                    setWorkflow,\n                    workflowsConfig,\n                    sourceBuckets,\n                    initial: { name: src?.name, path: s3Path, ...manifest },\n                    delayHashing,\n                    disableStateDisplay,\n                    onSuccessor: setSuccessor,\n                    ui: {\n                      title: ui.title,\n                      submit: ui.submit,\n                      resetFiles: ui.resetFiles,\n                    },\n                  }}\n                />\n              )}\n            </PD.SchemaFetcher>\n          ),\n          Success: (props) => (\n            <DialogSuccess\n              {...props}\n              bucket={successor.slug}\n              onClose={close}\n              browseText={ui.successBrowse}\n              title={ui.successTitle}\n              renderMessage={ui.successRenderMessage}\n            />\n          ),\n        },\n        state,\n      )}\n    </PD.DialogWrapper>\n  )\n\n  return { open, close, render }\n}\n","import * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport { docs } from 'constants/urls'\nimport * as workflows from 'utils/workflows'\n\nimport WorkflowsConfigLink from '../WorkflowsConfigLink'\n\nconst useStyles = M.makeStyles((t) => ({\n  crop: {\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n  },\n  error: {\n    marginRight: t.spacing(1),\n  },\n  spinner: {\n    flex: 'none',\n    marginRight: t.spacing(3),\n  },\n}))\n\ninterface SelectWorkflowProps {\n  bucket: string\n  disabled?: boolean\n  error?: React.ReactNode\n  items: workflows.Workflow[]\n  onChange: (v: workflows.Workflow) => void\n  value: workflows.Workflow\n}\n\nexport default function SelectWorkflow({\n  bucket,\n  disabled,\n  error,\n  items,\n  onChange,\n  value,\n}: SelectWorkflowProps) {\n  const classes = useStyles()\n\n  const noChoice = items.length === 1\n\n  return (\n    <M.FormControl disabled={disabled || noChoice} fullWidth size=\"small\" error={!!error}>\n      <M.InputLabel id=\"schema-select\" shrink>\n        Workflow\n      </M.InputLabel>\n      <M.Select\n        labelId=\"schema-select\"\n        value={value ? value.slug.toString() : workflows.notSelected.toString()}\n      >\n        {items.map((workflow) => (\n          <M.MenuItem\n            key={workflow.slug.toString()}\n            value={workflow.slug.toString()}\n            onClick={() => !workflow.isDisabled && onChange(workflow)}\n            disabled={workflow.isDisabled}\n            dense\n          >\n            <M.ListItemText\n              classes={{\n                primary: classes.crop,\n                secondary: classes.crop,\n              }}\n              primary={workflow.name || 'None'}\n              secondary={workflow.description}\n            />\n          </M.MenuItem>\n        ))}\n      </M.Select>\n      <M.FormHelperText>\n        {!!error && <span className={classes.error}>{error}</span>}\n        <M.Link href={`${docs}/advanced/workflows`} target=\"_blank\">\n          Learn about data quality workflows\n        </M.Link>\n        , or edit{' '}\n        <WorkflowsConfigLink bucket={bucket}>\n          your workflows config file\n        </WorkflowsConfigLink>\n      </M.FormHelperText>\n    </M.FormControl>\n  )\n}\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport type { TypedDocumentNode as DocumentNode } from '@graphql-typed-document-node/core'\nimport * as Types from '../../../../model/graphql/types.generated'\n\nexport type containers_Bucket_PackageDialog_gql_PackageExistsQueryVariables =\n  Types.Exact<{\n    bucket: Types.Scalars['String']\n    name: Types.Scalars['String']\n  }>\n\nexport type containers_Bucket_PackageDialog_gql_PackageExistsQuery = {\n  readonly __typename: 'Query'\n} & {\n  readonly package: Types.Maybe<\n    { readonly __typename: 'Package' } & Pick<Types.Package, 'name'>\n  >\n}\n\nexport const containers_Bucket_PackageDialog_gql_PackageExistsDocument = {\n  kind: 'Document',\n  definitions: [\n    {\n      kind: 'OperationDefinition',\n      operation: 'query',\n      name: { kind: 'Name', value: 'containers_Bucket_PackageDialog_gql_PackageExists' },\n      variableDefinitions: [\n        {\n          kind: 'VariableDefinition',\n          variable: { kind: 'Variable', name: { kind: 'Name', value: 'bucket' } },\n          type: {\n            kind: 'NonNullType',\n            type: { kind: 'NamedType', name: { kind: 'Name', value: 'String' } },\n          },\n        },\n        {\n          kind: 'VariableDefinition',\n          variable: { kind: 'Variable', name: { kind: 'Name', value: 'name' } },\n          type: {\n            kind: 'NonNullType',\n            type: { kind: 'NamedType', name: { kind: 'Name', value: 'String' } },\n          },\n        },\n      ],\n      selectionSet: {\n        kind: 'SelectionSet',\n        selections: [\n          {\n            kind: 'Field',\n            name: { kind: 'Name', value: 'package' },\n            arguments: [\n              {\n                kind: 'Argument',\n                name: { kind: 'Name', value: 'bucket' },\n                value: { kind: 'Variable', name: { kind: 'Name', value: 'bucket' } },\n              },\n              {\n                kind: 'Argument',\n                name: { kind: 'Name', value: 'name' },\n                value: { kind: 'Variable', name: { kind: 'Name', value: 'name' } },\n              },\n            ],\n            selectionSet: {\n              kind: 'SelectionSet',\n              selections: [\n                { kind: 'Field', name: { kind: 'Name', value: '__typename' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'name' } },\n              ],\n            },\n          },\n        ],\n      },\n    },\n  ],\n} as unknown as DocumentNode<\n  containers_Bucket_PackageDialog_gql_PackageExistsQuery,\n  containers_Bucket_PackageDialog_gql_PackageExistsQueryVariables\n>\n\nexport { containers_Bucket_PackageDialog_gql_PackageExistsDocument as default }\n","import { basename } from 'path'\n\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport type * as RF from 'react-final-form'\nimport * as redux from 'react-redux'\nimport * as urql from 'urql'\nimport * as M from '@material-ui/core'\n\nimport * as authSelectors from 'containers/Auth/selectors'\nimport { useData } from 'utils/Data'\nimport * as APIConnector from 'utils/APIConnector'\nimport * as AWS from 'utils/AWS'\nimport * as Sentry from 'utils/Sentry'\nimport { mkFormError } from 'utils/formTools'\nimport {\n  JsonSchema,\n  makeSchemaDefaultsSetter,\n  makeSchemaValidator,\n} from 'utils/json-schema'\nimport * as packageHandleUtils from 'utils/packageHandle'\nimport * as s3paths from 'utils/s3paths'\nimport * as workflows from 'utils/workflows'\n\nimport * as requests from '../requests'\nimport SelectWorkflow from './SelectWorkflow'\nimport PACKAGE_EXISTS_QUERY from './gql/PackageExists.generated'\n\nexport const MAX_UPLOAD_SIZE = 20 * 1000 * 1000 * 1000 // 20GB\nexport const MAX_S3_SIZE = 50 * 1000 * 1000 * 1000 // 50GB\nexport const MAX_FILE_COUNT = 1000\n\nexport const ERROR_MESSAGES = {\n  UPLOAD: 'Error uploading files',\n  MANIFEST: 'Error creating manifest',\n}\n\nexport const getNormalizedPath = (f: { path?: string; name: string }) => {\n  const p = f.path || f.name\n  return p.startsWith('/') ? p.substring(1) : p\n}\n\nexport async function hashFile(file: File) {\n  if (!window.crypto?.subtle?.digest) throw new Error('Crypto API unavailable')\n  const buf = await file.arrayBuffer()\n  // XXX: consider using hashwasm for stream-based hashing to support larger files\n  const hashBuf = await window.crypto.subtle.digest('SHA-256', buf)\n  return Array.from(new Uint8Array(hashBuf))\n    .map((b) => b.toString(16).padStart(2, '0'))\n    .join('')\n}\n\nfunction cacheDebounce<I extends [any, ...any[]], O, K extends string | number | symbol>(\n  fn: (...args: I) => Promise<O>,\n  wait: number,\n  getKey: (...args: I) => K = R.identity as unknown as (...args: I) => K,\n) {\n  type Resolver = (result: Promise<O>) => void\n  const cache = {} as Record<K, Promise<O>>\n  let timer: null | ReturnType<typeof setTimeout>\n  let resolveList: Resolver[] = []\n\n  return (...args: I) => {\n    const key = getKey(...args)\n    if (key in cache) return cache[key]\n\n    return new Promise((resolveNew: Resolver) => {\n      if (timer) clearTimeout(timer)\n\n      timer = setTimeout(() => {\n        timer = null\n\n        const result = fn(...args)\n        cache[key] = result\n\n        resolveList.forEach((resolve) => resolve(result))\n\n        resolveList = []\n      }, wait)\n\n      resolveList.push(resolveNew)\n    })\n  }\n}\n\ninterface ApiRequest {\n  <O>(opts: {\n    endpoint: string\n    method?: 'GET' | 'PUT' | 'POST' | 'DELETE' | 'HEAD'\n    body?: {}\n  }): Promise<O>\n}\n\nconst validateName = (req: ApiRequest) =>\n  cacheDebounce(async (name: string) => {\n    if (name) {\n      const res = await req<{ valid: boolean }>({\n        endpoint: '/package_name_valid',\n        method: 'POST',\n        body: { name },\n      })\n      if (!res.valid) return 'invalid'\n    }\n    return undefined\n  }, 200)\n\nexport function useNameValidator(workflow?: workflows.Workflow) {\n  const req: ApiRequest = APIConnector.use()\n  const [counter, setCounter] = React.useState(0)\n  const [processing, setProcessing] = React.useState(false)\n  const inc = React.useCallback(() => setCounter(R.inc), [setCounter])\n\n  const validator = React.useMemo(() => validateName(req), [req])\n\n  const validate = React.useCallback(\n    async (name: string) => {\n      if (workflow?.packageNamePattern?.test(name) === false) {\n        return 'pattern'\n      }\n\n      setProcessing(true)\n      try {\n        const error = await validator(name)\n        setProcessing(false)\n        return error\n      } catch (e) {\n        setProcessing(false)\n        return e instanceof Error ? (e.message as string) : ''\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [counter, validator, workflow?.packageNamePattern],\n  )\n\n  return React.useMemo(() => ({ validate, processing, inc }), [validate, processing, inc])\n}\n\nexport function useNameExistence(bucket: string) {\n  const [counter, setCounter] = React.useState(0)\n  const inc = React.useCallback(() => setCounter(R.inc), [setCounter])\n  const client = urql.useClient()\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const validate = React.useCallback(\n    cacheDebounce(async (name: string) => {\n      if (name) {\n        const res = await client\n          .query(\n            PACKAGE_EXISTS_QUERY,\n            { bucket, name },\n            { requestPolicy: 'network-only' },\n          )\n          .toPromise()\n        if (res.data?.package) return 'exists'\n      }\n      return undefined\n    }, 200),\n    [bucket, counter, client],\n  )\n\n  return React.useMemo(() => ({ validate, inc }), [validate, inc])\n}\n\nexport function mkMetaValidator(schema?: JsonSchema) {\n  // TODO: move schema validation to utils/validators\n  //       but don't forget that validation depends on library.\n  //       Maybe we should split validators to files at first\n  const schemaValidator = makeSchemaValidator(schema)\n  return function validateMeta(value: object | null) {\n    const jsonObjectErr = value && !R.is(Object, value)\n    if (jsonObjectErr) {\n      return new Error('Metadata must be a valid JSON object')\n    }\n\n    if (schema) {\n      const setDefaults = makeSchemaDefaultsSetter(schema)\n      const errors = schemaValidator(setDefaults(value || {}))\n      if (errors.length) return errors\n    }\n\n    return undefined\n  }\n}\n\nexport type MetaValidator = ReturnType<typeof mkMetaValidator>\n\ninterface FieldProps {\n  error?: string\n  helperText?: React.ReactNode\n  validating?: boolean\n}\n\nconst useFieldInputStyles = M.makeStyles({\n  root: {\n    // It hides M.CircularProgress (spinning square) overflow\n    overflow: 'hidden',\n  },\n})\n\n// TODO: re-use components/Form/TextField\nexport function Field({\n  error,\n  helperText,\n  validating,\n  ...rest\n}: FieldProps & M.TextFieldProps) {\n  const inputClasses = useFieldInputStyles()\n  const props = {\n    InputLabelProps: { shrink: true },\n    InputProps: {\n      endAdornment: validating && <M.CircularProgress size={20} />,\n      classes: inputClasses,\n    },\n    error: !!error,\n    helperText: error || helperText,\n    ...rest,\n  }\n  return <M.TextField {...props} />\n}\n\ninterface PackageNameInputOwnProps {\n  errors: Record<string, React.ReactNode>\n  input: RF.FieldInputProps<string>\n  directory?: string\n  meta: RF.FieldMetaState<string>\n  validating: boolean\n  workflow: { packageName: packageHandleUtils.NameTemplates }\n}\n\ntype PackageNameInputProps = PackageNameInputOwnProps &\n  Omit<Parameters<typeof Field>[0], keyof PackageNameInputOwnProps>\n\nexport function PackageNameInput({\n  errors,\n  input: { value, onChange },\n  meta,\n  workflow,\n  directory,\n  validating,\n  ...rest\n}: PackageNameInputProps) {\n  const readyForValidation = (value && meta.modified) || meta.submitFailed\n  const errorCode = readyForValidation && meta.error\n  const error = errorCode ? errors[errorCode] || errorCode : ''\n  const [modified, setModified] = React.useState(!!(meta.modified || value))\n  const handleChange = React.useCallback(\n    (event) => {\n      setModified(true)\n      onChange(event)\n    },\n    [onChange, setModified],\n  )\n  const props = {\n    disabled: meta.submitting || meta.submitSucceeded,\n    error,\n    fullWidth: true,\n    label: 'Name',\n    margin: 'normal' as const,\n    onChange: handleChange,\n    placeholder: 'e.g. user/package',\n    // NOTE: react-form doesn't change `FormState.validating` on async validation when field loses focus\n    validating,\n    value,\n    ...rest,\n  }\n  const username = redux.useSelector(authSelectors.username)\n  React.useEffect(() => {\n    if (modified) return\n\n    const packageName = getDefaultPackageName(workflow, {\n      username,\n      directory,\n    })\n    if (!packageName) return\n\n    onChange({\n      target: {\n        value: packageName,\n      },\n    })\n  }, [directory, workflow, modified, onChange, username])\n  return <Field {...props} />\n}\n\ninterface CommitMessageInputOwnProps {\n  errors: Record<string, React.ReactNode>\n  input: RF.FieldInputProps<string>\n  meta: RF.FieldMetaState<string>\n}\n\ntype CommitMessageInputProps = CommitMessageInputOwnProps &\n  Omit<Parameters<typeof Field>[0], keyof CommitMessageInputOwnProps>\n\nexport function CommitMessageInput({\n  errors,\n  input,\n  meta,\n  ...rest\n}: CommitMessageInputProps) {\n  const errorCode = meta.submitFailed && meta.error\n  const error = errorCode ? errors[errorCode] || errorCode : ''\n  const props = {\n    disabled: meta.submitting || meta.submitSucceeded,\n    error,\n    fullWidth: true,\n    label: 'Message',\n    margin: 'normal' as const,\n    placeholder: 'Enter a commit message',\n    validating: meta.submitFailed && meta.validating,\n    ...input,\n    ...rest,\n  }\n  return <Field {...props} />\n}\n\ninterface WorkflowInputProps {\n  bucket: string\n  input: RF.FieldInputProps<workflows.Workflow>\n  meta: RF.FieldMetaState<workflows.Workflow>\n  workflowsConfig?: workflows.WorkflowsConfig\n  errors?: Record<string, React.ReactNode>\n}\n\nexport function WorkflowInput({\n  bucket,\n  input,\n  meta,\n  workflowsConfig,\n  errors = {},\n}: WorkflowInputProps) {\n  const disabled = meta.submitting || meta.submitSucceeded\n  const errorKey = meta.submitFailed && meta.error\n\n  return (\n    <SelectWorkflow\n      bucket={bucket}\n      items={workflowsConfig ? workflowsConfig.workflows : []}\n      onChange={input.onChange}\n      value={input.value}\n      disabled={disabled}\n      error={errorKey ? errors[errorKey] || errorKey : undefined}\n    />\n  )\n}\n\nexport const defaultWorkflowFromConfig = (cfg?: workflows.WorkflowsConfig) =>\n  cfg && cfg.workflows.find((item) => item.isDefault)\n\nexport function useWorkflowValidator(workflowsConfig?: workflows.WorkflowsConfig) {\n  return React.useMemo(\n    () => (workflow?: workflows.Workflow) => {\n      if (!workflowsConfig?.isWorkflowRequired) return undefined\n      if (workflow && workflow.slug !== workflows.notSelected) return undefined\n      return 'required'\n    },\n    [workflowsConfig?.isWorkflowRequired],\n  )\n}\n\nexport interface SchemaFetcherRenderPropsLoading {\n  responseError: undefined\n  schema: undefined\n  schemaLoading: true\n  selectedWorkflow: workflows.Workflow | undefined\n  validate: MetaValidator\n}\n\nexport interface SchemaFetcherRenderPropsSuccess {\n  responseError: undefined\n  schema?: JsonSchema\n  schemaLoading: false\n  selectedWorkflow: workflows.Workflow | undefined\n  validate: MetaValidator\n}\n\nexport interface SchemaFetcherRenderPropsError {\n  responseError: Error\n  schema: undefined\n  schemaLoading: false\n  selectedWorkflow: workflows.Workflow | undefined\n  validate: MetaValidator\n}\n\nexport type SchemaFetcherRenderProps =\n  | SchemaFetcherRenderPropsLoading\n  | SchemaFetcherRenderPropsSuccess\n  | SchemaFetcherRenderPropsError\n\nconst noopValidator: MetaValidator = () => undefined\n\ninterface SchemaFetcherProps {\n  initialWorkflowId?: string\n  workflow?: workflows.Workflow\n  workflowsConfig: workflows.WorkflowsConfig\n  children: (props: SchemaFetcherRenderProps) => React.ReactElement\n}\n\nexport function SchemaFetcher({\n  initialWorkflowId,\n  workflow,\n  workflowsConfig,\n  children,\n}: SchemaFetcherProps) {\n  const s3 = AWS.S3.use()\n  const sentry = Sentry.use()\n\n  const initialWorkflow = React.useMemo(() => {\n    // reuse workflow from previous revision if it's still present in the config\n    if (initialWorkflowId) {\n      const w = workflowsConfig.workflows.find(R.propEq('slug', initialWorkflowId))\n      if (w) return w\n    }\n    return defaultWorkflowFromConfig(workflowsConfig)\n  }, [initialWorkflowId, workflowsConfig])\n\n  const selectedWorkflow = workflow || initialWorkflow\n\n  if (!selectedWorkflow) {\n    const error = new Error(`\"default_workflow\" or \"workflow.id\" doesn't exist`)\n    sentry('captureException', error)\n    // eslint-disable-next-line no-console\n    console.error(error)\n  }\n\n  const schemaUrl = R.pathOr('', ['schema', 'url'], selectedWorkflow)\n  const data = useData(requests.metadataSchema, { s3, schemaUrl })\n\n  const res: SchemaFetcherRenderProps = React.useMemo(\n    () =>\n      data.case({\n        Ok: (schema?: JsonSchema) =>\n          ({\n            schema,\n            schemaLoading: false,\n            selectedWorkflow,\n            validate: mkMetaValidator(schema),\n          } as SchemaFetcherRenderPropsSuccess),\n        Err: (responseError: Error) =>\n          ({\n            responseError,\n            schemaLoading: false,\n            selectedWorkflow,\n            validate: mkMetaValidator(),\n          } as SchemaFetcherRenderPropsError),\n        _: () =>\n          ({\n            schemaLoading: true,\n            selectedWorkflow,\n            validate: noopValidator,\n          } as SchemaFetcherRenderPropsLoading),\n      }),\n    [data, selectedWorkflow],\n  )\n  return children(res)\n}\n\nexport function useCryptoApiValidation() {\n  return React.useCallback(\n    () =>\n      !!window.crypto?.subtle?.digest\n        ? {}\n        : mkFormError(\n            'Quilt requires the Web Cryptography API. Please try another browser.',\n          ),\n\n    [],\n  )\n}\n\nexport function calcDialogHeight(windowHeight: number, metaHeight: number): number {\n  const neededSpace = 345 /* space to fit other inputs */ + metaHeight\n  const availableSpace = windowHeight - 200 /* free space for headers */\n  const minimalSpace = 420 /* minimal height */\n  if (availableSpace < minimalSpace) return minimalSpace\n  return R.clamp(minimalSpace, availableSpace, neededSpace)\n}\n\nexport const useContentStyles = M.makeStyles({\n  root: {\n    height: ({ metaHeight }: { metaHeight: number }) =>\n      calcDialogHeight(window.innerHeight, metaHeight),\n    paddingTop: 0,\n  },\n})\n\nexport function getUsernamePrefix(username?: string | null) {\n  if (!username) return ''\n  const name = username.includes('@') ? username.split('@')[0] : username\n  // see PACKAGE_NAME_FORMAT at quilt3/util.py\n  const validParts = name.match(/\\w+/g)\n  return validParts ? `${validParts.join('')}/` : ''\n}\n\nconst getDefaultPackageName = (\n  workflow: { packageName: packageHandleUtils.NameTemplates },\n  { directory, username }: { directory?: string; username: string },\n) => {\n  const usernamePrefix = getUsernamePrefix(username)\n  const templateBasedName =\n    typeof directory === 'string'\n      ? packageHandleUtils.execTemplate(workflow?.packageName, 'files', {\n          directory: basename(directory),\n          username: s3paths.ensureNoSlash(usernamePrefix),\n        })\n      : packageHandleUtils.execTemplate(workflow?.packageName, 'packages', {\n          username: s3paths.ensureNoSlash(usernamePrefix),\n        })\n  return typeof templateBasedName === 'string' ? templateBasedName : usernamePrefix\n}\n\nconst usePackageNameWarningStyles = M.makeStyles({\n  root: {\n    marginRight: '4px',\n    verticalAlign: '-5px',\n  },\n})\n\ninterface PackageNameWarningProps {\n  exists?: boolean\n}\n\nexport const PackageNameWarning = ({ exists }: PackageNameWarningProps) => {\n  const classes = usePackageNameWarningStyles()\n  return (\n    <>\n      <M.Icon className={classes.root} fontSize=\"small\">\n        info_outlined\n      </M.Icon>\n      {exists ? 'Existing package' : 'New package'}\n    </>\n  )\n}\n\ninterface DialogWrapperProps {\n  exited: boolean\n}\n\nexport function DialogWrapper({\n  exited,\n  ...props\n}: DialogWrapperProps & React.ComponentProps<typeof M.Dialog>) {\n  const refProps = { exited, onExited: props.onExited }\n  const ref = React.useRef<typeof refProps>()\n  ref.current = refProps\n  React.useEffect(\n    () => () => {\n      // call onExited on unmount if it has not been called yet\n      if (!ref.current!.exited && ref.current!.onExited)\n        (ref.current!.onExited as () => void)()\n    },\n    [],\n  )\n  return <M.Dialog {...props} />\n}\n\nexport function useEntriesValidator(workflow?: workflows.Workflow) {\n  const s3 = AWS.S3.use()\n\n  return React.useCallback(\n    async (entries: $TSFixMe) => {\n      const schemaUrl = workflow?.entriesSchema\n      if (!schemaUrl) return undefined\n      const entriesSchema = await requests.objectSchema({ s3, schemaUrl })\n      // TODO: Show error if there is network error\n      if (!entriesSchema) return undefined\n\n      return makeSchemaValidator(entriesSchema)(entries)\n    },\n    [workflow, s3],\n  )\n}\n","import cx from 'classnames'\nimport pLimit from 'p-limit'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\nimport * as DG from '@material-ui/data-grid'\n\nimport Lock from 'components/Lock'\nimport { Crumb, render as renderCrumbs } from 'components/BreadCrumbs'\nimport AsyncResult from 'utils/AsyncResult'\nimport { useData } from 'utils/Data'\nimport { linkStyle } from 'utils/StyledLink'\nimport { getBreadCrumbs, ensureNoSlash, withoutPrefix } from 'utils/s3paths'\nimport type * as Model from 'model'\n\nimport * as Listing from '../Listing'\nimport { displayError } from '../errors'\nimport * as requests from '../requests'\n\nimport SubmitSpinner from './SubmitSpinner'\n\nconst limit = pLimit(5)\n\nexport const isS3File = (f: any): f is Model.S3File =>\n  !!f &&\n  typeof f === 'object' &&\n  typeof f.bucket === 'string' &&\n  typeof f.key === 'string' &&\n  (typeof f.version === 'string' || typeof f.version === 'undefined') &&\n  typeof f.size === 'number'\n\nconst getCrumbs = R.compose(R.intersperse(Crumb.Sep(<>&nbsp;/ </>)), (path: string) =>\n  [{ label: 'ROOT', path: '' }, ...getBreadCrumbs(path)].map(({ label, path: segPath }) =>\n    Crumb.Segment({ label, to: segPath === path ? undefined : segPath }),\n  ),\n)\n\nfunction ExpandMore({ className }: { className?: string }) {\n  return <M.Icon className={className}>expand_more</M.Icon>\n}\n\nconst useBucketSelectStyles = M.makeStyles({\n  root: {\n    ...linkStyle,\n    font: 'inherit',\n  },\n  select: {\n    paddingBottom: 0,\n    paddingTop: 0,\n  },\n  icon: {\n    color: 'inherit',\n  },\n})\n\ninterface BucketSelectProps {\n  bucket: string\n  buckets: string[]\n  selectBucket: (bucket: string) => void\n}\n\nfunction BucketSelect({ bucket, buckets, selectBucket }: BucketSelectProps) {\n  const classes = useBucketSelectStyles()\n\n  const handleChange = React.useCallback(\n    (e: React.ChangeEvent<{ value: unknown }>) => {\n      selectBucket(e.target.value as string)\n    },\n    [selectBucket],\n  )\n\n  return (\n    <M.Select\n      value={bucket}\n      onChange={handleChange}\n      input={<M.InputBase />}\n      className={classes.root}\n      classes={{ select: classes.select, icon: classes.icon }}\n      IconComponent={ExpandMore}\n    >\n      {buckets.map((b) => (\n        <M.MenuItem key={b} value={b}>\n          {b}\n        </M.MenuItem>\n      ))}\n    </M.Select>\n  )\n}\n\ntype MuiCloseReason = 'backdropClick' | 'escapeKeyDown'\nexport type CloseReason =\n  | MuiCloseReason\n  | 'cancel'\n  | { path: string; files: Model.S3File[] }\n\nconst useStyles = M.makeStyles((t) => ({\n  paper: {\n    height: '100vh',\n  },\n  crumbs: {\n    ...t.typography.body1,\n    marginTop: -t.spacing(1),\n    maxWidth: '100%',\n    overflowWrap: 'break-word',\n    paddingLeft: t.spacing(3),\n    paddingRight: t.spacing(3),\n  },\n  lock: {\n    bottom: 52,\n    top: 56,\n  },\n}))\n\ninterface DialogProps {\n  initialPath?: string\n  bucket: string\n  buckets?: string[]\n  selectBucket?: (bucket: string) => void\n  open: boolean\n  onClose: (reason: CloseReason) => void\n}\n\nexport function Dialog({\n  bucket,\n  buckets,\n  selectBucket,\n  open,\n  onClose,\n  initialPath,\n}: DialogProps) {\n  const classes = useStyles()\n\n  const bucketListing = requests.useBucketListing()\n\n  const [path, setPath] = React.useState('')\n  const [prefix, setPrefix] = React.useState('')\n  const [prev, setPrev] = React.useState<requests.BucketListingResult | null>(null)\n  const [selection, setSelection] = React.useState<DG.GridRowId[]>([])\n\n  const [locked, setLocked] = React.useState(false)\n\n  const cancel = React.useCallback(() => onClose('cancel'), [onClose])\n\n  const handleClose = React.useCallback(\n    (_e: {}, reason: MuiCloseReason) => {\n      if (!locked) onClose(reason)\n    },\n    [locked, onClose],\n  )\n\n  const crumbs = React.useMemo(() => getCrumbs(path), [path])\n\n  const getCrumbLinkProps = ({ to }: { to: string }) => ({\n    onClick: () => {\n      setPath(to)\n    },\n  })\n\n  React.useLayoutEffect(() => {\n    // reset accumulated results when bucket, path and / or prefix change\n    setPrev(null)\n  }, [bucket, path, prefix])\n\n  React.useLayoutEffect(() => {\n    // reset state when bucket changes\n    setPath('')\n    setPrefix('')\n    setSelection([])\n  }, [bucket])\n\n  React.useLayoutEffect(() => {\n    if (!initialPath) return\n    setPath(initialPath)\n  }, [initialPath])\n\n  const data = useData(bucketListing, { bucket, path, prefix, prev, drain: true })\n\n  const loadMore = React.useCallback(() => {\n    AsyncResult.case(\n      {\n        Ok: (res: requests.BucketListingResult) => {\n          // this triggers a re-render and fetching of next page of results\n          if (res.continuationToken) setPrev(res)\n        },\n        _: () => {},\n      },\n      data.result,\n    )\n  }, [data.result])\n\n  const add = React.useCallback(() => {\n    data.case({\n      Ok: async (r: requests.BucketListingResult) => {\n        try {\n          setLocked(true)\n          const dirsByBasename = R.fromPairs(\n            r.dirs.map((name) => [ensureNoSlash(withoutPrefix(r.path, name)), name]),\n          )\n          const filesByBasename = R.fromPairs(\n            r.files.map((f) => [withoutPrefix(r.path, f.key), f]),\n          )\n          const { dirs, files } = selection.reduce(\n            (acc, id) => {\n              const dir = dirsByBasename[id]\n              if (dir) return { ...acc, dirs: [...acc.dirs, dir] }\n              const file = filesByBasename[id]\n              if (file) return { ...acc, files: [...acc.files, file] }\n              return acc // shouldnt happen\n            },\n            { files: [] as requests.BucketListingFile[], dirs: [] as string[] },\n          )\n\n          const dirsPromises = dirs.map((dir) =>\n            limit(bucketListing, { bucket, path: dir, delimiter: false, drain: true }),\n          )\n\n          const dirsChildren = await Promise.all(dirsPromises)\n          const allChildren = dirsChildren.reduce(\n            (acc, res) => acc.concat(res.files),\n            [] as requests.BucketListingFile[],\n          )\n\n          onClose({ files: files.concat(allChildren), path })\n        } finally {\n          setLocked(false)\n        }\n      },\n      _: () => {},\n    })\n  }, [onClose, selection, data, bucket, path, bucketListing])\n\n  const handleExited = React.useCallback(() => {\n    setPath('')\n    setPrefix('')\n    setPrev(null)\n    setSelection([])\n  }, [])\n\n  return (\n    <M.Dialog\n      open={open}\n      onClose={handleClose}\n      onExited={handleExited}\n      fullWidth\n      maxWidth=\"lg\"\n      classes={{ paper: classes.paper }}\n    >\n      <M.DialogTitle disableTypography>\n        <M.Typography component=\"h2\" variant=\"h6\">\n          Add files from s3://\n          {!!buckets && buckets.length > 1 && !!selectBucket ? (\n            <BucketSelect bucket={bucket} buckets={buckets} selectBucket={selectBucket} />\n          ) : (\n            bucket\n          )}\n        </M.Typography>\n      </M.DialogTitle>\n      <div className={classes.crumbs}>\n        {/* @ts-expect-error, TODO: convert Breadcrumbs to typescript */}\n        {renderCrumbs(crumbs, { getLinkProps: getCrumbLinkProps })}\n      </div>\n      {data.case({\n        // TODO: customized error display?\n        Err: displayError(),\n        Init: () => null,\n        _: (x: $TSFixMe) => {\n          const res: requests.BucketListingResult | null = AsyncResult.getPrevResult(x)\n          return res ? (\n            <DirContents\n              response={res}\n              locked={!AsyncResult.Ok.is(x)}\n              setPath={setPath}\n              setPrefix={setPrefix}\n              loadMore={loadMore}\n              selection={selection}\n              onSelectionChange={setSelection}\n            />\n          ) : (\n            // TODO: skeleton\n            <M.Box px={3} pt={2} flexGrow={1}>\n              <M.CircularProgress />\n            </M.Box>\n          )\n        },\n      })}\n      {locked && <Lock className={classes.lock} />}\n      <M.DialogActions>\n        {locked ? (\n          <SubmitSpinner>Adding files</SubmitSpinner>\n        ) : (\n          <M.Box flexGrow={1} display=\"flex\" alignItems=\"center\" pl={2}>\n            <M.Typography variant=\"body2\" color=\"textSecondary\">\n              {selection.length} item{selection.length === 1 ? '' : 's'} selected\n            </M.Typography>\n          </M.Box>\n        )}\n        <M.Button onClick={cancel}>Cancel</M.Button>\n        <M.Button\n          onClick={add}\n          variant=\"contained\"\n          color=\"primary\"\n          disabled={locked || !selection.length}\n        >\n          Add files\n        </M.Button>\n      </M.DialogActions>\n    </M.Dialog>\n  )\n}\n\nfunction useFormattedListing(r: requests.BucketListingResult) {\n  return React.useMemo(() => {\n    const dirs = r.dirs.map((name) => ({\n      type: 'dir' as const,\n      name: ensureNoSlash(withoutPrefix(r.path, name)),\n      to: name,\n    }))\n    const files = r.files.map(({ key, size, modified, archived }) => ({\n      type: 'file' as const,\n      name: withoutPrefix(r.path, key),\n      to: key,\n      size,\n      modified,\n      archived,\n    }))\n    const items = [...dirs, ...files]\n    // filter-out files with same name as one of dirs\n    return R.uniqBy(R.prop('name'), items)\n  }, [r])\n}\n\nconst useDirContentsStyles = M.makeStyles((t) => ({\n  root: {\n    borderBottom: `1px solid ${t.palette.divider}`,\n    borderTop: `1px solid ${t.palette.divider}`,\n    flexGrow: 1,\n    marginLeft: t.spacing(2),\n    marginRight: t.spacing(2),\n    marginTop: t.spacing(1),\n  },\n  interactive: {\n    cursor: 'pointer',\n  },\n}))\n\ninterface DirContentsProps {\n  response: requests.BucketListingResult\n  locked: boolean\n  setPath: (path: string) => void\n  setPrefix: (prefix: string) => void\n  loadMore: () => void\n  selection: DG.GridRowId[]\n  onSelectionChange: (newSelection: DG.GridRowId[]) => void\n}\n\nfunction DirContents({\n  response,\n  locked,\n  setPath,\n  setPrefix,\n  loadMore,\n  selection,\n  onSelectionChange,\n}: DirContentsProps) {\n  const classes = useDirContentsStyles()\n  const items = useFormattedListing(response)\n  const { bucket, path, prefix, truncated } = response\n\n  React.useLayoutEffect(() => {\n    // reset selection when bucket, path and / or prefix change\n    onSelectionChange([])\n  }, [onSelectionChange, bucket, path, prefix])\n\n  const CellComponent = React.useMemo(\n    () =>\n      function Cell({ item, className, ...props }: Listing.CellProps) {\n        const onClick = React.useCallback(() => {\n          if (item.type === 'dir') {\n            setPath(item.to)\n            setPrefix('')\n          }\n        }, [item])\n        return (\n          // eslint-disable-next-line jsx-a11y/interactive-supports-focus, jsx-a11y/click-events-have-key-events\n          <div\n            role=\"button\"\n            onClick={onClick}\n            className={cx(item.type === 'dir' && classes.interactive, className)}\n            {...props}\n          />\n        )\n      },\n    [classes.interactive, setPath, setPrefix],\n  )\n\n  return (\n    <Listing.Listing\n      items={items}\n      locked={locked}\n      loadMore={loadMore}\n      truncated={truncated}\n      prefixFilter={prefix}\n      selection={selection}\n      onSelectionChange={onSelectionChange}\n      CellComponent={CellComponent}\n      RootComponent=\"div\"\n      className={classes.root}\n      dataGridProps={{ autoHeight: false }}\n      toolbarContents={\n        <Listing.PrefixFilter\n          key={`${bucket}/${path}`}\n          prefix={prefix}\n          setPrefix={setPrefix}\n        />\n      }\n    />\n  )\n}\n","import * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport Skeleton from 'components/Skeleton'\n\nimport * as Layout from './Layout'\n\ninterface AnimateProp {\n  animate?: boolean\n}\n\ninterface ClassNameProp {\n  className?: string\n}\n\nexport function TextFieldSkeleton({ animate }: AnimateProp) {\n  return <Skeleton {...{ height: 54, mt: 2, mb: 1, animate }} />\n}\n\nexport function FilesInputSkeleton({ animate, className }: AnimateProp & ClassNameProp) {\n  return (\n    <div className={className}>\n      <Skeleton {...{ height: 24, width: 64, animate }} />\n      <Skeleton {...{ height: 336, mt: 2, animate }} />\n    </div>\n  )\n}\n\nexport const MetaInputSkeleton = React.forwardRef(function MetaInputSkeleton(\n  { animate, className }: AnimateProp & ClassNameProp,\n  ref: React.Ref<HTMLDivElement>,\n) {\n  return (\n    <div className={className}>\n      <M.Box display=\"flex\" mb={2}>\n        <Skeleton {...{ height: 24, width: 64, animate }} />\n        <M.Box flexGrow={1} />\n        <Skeleton {...{ height: 24, width: 64, animate }} />\n      </M.Box>\n      <div ref={ref}>\n        <M.Box display=\"flex\">\n          <Skeleton {...{ height: 32, width: 200, animate }} />\n          <Skeleton {...{ height: 32, ml: 0.5, flexGrow: 1, animate }} />\n        </M.Box>\n        <M.Box display=\"flex\" mt={0.5}>\n          <Skeleton {...{ height: 32, width: 200, animate }} />\n          <Skeleton {...{ height: 32, ml: 0.5, flexGrow: 1, animate }} />\n        </M.Box>\n      </div>\n    </div>\n  )\n})\n\nexport function WorkflowsInputSkeleton({ animate }: AnimateProp) {\n  return <Skeleton {...{ height: 80, mt: 3, mb: 3, animate }} />\n}\n\nconst useFormSkeletonStyles = M.makeStyles((t) => ({\n  files: {\n    marginTop: t.spacing(2),\n  },\n  meta: {\n    marginTop: t.spacing(3),\n  },\n}))\n\nexport function FormSkeleton({ animate }: AnimateProp) {\n  const classes = useFormSkeletonStyles()\n\n  return (\n    <Layout.Container>\n      <Layout.LeftColumn>\n        <TextFieldSkeleton animate={animate} />\n        <TextFieldSkeleton animate={animate} />\n\n        <MetaInputSkeleton className={classes.meta} animate={animate} />\n\n        <WorkflowsInputSkeleton animate={animate} />\n      </Layout.LeftColumn>\n\n      <Layout.RightColumn>\n        <FilesInputSkeleton className={classes.files} animate={animate} />\n      </Layout.RightColumn>\n    </Layout.Container>\n  )\n}\n","import * as R from 'ramda'\nimport * as React from 'react'\n\nimport * as M from '@material-ui/core'\n\nimport Delay from 'utils/Delay'\n\ninterface SubmitSpinnerProps {\n  children?: React.ReactNode\n  value?: number\n}\n\nexport default function SubmitSpinner({ children, value }: SubmitSpinnerProps) {\n  const hasValue = R.is(Number, value) && value! < 100\n\n  return (\n    <Delay ms={200} alwaysRender>\n      {(ready) => (\n        <M.Fade in={ready}>\n          <M.Box flexGrow={1} display=\"flex\" alignItems=\"center\" pl={2}>\n            <M.CircularProgress\n              size={24}\n              variant={hasValue ? 'determinate' : 'indeterminate'}\n              value={hasValue ? value! * 0.9 : undefined}\n            />\n\n            {!!children && (\n              <>\n                <M.Box pl={1} />\n\n                <M.Typography variant=\"body2\" color=\"textSecondary\">\n                  {children}\n                </M.Typography>\n              </>\n            )}\n          </M.Box>\n        </M.Fade>\n      )}\n    </Delay>\n  )\n}\n","import type { S3 } from 'aws-sdk'\nimport * as FP from 'fp-ts'\nimport pLimit from 'p-limit'\nimport * as R from 'ramda'\nimport * as React from 'react'\n\nimport * as Model from 'model'\nimport * as AWS from 'utils/AWS'\nimport dissocBy from 'utils/dissocBy'\nimport * as s3paths from 'utils/s3paths'\nimport useMemoEq from 'utils/useMemoEq'\n\nimport type { LocalFile } from './FilesInput'\n\ninterface UploadResult extends S3.ManagedUpload.SendData {\n  VersionId: string\n}\n\nexport interface UploadTotalProgress {\n  total: number\n  loaded: number\n  percent: number\n}\n\nexport interface UploadsState {\n  [path: string]: {\n    file: File\n    promise: Promise<S3.ManagedUpload.SendData>\n    progress?: { total: number; loaded: number }\n  }\n}\n\nexport const computeTotalProgress = (uploads: UploadsState): UploadTotalProgress =>\n  FP.function.pipe(\n    uploads,\n    R.values,\n    R.reduce(\n      (acc, { progress: p }) => ({\n        total: acc.total + ((p && p.total) || 0),\n        loaded: acc.loaded + ((p && p.loaded) || 0),\n      }),\n      { total: 0, loaded: 0 },\n    ),\n    (p) => ({\n      ...p,\n      percent: p.total ? Math.floor((p.loaded / p.total) * 100) : 100,\n    }),\n  )\n\nexport function useUploads() {\n  const s3 = AWS.S3.use()\n\n  const [uploads, setUploads] = React.useState<UploadsState>({})\n  const progress = React.useMemo(() => computeTotalProgress(uploads), [uploads])\n\n  const remove = React.useCallback(\n    (path: string) => setUploads(R.dissoc(path)),\n    [setUploads],\n  )\n  const removeByPrefix = React.useCallback(\n    (prefix: string) => setUploads(dissocBy(R.startsWith(prefix))),\n    [setUploads],\n  )\n  const reset = React.useCallback(() => setUploads({}), [setUploads])\n\n  const doUpload = React.useCallback(\n    async ({\n      files,\n      bucket,\n      prefix,\n      getMeta,\n    }: {\n      files: { path: string; file: LocalFile }[]\n      bucket: string\n      prefix: string\n      getMeta?: (path: string) => object | undefined\n    }) => {\n      const limit = pLimit(2)\n      let rejected = false\n      const pendingUploads: Record<string, S3.ManagedUpload> = {}\n\n      const uploadFile = async (path: string, file: LocalFile) => {\n        if (rejected) {\n          remove(path)\n          return undefined as never\n        }\n\n        const upload: S3.ManagedUpload = s3.upload({\n          Bucket: bucket,\n          Key: `${prefix}/${path}`,\n          Body: file,\n        })\n\n        upload.on('httpUploadProgress', ({ loaded }) => {\n          if (rejected) return\n          setUploads(R.assocPath([path, 'progress', 'loaded'], loaded))\n        })\n\n        pendingUploads[path] = upload\n\n        try {\n          const uploadP = upload.promise()\n          await file.hash.promise\n          return await uploadP\n        } catch (e) {\n          if ((e as any).code !== 'RequestAbortedError') {\n            // eslint-disable-next-line no-console\n            console.log(`Error uploading file \"${file.name}\"`)\n            rejected = true\n            Object.values(pendingUploads).forEach((u) => u.abort())\n          }\n          remove(path)\n          throw e\n        } finally {\n          delete pendingUploads[path]\n        }\n      }\n\n      const uploadStates = files.map(({ path, file }) => {\n        // reuse state if file hasnt changed\n        const entry = uploads[path]\n        if (entry && entry.file === file) return { ...entry, path }\n\n        const promise = limit(uploadFile, path, file)\n        return { path, file, promise, progress: { total: file.size, loaded: 0 } }\n      })\n\n      FP.function.pipe(\n        uploadStates,\n        R.map(({ path, ...rest }) => ({ [path]: rest })),\n        R.mergeAll,\n        setUploads,\n      )\n\n      const uploaded = await Promise.all(uploadStates.map((x) => x.promise))\n\n      return FP.function.pipe(\n        FP.array.zipWith(\n          files,\n          uploaded,\n          (f, r) =>\n            [\n              f.path,\n              {\n                physicalKey: s3paths.handleToS3Url({\n                  bucket,\n                  key: r.Key,\n                  version: (r as UploadResult).VersionId,\n                }),\n                size: f.file.size,\n                hash: f.file.hash.value,\n                meta: getMeta?.(f.path),\n              },\n            ] as R.KeyValuePair<string, Model.PackageEntry>,\n        ),\n        R.fromPairs,\n      )\n    },\n    [remove, s3, uploads],\n  )\n\n  return useMemoEq(\n    { uploads, upload: doUpload, progress, remove, removeByPrefix, reset },\n    R.identity,\n  )\n}\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport type { TypedDocumentNode as DocumentNode } from '@graphql-typed-document-node/core'\nimport * as Types from '../../../../model/graphql/types.generated'\n\nexport type InvalidInputSelectionFragment = { readonly __typename: 'InvalidInput' } & {\n  readonly errors: ReadonlyArray<\n    { readonly __typename: 'InputError' } & Pick<Types.InputError, 'path' | 'message'>\n  >\n}\n\nexport const InvalidInputSelectionFragmentDoc = {\n  kind: 'Document',\n  definitions: [\n    {\n      kind: 'FragmentDefinition',\n      name: { kind: 'Name', value: 'InvalidInputSelection' },\n      typeCondition: { kind: 'NamedType', name: { kind: 'Name', value: 'InvalidInput' } },\n      selectionSet: {\n        kind: 'SelectionSet',\n        selections: [\n          {\n            kind: 'Field',\n            name: { kind: 'Name', value: 'errors' },\n            selectionSet: {\n              kind: 'SelectionSet',\n              selections: [\n                { kind: 'Field', name: { kind: 'Name', value: 'path' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'message' } },\n              ],\n            },\n          },\n        ],\n      },\n    },\n  ],\n} as unknown as DocumentNode<InvalidInputSelectionFragment, unknown>\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport type { TypedDocumentNode as DocumentNode } from '@graphql-typed-document-node/core'\nimport * as Types from '../../../../model/graphql/types.generated'\n\nexport type OperationErrorSelectionFragment = {\n  readonly __typename: 'OperationError'\n} & Pick<Types.OperationError, 'message'>\n\nexport const OperationErrorSelectionFragmentDoc = {\n  kind: 'Document',\n  definitions: [\n    {\n      kind: 'FragmentDefinition',\n      name: { kind: 'Name', value: 'OperationErrorSelection' },\n      typeCondition: {\n        kind: 'NamedType',\n        name: { kind: 'Name', value: 'OperationError' },\n      },\n      selectionSet: {\n        kind: 'SelectionSet',\n        selections: [{ kind: 'Field', name: { kind: 'Name', value: 'message' } }],\n      },\n    },\n  ],\n} as unknown as DocumentNode<OperationErrorSelectionFragment, unknown>\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport type { TypedDocumentNode as DocumentNode } from '@graphql-typed-document-node/core'\nimport * as Types from '../../../../model/graphql/types.generated'\n\nexport type PackagePushSuccessSelectionFragment = {\n  readonly __typename: 'PackagePushSuccess'\n} & {\n  readonly package: { readonly __typename: 'Package' } & Pick<\n    Types.Package,\n    'bucket' | 'name' | 'modified'\n  > & {\n      readonly revision: Types.Maybe<\n        { readonly __typename: 'PackageRevision' } & Pick<Types.PackageRevision, 'hash'>\n      >\n      readonly revisions: { readonly __typename: 'PackageRevisionList' } & Pick<\n        Types.PackageRevisionList,\n        'total'\n      > & {\n          readonly page: ReadonlyArray<\n            { readonly __typename: 'PackageRevision' } & Pick<\n              Types.PackageRevision,\n              'hash'\n            >\n          >\n          readonly page1: ReadonlyArray<\n            { readonly __typename: 'PackageRevision' } & Pick<\n              Types.PackageRevision,\n              'hash'\n            >\n          >\n        }\n    }\n  readonly revision: { readonly __typename: 'PackageRevision' } & Pick<\n    Types.PackageRevision,\n    | 'hash'\n    | 'modified'\n    | 'message'\n    | 'metadata'\n    | 'userMeta'\n    | 'totalEntries'\n    | 'totalBytes'\n  > & {\n      readonly accessCounts: Types.Maybe<\n        { readonly __typename: 'AccessCounts' } & Pick<Types.AccessCounts, 'total'> & {\n            readonly counts: ReadonlyArray<\n              { readonly __typename: 'AccessCountForDate' } & Pick<\n                Types.AccessCountForDate,\n                'date' | 'value'\n              >\n            >\n          }\n      >\n    }\n}\n\nexport const PackagePushSuccessSelectionFragmentDoc = {\n  kind: 'Document',\n  definitions: [\n    {\n      kind: 'FragmentDefinition',\n      name: { kind: 'Name', value: 'PackagePushSuccessSelection' },\n      typeCondition: {\n        kind: 'NamedType',\n        name: { kind: 'Name', value: 'PackagePushSuccess' },\n      },\n      selectionSet: {\n        kind: 'SelectionSet',\n        selections: [\n          {\n            kind: 'Field',\n            name: { kind: 'Name', value: 'package' },\n            selectionSet: {\n              kind: 'SelectionSet',\n              selections: [\n                { kind: 'Field', name: { kind: 'Name', value: 'bucket' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'name' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'modified' } },\n                {\n                  kind: 'Field',\n                  name: { kind: 'Name', value: 'revision' },\n                  arguments: [\n                    {\n                      kind: 'Argument',\n                      name: { kind: 'Name', value: 'hashOrTag' },\n                      value: { kind: 'StringValue', value: 'latest', block: false },\n                    },\n                  ],\n                  selectionSet: {\n                    kind: 'SelectionSet',\n                    selections: [\n                      { kind: 'Field', name: { kind: 'Name', value: 'hash' } },\n                    ],\n                  },\n                },\n                {\n                  kind: 'Field',\n                  name: { kind: 'Name', value: 'revisions' },\n                  selectionSet: {\n                    kind: 'SelectionSet',\n                    selections: [\n                      { kind: 'Field', name: { kind: 'Name', value: 'total' } },\n                      {\n                        kind: 'Field',\n                        name: { kind: 'Name', value: 'page' },\n                        arguments: [\n                          {\n                            kind: 'Argument',\n                            name: { kind: 'Name', value: 'number' },\n                            value: { kind: 'IntValue', value: '1' },\n                          },\n                          {\n                            kind: 'Argument',\n                            name: { kind: 'Name', value: 'perPage' },\n                            value: { kind: 'IntValue', value: '5' },\n                          },\n                        ],\n                        selectionSet: {\n                          kind: 'SelectionSet',\n                          selections: [\n                            { kind: 'Field', name: { kind: 'Name', value: 'hash' } },\n                          ],\n                        },\n                      },\n                      {\n                        kind: 'Field',\n                        alias: { kind: 'Name', value: 'page1' },\n                        name: { kind: 'Name', value: 'page' },\n                        arguments: [\n                          {\n                            kind: 'Argument',\n                            name: { kind: 'Name', value: 'number' },\n                            value: { kind: 'IntValue', value: '1' },\n                          },\n                          {\n                            kind: 'Argument',\n                            name: { kind: 'Name', value: 'perPage' },\n                            value: { kind: 'IntValue', value: '30' },\n                          },\n                        ],\n                        selectionSet: {\n                          kind: 'SelectionSet',\n                          selections: [\n                            { kind: 'Field', name: { kind: 'Name', value: 'hash' } },\n                          ],\n                        },\n                      },\n                    ],\n                  },\n                },\n              ],\n            },\n          },\n          {\n            kind: 'Field',\n            name: { kind: 'Name', value: 'revision' },\n            selectionSet: {\n              kind: 'SelectionSet',\n              selections: [\n                { kind: 'Field', name: { kind: 'Name', value: 'hash' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'modified' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'message' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'metadata' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'userMeta' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'totalEntries' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'totalBytes' } },\n                {\n                  kind: 'Field',\n                  name: { kind: 'Name', value: 'accessCounts' },\n                  selectionSet: {\n                    kind: 'SelectionSet',\n                    selections: [\n                      { kind: 'Field', name: { kind: 'Name', value: 'total' } },\n                      {\n                        kind: 'Field',\n                        name: { kind: 'Name', value: 'counts' },\n                        selectionSet: {\n                          kind: 'SelectionSet',\n                          selections: [\n                            { kind: 'Field', name: { kind: 'Name', value: 'date' } },\n                            { kind: 'Field', name: { kind: 'Name', value: 'value' } },\n                          ],\n                        },\n                      },\n                    ],\n                  },\n                },\n              ],\n            },\n          },\n        ],\n      },\n    },\n  ],\n} as unknown as DocumentNode<PackagePushSuccessSelectionFragment, unknown>\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nconst useStyles = M.makeStyles((t) => ({\n  left: {\n    marginRight: t.spacing(1),\n  },\n  right: {\n    marginLeft: t.spacing(1),\n  },\n}))\n\ninterface ButtonIconProps extends M.IconProps {\n  position?: 'left' | 'right'\n}\n\nexport default function ButtonIcon({\n  className,\n  position = 'left',\n  ...props\n}: ButtonIconProps) {\n  const classes = useStyles()\n  return <M.Icon {...props} className={cx(className, classes[position])} />\n}\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport ButtonIcon from 'components/ButtonIcon'\n\nconst useStyles = M.makeStyles((t) => ({\n  summaryExpanded: {},\n  summaryRoot: {\n    '&$summaryExpanded': {\n      minHeight: 48,\n    },\n  },\n  summaryContent: {\n    '&$summaryExpanded': {\n      margin: [[12, 0]],\n    },\n  },\n  heading: {\n    display: 'flex',\n  },\n  gutterBottom: {\n    marginBottom: t.spacing(2),\n  },\n  gutterTop: {\n    marginTop: t.spacing(2),\n  },\n}))\n\ntype NodeRenderer = (props: {\n  expanded: boolean\n  setExpanded: (exp: boolean) => void\n}) => React.ReactNode\n\ntype NodeOrFn = NodeRenderer | React.ReactNode\n\nexport interface SectionProps extends M.AccordionProps {\n  icon?: string\n  heading: NodeOrFn\n  defaultExpanded?: boolean\n  expandable?: boolean\n  gutterBottom?: boolean\n  gutterTop?: boolean\n  extraSummary?: NodeOrFn\n}\n\nexport default function Section({\n  icon,\n  heading,\n  defaultExpanded = false,\n  expandable = true,\n  gutterBottom = false,\n  gutterTop = false,\n  extraSummary,\n  children,\n  ...props\n}: SectionProps) {\n  const classes = useStyles()\n  const [expandedState, setExpanded] = React.useState<boolean | null>(null)\n  const expanded =\n    !expandable || (expandedState != null ? expandedState : defaultExpanded)\n\n  const onChange = React.useCallback(\n    (_e: unknown, changedExpanded: boolean) => {\n      setExpanded(changedExpanded)\n    },\n    [setExpanded],\n  )\n\n  const renderNodeOrFn = (nodeOrFn: NodeOrFn) =>\n    typeof nodeOrFn === 'function' ? nodeOrFn({ expanded, setExpanded }) : nodeOrFn\n\n  return (\n    <M.Accordion\n      expanded={expanded}\n      onChange={onChange}\n      className={cx({\n        [classes.gutterBottom]: gutterBottom,\n        [classes.gutterTop]: gutterTop,\n      })}\n      {...props}\n    >\n      <M.AccordionSummary\n        expandIcon={expandable && <M.Icon>expand_more</M.Icon>}\n        classes={{\n          expanded: classes.summaryExpanded,\n          root: classes.summaryRoot,\n          content: classes.summaryContent,\n        }}\n      >\n        <M.Typography variant=\"button\" className={classes.heading}>\n          {!!icon && <ButtonIcon>{icon}</ButtonIcon>}\n          {renderNodeOrFn(heading)}\n        </M.Typography>\n        {renderNodeOrFn(extraSummary)}\n      </M.AccordionSummary>\n      <M.AccordionDetails>{renderNodeOrFn(children)}</M.AccordionDetails>\n    </M.Accordion>\n  )\n}\n","import * as React from 'react'\nimport * as M from '@material-ui/core'\nimport * as Lab from '@material-ui/lab'\n\nimport SelectDropdown from 'components/SelectDropdown'\nimport { docs } from 'constants/urls'\nimport * as AWS from 'utils/AWS'\nimport { useData } from 'utils/Data'\nimport StyledLink from 'utils/StyledLink'\nimport type * as workflows from 'utils/workflows'\n\nimport WorkflowsConfigLink from './WorkflowsConfigLink'\nimport * as ERRORS from './errors'\nimport * as requests from './requests'\n\ninterface EmptySlotProps {\n  bucket: string\n}\n\nfunction EmptySlot({ bucket }: EmptySlotProps) {\n  return (\n    <M.Box px={2} py={1}>\n      <M.Typography gutterBottom>\n        Add or update a{' '}\n        <WorkflowsConfigLink bucket={bucket}>config.yml</WorkflowsConfigLink> file to\n        populate this menu.\n      </M.Typography>\n      <M.Typography>\n        <StyledLink\n          href={`${docs}/advanced/workflows#cross-bucket-package-push-quilt-catalog`}\n          target=\"_blank\"\n        >\n          Learn more\n        </StyledLink>\n        .\n      </M.Typography>\n    </M.Box>\n  )\n}\n\ninterface ErrorSlotProps {\n  error: Error\n}\n\nfunction ErrorSlot({ error }: ErrorSlotProps) {\n  return (\n    <M.Box px={2} py={1}>\n      <M.Typography gutterBottom>\n        Error: <code>{error.message}</code>\n      </M.Typography>\n      {error instanceof ERRORS.WorkflowsConfigInvalid && (\n        <M.Typography>\n          Please fix the workflows config according to{' '}\n          <StyledLink href={`${docs}/advanced/workflows`} target=\"_blank\">\n            the documentation\n          </StyledLink>\n        </M.Typography>\n      )}\n    </M.Box>\n  )\n}\n\nconst useMenuPlaceholderStyles = M.makeStyles((t) => ({\n  root: {\n    minWidth: t.spacing(22),\n  },\n  item: {\n    height: t.spacing(6),\n    width: '100%',\n  },\n}))\n\nfunction MenuPlaceholder() {\n  const classes = useMenuPlaceholderStyles()\n  return (\n    <div className={classes.root}>\n      <M.MenuItem disabled>\n        <Lab.Skeleton className={classes.item} />\n      </M.MenuItem>\n      <M.MenuItem disabled>\n        <Lab.Skeleton className={classes.item} />\n      </M.MenuItem>\n      <M.MenuItem disabled>\n        <Lab.Skeleton className={classes.item} />\n      </M.MenuItem>\n    </div>\n  )\n}\n\nfunction useSuccessors(\n  bucket: string,\n  { noAutoFetch = false },\n): workflows.Successor[] | Error | undefined {\n  const s3 = AWS.S3.use()\n  const data = useData(requests.workflowsConfig, { s3, bucket }, { noAutoFetch })\n  return React.useMemo(\n    () =>\n      data.case({\n        Ok: ({ successors }: { successors: workflows.Successor[] }) => successors,\n        Err: (error: Error) => error,\n        _: () => undefined,\n      }),\n    [data],\n  )\n}\n\ninterface SuccessorsSelectProps {\n  anchorEl: HTMLElement | null\n  bucket: string\n  onChange: (x: workflows.Successor) => void\n  onClose: () => void\n  open: boolean\n}\n\nfunction SuccessorsSelect({\n  anchorEl,\n  bucket,\n  onChange,\n  onClose,\n  open,\n}: SuccessorsSelectProps) {\n  const s3 = AWS.S3.use()\n  const data = useData(requests.workflowsConfig, { s3, bucket })\n\n  return (\n    <M.Menu anchorEl={anchorEl} onClose={onClose} open={open}>\n      {data.case({\n        Ok: ({ successors }: { successors: workflows.Successor[] }) =>\n          successors.length ? (\n            successors.map((successor) => (\n              <M.MenuItem key={successor.slug} onClick={() => onChange(successor)}>\n                <M.ListItemText primary={successor.name} secondary={successor.url} />\n              </M.MenuItem>\n            ))\n          ) : (\n            <EmptySlot bucket={bucket} />\n          ),\n        _: () => <MenuPlaceholder />,\n        Err: (error: Error) => <ErrorSlot error={error} />,\n      })}\n    </M.Menu>\n  )\n}\n\nconst useButtonStyles = M.makeStyles({\n  root: {\n    font: 'inherit',\n  },\n})\n\ninterface InputProps {\n  bucket: string\n  className?: string\n  onChange?: (value: workflows.Successor) => void\n  successor: workflows.Successor\n}\n\nexport function Dropdown({ bucket, className, onChange, successor }: InputProps) {\n  const [open, setOpen] = React.useState(false)\n  const [noAutoFetch, setNoAutoFetch] = React.useState(true)\n  const successors = useSuccessors(bucket, { noAutoFetch })\n  const options = React.useMemo(\n    () =>\n      Array.isArray(successors)\n        ? successors.map((s) => ({\n            ...s,\n            valueOf: () => s.slug,\n            toString: () => s.slug,\n          }))\n        : [],\n    [successors],\n  )\n  const handleClose = React.useCallback(() => setOpen(false), [])\n  const handleOpen = React.useCallback(() => {\n    setOpen(true)\n    setNoAutoFetch(false)\n  }, [])\n  const handleChange = React.useCallback(\n    ({ valueOf, toString, ...s }) => {\n      if (onChange) onChange(s)\n    },\n    [onChange],\n  )\n  const emptySlot = React.useMemo(\n    () =>\n      successors instanceof Error ? (\n        <ErrorSlot error={successors} />\n      ) : (\n        <EmptySlot bucket={bucket} />\n      ),\n    [bucket, successors],\n  )\n  const loading = !successors && open\n\n  const buttonClasses = useButtonStyles()\n  const ButtonProps = React.useMemo(\n    () =>\n      ({\n        className: buttonClasses.root,\n        variant: 'text',\n      } as M.ButtonProps),\n    [buttonClasses],\n  )\n  return (\n    <SelectDropdown\n      ButtonProps={ButtonProps}\n      className={className}\n      disabled={!onChange || (Array.isArray(successors) && !successors?.length)}\n      emptySlot={emptySlot}\n      loading={loading}\n      onChange={handleChange}\n      onClose={handleClose}\n      onOpen={handleOpen}\n      options={options}\n      value={successor.slug}\n    />\n  )\n}\n\ninterface ButtonInnerProps {\n  children: string\n  className: string\n  onClick: React.MouseEventHandler<HTMLButtonElement>\n}\n\n// TODO: Replace by FileView.AdaptiveButtonLayout\nfunction ButtonInner({ children, className, onClick }: ButtonInnerProps) {\n  const t = M.useTheme()\n  const sm = M.useMediaQuery(t.breakpoints.down('sm'))\n\n  return sm ? (\n    <M.IconButton\n      aria-haspopup\n      className={className}\n      edge=\"end\"\n      onClick={onClick}\n      size=\"small\"\n      title={children}\n    >\n      <M.Icon>exit_to_app</M.Icon>\n    </M.IconButton>\n  ) : (\n    <M.Button\n      aria-haspopup\n      className={className}\n      onClick={onClick}\n      size=\"small\"\n      variant=\"outlined\"\n    >\n      {children}\n    </M.Button>\n  )\n}\n\ninterface ButtonProps {\n  bucket: string\n  className: string\n  children: string\n  onChange: (s: workflows.Successor) => void\n}\n\nexport function Button({ bucket, className, children, onChange }: ButtonProps) {\n  const [menuAnchorEl, setMenuAnchorEl] = React.useState(null)\n\n  const onButtonClick = React.useCallback(\n    (event) => setMenuAnchorEl(event.currentTarget),\n    [setMenuAnchorEl],\n  )\n\n  const onMenuClick = React.useCallback(\n    (menuItem) => {\n      onChange(menuItem)\n      setMenuAnchorEl(null)\n    },\n    [onChange, setMenuAnchorEl],\n  )\n\n  const onMenuClose = React.useCallback(() => setMenuAnchorEl(null), [setMenuAnchorEl])\n\n  return (\n    <>\n      <ButtonInner className={className} onClick={onButtonClick}>\n        {children}\n      </ButtonInner>\n\n      <SuccessorsSelect\n        anchorEl={menuAnchorEl}\n        bucket={bucket}\n        open={!!menuAnchorEl}\n        onChange={onMenuClick}\n        onClose={onMenuClose}\n      />\n    </>\n  )\n}\n","import * as React from 'react'\nimport * as RRDom from 'react-router-dom'\n\nimport * as NamedRoutes from 'utils/NamedRoutes'\nimport StyledLink from 'utils/StyledLink'\n\nimport * as requests from './requests'\n\ninterface WorkflowsConfigLinkProps {\n  bucket: string\n  children: React.ReactNode\n}\n\n// TODO: add any file rather than specific add workflows config file\n//       move it to components/FileEditor directory because purpose of this link is to edit file\nexport default function WorkflowsConfigLink({\n  bucket,\n  children,\n}: WorkflowsConfigLinkProps) {\n  const { urls } = NamedRoutes.use()\n  const { pathname, search } = RRDom.useLocation()\n  const next = pathname + search\n  const toConfig = urls.bucketFile(bucket, requests.WORKFLOWS_CONFIG_PATH, { next })\n  return <StyledLink to={toConfig}>{children}</StyledLink>\n}\n","import * as R from 'ramda'\nimport * as React from 'react'\nimport * as redux from 'react-redux'\nimport { Route, Link } from 'react-router-dom'\nimport * as M from '@material-ui/core'\n\nimport Message from 'components/Message'\nimport { authenticated as authenticatedSelector } from 'containers/Auth/selectors'\nimport { docs } from 'constants/urls'\nimport * as NamedRoutes from 'utils/NamedRoutes'\nimport StyledLink from 'utils/StyledLink'\nimport { BaseError } from 'utils/error'\n\nexport class BucketError extends BaseError {}\n\nexport class AccessDenied extends BucketError {}\n\nexport class CORSError extends BucketError {}\n\nexport class NoSuchBucket extends BucketError {}\n\nexport class ESNoIndex extends BucketError {}\n\nexport class ESTimeout extends BucketError {}\n\nexport class ESThrottle extends BucketError {}\n\nexport class FileNotFound extends BucketError {}\n\nexport class VersionNotFound extends BucketError {}\n\nexport interface BucketPreferencesInvalidProps {\n  errors: { instancePath?: string; message?: string }[]\n}\n\nexport class BucketPreferencesInvalid extends BucketError {\n  static displayName = 'BucketPreferencesInvalid'\n\n  constructor(props: BucketPreferencesInvalidProps) {\n    super(\n      props.errors\n        .map(({ instancePath, message }) => `${instancePath} ${message}`)\n        .join(', '),\n      props,\n    )\n  }\n}\n\nexport interface WorkflowsConfigInvalidProps {\n  errors: { instancePath?: string; message?: string }[]\n}\n\nexport class WorkflowsConfigInvalid extends BucketError {\n  static displayName = 'WorkflowsConfigInvalid'\n\n  constructor(props: WorkflowsConfigInvalidProps) {\n    super(\n      props.errors\n        .map(({ instancePath, message }) =>\n          instancePath ? `${instancePath} ${message}` : message,\n        )\n        .join(', '),\n      props,\n    )\n  }\n}\n\nexport interface ManifestTooLargeProps {\n  bucket: string\n  hash: string\n  max: number\n}\n\nexport class ManifestTooLarge extends BucketError {\n  static displayName = 'ManifestTooLarge'\n\n  constructor(props: ManifestTooLargeProps) {\n    super(\n      `Package manifest ${props.hash} at s3://${props.bucket} is too large (more than ${props.max} entries)`,\n      props,\n    )\n  }\n}\n\ninterface WhenAuthCases {\n  true: () => React.ReactElement\n  false: () => React.ReactElement\n}\n\ninterface WhenAuthProps {\n  cases: WhenAuthCases\n}\n\nfunction WhenAuth({ cases }: WhenAuthProps) {\n  const authenticated = redux.useSelector(authenticatedSelector)\n  return cases[`${authenticated}` as 'true' | 'false']()\n}\n\nconst whenAuth = (cases: WhenAuthCases) => () => <WhenAuth cases={cases} />\n\nfunction SignIn() {\n  const { urls } = NamedRoutes.use()\n  return (\n    <Route>\n      {({ location: l }) => (\n        <M.Button\n          component={Link}\n          to={urls.signIn(l.pathname + l.search + l.hash)}\n          variant=\"contained\"\n          color=\"primary\"\n        >\n          Sign In\n        </M.Button>\n      )}\n    </Route>\n  )\n}\n\nconst defaultHandlers: ErrorHandler[] = [\n  [\n    R.is(CORSError),\n    () => (\n      <Message headline=\"Error\">\n        Seems like this bucket is not configured for Quilt.\n        <br />\n        <StyledLink\n          target=\"_blank\"\n          href={`${docs}/advanced/technical-reference#preparing-an-aws-role-for-use-with-quilt`}\n        >\n          Learn how to configure the bucket for Quilt\n        </StyledLink>\n        .\n      </Message>\n    ),\n  ],\n  [\n    R.is(NoSuchBucket),\n    () => (\n      <Message headline=\"No Such Bucket\">The specified bucket does not exist.</Message>\n    ),\n  ],\n  [\n    R.is(ESNoIndex),\n    () => (\n      <Message headline=\"Oops, no search cluster\">\n        The bucket owner needs to{' '}\n        <StyledLink target=\"_blank\" href={docs}>\n          tie this bucket to Quilt\n        </StyledLink>{' '}\n        to enable Packages, Search, and detailed Overviews.\n      </Message>\n    ),\n  ],\n  [\n    R.either(R.is(ESTimeout), R.is(ESThrottle)),\n    () => (\n      <Message headline=\"Whoa, search cluster is stressed out\">\n        ElasticSearch is stressed out. Please try again in a few minutes.\n      </Message>\n    ),\n  ],\n  [\n    R.is(AccessDenied),\n    whenAuth({\n      true: () => (\n        <Message headline=\"Access Denied\">\n          Seems like you don&apos;t have access to this bucket.\n          <br />\n          <StyledLink\n            target=\"_blank\"\n            href={`${docs}/walkthrough/working-with-the-catalog#access-control`}\n          >\n            Learn about access control in Quilt\n          </StyledLink>\n          .\n        </Message>\n      ),\n      false: () => (\n        <Message headline=\"Access Denied\">\n          Anonymous access not allowed. Please sign in.\n          <br />\n          <br />\n          <SignIn />\n        </Message>\n      ),\n    }),\n  ],\n]\n\ntype ErrorHandler = [(error: unknown) => boolean, (error: any) => React.ReactElement]\n\nexport const displayError = (pairs: ErrorHandler[] = []) =>\n  R.cond([\n    ...defaultHandlers,\n    ...pairs,\n    [\n      R.T,\n      (e) => {\n        throw e\n      },\n    ],\n  ])\n\nconst startsWithSafe = (prefix: string) => (str: unknown) =>\n  typeof str === 'string' ? str.startsWith(prefix) : false\n\ntype ErrorCatcher = [(error: unknown) => boolean, (error: unknown) => never]\n\nexport const catchErrors = (pairs: ErrorCatcher[] = []) =>\n  R.cond([\n    [\n      R.propEq('message', 'Network Failure'),\n      () => {\n        throw new CORSError()\n      },\n    ],\n    [\n      R.propEq('message', 'Access Denied'),\n      () => {\n        throw new AccessDenied()\n      },\n    ],\n    [\n      R.propEq('code', 'Forbidden'),\n      () => {\n        throw new AccessDenied()\n      },\n    ],\n    [\n      R.propEq('code', 'NoSuchBucket'),\n      () => {\n        throw new NoSuchBucket()\n      },\n    ],\n    [\n      R.propEq(\n        'message',\n        \"API Gateway error (500): NotFoundError(404, 'index_not_found_exception', 'no such index')\",\n      ),\n      () => {\n        throw new ESNoIndex()\n      },\n    ],\n    [\n      R.propSatisfies(\n        startsWithSafe(\n          'API Gateway error (500): ConnectionTimeout caused by - ReadTimeout',\n        ),\n        'message',\n      ),\n      () => {\n        throw new ESTimeout()\n      },\n    ],\n    [\n      R.propSatisfies(\n        startsWithSafe(\n          \"API Gateway error (500): AuthorizationException(403, '403 Request throttled due to too many requests\",\n        ),\n        'message',\n      ),\n      () => {\n        throw new ESThrottle()\n      },\n    ],\n    ...pairs,\n    [\n      R.T,\n      (e) => {\n        throw e\n      },\n    ],\n  ]) as (reason: unknown) => never\n","import type { S3 } from 'aws-sdk'\nimport * as React from 'react'\nimport * as R from 'ramda'\n\nimport * as AWS from 'utils/AWS'\n\nimport * as errors from '../errors'\n\nimport { decodeS3Key } from './utils'\n\nconst DEFAULT_DRAIN_REQUESTS = 10\n\ninterface DrainObjectListParams {\n  s3: S3\n  bucket: string\n  prefix: string\n  delimiter?: string\n  continuationToken?: string\n  maxRequests: true | number\n}\n\nconst drainObjectList = async ({\n  s3,\n  bucket,\n  prefix,\n  delimiter,\n  continuationToken,\n  maxRequests,\n}: DrainObjectListParams) => {\n  let reqNo = 0\n  let Contents: S3.Object[] = []\n  let CommonPrefixes: S3.CommonPrefixList = []\n  let ContinuationToken: string | undefined\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    // eslint-disable-next-line no-await-in-loop\n    const r = await s3\n      .listObjectsV2({\n        Bucket: bucket,\n        Delimiter: delimiter,\n        Prefix: prefix,\n        ContinuationToken: ContinuationToken || continuationToken,\n        EncodingType: 'url',\n      })\n      .promise()\n    Contents = Contents.concat(r.Contents || [])\n    CommonPrefixes = CommonPrefixes.concat(r.CommonPrefixes || [])\n    reqNo += 1\n    if (!r.IsTruncated || reqNo >= maxRequests) return { ...r, Contents, CommonPrefixes }\n    ContinuationToken = r.NextContinuationToken\n  }\n}\n\nexport interface BucketListingFile {\n  bucket: string\n  key: string\n  modified: Date\n  size: number\n  etag: string\n  archived: boolean\n}\n\nexport interface BucketListingResult {\n  dirs: string[]\n  files: BucketListingFile[]\n  truncated: boolean\n  continuationToken?: string\n  bucket: string\n  path: string\n  prefix?: string\n}\n\ninterface BucketListingDependencies {\n  s3: S3\n}\n\ninterface BucketListingParams {\n  bucket: string\n  path?: string\n  prefix?: string\n  prev?: BucketListingResult\n  delimiter?: string | false\n  drain?: true | number\n}\n\nexport const bucketListing = async ({\n  s3,\n  bucket,\n  path = '',\n  prefix,\n  prev,\n  delimiter = '/',\n  drain = 0,\n}: BucketListingParams & BucketListingDependencies): Promise<BucketListingResult> =>\n  drainObjectList({\n    s3,\n    bucket,\n    prefix: path + (prefix || ''),\n    delimiter: delimiter === false ? undefined : delimiter,\n    continuationToken: prev ? prev.continuationToken : undefined,\n    maxRequests: drain === true ? DEFAULT_DRAIN_REQUESTS : drain,\n  })\n    .then((res) => {\n      let dirs = (res.CommonPrefixes || [])\n        .map((p) => decodeS3Key(p.Prefix!))\n        .filter((d) => d !== '/' && d !== '../')\n      if (prev && prev.dirs) dirs = prev.dirs.concat(dirs)\n      dirs = R.uniq(dirs)\n\n      let files = (res.Contents || [])\n        .map(R.evolve({ Key: decodeS3Key }))\n        // filter-out \"directory-files\" (files that match prefixes)\n        .filter(({ Key }: S3.Object) => Key !== path && !Key!.endsWith('/'))\n        .map((i: S3.Object) => ({\n          bucket,\n          key: i.Key!,\n          modified: i.LastModified!,\n          size: i.Size!,\n          etag: i.ETag!,\n          archived: i.StorageClass === 'GLACIER' || i.StorageClass === 'DEEP_ARCHIVE',\n        }))\n      if (prev && prev.files) files = prev.files.concat(files)\n\n      return {\n        dirs,\n        files,\n        truncated: res.IsTruncated!,\n        continuationToken: res.NextContinuationToken,\n        bucket,\n        path,\n        prefix,\n      }\n    })\n    .catch(errors.catchErrors())\n\nexport function useBucketListing() {\n  const s3: S3 = AWS.S3.use()\n  return React.useCallback(\n    (params: BucketListingParams) => bucketListing({ s3, ...params }),\n    [s3],\n  )\n}\n","import type { S3 } from 'aws-sdk'\nimport * as R from 'ramda'\n\nimport { makeSchemaDefaultsSetter, JsonSchema } from 'utils/json-schema'\nimport pipeThru from 'utils/pipeThru'\nimport * as s3paths from 'utils/s3paths'\nimport * as workflows from 'utils/workflows'\n\nimport * as errors from '../errors'\nimport * as requests from './requestsUntyped'\n\nexport const objectSchema = async ({ s3, schemaUrl }: { s3: S3; schemaUrl: string }) => {\n  if (!schemaUrl) return null\n\n  const { bucket, key, version } = s3paths.parseS3Url(schemaUrl)\n\n  try {\n    const response = await requests.fetchFile({ s3, bucket, path: key, version })\n    return JSON.parse(response.Body.toString('utf-8'))\n  } catch (e) {\n    if (e instanceof errors.FileNotFound || e instanceof errors.VersionNotFound) throw e\n\n    // eslint-disable-next-line no-console\n    console.log('Unable to fetch')\n    // eslint-disable-next-line no-console\n    console.error(e)\n  }\n\n  return null\n}\n\nexport const getMetaValue = (value: unknown, optSchema?: JsonSchema) =>\n  value\n    ? pipeThru(value || {})(\n        makeSchemaDefaultsSetter(optSchema),\n        R.toPairs,\n        R.filter(([k]) => !!k.trim()),\n        R.fromPairs,\n        R.when(R.isEmpty, () => undefined),\n      )\n    : undefined\n\nexport const getWorkflowApiParam = R.cond([\n  [R.equals(workflows.notAvailable), R.always(undefined)],\n  [R.equals(workflows.notSelected), R.always(null)],\n  [R.T, R.identity],\n]) as (\n  slug: typeof workflows.notAvailable | typeof workflows.notSelected | string,\n) => string | null | undefined\n","import * as R from 'ramda'\n\nexport const decodeS3Key = R.pipe(R.replace(/\\+/g, ' '), decodeURIComponent)\n","import * as FP from 'fp-ts'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\nimport * as Lab from '@material-ui/lab'\n\nimport StyledLink from 'utils/StyledLink'\nimport Code from 'components/Code'\n\nconst ES_V = '6.7'\nconst ES_REF = `https://www.elastic.co/guide/en/elasticsearch/reference/${ES_V}/query-dsl-query-string-query.html#query-string-syntax`\n\nconst useStyles = M.makeStyles((t) => ({\n  group: {\n    marginTop: t.spacing(2),\n  },\n  headerLabel: {\n    background: 'transparent !important',\n  },\n  item: {\n    borderBottom: `1px solid ${t.palette.divider}`,\n\n    '&:last-child': {\n      border: 0,\n    },\n  },\n  list: {\n    marginBottom: t.spacing(1),\n  },\n  subList: {\n    marginLeft: t.spacing(-1.5),\n  },\n}))\n\ntype ExampleFormatter = (...syntaxParts: React.ReactNode[]) => React.ReactNode\n\ninterface SyntaxHelpItem {\n  example: ExampleFormatter\n  syntax: string | string[]\n  title: string\n}\n\ninterface SyntaxHelpNamespace {\n  namespace: string\n  rows: SyntaxHelpItem[]\n}\n\nconst syntaxHelpRows: SyntaxHelpNamespace[] = [\n  {\n    namespace: 'Fields',\n    rows: [\n      {\n        example: (s) => <>{s}TODO</>,\n        syntax: 'comment:',\n        title: 'Package comment',\n      },\n      {\n        example: (s) => <>{s}Hello</>,\n        syntax: 'content:',\n        title: 'Object content',\n      },\n      {\n        example: (s) => <>{s}*.fastq.gz</>,\n        syntax: 'ext:',\n        title: 'Object extension',\n      },\n      {\n        example: (s) => <>{s}user\\/*</>,\n        syntax: 'handle:',\n        title: 'Package name',\n      },\n      {\n        example: (s) => <>{s}3192ac1*</>,\n        syntax: 'hash:',\n        title: 'Package hash',\n      },\n      {\n        example: (s) => <>{s}research*</>,\n        syntax: 'key:',\n        title: 'Object key',\n      },\n      {\n        example: (s) => <>{s}\"research\"</>,\n        syntax: 'key_text:',\n        title: 'Analyzed object key',\n      },\n      {\n        example: (s) => <>{s}[2022-02-04 TO 2022-02-20]</>,\n        syntax: 'last_modified:',\n        title: 'Last modified date',\n      },\n      {\n        example: (s) => <>{s}dapi</>,\n        syntax: 'metadata:',\n        title: 'Package metadata',\n      },\n      {\n        example: (s) => <>{s}&gt;=4096</>,\n        syntax: 'size:',\n        title: 'Object size in bytes',\n      },\n      {\n        example: (s) => <>{s}t.LVVCx*</>,\n        syntax: 'version_id:',\n        title: 'Object version id',\n      },\n      {\n        example: (s) => <>{s}&gt;100</>,\n        syntax: 'package_stats\\n  .total_files:',\n        title: 'Package total files',\n      },\n      {\n        example: (s) => <>{s}&lt;100</>,\n        syntax: 'package_stats\\n  .total_bytes:',\n        title: 'Package total bytes',\n      },\n    ],\n  },\n\n  {\n    namespace: 'Logical operators and grouping',\n    rows: [\n      {\n        example: (s) => <>a {s} b</>,\n        syntax: 'AND',\n        title: 'Conjunction',\n      },\n      {\n        example: (s) => <>a {s} b</>,\n        syntax: 'OR',\n        title: 'Disjunction',\n      },\n      {\n        example: (s) => <>{s} a</>,\n        syntax: 'NOT',\n        title: 'Negation',\n      },\n      {\n        example: (s) => <>{s} content</>,\n        syntax: '_exists_:',\n        title: 'Matches any non-null value for the given field',\n      },\n      {\n        example: (s1, s2) => (\n          <>\n            {s1}a AND b{s2}\n          </>\n        ),\n        syntax: ['(', ')'],\n        title: 'Group terms',\n      },\n    ],\n  },\n\n  {\n    namespace: 'Wildcards and regular expressions',\n    rows: [\n      {\n        example: (s) => <>config.y{s}ml</>,\n        syntax: '*',\n        title: 'Zero or more characters, avoid leading * (slow)',\n      },\n      {\n        example: (s) => <>React.{s}sx</>,\n        syntax: '?',\n        title: 'Exactly one character',\n      },\n      {\n        example: (s1, s2) => (\n          <>\n            {s1}lmnb[12]{s2}\n          </>\n        ),\n        syntax: ['/', '/'],\n        title: 'Regular expression (slows search)',\n      },\n    ],\n  },\n]\n\nconst useExamplePartStyles = M.makeStyles((t) => ({\n  root: {\n    color: t.palette.text.hint,\n  },\n  syntax: {\n    color: t.palette.text.primary,\n  },\n}))\n\ninterface ExamplePartProps {\n  syntax: string | string[]\n  example: ExampleFormatter\n}\n\nfunction Example({ syntax, example }: ExamplePartProps) {\n  const classes = useExamplePartStyles()\n  const syntaxParts = (Array.isArray(syntax) ? syntax : [syntax]).map((part) => (\n    <span className={classes.syntax}>{part}</span>\n  ))\n  return <span className={classes.root}>{example(...syntaxParts)}</span>\n}\n\ninterface SyntaxProps {\n  syntax: string | string[]\n}\nfunction Syntax({ syntax }: SyntaxProps) {\n  return <>{Array.isArray(syntax) ? syntax.join('') : syntax}</>\n}\n\ninterface ItemProps {\n  item: SyntaxHelpItem\n}\n\nfunction Item({ item }: ItemProps) {\n  const t = M.useTheme()\n  const sm = M.useMediaQuery(t.breakpoints.up('sm'))\n\n  const { example, syntax, title } = item\n  return (\n    <M.Grid container>\n      <M.Grid item xs={7}>\n        <M.Typography variant=\"body2\">\n          <Code>\n            {sm ? (\n              <Example syntax={syntax} example={example} />\n            ) : (\n              <Syntax syntax={syntax} />\n            )}\n          </Code>\n        </M.Typography>\n      </M.Grid>\n      <M.Grid item xs>\n        <M.Typography variant=\"body2\">{title}</M.Typography>\n      </M.Grid>\n    </M.Grid>\n  )\n}\n\nconst useItemsHeaderStyles = M.makeStyles((t) => ({\n  root: {\n    borderBottom: `1px solid ${t.palette.divider}`,\n    padding: `0 ${t.spacing(2)}px ${t.spacing(1)}px`,\n  },\n}))\n\nfunction ItemsHeader() {\n  const classes = useItemsHeaderStyles()\n\n  return (\n    <M.Grid container className={classes.root}>\n      <M.Grid item xs={7}>\n        <M.Typography variant=\"subtitle2\">Command</M.Typography>\n      </M.Grid>\n      <M.Grid item xs>\n        <M.Typography variant=\"subtitle2\">Description</M.Typography>\n      </M.Grid>\n    </M.Grid>\n  )\n}\n\nconst useDocsExternalLinkStyles = M.makeStyles((t) => ({\n  root: {\n    marginTop: t.spacing(2),\n    marginBottom: t.spacing(4),\n  },\n}))\n\nfunction DocsExternalLink() {\n  const classes = useDocsExternalLinkStyles()\n\n  return (\n    <M.Typography variant=\"body2\" component=\"p\" className={classes.root}>\n      {`Quilt uses ElasticSearch ${ES_V} query string queries. `}\n      <StyledLink href={ES_REF} target=\"_blank\">\n        Learn more\n      </StyledLink>\n      .\n    </M.Typography>\n  )\n}\n\nconst normalizeSyntaxItem = (s: string | string[]) =>\n  FP.function.pipe(\n    s,\n    (s1: string | string[]) => (Array.isArray(s1) ? s1.join('') : s1),\n    (s2: string) => s2.replace(/\\s/g, ''),\n  )\n\ntype HelpProps = Partial<React.HTMLAttributes<HTMLDivElement>> & {\n  className: string\n  onQuery: (query: string) => void\n}\n\nexport default function Help({ className, onQuery, ...props }: HelpProps) {\n  const classes = useStyles()\n\n  return (\n    <div className={className} {...props}>\n      <Lab.TreeView\n        defaultCollapseIcon={<M.Icon>arrow_drop_down</M.Icon>}\n        defaultExpandIcon={<M.Icon>arrow_right</M.Icon>}\n        defaultExpanded={syntaxHelpRows.map(({ namespace }) => namespace)}\n        disableSelection\n        className={classes.list}\n      >\n        {syntaxHelpRows.map(({ namespace, rows }) => (\n          <Lab.TreeItem\n            className={classes.group}\n            label={<M.Typography variant=\"subtitle2\">{namespace}</M.Typography>}\n            nodeId={namespace}\n            key={namespace}\n            classes={{\n              label: classes.headerLabel,\n            }}\n          >\n            <M.List className={classes.subList}>\n              <ItemsHeader />\n\n              {rows.map((item) => {\n                const syntax = normalizeSyntaxItem(item.syntax)\n                return (\n                  <M.ListItem\n                    key={syntax}\n                    className={classes.item}\n                    button\n                    onClick={() => onQuery(syntax)}\n                  >\n                    <Item item={item} />\n                  </M.ListItem>\n                )\n              })}\n            </M.List>\n          </Lab.TreeItem>\n        ))}\n      </Lab.TreeView>\n\n      <DocsExternalLink />\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { CssBaseline } from '@material-ui/core'\nimport { makeStyles } from '@material-ui/styles'\n\nconst useGlobalStyles = makeStyles({\n  '@global': {\n    'html, body': {\n      background: '#19163b',\n      cursor: 'auto',\n      textRendering: 'optimizeLegibility',\n      height: '100%',\n      width: '100%',\n      wordBreak: 'normal',\n    },\n    a: {\n      color: 'inherit',\n      textDecoration: 'none',\n    },\n    'code, kbd, pre, samp': {\n      fontFamily: \"'Roboto Mono', monospace\",\n    },\n    h1: {\n      // reset margin set by sanitize.css\n      margin: 0,\n    },\n    p: {\n      // reset margins set by user-agent\n      marginBlockEnd: 0,\n      marginBlockStart: 0,\n    },\n  },\n})\n\nfunction GlobalStyles() {\n  useGlobalStyles()\n  return null\n}\n\nexport default function WithGlobalStyles({ children }: React.PropsWithChildren<{}>) {\n  return (\n    <CssBaseline>\n      <GlobalStyles />\n      {children}\n    </CssBaseline>\n  )\n}\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport type { TypedDocumentNode as DocumentNode } from '@graphql-typed-document-node/core'\nimport * as Types from '../model/graphql/types.generated'\n\nexport type utils_BucketConfigListQueryVariables = Types.Exact<{\n  includeCollaborators?: Types.Scalars['Boolean']\n}>\n\nexport type utils_BucketConfigListQuery = { readonly __typename: 'Query' } & {\n  readonly bucketConfigs: ReadonlyArray<\n    { readonly __typename: 'BucketConfig' } & Pick<\n      Types.BucketConfig,\n      | 'name'\n      | 'title'\n      | 'iconUrl'\n      | 'description'\n      | 'linkedData'\n      | 'overviewUrl'\n      | 'tags'\n      | 'relevanceScore'\n    > & {\n        readonly collaborators?: Types.Maybe<\n          ReadonlyArray<\n            { readonly __typename: 'CollaboratorBucketConnection' } & Pick<\n              Types.CollaboratorBucketConnection,\n              'permissionLevel'\n            > & {\n                readonly collaborator: { readonly __typename: 'Collaborator' } & Pick<\n                  Types.Collaborator,\n                  'email' | 'username'\n                >\n              }\n          >\n        >\n      }\n  >\n}\n\nexport const utils_BucketConfigListDocument = {\n  kind: 'Document',\n  definitions: [\n    {\n      kind: 'OperationDefinition',\n      operation: 'query',\n      name: { kind: 'Name', value: 'utils_BucketConfigList' },\n      variableDefinitions: [\n        {\n          kind: 'VariableDefinition',\n          variable: {\n            kind: 'Variable',\n            name: { kind: 'Name', value: 'includeCollaborators' },\n          },\n          type: {\n            kind: 'NonNullType',\n            type: { kind: 'NamedType', name: { kind: 'Name', value: 'Boolean' } },\n          },\n          defaultValue: { kind: 'BooleanValue', value: false },\n        },\n      ],\n      selectionSet: {\n        kind: 'SelectionSet',\n        selections: [\n          {\n            kind: 'Field',\n            name: { kind: 'Name', value: 'bucketConfigs' },\n            selectionSet: {\n              kind: 'SelectionSet',\n              selections: [\n                { kind: 'Field', name: { kind: 'Name', value: 'name' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'title' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'iconUrl' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'description' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'linkedData' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'overviewUrl' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'tags' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'relevanceScore' } },\n                {\n                  kind: 'Field',\n                  name: { kind: 'Name', value: 'collaborators' },\n                  directives: [\n                    {\n                      kind: 'Directive',\n                      name: { kind: 'Name', value: 'include' },\n                      arguments: [\n                        {\n                          kind: 'Argument',\n                          name: { kind: 'Name', value: 'if' },\n                          value: {\n                            kind: 'Variable',\n                            name: { kind: 'Name', value: 'includeCollaborators' },\n                          },\n                        },\n                      ],\n                    },\n                  ],\n                  selectionSet: {\n                    kind: 'SelectionSet',\n                    selections: [\n                      {\n                        kind: 'Field',\n                        name: { kind: 'Name', value: 'collaborator' },\n                        selectionSet: {\n                          kind: 'SelectionSet',\n                          selections: [\n                            { kind: 'Field', name: { kind: 'Name', value: 'email' } },\n                            { kind: 'Field', name: { kind: 'Name', value: 'username' } },\n                          ],\n                        },\n                      },\n                      { kind: 'Field', name: { kind: 'Name', value: 'permissionLevel' } },\n                    ],\n                  },\n                },\n              ],\n            },\n          },\n        ],\n      },\n    },\n  ],\n} as unknown as DocumentNode<\n  utils_BucketConfigListQuery,\n  utils_BucketConfigListQueryVariables\n>\n\nexport { utils_BucketConfigListDocument as default }\n","import * as R from 'ramda'\nimport * as React from 'react'\nimport * as redux from 'react-redux'\nimport * as urql from 'urql'\n\nimport * as AuthSelectors from 'containers/Auth/selectors'\nimport * as Config from 'utils/Config'\nimport * as NamedRoutes from 'utils/NamedRoutes'\nimport { useRoute } from 'utils/router'\n\nimport BUCKET_CONFIGS_QUERY from './BucketConfigList.generated'\n\n// always suspended\nfunction useBucketConfigs() {\n  const cfg = Config.use()\n  const authenticated = redux.useSelector(AuthSelectors.authenticated)\n  // XXX: consider moving this logic to gql resolver\n  const empty = cfg.mode === 'MARKETING' || (cfg.alwaysRequiresAuth && !authenticated)\n\n  const [{ data }] = urql.useQuery({\n    query: BUCKET_CONFIGS_QUERY,\n    pause: empty,\n    variables: { includeCollaborators: cfg.mode === 'PRODUCT' },\n  })\n\n  return React.useMemo(() => {\n    if (empty) return []\n    return data?.bucketConfigs || []\n  }, [empty, data?.bucketConfigs])\n}\n\n// XXX: consider deprecating this in favor of direct graphql usage\nexport const useRelevantBucketConfigs = () => {\n  const bs = useBucketConfigs()\n  return React.useMemo(() => {\n    const filtered = bs.filter((b) => b.relevanceScore >= 0)\n    const sorted = R.sortWith(\n      [R.descend(R.prop('relevanceScore')), R.ascend(R.prop('name'))],\n      filtered,\n    )\n    return sorted\n  }, [bs])\n}\n\nexport const useCurrentBucket = () => {\n  const { paths } = NamedRoutes.use()\n  const { match } = useRoute(paths.bucketRoot)\n  return match && match.params.bucket\n}\n\nexport function useIsInStack() {\n  const bucketConfigs = useBucketConfigs()\n  return React.useCallback(\n    (bucket: string) => bucketConfigs.some((bc) => bc.name === bucket),\n    [bucketConfigs],\n  )\n}\n","import * as R from 'ramda'\n\nimport bucketPreferencesSchema from 'schemas/bucketConfig.yml.json'\n\nimport * as bucketErrors from 'containers/Bucket/errors'\nimport { makeSchemaValidator } from 'utils/json-schema'\nimport * as YAML from 'utils/yaml'\n\nexport type SentryInstance = (command: 'captureMessage', message: string) => void\n\nexport type ActionPreferences = Record<\n  'copyPackage' | 'createPackage' | 'deleteRevision' | 'openInDesktop' | 'revisePackage',\n  boolean\n>\n\nexport interface MetaBlockPreferencesInput {\n  user_meta?: {\n    expanded: boolean | number\n  }\n  workflows?: {\n    expanded: boolean | number\n  }\n}\n\nexport interface MetaBlockPreferences {\n  userMeta: {\n    expanded: boolean | number\n  }\n  workflows: {\n    expanded: boolean | number\n  }\n}\n\ninterface BlocksPreferencesInput {\n  analytics?: boolean\n  browser?: boolean\n  code?: boolean\n  meta?: boolean | MetaBlockPreferencesInput\n}\n\ninterface BlocksPreferences {\n  analytics: boolean\n  browser: boolean\n  code: boolean\n  meta: false | MetaBlockPreferences\n}\n\nexport type NavPreferences = Record<'files' | 'packages' | 'queries', boolean>\n\ninterface PackagePreferencesInput {\n  message?: true\n  user_meta?: ReadonlyArray<string>\n}\ninterface PackagePreferences {\n  message?: true\n  userMeta?: ReadonlyArray<string>\n}\ntype PackagesListPreferencesInput = Record<string, PackagePreferencesInput>\ntype PackagesListPreferences = Record<string, PackagePreferences>\n\ntype DefaultSourceBucketInput = string\ntype SourceBucketsInput = Record<string, null>\n\nexport interface AthenaPreferencesInput {\n  defaultWorkflow?: string // @deprecated, was used by mistake\n  defaultWorkgroup?: string\n}\n\nexport interface AthenaPreferences {\n  defaultWorkgroup?: string\n}\n\ninterface UiPreferencesInput {\n  actions?: Partial<ActionPreferences>\n  athena?: AthenaPreferences\n  blocks?: Partial<BlocksPreferencesInput>\n  defaultSourceBucket?: DefaultSourceBucketInput\n  nav?: Partial<NavPreferences>\n  package_description?: PackagesListPreferencesInput\n  sourceBuckets?: SourceBucketsInput\n}\n\ninterface BucketPreferencesInput {\n  ui?: UiPreferencesInput\n}\n\nexport interface SourceBuckets {\n  getDefault: () => string\n  list: string[]\n}\n\ninterface UiPreferences {\n  actions: ActionPreferences\n  athena: AthenaPreferences\n  blocks: BlocksPreferences\n  nav: NavPreferences\n  package_description: PackagesListPreferences\n  sourceBuckets: SourceBuckets\n}\n\nexport interface BucketPreferences {\n  ui: UiPreferences\n}\n\nconst defaultBlockMeta: MetaBlockPreferences = {\n  userMeta: {\n    expanded: false,\n  },\n  workflows: {\n    expanded: false,\n  },\n}\n\nconst defaultPreferences: BucketPreferences = {\n  ui: {\n    actions: {\n      copyPackage: true,\n      createPackage: true,\n      deleteRevision: false,\n      openInDesktop: false,\n      revisePackage: true,\n    },\n    athena: {},\n    blocks: {\n      analytics: true,\n      browser: true,\n      code: true,\n      meta: defaultBlockMeta,\n    },\n    nav: {\n      files: true,\n      packages: true,\n      queries: true,\n    },\n    package_description: {\n      '.*': {\n        message: true,\n      },\n    },\n    sourceBuckets: {\n      getDefault: () => '',\n      list: [],\n    },\n  },\n}\n\nconst S3_PREFIX = 's3://'\nconst normalizeBucketName = (input: string) =>\n  input.startsWith(S3_PREFIX) ? input.slice(S3_PREFIX.length) : input\n\nconst bucketPreferencesValidator = makeSchemaValidator(bucketPreferencesSchema)\n\nfunction validate(data: unknown): asserts data is BucketPreferencesInput {\n  const errors = bucketPreferencesValidator(data)\n  if (errors.length) throw new bucketErrors.BucketPreferencesInvalid({ errors })\n}\n\nfunction parseAthena(athena?: AthenaPreferencesInput): AthenaPreferences {\n  const { defaultWorkflow, ...rest } = { ...defaultPreferences.ui.athena, ...athena }\n  return {\n    ...(defaultWorkflow\n      ? {\n          defaultWorkgroup: defaultWorkflow,\n        }\n      : null),\n    ...rest,\n  }\n}\n\nfunction parseMetaBlock(\n  meta?: boolean | MetaBlockPreferencesInput,\n): false | MetaBlockPreferences {\n  if (meta === false) return false\n  if (meta === true || meta === undefined) return defaultBlockMeta\n  return {\n    userMeta: meta.user_meta || defaultBlockMeta.userMeta,\n    workflows: meta.workflows || defaultBlockMeta.workflows,\n  }\n}\n\nfunction parseBlocks(blocks?: BlocksPreferencesInput): BlocksPreferences {\n  return {\n    ...defaultPreferences.ui.blocks,\n    ...blocks,\n    meta: parseMetaBlock(blocks?.meta),\n  }\n}\n\nfunction parsePackages(packages?: PackagesListPreferencesInput): PackagesListPreferences {\n  return Object.entries(packages || {}).reduce(\n    (memo, [name, { message, user_meta }]) => ({\n      ...memo,\n      [name]: {\n        message,\n        userMeta: user_meta,\n      },\n    }),\n    defaultPreferences.ui.package_description,\n  )\n}\n\nfunction parseSourceBuckets(\n  sentry: SentryInstance,\n  sourceBuckets?: SourceBucketsInput,\n  defaultSourceBucketInput?: DefaultSourceBucketInput,\n): SourceBuckets {\n  const list = Object.keys(sourceBuckets || {}).map(normalizeBucketName)\n  const defaultSourceBucket = normalizeBucketName(defaultSourceBucketInput || '')\n  return {\n    getDefault: () => {\n      if (defaultSourceBucket) {\n        const found = list.find((name) => name === defaultSourceBucket)\n        if (found) return found\n        // TODO: use more civilized logger, log all similar configuration errors\n        sentry(\n          'captureMessage',\n          `defaultSourceBucket ${defaultSourceBucket} is incorrect`,\n        )\n      }\n      return list[0] || ''\n    },\n    list,\n  }\n}\n\nexport function extendDefaults(\n  data: BucketPreferencesInput,\n  sentry: SentryInstance,\n): BucketPreferences {\n  return {\n    ui: {\n      ...R.mergeDeepRight(defaultPreferences.ui, data?.ui || {}),\n      athena: parseAthena(data?.ui?.athena),\n      blocks: parseBlocks(data?.ui?.blocks),\n      package_description: parsePackages(data?.ui?.package_description),\n      sourceBuckets: parseSourceBuckets(\n        sentry,\n        data?.ui?.sourceBuckets,\n        data?.ui?.defaultSourceBucket,\n      ),\n    },\n  }\n}\n\nexport function parse(\n  bucketPreferencesYaml: string,\n  sentry: SentryInstance,\n): BucketPreferences {\n  const data = YAML.parse(bucketPreferencesYaml)\n  if (!data) return defaultPreferences\n\n  validate(data)\n\n  return extendDefaults(data, sentry)\n}\n","import * as React from 'react'\n\nimport AsyncResult from 'utils/AsyncResult'\nimport * as Sentry from 'utils/Sentry'\n\nimport { BucketPreferences, extendDefaults } from './BucketPreferences'\n\nconst localModePreferences = {\n  ui: {\n    actions: {\n      copyPackage: false,\n      createPackage: false,\n      deleteRevision: false,\n      revisePackage: false,\n    },\n    blocks: {\n      analytics: false,\n    },\n    nav: {\n      queries: false,\n    },\n  },\n}\n\ninterface LocalProviderProps {\n  context: React.Context<{ preferences: BucketPreferences | null; result: $TSFixMe }>\n  children: React.ReactNode\n}\n\nexport default function LocalProvider({ context: Ctx, children }: LocalProviderProps) {\n  const sentry = Sentry.use()\n  const preferences = React.useMemo(\n    () => extendDefaults(localModePreferences, sentry),\n    [sentry],\n  )\n  const result = AsyncResult.Ok(preferences)\n  return <Ctx.Provider value={{ preferences, result }}>{children}</Ctx.Provider>\n}\n","import * as R from 'ramda'\nimport * as React from 'react'\n\nimport * as bucketErrors from 'containers/Bucket/errors'\nimport * as requests from 'containers/Bucket/requests'\nimport * as quiltConfigs from 'constants/quiltConfigs'\nimport * as AWS from 'utils/AWS'\nimport AsyncResult from 'utils/AsyncResult'\nimport * as CatalogSettings from 'utils/CatalogSettings'\nimport * as Config from 'utils/Config'\nimport { useData } from 'utils/Data'\nimport * as Sentry from 'utils/Sentry'\n\nimport { BucketPreferences, SentryInstance, parse } from './BucketPreferences'\nimport LocalProvider from './LocalProvider'\n\ninterface FetchBucketPreferencesArgs {\n  s3: $TSFixMe\n  bucket: string\n  sentry: SentryInstance\n}\n\nasync function fetchBucketPreferences({\n  s3,\n  sentry,\n  bucket,\n}: FetchBucketPreferencesArgs) {\n  try {\n    const response = await requests.fetchFile({\n      s3,\n      bucket,\n      path: quiltConfigs.bucketPreferences,\n    })\n    return parse(response.Body.toString('utf-8'), sentry)\n  } catch (e) {\n    if (\n      e instanceof bucketErrors.FileNotFound ||\n      e instanceof bucketErrors.VersionNotFound\n    )\n      return parse('', sentry)\n\n    // eslint-disable-next-line no-console\n    console.log('Unable to fetch')\n    // eslint-disable-next-line no-console\n    console.error(e)\n    throw e\n  }\n}\n\nconst Ctx = React.createContext<{\n  preferences: BucketPreferences | null\n  result: $TSFixMe\n}>({\n  result: AsyncResult.Init(),\n  preferences: null,\n})\n\ntype ProviderProps = React.PropsWithChildren<{ bucket: string }>\n\nfunction CatalogProvider({ bucket, children }: ProviderProps) {\n  const sentry = Sentry.use()\n  const s3 = AWS.S3.use()\n  const settings = CatalogSettings.use()\n  const data = useData(fetchBucketPreferences, { s3, sentry, bucket })\n\n  // XXX: migrate to AsyncResult\n  const preferences = data.case({\n    Ok: settings?.beta\n      ? R.assocPath(['ui', 'actions', 'openInDesktop'], true)\n      : R.identity,\n    Err: () => parse('', sentry),\n    _: () => null,\n  })\n  const result = preferences ? AsyncResult.Ok(preferences) : AsyncResult.Pending()\n  return <Ctx.Provider value={{ preferences, result }}>{children}</Ctx.Provider>\n}\n\nexport function Provider({ bucket, children }: ProviderProps) {\n  const cfg = Config.use()\n  const local = cfg.mode === 'LOCAL'\n  if (local) return <LocalProvider context={Ctx}>{children}</LocalProvider>\n\n  return <CatalogProvider bucket={bucket}>{children}</CatalogProvider>\n}\n\nexport const useBucketPreferences = () => React.useContext(Ctx)\n\nexport const use = useBucketPreferences\n","import type { S3 } from 'aws-sdk'\nimport * as React from 'react'\n\nimport * as AWS from 'utils/AWS'\nimport * as Config from 'utils/Config'\nimport * as Cache from 'utils/ResourceCache'\n\nconst CONFIG_KEY = 'catalog/settings.json'\n\nexport interface CatalogSettings {\n  customNavLink?: {\n    url: string\n    label: string\n  }\n  logo?: {\n    url: string\n  }\n  beta?: boolean\n  theme?: {\n    palette: {\n      primary: {\n        main: string\n      }\n    }\n  }\n}\n\nasync function fetchSettings({\n  s3,\n  serviceBucket,\n  mode,\n}: {\n  s3: S3\n  serviceBucket: string\n  mode: string\n}) {\n  if (mode === 'MARKETING' || mode === 'LOCAL') return null\n\n  const location = `s3://${serviceBucket}/${CONFIG_KEY}`\n  try {\n    const res = await s3.getObject({ Bucket: serviceBucket, Key: CONFIG_KEY }).promise()\n    const text = res.Body!.toString('utf-8')\n    return JSON.parse(text) as CatalogSettings\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.warn(`Error fetching catalog settings from \"${location}\":`)\n    // eslint-disable-next-line no-console\n    console.error(e)\n    return null\n  }\n}\n\nconst CatalogSettingsResource = Cache.createResource({\n  name: 'CatalogSettings.config',\n  fetch: fetchSettings,\n  // @ts-expect-error\n  key: () => null,\n})\n\nfunction format(settings: CatalogSettings) {\n  return JSON.stringify(settings, null, 2)\n}\n\n// FIXME: remove if decide to not use file upload for logo\nexport function useUploadFile() {\n  return React.useCallback(async (file: File) => {\n    // eslint-disable-next-line no-console\n    console.log(file)\n    throw new Error('This functionality is not ready yet')\n  }, [])\n}\n\nexport function useWriteSettings() {\n  const { serviceBucket } = Config.use()\n  const s3 = AWS.S3.use()\n  const cache = Cache.use()\n\n  return React.useCallback(\n    async (settings: CatalogSettings) => {\n      const body = format(settings)\n      await s3.putObject({ Bucket: serviceBucket, Key: CONFIG_KEY, Body: body }).promise()\n      cache.patchOk(CatalogSettingsResource, null, () => settings)\n    },\n    [serviceBucket, s3, cache],\n  )\n}\n\nexport function useCatalogSettings() {\n  const { serviceBucket, mode } = Config.use()\n  const s3 = AWS.S3.use()\n  return Cache.useData(\n    CatalogSettingsResource,\n    { serviceBucket, mode, s3 },\n    { suspend: true },\n  ) as CatalogSettings | null\n}\n\nexport { useCatalogSettings as use }\n","import Ajv from 'ajv'\nimport invariant from 'invariant'\n\nimport { BaseError } from 'utils/error'\nimport { printObject } from 'utils/string'\n\nimport configSchema from '../../config-schema.json'\n\ntype Mode = 'MARKETING' | 'OPEN' | 'PRODUCT' | 'LOCAL'\ntype AuthMethodConfig = 'ENABLED' | 'DISABLED' | 'SIGN_IN_ONLY'\n\n// manually synced w/ config-schema.json\nexport interface ConfigJson {\n  alwaysRequiresAuth: boolean\n  analyticsBucket?: string\n  apiGatewayEndpoint: string\n  binaryApiGatewayEndpoint: string\n  calendlyLink?: string\n  googleClientId?: string\n  oktaClientId?: string\n  oktaBaseUrl?: string\n  intercomAppId?: string\n  mode: Mode\n  legacyPackagesRedirect?: string\n  linkedData?: {\n    name?: string\n    description?: string\n  }\n  mixpanelToken: string\n  noDownload?: boolean\n  noOverviewImages?: boolean\n  passwordAuth: AuthMethodConfig\n  registryUrl: string\n  s3Proxy: string\n  sentryDSN?: string\n  serviceBucket: string\n  ssoAuth: AuthMethodConfig\n  ssoProviders: string\n  desktop?: boolean\n  build_version?: string // not sure where this comes from\n}\n\nconst ajv = new Ajv({ allErrors: true, removeAdditional: true })\n\najv.addSchema(configSchema, 'Config')\n\nexport class ConfigError extends BaseError {\n  static displayName = 'ConfigError'\n}\n\nfunction validateConfig(input: unknown): asserts input is ConfigJson {\n  if (ajv.validate('Config', input)) return\n  throw new ConfigError(\n    [\n      'invalid config format:',\n      ajv.errorsText(),\n      'Errors array:',\n      printObject(ajv.errors),\n      'Input:',\n      printObject(input),\n    ].join('\\n'),\n    { errors: ajv.errors, input },\n  )\n}\n\nconst AUTH_MAP = {\n  ENABLED: true,\n  DISABLED: false,\n  SIGN_IN_ONLY: 'SIGN_IN_ONLY',\n}\n\nconst startWithOrigin = (s: string) => (s.startsWith('/') ? window.origin + s : s)\n\nconst transformConfig = (cfg: ConfigJson) => ({\n  ...cfg,\n  passwordAuth: AUTH_MAP[cfg.passwordAuth],\n  ssoAuth: AUTH_MAP[cfg.ssoAuth],\n  ssoProviders: cfg.ssoProviders.length ? cfg.ssoProviders.split(' ') : [],\n  enableMarketingPages: cfg.mode === 'PRODUCT' || cfg.mode === 'MARKETING',\n  disableNavigator: cfg.mode === 'MARKETING',\n  s3Proxy: startWithOrigin(cfg.s3Proxy),\n  apiGatewayEndpoint: startWithOrigin(cfg.apiGatewayEndpoint),\n  binaryApiGatewayEndpoint: startWithOrigin(cfg.binaryApiGatewayEndpoint),\n  noDownload: !!cfg.noDownload,\n  noOverviewImages: !!cfg.noOverviewImages,\n  desktop: !!cfg.desktop,\n})\n\nexport function prepareConfig(input: unknown) {\n  try {\n    validateConfig(input)\n    return transformConfig(input)\n  } catch (e) {\n    if (e instanceof ConfigError) throw e\n    throw new ConfigError('unexpected error', { originalError: e })\n  }\n}\n\nexport type Config = ReturnType<typeof prepareConfig>\n\nlet cachedConfig: Config | null = null\nconst configKey = 'QUILT_CATALOG_CONFIG'\nexport function getConfig() {\n  if (!cachedConfig) {\n    const rawConfig = (window as any)[configKey]\n    invariant(rawConfig, `window.${configKey} must be defined`)\n    cachedConfig = prepareConfig(rawConfig)\n  }\n  return cachedConfig\n}\n\n/** @deprecated Just import 'constants/config' */\nexport const useConfig = getConfig\nexport { useConfig as use }\n","import * as React from 'react'\n\ninterface DelayProps {\n  ms?: number\n  alwaysRender?: boolean\n  children: (ready?: boolean) => JSX.Element\n}\n\nexport default function Delay({ ms = 1000, alwaysRender = false, children }: DelayProps) {\n  const [ready, setReady] = React.useState(false)\n  React.useEffect(() => {\n    const timeout = setTimeout(() => setReady(true), ms)\n    return () => clearTimeout(timeout)\n    // run this only once with initial `ms` value, ignore changes\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n  // eslint-disable-next-line no-nested-ternary\n  return alwaysRender ? children(ready) : ready ? children() : null\n}\n","export type Path = (number | string)[]\n\nexport type Pointer = string\n\nexport function stringify(addressPath: Path): Pointer {\n  return `/${addressPath.join('/')}`\n}\n\nexport function parse(address: Pointer): Path {\n  return address.slice(1).split('/')\n}\n","import invariant from 'invariant'\nimport * as R from 'ramda'\nimport * as React from 'react'\n\nimport useMemoEq from 'utils/useMemoEq'\n\nexport { default as mkSearch } from 'utils/mkSearch'\n\ntype RouteMap = {\n  [name: string]: any\n}\n\ntype RoutesConfig<RMap extends RouteMap = RouteMap> = {\n  [Name in keyof RMap]: {\n    path: string\n    url: (...args: RMap[Name]) => string\n  }\n}\n\ntype RouteMapFromConfig<Config> = Config extends RoutesConfig<infer RMap> ? RMap : never\n\nexport type Paths<RMap extends RouteMap> = {\n  [Name in keyof RMap]: string\n}\n\nexport type Urls<RMap extends RouteMap> = {\n  [Name in keyof RMap]: (...args: RMap[Name]) => string\n}\n\nexport type Routes<RMap extends RouteMap = RouteMap> = {\n  paths: Paths<RMap>\n  urls: Urls<RMap>\n}\n\nconst Ctx = React.createContext<Routes | null>(null)\n\nexport const Provider = function NamedRoutesProvider<R extends RoutesConfig>({\n  routes,\n  children,\n}: React.PropsWithChildren<{ routes: R }>) {\n  // using rest syntax here to cast module or some other object-like thing into plain object\n  const value = useMemoEq(\n    // @ts-expect-error\n    { ...routes },\n    R.applySpec({\n      paths: R.pluck('path'),\n      urls: R.pluck('url'),\n    }),\n  ) as unknown as Routes<RouteMapFromConfig<R>>\n  return <Ctx.Provider value={value}>{children}</Ctx.Provider>\n}\n\n// XXX: it's not possible to type the actual routes bc they are injected dymanically,\n// solution would be to split routes definition (mapping of route names to route parameters)\n// and route implementation (mapping of route names to urls),\n// and then use route definitions as type parameters to this use() call\nexport function useNamedRoutes<RMap extends RouteMap = RouteMap>() {\n  const value = React.useContext(Ctx) as Routes<RMap>\n  invariant(!!value, 'Must have a NamedRoutesProvider somewhere up the component tree')\n  return value\n}\n\nexport const use = useNamedRoutes\n","import * as tagged from 'utils/taggedV2'\n\n/*\ns3 urls:\nbucket/key/with/path/segments\n/key/with/path/segments\n./relative/path\n../relative/path\n*/\n\nexport const Pointer = tagged.create('app/utils/Resource:Pointer' as const, {\n  Web: (url: string) => url,\n  S3: (h: { bucket: string; key: string }) => h,\n  S3Rel: (path: string) => path,\n  Path: (path: string) => path,\n})\n\nconst WEB_RE = /^(https?:)?\\/\\//\nconst S3_RE = /^s3:\\/\\//\n\nexport const parse = (url: string) => {\n  if (WEB_RE.test(url)) {\n    return Pointer.Web(url)\n  }\n  if (S3_RE.test(url)) {\n    const pth = url.replace(S3_RE, '')\n    const m = pth.match(/^([a-z0-9-]+)?\\/([^.].+)$/)\n    if (m) {\n      return Pointer.S3({ bucket: m[1], key: m[2] })\n    }\n    if (pth.startsWith('.')) {\n      return Pointer.S3Rel(pth)\n    }\n    // TODO\n    throw new TypeError(`Invalid S3 URL: ${url}`)\n  }\n  // TODO: check path format as well\n  return Pointer.Path(url)\n}\n","import type { History } from 'history'\nimport * as React from 'react'\nimport * as redux from 'react-redux'\nimport * as Integrations from '@sentry/integrations'\nimport * as Sentry from '@sentry/react'\nimport * as Tracing from '@sentry/tracing'\n\nimport * as AuthSelectors from 'containers/Auth/selectors'\nimport type { Config } from 'utils/Config'\n\nconst RELEASE = `catalog@${process.env.REVISION_HASH}`\n\ntype BrowserTracingOptions = NonNullable<\n  ConstructorParameters<typeof Tracing.BrowserTracing>[0]\n>\n\nexport function init(cfg: Config, history?: History) {\n  if (!cfg.sentryDSN) return false\n\n  const tracingOpts: BrowserTracingOptions = {}\n  if (history) {\n    tracingOpts.routingInstrumentation = Sentry.reactRouterV5Instrumentation(history)\n  }\n\n  Sentry.init({\n    dsn: cfg.sentryDSN,\n    release: RELEASE,\n    environment: process.env.NODE_ENV === 'development' ? 'dev' : 'prod',\n    integrations: [\n      new Tracing.BrowserTracing(tracingOpts),\n      new Integrations.ExtraErrorData({ depth: 5 }),\n      new Sentry.Integrations.LinkedErrors({ key: 'originalError' }),\n    ],\n    normalizeDepth: 10,\n    // XXX: dial down in production? get from config?\n    // tracesSampleRate: 1.0,\n    denyUrls: ['//localhost', 'extension://'],\n  })\n\n  Sentry.setContext('config', cfg)\n\n  return Sentry\n}\n\ninterface User {\n  username: string\n  email: string\n}\n\nconst userSelector = (state: $TSFixMe): User | null => {\n  const { user: u } = AuthSelectors.domain(state)\n  return u ? { username: u.current_user, email: u.email } : null\n}\n\nconst userEq = (l: User | null, r: User | null) =>\n  l === r || (l?.username === r?.username && l?.email === r?.email)\n\nexport const UserTracker = function SentryUserTracker({\n  children,\n}: React.PropsWithChildren<{}>) {\n  const user = redux.useSelector(userSelector, userEq)\n  const userRef = React.useRef<User | null>(null)\n\n  React.useEffect(() => {\n    if (!userEq(user, userRef.current)) {\n      userRef.current = user\n      Sentry.setUser(user)\n    }\n  })\n\n  return children\n}\n\n/** @deprecated */\nasync function callSentry(method: string, ...args: $TSFixMe[]) {\n  return (Sentry as $TSFixMe)[method](...args)\n}\n\n/** @deprecated */\nexport const useSentry = () => callSentry\n\n/** @deprecated */\nexport const use = useSentry\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport type { TypedDocumentNode as DocumentNode } from '@graphql-typed-document-node/core'\nimport * as Types from '../model/graphql/types.generated'\n\nexport type utils_StatusReportsBucketQueryVariables = Types.Exact<{\n  [key: string]: never\n}>\n\nexport type utils_StatusReportsBucketQuery = { readonly __typename: 'Query' } & {\n  readonly status:\n    | ({ readonly __typename: 'Status' } & Pick<Types.Status, 'reportsBucket'>)\n    | { readonly __typename: 'Unavailable' }\n}\n\nexport const utils_StatusReportsBucketDocument = {\n  kind: 'Document',\n  definitions: [\n    {\n      kind: 'OperationDefinition',\n      operation: 'query',\n      name: { kind: 'Name', value: 'utils_StatusReportsBucket' },\n      selectionSet: {\n        kind: 'SelectionSet',\n        selections: [\n          {\n            kind: 'Field',\n            name: { kind: 'Name', value: 'status' },\n            selectionSet: {\n              kind: 'SelectionSet',\n              selections: [\n                { kind: 'Field', name: { kind: 'Name', value: '__typename' } },\n                {\n                  kind: 'InlineFragment',\n                  typeCondition: {\n                    kind: 'NamedType',\n                    name: { kind: 'Name', value: 'Status' },\n                  },\n                  selectionSet: {\n                    kind: 'SelectionSet',\n                    selections: [\n                      { kind: 'Field', name: { kind: 'Name', value: 'reportsBucket' } },\n                    ],\n                  },\n                },\n              ],\n            },\n          },\n        ],\n      },\n    },\n  ],\n} as unknown as DocumentNode<\n  utils_StatusReportsBucketQuery,\n  utils_StatusReportsBucketQueryVariables\n>\n\nexport { utils_StatusReportsBucketDocument as default }\n","import useQuery from 'utils/useQuery'\n\nimport STATUS_REPORTS_BUCKET_QUERY from './StatusReportsBucket.generated'\n\nexport function useStatusReportsBucket() {\n  const result = useQuery({\n    query: STATUS_REPORTS_BUCKET_QUERY,\n    suspend: true,\n  })\n  if (!result.data) return null\n  const { status } = result.data\n  return status.__typename === 'Status' ? status.reportsBucket : null\n}\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as RRDom from 'react-router-dom'\nimport * as M from '@material-ui/core'\n\nexport const linkStyle = {\n  '&, &:visited': {\n    color: M.colors.blue[900],\n    cursor: 'pointer',\n  },\n  '&:hover, &:focus': {\n    color: M.colors.blue[500],\n  },\n}\n\nconst useStyles = M.makeStyles({ root: linkStyle })\n\ntype StyledLinkProps<C extends React.ElementType> = {\n  component?: C\n  className?: string\n} & Omit<React.ComponentProps<C>, 'component'>\n\nexport default React.forwardRef(function StyledLink<C extends React.ElementType>(\n  { component, className, ...props }: StyledLinkProps<C>,\n  ref: React.Ref<C>,\n) {\n  const classes = useStyles()\n  const Component = component || (props.to ? RRDom.Link : 'a')\n  return <Component className={cx(className, classes.root)} {...props} ref={ref} />\n})\n","export default function assertNever(x: never): never {\n  throw new Error(`Unexpected value '${x}'. Should have been never.`)\n}\n","interface Resolver<T> {\n  resolve: (value: T | PromiseLike<T>) => void\n  reject: (reason?: any) => void\n}\n\ninterface Deferred<T> {\n  resolver: Resolver<T>\n  promise: Promise<T>\n}\n\nexport default function defer<T = unknown>() {\n  let resolver: unknown\n  const promise = new Promise<T>((resolve, reject) => {\n    resolver = { resolve, reject }\n  })\n  return { resolver, promise } as Deferred<T>\n}\n","import * as FP from 'fp-ts'\n\nexport default <VV = any>(fn: (key: string) => boolean) =>\n  <V extends VV>(r: Record<string, V>) =>\n    FP.record.filterWithIndex<string, V>((k) => !fn(k))(r)\n","import * as React from 'react'\n\nexport default function useDragging() {\n  const [isDragActive, setDragActive] = React.useState(false)\n\n  const setActive = React.useCallback(() => setDragActive(true), [])\n  const setInactive = React.useCallback(() => setDragActive(false), [])\n\n  React.useEffect(() => {\n    document.addEventListener('dragover', setActive)\n    document.addEventListener('dragleave', setInactive)\n    document.addEventListener('drop', setInactive)\n\n    return () => {\n      document.removeEventListener('dragover', setActive)\n      document.removeEventListener('dragleave', setInactive)\n      document.removeEventListener('drop', setInactive)\n    }\n  }, [setActive, setInactive])\n\n  return isDragActive\n}\n","export const CLI_OUTPUT = 'cli_output'\nexport const DOWNLOAD_PACKAGE = 'download_package'\nexport const LOCALPATH_REQUEST = 'localpath_request' // TODO: OPEN_IN_EXPLORER\nexport const UPLOAD_PACKAGE = 'upload_package'\n\nexport const SYNC_FOLDERS_ADD = 'sync_folders_add'\nexport const SYNC_FOLDERS_EDIT = 'sync_folders_edit'\nexport const SYNC_FOLDERS_LIST = 'sync_folders_list'\nexport const SYNC_FOLDERS_REMOVE = 'sync_folders_remove'\n","import * as React from 'react'\n\nimport * as AWS from 'utils/AWS'\n\nexport * as EVENTS from './events'\n\ninterface Credentials {\n  accessKeyId: string\n  secretAccessKey: string\n  sessionToken: string\n}\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst handler = (eventName: string, callback: (event: any, ...args: any[]) => void) => {}\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst request = (eventName: string, ...args: any[]): Promise<any> => Promise.resolve(null)\n\nexport interface IPC {\n  on: typeof handler\n  off: typeof handler\n  invoke: typeof request\n  send: typeof request\n}\n\nconst Ctx = React.createContext({\n  on: handler,\n  off: handler,\n  invoke: request,\n  send: request,\n})\n\ninterface SentryProviderProps {\n  children: React.ReactNode\n  value: IPC\n}\n\nconst serializeCredentials = (credentials: Credentials) => ({\n  accessKeyId: credentials.accessKeyId,\n  secretAccessKey: credentials.secretAccessKey,\n  sessionToken: credentials.sessionToken,\n})\n\nexport const Provider = function IpcProvider({\n  children,\n  value: { off, on, invoke, send },\n}: SentryProviderProps) {\n  const credentials: Credentials = AWS.Credentials.use()\n  const ipc = React.useMemo(\n    () => ({\n      off,\n      on,\n      invoke: (channel: string, ...args: any[]) =>\n        invoke(channel, serializeCredentials(credentials), ...args),\n      send,\n    }),\n    [credentials, on, off, send, invoke],\n  )\n  return <Ctx.Provider value={ipc}>{children}</Ctx.Provider>\n}\n\nfunction useIPC(): IPC {\n  return React.useContext(Ctx)\n}\n\nexport const use = useIPC\n","/**\n * Extensible error class.\n */\nexport class BaseError extends Error {\n  /**\n   * @param message - Message to pass to the Error constructor.\n   *\n   * @param props - Properties to assign to the created instance.\n   */\n  constructor(msg?: string, props?: {}) {\n    super(msg)\n    Object.setPrototypeOf(this, new.target.prototype)\n    // XXX: do we still need this?\n    if (Error.captureStackTrace) Error.captureStackTrace(this, this.constructor)\n    if (props) Object.assign(this, props)\n  }\n\n  [k: string]: any\n}\n\nObject.defineProperty(BaseError.prototype, 'name', {\n  enumerable: false,\n  get() {\n    return this.constructor.displayName || this.constructor.name\n  },\n})\n\n/**\n * Error class with fields designed to feed <Error /> via object rest spread.\n */\nexport class ErrorDisplay extends BaseError {\n  /**\n   * @param headline\n   *\n   * @param detail\n   *\n   * @param object\n   */\n  constructor(headline: string, detail?: string, object?: {}) {\n    super(headline, { headline, detail, object })\n  }\n}\n","import { FORM_ERROR } from 'final-form'\nimport * as React from 'react'\n\nexport const mkFormError = (err: React.ReactNode) => ({ [FORM_ERROR]: err })\n\nexport interface InputError {\n  path: string | null\n  message: string\n}\n\nexport function mapInputErrors(\n  inputErrors: Readonly<InputError[]>,\n  mapping: Record<string, string> = {},\n) {\n  const formErrors: Record<string, string> = {}\n  for (let err of inputErrors) {\n    const key = err.path && err.path in mapping ? mapping[err.path] : FORM_ERROR\n    formErrors[key] = err.message\n  }\n  return formErrors\n}\n","import Ajv, { SchemaObject, ErrorObject, Options } from 'ajv'\nimport addFormats from 'ajv-formats'\nimport * as dateFns from 'date-fns'\nimport * as R from 'ramda'\n\ntype CompoundCondition = 'anyOf' | 'oneOf' | 'not' | 'allOf'\n\n// TODO: use more detailed `Ajv.JSONSchemaType` instead\nexport type JsonSchema = SchemaObject\n\nexport function isSchemaCompound(optSchema?: JsonSchema) {\n  if (!optSchema) return false\n  if (Array.isArray(optSchema)) return true\n  return ['anyOf', 'oneOf', 'not', 'allOf'].some(\n    (key) => optSchema[key as 'anyOf' | 'oneOf' | 'not' | 'allOf'],\n  )\n}\n\nfunction hasTypeInCompoundSchema(\n  typeCheck: (schema?: JsonSchema) => boolean,\n  optSchema?: JsonSchema,\n) {\n  if (!isSchemaCompound(optSchema)) return false\n  if (optSchema?.allOf) return optSchema.allOf.every(typeCheck)\n  if (optSchema?.anyOf) return optSchema.anyOf.some(typeCheck)\n  if (optSchema?.oneOf) {\n    const checks = optSchema?.oneOf.map(typeCheck)\n    // [true,false,false] => [1,0,0] => sum === 1\n    return checks.reduce((memo: number, check: boolean) => memo + Number(check), 0) === 1\n  }\n  if (optSchema?.not) return !typeCheck(optSchema.not)\n  if (Array.isArray(optSchema)) return optSchema.some(typeCheck)\n}\n\nexport function findTypeInCompoundSchema(\n  typeCheck: (schema?: JsonSchema) => boolean,\n  optSchema?: JsonSchema,\n) {\n  if (!isSchemaCompound(optSchema)) return typeCheck(optSchema) ? optSchema : undefined\n  if (optSchema?.allOf)\n    return hasTypeInCompoundSchema(typeCheck, optSchema)\n      ? optSchema.allOf.find(typeCheck)\n      : undefined\n  if (optSchema?.anyOf) return optSchema.anyOf.find(typeCheck)\n  if (optSchema?.oneOf)\n    return hasTypeInCompoundSchema(typeCheck, optSchema)\n      ? optSchema?.oneOf.find(typeCheck)\n      : undefined\n  if (Array.isArray(optSchema)) return optSchema.find(typeCheck)\n}\n\nexport function isSchemaArray(optSchema?: JsonSchema) {\n  return optSchema?.type === 'array' || hasTypeInCompoundSchema(isSchemaArray, optSchema)\n}\n\nexport function isSchemaObject(optSchema?: JsonSchema) {\n  return (\n    optSchema?.type === 'object' || hasTypeInCompoundSchema(isSchemaObject, optSchema)\n  )\n}\n\nfunction isSchemaString(optSchema?: JsonSchema) {\n  return (\n    optSchema?.type === 'string' || hasTypeInCompoundSchema(isSchemaString, optSchema)\n  )\n}\n\nfunction isSchemaNumber(optSchema?: JsonSchema) {\n  return (\n    optSchema?.type === 'number' || hasTypeInCompoundSchema(isSchemaNumber, optSchema)\n  )\n}\n\nfunction isSchemaInteger(optSchema?: JsonSchema) {\n  return (\n    optSchema?.type === 'integer' || hasTypeInCompoundSchema(isSchemaInteger, optSchema)\n  )\n}\n\nexport function isSchemaBoolean(optSchema?: JsonSchema) {\n  return (\n    optSchema?.type === 'boolean' || hasTypeInCompoundSchema(isSchemaBoolean, optSchema)\n  )\n}\n\nfunction isSchemaNull(optSchema?: JsonSchema) {\n  return optSchema?.type === 'null' || hasTypeInCompoundSchema(isSchemaNull, optSchema)\n}\n\nexport function isSchemaEnum(optSchema?: JsonSchema) {\n  return !!optSchema?.enum || hasTypeInCompoundSchema(isSchemaEnum, optSchema)\n}\n\nexport function isSchemaOneOf(optSchema?: JsonSchema) {\n  return !!optSchema?.oneOf || hasTypeInCompoundSchema(isSchemaOneOf, optSchema)\n}\n\nexport function isSchemaAnyOf(optSchema?: JsonSchema) {\n  return !!optSchema?.anyOf || hasTypeInCompoundSchema(isSchemaAnyOf, optSchema)\n}\n\nexport function isSchemaAllOf(optSchema?: JsonSchema) {\n  return !!optSchema?.allOf || hasTypeInCompoundSchema(isSchemaAllOf, optSchema)\n}\n\nfunction isSchemaConst(optSchema?: JsonSchema) {\n  return !!optSchema?.const || hasTypeInCompoundSchema(isSchemaConst, optSchema)\n}\n\nfunction isSchemaReference(optSchema?: JsonSchema) {\n  return !!optSchema?.$ref || hasTypeInCompoundSchema(isSchemaReference, optSchema)\n}\n\nexport function isNestedType(optSchema?: JsonSchema) {\n  return (\n    isSchemaArray(optSchema) ||\n    isSchemaObject(optSchema) ||\n    hasTypeInCompoundSchema(isNestedType, optSchema)\n  )\n}\n\nfunction compoundTypeToHumanString(\n  optSchema: JsonSchema,\n  condition: CompoundCondition,\n  divider: string,\n): string {\n  if (!isSchemaCompound(optSchema)) return ''\n\n  return optSchema[condition]!.map(schemaTypeToHumanString)\n    .filter((v: string) => v !== 'undefined') // NOTE: sic, see default case of `schemaTypeToHumanString`\n    .join(divider)\n}\n\nexport function schemaTypeToHumanString(optSchema?: JsonSchema) {\n  if (!optSchema) return ''\n  return R.cond<JsonSchema, string>([\n    [isSchemaAnyOf, () => compoundTypeToHumanString(optSchema, 'anyOf', '|')],\n    [isSchemaOneOf, () => compoundTypeToHumanString(optSchema, 'oneOf', '|')],\n    [isSchemaAllOf, () => compoundTypeToHumanString(optSchema, 'allOf', '&')],\n    [isSchemaCompound, () => 'compound'],\n    [isSchemaEnum, () => 'enum'],\n    [isSchemaConst, () => 'const'],\n    [isSchemaBoolean, () => 'boolean'],\n    [isSchemaNull, () => 'null'],\n    // NOTE: enum and const can be string too,\n    //       that's why they are first\n    [\n      R.propOr('', 'type'),\n      () =>\n        Array.isArray(optSchema.type)\n          ? optSchema.type.join('|')\n          : (optSchema.type as string),\n    ],\n    [isSchemaReference, () => '$ref'],\n    [R.T, () => 'undefined'],\n  ])(optSchema)\n}\n\nfunction doesTypeMatchCompoundSchema(\n  value: any,\n  condition: CompoundCondition,\n  optSchema?: JsonSchema,\n): boolean {\n  if (!optSchema) return true\n\n  if (!isSchemaCompound(optSchema)) return false\n\n  return optSchema[condition]!.filter((s: JsonSchema) => s.type || s.$ref).some(\n    (subSchema: JsonSchema) => doesTypeMatchSchema(value, subSchema),\n  )\n}\n\n// Purpose is to find mismatch explicitly\n// TODO: rename and redesign function to avoid \"if no schema -> return true aka 'type matches schema'\"\nexport function doesTypeMatchSchema(value: any, optSchema?: JsonSchema): boolean {\n  if (!optSchema) return true\n\n  return R.cond<JsonSchema, boolean>([\n    [isSchemaAnyOf, () => doesTypeMatchCompoundSchema(value, 'anyOf', optSchema)],\n    [isSchemaOneOf, () => doesTypeMatchCompoundSchema(value, 'oneOf', optSchema)],\n    [isSchemaAllOf, () => doesTypeMatchCompoundSchema(value, 'allOf', optSchema)],\n    [\n      isSchemaEnum,\n      () => {\n        const foundSchema = findTypeInCompoundSchema(isSchemaEnum, optSchema)\n        const options = foundSchema?.enum || []\n        // Note that value and enum items can be objects\n        const includesEnum = R.includes(value)\n        // TODO: use R.includes(value, options) without aux const\n        //       ramda types incorectly set return type\n        return includesEnum(options)\n      },\n    ],\n    [\n      (s) => Array.isArray(s?.type),\n      () =>\n        (optSchema.type as JsonSchema[]).some((subSchema) =>\n          doesTypeMatchSchema(value, subSchema),\n        ),\n    ],\n    [isSchemaArray, () => Array.isArray(value)],\n    [isSchemaObject, () => R.is(Object, value)],\n    [isSchemaString, () => R.is(String, value)],\n    [isSchemaInteger, () => Number.isInteger(value)],\n    [isSchemaNumber, () => R.is(Number, value)],\n    [isSchemaNull, () => R.equals(null, value)],\n    [isSchemaBoolean, () => R.is(Boolean, value)],\n    [R.T, R.T], // It's not a user's fault that we can't handle the type\n  ])(optSchema)\n}\n\nexport const EMPTY_SCHEMA: JsonSchema = {}\n\nexport function makeSchemaValidator(\n  optSchema?: JsonSchema,\n  optSchemas?: JsonSchema[],\n  ajvOptions?: Options,\n): (obj?: any) => (Error | ErrorObject)[] {\n  let mainSchema = R.clone(optSchema || EMPTY_SCHEMA)\n  if (!mainSchema.$id) {\n    // Make further code more universal by using one format: `id` → `$id`\n    if (mainSchema.id) {\n      mainSchema = R.pipe(R.assoc('$id', mainSchema.id), R.dissoc('id'))(mainSchema)\n    } else {\n      mainSchema = R.assoc('$id', 'main_schema', mainSchema)\n    }\n  }\n  const schemas = optSchemas ? [mainSchema, ...optSchemas] : [mainSchema]\n\n  const { $id } = schemas[0]\n  const options: Options = {\n    allErrors: true,\n    allowUnionTypes: true,\n    schemaId: '$id',\n    schemas,\n    useDefaults: true,\n    ...ajvOptions,\n  }\n\n  try {\n    const ajv = new Ajv(options)\n    addFormats(ajv, ['date', 'regex', 'uri'])\n    ajv.addKeyword('dateformat')\n\n    // TODO: show warning if $schema !== '…draft-07…'\n    // TODO: fail early, return Error instead of callback\n    if (!$id) return () => [new Error('$id is not provided')]\n\n    return (obj: any): (Error | ErrorObject)[] => {\n      try {\n        ajv.validate($id, R.clone(obj))\n      } catch (e) {\n        return e instanceof Error ? [e] : []\n      }\n      // TODO: add custom errors\n      return ajv.errors || []\n    }\n  } catch (e) {\n    // TODO: fail early if Ajv options are incorrect, return Error instead of callback\n    // TODO: add custom errors\n    return () => (e instanceof Error ? [e] : []) as Error[]\n  }\n}\n\n// TODO: make general purpose function like reduce,\n//       do \"prefill Value\" at callback,\n//       and use it for iterating Schema in JsonEditor/State\nfunction scanSchemaAndPrefillValues(\n  getValue: (s?: JsonSchema) => any,\n  value: Record<string, any>,\n  optSchema?: JsonSchema,\n): Record<string, any> {\n  if (!optSchema) return value\n\n  if (!optSchema?.properties) return value\n\n  return Object.keys(optSchema.properties).reduce((memo, key) => {\n    const valueItem = value === undefined ? undefined : value[key]\n\n    // don't touch user's primitive value\n    if (valueItem && !R.is(Object, valueItem)) return memo\n\n    const schemaItem = R.propOr({}, key, optSchema.properties) as JsonSchema\n\n    if (schemaItem.properties)\n      return R.assoc(\n        key,\n        scanSchemaAndPrefillValues(getValue, valueItem, schemaItem),\n        memo,\n      )\n\n    if (schemaItem.items && Array.isArray(valueItem))\n      return R.assoc(\n        key,\n        valueItem.map((v) => scanSchemaAndPrefillValues(getValue, v, schemaItem.items)),\n        memo,\n      )\n\n    const preDefinedValue = getValue(schemaItem)\n    if (preDefinedValue) return R.assoc(key, preDefinedValue, memo)\n\n    return memo\n  }, value)\n}\n\nexport function getDefaultValue(optSchema?: JsonSchema): any {\n  if (!optSchema) return undefined\n\n  if (optSchema.default !== undefined) return optSchema.default\n\n  try {\n    if (optSchema.format === 'date' && optSchema.dateformat)\n      return dateFns.format(new Date(), optSchema.dateformat)\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error(error)\n  }\n\n  return undefined\n}\n\nexport function makeSchemaDefaultsSetter(optSchema?: JsonSchema) {\n  return (obj: any) => scanSchemaAndPrefillValues(getDefaultValue, obj, optSchema)\n}\n","import * as qs from 'querystring'\n\nimport * as R from 'ramda'\n\nexport default R.pipe(\n  R.reject(R.isNil),\n  qs.stringify,\n  R.unless(R.isEmpty, R.concat('?')),\n) as (params: qs.ParsedUrlQueryInput) => string\n","import lodashTemplate from 'lodash/template'\nimport * as R from 'ramda'\n\nexport interface PackageHandle {\n  bucket: string\n  name: string\n  hash: string\n}\n\nexport function shortenRevision(fullRevision: string): string {\n  return R.take(10, fullRevision)\n}\n\ntype Context = 'files' | 'packages'\n\nexport type NameTemplates = Partial<Record<Context, string>>\n\ntype Options = {\n  username?: string\n  directory?: string\n}\n\nexport function execTemplateItem(template: string, options?: Options): string | null {\n  try {\n    return lodashTemplate(template)(options)\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.log('Template for default package name is invalid')\n    // eslint-disable-next-line no-console\n    console.error(error)\n    return null\n  }\n}\n\nexport function execTemplate(\n  templatesDict: NameTemplates,\n  context: Context,\n  options?: Options,\n): string | null {\n  if (!templatesDict || !templatesDict[context]) return null\n  return execTemplateItem(templatesDict[context] || '', options)\n}\n","import * as qs from 'querystring'\n\nconst takeFirstValues = (q: qs.ParsedUrlQuery) =>\n  Object.fromEntries(Object.entries(q).map(([k, v]) => [k, Array.isArray(v) ? v[0] : v]))\n\nfunction parseSearch(search: string, firstOnly?: false): qs.ParsedUrlQuery\nfunction parseSearch(search: string, firstOnly: true): Record<string, string | undefined>\nfunction parseSearch(search: string, firstOnly: boolean = false) {\n  const parsed = qs.parse(search.replace(/^\\?/, ''))\n  return firstOnly ? takeFirstValues(parsed) : parsed\n}\n\nexport default parseSearch\n","import * as React from 'react'\n\ntype ComponentWithProps = [React.ComponentType, {} | undefined]\ntype ComponentOrComponentWithProps = React.ComponentType | ComponentWithProps\n/**\n * Render nested components.\n *\n * @param components - React components or tuples of component and props.\n *\n * @returns The rendered nested components.\n */\nexport const nest = (...components: ComponentOrComponentWithProps[]) =>\n  components.reduceRight(\n    (children: React.ReactNode, comp: ComponentOrComponentWithProps) => {\n      const [Component, props = {}]: ComponentWithProps = [].concat(comp as any) as any\n      const actualProps = children ? { ...props, children } : props\n      return <Component {...actualProps} />\n    },\n    undefined,\n  ) as React.ReactElement\n\nexport const mkLazy = (\n  importFunc: () => Promise<{ default: React.ComponentType<any> }>,\n  FallbackComp: React.FC,\n) => {\n  const Component = React.lazy(importFunc)\n  return (props = {}) => (\n    <React.Suspense fallback={<FallbackComp />}>\n      <Component {...props} />\n    </React.Suspense>\n  )\n}\n","import { dirname, basename, resolve } from 'path'\nimport { parse as parseUrl } from 'url'\n\nimport * as R from 'ramda'\n\nimport { mkSearch } from 'utils/NamedRoutes'\n\n/**\n * Handle for an S3 object.\n */\nexport interface S3HandleBase {\n  bucket: string\n  key: string\n  version?: string\n}\n\nexport interface S3Handle extends S3HandleBase {\n  region: string\n  modified: Date\n  size: number\n  etag: string\n}\n\n/**\n * Ensure the string has no trailing slash.\n */\nexport const ensureNoSlash = (str: string) => str.replace(/\\/$/, '')\n\n/**\n * Ensure the string has a trailing slash.\n */\nexport const ensureSlash = (str: string) => `${ensureNoSlash(str)}/`\n\n/**\n * Go up a level.\n */\nexport const up = (prefix: string) => {\n  // handle double slashes\n  if (prefix.endsWith('//')) return prefix.substring(0, prefix.length - 1)\n  const m = prefix.match(/^(.*\\/\\/)[^/]+$/)\n  if (m) return m[1]\n  const d = dirname(prefix)\n  return d === '.' || d === '/' ? '' : ensureSlash(d)\n}\n\n/**\n * Check if the path is a directory / prefix (ends with a slash).\n */\nexport const isDir = (path: string) => path === '' || path.endsWith('/')\n\n/**\n * Get the \"prefix\" part of a path.\n */\nexport const getPrefix = (path: string) => {\n  if (!path) return ''\n  if (isDir(path)) return path\n  const name = dirname(path)\n  return name === '.' ? '' : ensureSlash(name)\n}\n\n/**\n * Get the \"basename\" part of a path.\n */\nexport const getBasename = (path: string) => {\n  if (!path) return ''\n  return isDir(path) ? '' : basename(path)\n}\n\n/**\n * Split a path into a basename and prefix parts. Examples:\n *\n * path       | prefix     | basename\n * -----------+------------+---------\n * ''         | ''         | ''\n * 'hey'      | ''         | 'hey'\n * 'hey/'     | 'hey/'     | ''\n * 'hey/sup'  | 'hey/'     | 'sup'\n * 'hey/sup/' | 'hey/sup/' | ''\n */\nexport const splitPath = (path: string) => ({\n  prefix: getPrefix(path),\n  basename: getBasename(path),\n})\n\n/**\n * Remove specified prefix from the path.\n */\nexport const withoutPrefix = (prefix: string, path: string) =>\n  path.startsWith(prefix) ? path.replace(prefix, '') : path\n\n/**\n * Check if the string is an S3 URL.\n */\nexport const isS3Url = (url: string) => url.startsWith('s3://')\n\n/**\n * Parse an S3 URL and create an S3Handle out of it.\n */\nexport const parseS3Url = (url: string): S3HandleBase => {\n  const u = parseUrl(url, true)\n  if (Array.isArray(u.query.versionId)) {\n    throw new Error('versionId specified multiple times')\n  }\n  if (!u.hostname) {\n    throw new Error('bucket not specified')\n  }\n  return {\n    bucket: u.hostname,\n    key: decode((u.pathname || '/').substring(1)),\n    version: u.query.versionId,\n  }\n}\n\n/**\n * Resolve an S3 key.\n */\nexport const resolveKey = (from: string, to: string) =>\n  resolve(`/${getPrefix(from)}`, to).substring(1)\n\n// AWS docs (https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingBucket.html) state that\n// \"buckets created in Regions launched after March 20, 2019 are not reachable via the\n// `https://bucket.s3.amazonaws.com naming scheme`\", so probably we need to support\n// `https://bucket.s3.aws-region.amazonaws.com` scheme as well.\nexport const handleToHttpsUri = ({ bucket, key, version }: S3HandleBase) =>\n  `https://${bucket}.s3.amazonaws.com/${encode(key)}${mkSearch({ versionId: version })}`\n\nexport const handleToS3Url = ({ bucket, key, version = undefined }: S3HandleBase) =>\n  `s3://${bucket}/${encode(key)}${mkSearch({ versionId: version })}`\n\n/**\n * Get breadcrumbs for a path.\n */\nexport const getBreadCrumbs = (path: string): { label: string; path: string }[] =>\n  path\n    ? [\n        ...getBreadCrumbs(up(path)),\n        { label: path.endsWith('//') ? '' : basename(path), path },\n      ]\n    : []\n\nexport const encode = R.pipe(R.split('/'), R.map(encodeURIComponent), R.join('/'))\n\nexport const decode = R.pipe(R.split('/'), R.map(decodeURIComponent), R.join('/'))\n","import * as R from 'ramda'\n\ninterface ValueConstructor<Input extends any[], Value> {\n  (...args: Input): Value\n}\n\nexport interface Instance<TypeTag, VariantTag = any, Value = any> {\n  type: TypeTag\n  variant: VariantTag\n  value: Value\n}\n\ninterface InstanceConstructor<\n  TypeTag,\n  VariantTag,\n  Input extends any[],\n  Value,\n  Inst extends Instance<TypeTag, VariantTag, Value> = Instance<\n    TypeTag,\n    VariantTag,\n    Value\n  >,\n> {\n  (...args: Input): Inst\n  unbox(inst: Inst): Value\n  is(inst: any): inst is Inst\n}\n\ninterface Meta<TypeTag, VMap, CMap> {\n  typeTag: TypeTag\n  variants: VMap\n  constructors: CMap\n}\n\nexport type InstanceOf<T> = T extends { meta: Meta<infer TypeTag, infer VMap, any> }\n  ? Instance<TypeTag, keyof VMap, VMap[keyof VMap]>\n  : T extends InstanceConstructor<infer TypeTag, infer VariantTag, any, infer Value>\n  ? Instance<TypeTag, VariantTag, Value>\n  : never\n\nexport type ConstructorOf<T> = T extends { meta: Meta<any, any, infer CMap> }\n  ? CMap[keyof CMap]\n  : never\n\nexport type ValueOf<T> = T extends InstanceConstructor<any, any, any, infer Value>\n  ? Value\n  : never\n\nconst mkCons =\n  <TypeTag>(typeTag: TypeTag) =>\n  <\n    VConsMap extends Record<any, ValueConstructor<any, any>>,\n    Variant extends keyof VConsMap,\n  >(\n    valueCons: VConsMap[Variant],\n    variantTag: Variant,\n  ) => {\n    type Inst = Instance<TypeTag, Variant, ReturnType<typeof valueCons>>\n    const cons = (...args: Parameters<typeof valueCons>): Inst => ({\n      type: typeTag,\n      variant: variantTag,\n      value: valueCons(...args),\n    })\n\n    cons.unbox = (inst: Inst) => inst.value\n\n    // TODO: support optional predicate arg?\n    cons.is = (inst: any): inst is Inst =>\n      !!inst && inst.type === typeTag && inst.variant === variantTag\n\n    return cons\n  }\n\nexport function create<TypeTag, VConsMap extends Record<any, ValueConstructor<any, any>>>(\n  typeTag: TypeTag,\n  vConsMap: VConsMap,\n) {\n  type Constructors = {\n    [VariantTag in keyof VConsMap]: InstanceConstructor<\n      TypeTag,\n      VariantTag,\n      Parameters<VConsMap[VariantTag]>,\n      ReturnType<VConsMap[VariantTag]>\n    >\n  }\n\n  type Inst = Instance<TypeTag, keyof VConsMap, ReturnType<VConsMap[keyof VConsMap]>>\n\n  type ValueMap = {\n    [VariantTag in keyof VConsMap]: ReturnType<VConsMap[VariantTag]>\n  }\n\n  type MatchCasesExhaustive<Out, Extra extends any[]> = {\n    [VariantTag in keyof ValueMap]: (value: ValueMap[VariantTag], ...args: Extra) => Out\n  }\n\n  type WildcardCase<Out, Extra extends any[]> = (inst: Inst, ...args: Extra) => Out\n\n  type MatchCasesWildcard<Out, Extra extends any[]> = Partial<\n    MatchCasesExhaustive<Out, Extra>\n  > & {\n    _: WildcardCase<Out, Extra>\n  }\n\n  type MatchCases<Out, Extra extends any[] = []> =\n    | MatchCasesExhaustive<Out, Extra>\n    | MatchCasesWildcard<Out, Extra>\n\n  type BoundMatch<Out, Extra extends any[]> = (inst: Inst, ...args: Extra) => Out\n\n  const constructors = R.mapObjIndexed(mkCons(typeTag), vConsMap) as Constructors\n\n  const is = (inst: any): inst is Inst => !!inst && inst.type === typeTag\n\n  // TODO: support non-instance match (__ case)?\n  function match<Out, Extra extends any[] = []>(\n    cases: MatchCases<Out, Extra>,\n  ): BoundMatch<Out, Extra>\n  function match<Out, Extra extends any[] = []>(\n    cases: MatchCases<Out, Extra>,\n    ...args: [Inst, ...Extra]\n  ): Out\n  function match<Out, Extra extends any[] = []>(\n    cases: MatchCases<Out, Extra>,\n    ...args: [] | [Inst, ...Extra]\n  ) {\n    const exec = (inst: Inst, ...extra: Extra) => {\n      const c = cases[inst.variant]\n      if (c) return c(inst.value, ...extra)\n      const wild = cases._ as WildcardCase<Out, Extra>\n      return wild(inst, ...extra)\n    }\n\n    return args.length ? exec(...(args as [Inst, ...Extra])) : exec\n  }\n\n  // TODO: mapCase\n  // TODO: reducer\n\n  const ret = { is, match, case: match, ...constructors }\n  return ret as typeof ret & {\n    meta: Meta<TypeTag, ValueMap, typeof constructors>\n  }\n}\n\n/*\n// examples\nconst FilesAction = create('FilesAction' as const, {\n  Add: (v: { files: [File]; prefix: string }) => v,\n  Delete: (path: string) => path,\n  DeleteDir: (prefix: string) => prefix,\n  Revert: (path: string) => path,\n  RevertDir: (prefix: string) => prefix,\n  Reset: () => {},\n})\n\ntype FilesAction = InstanceOf<typeof FilesAction>\n\nconst fn1 = (fa: FilesAction, d: ReturnType<typeof FilesAction.Delete>) => [fa, d]\n\nconsole.log('FilesAction', FilesAction)\n\nconst FilesAction2 = create('FilesAction2' as const, {\n  Delete: (path: string) => path,\n})\n\nconsole.log('FilesAction2', FilesAction2)\n\nconst del = FilesAction.Delete('del path')\nconst rev = FilesAction.Revert('rev path')\n\nconsole.log('del', del)\n\nconst del2 = FilesAction2.Delete('del BAD')\n\nconsole.log('del2', del2)\n\nconst isDel = (inst: any) => {\n  if (FilesAction.Delete.is(inst)) {\n    console.log('inst is del', inst, FilesAction.Delete.unbox(inst))\n  } else {\n    console.log('inst isnt del', inst)\n  }\n}\n\nisDel(del)\nisDel(rev)\nisDel(del2)\n\nconst eagerRes = FilesAction.match(\n  {\n    Add: ({ prefix }) => prefix,\n    Delete: (p) => p,\n    DeleteDir: (p) => p,\n    Revert: (p) => p,\n    RevertDir: (p) => p,\n    Reset: () => '',\n  },\n  del,\n)\n\nconsole.log('del match', eagerRes)\n\nconst curried = FilesAction.match({\n  Add: ({ prefix }) => prefix,\n  Delete: (p) => p,\n  DeleteDir: (p) => p,\n  Revert: (p) => p,\n  RevertDir: (p) => p,\n  Reset: () => '',\n})\n\nconsole.log('del match curried', curried(del))\n// @ts-expect-error\nconsole.log('del match bad', curried(del2))\n\nconst wild = FilesAction.match({\n  Add: ({ prefix }) => prefix,\n  Delete: (p) => p,\n  DeleteDir: (p) => p,\n  Revert: (p) => p,\n  // RevertDir: (p) => p,\n  // Reset: () => '',\n  _: (i) => {\n    console.log('wildcard case', i)\n    return 'wild'\n  },\n})\n\nconsole.log('del match wild', wild(del))\n*/\n","import * as R from 'ramda'\nimport * as React from 'react'\n\nexport default function useMemoEq<I, O>(\n  input: I,\n  cons: (input: I) => O,\n  eq: (a: I, b: I) => boolean = R.equals,\n) {\n  const ref = React.useRef<{ input: I; value: O }>()\n  if (ref.current && eq(ref.current.input, input)) {\n    return ref.current.value\n  }\n  const value = cons(input)\n  ref.current = { input, value }\n  return value\n}\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport type { TypedDocumentNode as DocumentNode } from '@graphql-typed-document-node/core'\nimport * as Types from '../model/graphql/types.generated'\n\nexport type utils_PotentialCollaboratorsQueryVariables = Types.Exact<{\n  [key: string]: never\n}>\n\nexport type utils_PotentialCollaboratorsQuery = { readonly __typename: 'Query' } & {\n  readonly potentialCollaborators: ReadonlyArray<\n    { readonly __typename: 'Collaborator' } & Pick<\n      Types.Collaborator,\n      'email' | 'username'\n    >\n  >\n}\n\nexport const utils_PotentialCollaboratorsDocument = {\n  kind: 'Document',\n  definitions: [\n    {\n      kind: 'OperationDefinition',\n      operation: 'query',\n      name: { kind: 'Name', value: 'utils_PotentialCollaborators' },\n      selectionSet: {\n        kind: 'SelectionSet',\n        selections: [\n          {\n            kind: 'Field',\n            name: { kind: 'Name', value: 'potentialCollaborators' },\n            selectionSet: {\n              kind: 'SelectionSet',\n              selections: [\n                { kind: 'Field', name: { kind: 'Name', value: 'email' } },\n                { kind: 'Field', name: { kind: 'Name', value: 'username' } },\n              ],\n            },\n          },\n        ],\n      },\n    },\n  ],\n} as unknown as DocumentNode<\n  utils_PotentialCollaboratorsQuery,\n  utils_PotentialCollaboratorsQueryVariables\n>\n\nexport { utils_PotentialCollaboratorsDocument as default }\n","import * as Model from 'model'\n\nimport useQuery from './useQuery'\nimport POTENTIAL_COLLABORATORS from './PotentialCollaborators.generated'\n\nconst NO_COLLABORATORS: ReadonlyArray<Model.GQLTypes.Collaborator> = []\n\nexport default function usePotentialCollaborators(): ReadonlyArray<Model.GQLTypes.Collaborator> {\n  const potentialCollaboratorsQuery = useQuery({\n    query: POTENTIAL_COLLABORATORS,\n  })\n  return potentialCollaboratorsQuery.data?.potentialCollaborators || NO_COLLABORATORS\n}\n","import * as React from 'react'\n\nexport default function usePrevious<V = unknown>(\n  value: V,\n  onChange?: (prev: V | undefined) => void,\n): V | undefined {\n  const ref = React.useRef<V>()\n  const prev = ref.current\n  ref.current = value\n  React.useEffect(() => {\n    if (onChange) onChange(prev)\n  })\n  return prev\n}\n","import * as R from 'ramda'\nimport * as urql from 'urql'\n\nimport { BaseError } from 'utils/error'\nimport useMemoEq from 'utils/useMemoEq'\n\nexport class QueryError<Data = any> extends BaseError {\n  constructor(result?: urql.UseQueryState<Data, any>) {\n    super('GraphQL query error')\n    this.result = result\n  }\n}\n\nconst defaultErrorHandler = <Data>(error: urql.CombinedError | QueryError<Data>) => {\n  throw error\n}\n\ninterface OpCases<Data, OnData, OnFecthing, OnError = never> {\n  data: (\n    data: Data,\n    error: urql.CombinedError | undefined,\n    result: urql.UseQueryState<Data, any>,\n  ) => OnData\n  fetching: (result: urql.UseQueryState<Data, any>) => OnFecthing\n  error?: (\n    error: urql.CombinedError | QueryError<Data>,\n    result: urql.UseQueryState<Data, any>,\n  ) => OnError\n}\n\ninterface DoCase<Data> {\n  <OnData, OnFetching>(cases: OpCases<Data, OnData, OnFetching>): OnData | OnFetching\n  <OnData, OnFetching, OnError>(cases: OpCases<Data, OnData, OnFetching, OnError>):\n    | OnData\n    | OnFetching\n    | OnError\n}\n\ninterface CaseOptions {\n  partial: boolean\n}\n\nconst mkCase =\n  <Data>(result: urql.UseQueryState<Data, any>, opts: CaseOptions): DoCase<Data> =>\n  <OnData, OnFetching, OnError = never>({\n    data,\n    error = defaultErrorHandler,\n    fetching,\n  }: OpCases<Data, OnData, OnFetching, OnError>) => {\n    const isPartial = result.operation?.context?.meta?.cacheOutcome === 'partial'\n    if (!opts.partial && isPartial) return fetching(result)\n    if (result.data) return data(result.data, result.error, result)\n    if (result.fetching) return fetching(result)\n    return error(result.error || new QueryError(result), result)\n  }\n\ninterface UseQueryArgs<Variables, Data> extends urql.UseQueryArgs<Variables, Data> {\n  suspend?: boolean\n  partial?: boolean\n}\n\nexport interface UseQueryResult<Data, Variables = any>\n  extends urql.UseQueryState<Data, Variables> {\n  case: DoCase<Data>\n  run: (opts?: Partial<urql.OperationContext>) => void\n}\n\nexport function useQuery<Variables, Data>({\n  context,\n  suspend = false,\n  partial = false,\n  // XXX: add staleAsFetching option?\n  ...args\n}: UseQueryArgs<Variables, Data>): UseQueryResult<Data, Variables> {\n  const ctxMemo = useMemoEq({ suspense: suspend, ...context }, R.identity)\n  const [result, run] = urql.useQuery({ ...args, context: ctxMemo })\n  return useMemoEq([result, run, partial], () => ({\n    ...result,\n    run,\n    case: mkCase(result, { partial }),\n  }))\n}\n\nexport default useQuery\n","export default async function wait(timeout: number): Promise<void> {\n  return new Promise((resolve) => {\n    setTimeout(resolve, timeout)\n  })\n}\n","import semver from 'semver'\n\nimport * as R from 'ramda'\n\nimport workflowsConfigSchema from 'schemas/workflows-config-1.1.0.json'\nimport workflowsCatalogConfigSchema from 'schemas/workflows-config_catalog-1.0.0.json'\n\nimport { makeSchemaValidator } from 'utils/json-schema'\nimport type * as packageHandleUtils from 'utils/packageHandle'\nimport * as s3paths from 'utils/s3paths'\nimport * as YAML from 'utils/yaml'\nimport * as bucketErrors from 'containers/Bucket/errors'\n\ninterface WorkflowsVersion {\n  base: string\n  catalog?: string\n}\n\ninterface WorkflowsYaml {\n  default_workflow?: string\n  is_workflow_required?: boolean\n  catalog?: {\n    package_handle?: packageHandleUtils.NameTemplates\n  }\n  schemas?: Record<string, Schema>\n  successors?: Record<string, SuccessorYaml>\n  version: '1' | WorkflowsVersion\n  workflows: Record<string, WorkflowYaml>\n}\n\nexport interface WorkflowYaml {\n  description?: string\n  entries_schema?: string\n  handle_pattern?: string\n  is_message_required?: boolean\n  metadata_schema?: string\n  name: string\n  catalog?: {\n    package_handle?: packageHandleUtils.NameTemplates\n  }\n}\n\ninterface SuccessorYaml {\n  title: string\n  copy_data?: boolean\n}\n\nexport interface Successor {\n  name: string\n  slug: string\n  url: string\n  copyData: boolean\n}\n\nexport interface Schema {\n  url: string\n}\n\nexport interface Workflow {\n  description?: string\n  isDefault: boolean\n  isDisabled: boolean\n  entriesSchema?: string\n  name?: string\n  packageNamePattern: RegExp | null\n  packageName: Required<packageHandleUtils.NameTemplates>\n  schema?: Schema\n  slug: string | typeof notAvailable | typeof notSelected\n}\n\nexport interface WorkflowsConfig {\n  isWorkflowRequired: boolean\n  packageName: Required<packageHandleUtils.NameTemplates>\n  successors: Successor[]\n  workflows: Workflow[]\n}\n\nconst defaultPackageNameTemplates = {\n  files: '',\n  packages: '',\n}\n\nexport const notAvailable = Symbol('not available')\n\nconst parsePackageNameTemplates = (\n  globalTemplates?: packageHandleUtils.NameTemplates,\n  workflowTemplates?: packageHandleUtils.NameTemplates,\n): Required<packageHandleUtils.NameTemplates> => ({\n  ...defaultPackageNameTemplates,\n  ...globalTemplates,\n  ...workflowTemplates,\n})\n\nexport const notSelected = Symbol('not selected')\n\nfunction getNoWorkflow(data: WorkflowsYaml, hasConfig: boolean): Workflow {\n  return {\n    isDefault: !data.default_workflow,\n    isDisabled: data.is_workflow_required !== false,\n    packageName: parsePackageNameTemplates(data.catalog?.package_handle),\n    packageNamePattern: null,\n    slug: hasConfig ? notSelected : notAvailable,\n  }\n}\n\nconst COPY_DATA_DEFAULT = true\n\nexport const emptyConfig: WorkflowsConfig = {\n  isWorkflowRequired: false,\n  packageName: defaultPackageNameTemplates,\n  successors: [],\n  workflows: [getNoWorkflow({} as WorkflowsYaml, false)],\n}\n\nfunction parseSchema(\n  schemaSlug: string | undefined,\n  schemas: Record<string, Schema> | undefined,\n): Schema | undefined {\n  return schemaSlug && schemas && schemaSlug in schemas\n    ? {\n        url: R.path([schemaSlug, 'url'], schemas) as string,\n      }\n    : undefined\n}\n\nfunction parseWorkflow(\n  workflowSlug: string,\n  workflow: WorkflowYaml,\n  data: WorkflowsYaml,\n): Workflow {\n  return {\n    description: workflow.description,\n    isDefault: workflowSlug === data.default_workflow,\n    isDisabled: false,\n    entriesSchema: data.schemas?.[workflow.entries_schema || '']?.url,\n    name: workflow.name,\n    packageName: parsePackageNameTemplates(\n      data.catalog?.package_handle,\n      workflow.catalog?.package_handle,\n    ),\n    packageNamePattern: workflow.handle_pattern\n      ? new RegExp(workflow.handle_pattern)\n      : null,\n    schema: parseSchema(workflow.metadata_schema, data.schemas),\n    slug: workflowSlug,\n  }\n}\n\nconst parseSuccessor = (url: string, successor: SuccessorYaml): Successor => ({\n  copyData: successor.copy_data === undefined ? COPY_DATA_DEFAULT : successor.copy_data,\n  name: successor.title,\n  slug: s3paths.parseS3Url(url).bucket || '',\n  url,\n})\n\nfunction validateConfigVersion(\n  objectVersion: string,\n  schemaVersion: string,\n): undefined | Error {\n  if (semver.satisfies(schemaVersion, `^${objectVersion}`)) return undefined\n\n  return new Error(\n    `Your config file version (${objectVersion}) is incompatible with the current version of the config schema (${schemaVersion})`,\n  )\n}\n\nfunction validateConfigCompoundVersion(\n  objectCompoundVersion: WorkflowsVersion,\n): undefined | Error[] {\n  const { base: baseVersion, catalog: catalogVersion } = objectCompoundVersion\n  const errors = []\n\n  const invalidBaseVersion = validateConfigVersion(baseVersion, '1.1.0')\n  if (invalidBaseVersion) {\n    errors.push(invalidBaseVersion)\n  }\n\n  if (catalogVersion) {\n    const invalidCatalogVersion = validateConfigVersion(catalogVersion, '1.0.0')\n    if (invalidCatalogVersion) {\n      errors.push(invalidCatalogVersion)\n    }\n  }\n\n  return errors.length ? errors : undefined\n}\n\nfunction validateConfig(data: unknown): asserts data is WorkflowsYaml {\n  const objectVersion = (data as WorkflowsYaml).version\n  if (!objectVersion)\n    throw new bucketErrors.WorkflowsConfigInvalid({\n      errors: [new Error('Provide the config version')],\n    })\n  const workflowsConfigValidator = (objectVersion as WorkflowsVersion).catalog\n    ? makeSchemaValidator(workflowsCatalogConfigSchema, [workflowsConfigSchema])\n    : makeSchemaValidator(workflowsConfigSchema)\n\n  const versionErrors = validateConfigCompoundVersion(\n    typeof objectVersion === 'string' ? { base: objectVersion } : objectVersion,\n  )\n  if (versionErrors)\n    throw new bucketErrors.WorkflowsConfigInvalid({ errors: versionErrors })\n\n  const errors = workflowsConfigValidator(data)\n  if (errors.length) throw new bucketErrors.WorkflowsConfigInvalid({ errors })\n}\n\nfunction prepareData(data: unknown): WorkflowsYaml {\n  validateConfig(data)\n\n  if ((data.version as WorkflowsVersion).catalog) return data\n\n  const removeCatalog = R.dissoc('catalog')\n  return removeCatalog(\n    R.over(R.lensProp('workflows'), R.mapObjIndexed(removeCatalog), data),\n  )\n}\n\nexport function parse(workflowsYaml: string): WorkflowsConfig {\n  const rawData = YAML.parse(workflowsYaml)\n  if (!rawData) return emptyConfig\n\n  const data = prepareData(rawData)\n\n  const { workflows } = data\n  const workflowsList = Object.keys(workflows).map((slug) =>\n    parseWorkflow(slug, workflows[slug], data),\n  )\n\n  const noWorkflow = getNoWorkflow(data, true)\n\n  const successors = data.successors || {}\n  return {\n    isWorkflowRequired: data.is_workflow_required !== false,\n    packageName: parsePackageNameTemplates(data.catalog?.package_handle),\n    successors: Object.entries(successors).map(([url, successor]) =>\n      parseSuccessor(url, successor),\n    ),\n    workflows: [noWorkflow, ...workflowsList],\n  }\n}\n","import yaml from 'js-yaml'\n\nimport * as Types from 'utils/types'\n\nexport function stringify(inputObj?: Types.JsonRecord): string {\n  return yaml.dump(inputObj)\n}\n\n// eslint-disable-next-line consistent-return\nexport function parse(inputStr?: string) {\n  if (!inputStr) return undefined\n  try {\n    return yaml.load(inputStr)\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error(error)\n  }\n}\n","import * as R from 'ramda'\nimport * as React from 'react'\n\nimport Link from 'utils/StyledLink'\nimport tagged from 'utils/tagged'\n\nconst EMPTY = <i>{'<EMPTY>'}</i>\n\nexport const Crumb = tagged([\n  'Segment', // { label, to }\n  'Sep', // value\n])\n\nexport const Segment = ({ label, to, getLinkProps = R.identity }) =>\n  to != null ? <Link {...getLinkProps({ to })}>{label || EMPTY}</Link> : label || EMPTY\n\nexport const render = (items, { getLinkProps = undefined } = {}) =>\n  items.map(\n    Crumb.case({\n      Segment: (s, i) => (\n        <Segment key={`${i}:${s.label}`} getLinkProps={getLinkProps} {...s} />\n      ),\n      Sep: (s, i) => <React.Fragment key={`__sep${i}`}>{s}</React.Fragment>,\n    }),\n  )\n\nexport function copyWithoutSpaces(e) {\n  if (typeof document === 'undefined') return\n  e.clipboardData.setData(\n    'text/plain',\n    document\n      .getSelection()\n      .toString()\n      .replace('<EMPTY>', '')\n      .replace('ROOT', '')\n      .replace(/\\s*\\/\\s*/g, '/'),\n  )\n  e.preventDefault()\n}\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nconst DOM_ID = 'intercom-mount-point'\n\nexport const SELECTOR = `#${DOM_ID}`\n\nconst useStyles = M.makeStyles((t) => ({\n  root: {\n    fontWeight: t.typography.fontWeightRegular,\n    minWidth: t.spacing(4),\n  },\n  img: {\n    marginRight: t.spacing(-1),\n  },\n}))\n\ninterface LauncherProps {\n  className: string\n}\n\nexport function Launcher({ className }: LauncherProps) {\n  const classes = useStyles()\n  return (\n    <M.Tooltip title=\"Chat with Quilt support\">\n      <M.Button\n        className={cx(classes.root, className)}\n        color=\"primary\"\n        id={DOM_ID}\n        startIcon={\n          <M.Icon fontSize=\"small\" className={classes.img}>\n            chat_bubble_outline\n          </M.Icon>\n        }\n        variant=\"contained\"\n        size=\"small\"\n      />\n    </M.Tooltip>\n  )\n}\n","import * as R from 'ramda'\nimport * as React from 'react'\nimport * as redux from 'react-redux'\n\nimport * as Config from 'utils/Config'\nimport usePrevious from 'utils/usePrevious'\n\nimport { SELECTOR } from './Launcher'\n\nconst canUseDOM = !!(\n  typeof window !== 'undefined' &&\n  window.document &&\n  window.document.createElement\n)\n\nfunction dummyIntercomApi(...args) {\n  // eslint-disable-next-line no-console\n  console.log(\"Trying to call Intercom, but it's unavailable\", args)\n}\ndummyIntercomApi.dummy = true\ndummyIntercomApi.isCustom = false\ndummyIntercomApi.isAvailable = () => false\n\nconst Ctx = React.createContext(dummyIntercomApi)\n\nconst mkPlaceholder = () => {\n  const i = (...args) => i.c(args)\n  i.q = []\n  i.c = (args) => {\n    i.q.push(args)\n  }\n  return i\n}\n\n// should return undefined or { name, email, user_id }\nconst defaultUserSelector = () => undefined\n\nfunction APILoader({ appId, userSelector = defaultUserSelector, children, ...props }) {\n  const settings = { app_id: appId, ...props }\n\n  const cfg = Config.use()\n\n  if (!window.Intercom) window.Intercom = mkPlaceholder()\n\n  const { current: api } = React.useRef((...args) => window.Intercom(...args))\n  if (!('dummy' in api)) api.dummy = false\n  if (!('isAvailable' in api)) api.isAvailable = () => !!window.Intercom\n  api.isCustom = cfg.mode === 'PRODUCT'\n\n  if (api.isCustom) {\n    settings.custom_launcher_selector = SELECTOR\n    settings.hide_default_launcher = true\n  }\n\n  React.useEffect(() => {\n    api('boot', settings)\n\n    const s = window.document.createElement('script')\n    s.type = 'text/javascript'\n    s.async = true\n    s.src = `https://widget.intercom.io/widget/${appId}`\n    const x = window.document.getElementsByTagName('script')[0]\n    x.parentNode.insertBefore(s, x)\n\n    return () => {\n      if (!window.Intercom) return\n      api('shutdown')\n      delete window.Intercom\n    }\n    // run this only once, ignore settings changes\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  const user = redux.useSelector(userSelector)\n\n  usePrevious(user, (prevUser) => {\n    if (!R.equals(user, prevUser)) {\n      if (!user) {\n        api('shutdown')\n        api('boot', settings)\n      } else {\n        api('update', { ...settings, ...user })\n      }\n    }\n  })\n\n  return children(api)\n}\n\nexport function IntercomProvider({ children, ...props }) {\n  const { intercomAppId: appId } = Config.useConfig()\n  if (!canUseDOM || !appId) {\n    return children\n  }\n  return (\n    <APILoader appId={appId} {...props}>\n      {(api) => <Ctx.Provider value={api}>{children}</Ctx.Provider>}\n    </APILoader>\n  )\n}\n\nexport function useIntercom() {\n  return React.useContext(Ctx)\n}\n\nexport { IntercomProvider as Provider, useIntercom as use }\n\nexport function usePauseVisibilityWhen(condition) {\n  const intercom = useIntercom()\n  const [isVisible, setVisible] = React.useState(true)\n  const showIntercom = React.useCallback(\n    (shouldShow) => {\n      if (isVisible === shouldShow) return\n      intercom('update', {\n        hide_default_launcher: !shouldShow,\n      })\n      setVisible(shouldShow)\n    },\n    [intercom, isVisible, setVisible],\n  )\n  React.useEffect(() => {\n    if (condition) showIntercom(false)\n    return () => showIntercom(true)\n  }, [condition, showIntercom])\n}\n","import cx from 'classnames'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport * as NamedRoutes from 'utils/NamedRoutes'\nimport StyledLink from 'utils/StyledLink'\nimport * as s3paths from 'utils/s3paths'\nimport useMemoEq from 'utils/useMemoEq'\nimport wait from 'utils/wait'\n\nconst useStyles = M.makeStyles((t) => ({\n  root: {\n    fontFamily: t.typography.monospace.fontFamily,\n    fontSize: t.typography.body2.fontSize,\n    overflow: 'auto',\n    whiteSpace: 'pre',\n    width: '100%',\n  },\n  more: {\n    color: t.palette.text.secondary,\n  },\n  flex: {\n    display: 'flex',\n  },\n  compoundInner: {\n    paddingLeft: t.spacing(2),\n  },\n  hidden: {\n    display: 'none',\n  },\n  iconBlank: {\n    paddingRight: t.spacing(2.5),\n  },\n  key: {\n    fontWeight: t.typography.fontWeightBold,\n  },\n}))\n\nconst IconBlank = ({ classes }) => <div className={classes.iconBlank} />\nconst IconExpand = () => <M.Icon fontSize=\"small\">chevron_right</M.Icon>\nconst IconCollapse = () => <M.Icon fontSize=\"small\">expand_more</M.Icon>\n\nconst useWaitingJsonRenderStyles = M.makeStyles((t) => ({\n  root: {\n    color: t.palette.text.secondary,\n    display: 'flex',\n    fontFamily: t.typography.monospace.fontFamily,\n    fontSize: t.typography.body2.fontSize,\n    marginLeft: t.spacing(2),\n  },\n}))\n\nconst WaitingJsonRender = () => {\n  const classes = useWaitingJsonRenderStyles()\n  return (\n    <span className={classes.root}>\n      <M.Icon fontSize=\"small\">hourglass_empty</M.Icon>rendering…\n    </span>\n  )\n}\n\nfunction Key({ children, classes }) {\n  return !!children && <div className={classes.key}>{children}: </div>\n}\n\nfunction getHref(v) {\n  try {\n    const urlData = new URL(v)\n    return urlData.href\n  } catch (e) {\n    return ''\n  }\n}\n\nfunction NonStringValue({ value }) {\n  return <div>{`${value}`}</div>\n}\n\nfunction S3UrlValue({ href, children }) {\n  const { urls } = NamedRoutes.use()\n  const to = React.useMemo(() => {\n    const { bucket, key, version } = s3paths.parseS3Url(href)\n    return urls.bucketFile(bucket, key, { version })\n  }, [href, urls])\n  return (\n    <div>\n      \"<StyledLink to={to}>{children}</StyledLink>\"\n    </div>\n  )\n}\n\nfunction StringValue({ value }) {\n  const href = React.useMemo(() => getHref(value), [value])\n  if (!href) return <div>\"{value}\"</div>\n  if (s3paths.isS3Url(href)) {\n    try {\n      return <S3UrlValue href={href}>{value}</S3UrlValue>\n    } catch (error) {\n      return <div>\"{value}\"</div>\n    }\n  }\n  return (\n    <div>\n      \"\n      <StyledLink href={href} target=\"_blank\">\n        {value}\n      </StyledLink>\n      \"\n    </div>\n  )\n}\n\nfunction PrimitiveEntry({ name, value, topLevel = true, classes }) {\n  return (\n    <div className={classes.flex}>\n      {!topLevel && <IconBlank classes={classes} />}\n      <Key classes={classes}>{name}</Key>\n      {typeof value === 'string' ? (\n        <StringValue value={value} />\n      ) : (\n        <NonStringValue value={value} />\n      )}\n    </div>\n  )\n}\n\nconst SEP = ', '\nconst SEP_LEN = 2\nconst MORE_LEN = 4\nconst CHAR_W = 8.6\n\nfunction More({ keys, classes }) {\n  return (\n    <span className={classes.more}>\n      {'<'}&hellip;{keys}\n      {'>'}\n    </span>\n  )\n}\n\nconst join = (s1, s2) =>\n  s1 ? (\n    <>\n      {s1}\n      {SEP}\n      {s2}\n    </>\n  ) : (\n    s2\n  )\n\nfunction CompoundEntry({\n  name,\n  value,\n  topLevel = true,\n  defaultExpanded = false,\n  showKeysWhenCollapsed,\n  classes,\n}) {\n  const braces = Array.isArray(value) ? '[]' : '{}'\n  const entries = React.useMemo(() => Object.entries(value), [value])\n  const [stateExpanded, setExpanded] = React.useState(!!defaultExpanded)\n  const toggle = React.useCallback(() => setExpanded((e) => !e), [])\n  const empty = !entries.length\n  const expanded = !empty && stateExpanded\n\n  const renderCollapsed = React.useCallback(() => {\n    const availableSpace =\n      showKeysWhenCollapsed -\n      R.sum([\n        SEP_LEN,\n        MORE_LEN,\n        20 / CHAR_W, // icon / padding\n        name ? name.length + 2 : 0,\n        4, // braces + spaces\n      ])\n    if (availableSpace <= 0 || Array.isArray(value)) {\n      return <More keys={entries.length} classes={classes} />\n    }\n    return entries.reduce(\n      (acc, [k]) => {\n        if (acc.done) return acc\n        return acc.availableSpace < k.length\n          ? {\n              str: join(\n                acc.str,\n                <More keys={entries.length - acc.keys} classes={classes} />,\n              ),\n              done: true,\n            }\n          : {\n              str: join(acc.str, <span className={classes.key}>{k}</span>),\n              availableSpace: acc.availableSpace - k.length - (acc.str ? SEP_LEN : 0),\n              keys: acc.keys + 1,\n              done: false,\n            }\n      },\n      { str: null, availableSpace, keys: 0, done: false },\n    ).str\n  }, [classes, entries, name, showKeysWhenCollapsed, value])\n\n  return (\n    <div>\n      {/* eslint-disable-next-line jsx-a11y/no-static-element-interactions, jsx-a11y/click-events-have-key-events */}\n      <div className={classes.flex} onClick={toggle}>\n        {/* TODO: use icon rotation like MUI ? */}\n        {empty ? ( // eslint-disable-line no-nested-ternary\n          !topLevel && <IconBlank classes={classes} />\n        ) : expanded ? (\n          <IconCollapse />\n        ) : (\n          <IconExpand />\n        )}\n        <Key classes={classes}>{name}</Key>\n        {braces[0]}\n        {!expanded && (\n          <>\n            {empty ? '' : <span> {renderCollapsed()} </span>}\n            {braces[1]}\n          </>\n        )}\n      </div>\n      {expanded && (\n        <React.Suspense\n          fallback={\n            <>\n              <WaitingJsonRender />\n              {braces[1]}\n            </>\n          }\n        >\n          <div className={cx(classes.compoundInner)}>\n            {entries.map(([k, v]) => (\n              <JsonDisplayInner\n                classes={classes}\n                key={k}\n                name={k}\n                value={v}\n                topLevel={false}\n                defaultExpanded={\n                  Number.isInteger(defaultExpanded) && defaultExpanded > 0\n                    ? defaultExpanded - 1\n                    : defaultExpanded\n                }\n                showKeysWhenCollapsed={showKeysWhenCollapsed - 20 / CHAR_W}\n              />\n            ))}\n            {/* eslint-disable-next-line jsx-a11y/no-static-element-interactions, jsx-a11y/click-events-have-key-events */}\n            <div onClick={toggle}>{braces[1]}</div>\n          </div>\n        </React.Suspense>\n      )}\n    </div>\n  )\n}\n\nconst isPrimitive = R.anyPass([\n  R.is(String),\n  R.is(Number),\n  R.is(Boolean),\n  R.equals(null),\n  R.equals(undefined),\n])\n\nfunction useComponentOnNextTick(Component, props, optTimeout) {\n  return useMemoEq([Component, props], () =>\n    React.lazy(async () => {\n      await wait(optTimeout || 0)\n      return {\n        default: () => <Component {...props} />,\n      }\n    }),\n  )\n}\n\nfunction JsonDisplayInner(props) {\n  const Component = useComponentOnNextTick(\n    isPrimitive(props.value) ? PrimitiveEntry : CompoundEntry,\n    props,\n  )\n  return <Component />\n}\n\nfunction useCurrentBreakpointWidth() {\n  const t = M.useTheme()\n  return ['sm', 'md', 'lg'].reduce(\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    (acc, b) => (M.useMediaQuery(t.breakpoints.up(b)) ? t.breakpoints.width(b) : acc),\n    320, // min supproted width\n  )\n}\n\nexport default function JsonDisplay({\n  name,\n  value,\n  topLevel,\n  // true (expand all) | false (collapse all) | int (expand N levels deep)\n  defaultExpanded,\n  // true (show all keys) | false (dont show keys, just show their number) | int (max length of keys string to show, incl. commas and stuff) | 'auto' (calculate string length based on screen size)\n  showKeysWhenCollapsed = 'auto',\n  className,\n  ...props\n}) {\n  const classes = useStyles()\n  const currentBPWidth = useCurrentBreakpointWidth()\n  const computedKeys = React.useMemo(() => {\n    if (showKeysWhenCollapsed === true) return Number.POSITIVE_INFINITY\n    if (showKeysWhenCollapsed === false) return Number.POSITIVE_INFINITY\n    // 80 is the usual total padding\n    if (showKeysWhenCollapsed === 'auto') return (currentBPWidth - 80) / CHAR_W\n    return showKeysWhenCollapsed\n  }, [showKeysWhenCollapsed, currentBPWidth])\n\n  return (\n    <M.Box className={cx(className, classes.root)} {...props}>\n      <React.Suspense fallback={<WaitingJsonRender />}>\n        <JsonDisplayInner\n          {...{ name, value, topLevel, defaultExpanded, classes }}\n          showKeysWhenCollapsed={computedKeys}\n        />\n      </React.Suspense>\n    </M.Box>\n  )\n}\n","import * as React from 'react'\nimport * as M from '@material-ui/core'\n\nexport default function Message({ headline, children, ...props }) {\n  return (\n    <M.Box pt={5} textAlign=\"center\" {...props}>\n      {!!headline && <M.Typography variant=\"h4\">{headline}</M.Typography>}\n      {!!headline && !!children && <M.Box pt={2} />}\n      {!!children && <M.Typography variant=\"body1\">{children}</M.Typography>}\n    </M.Box>\n  )\n}\n","import cx from 'classnames'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport { Link } from 'react-router-dom'\nimport * as M from '@material-ui/core'\n\nconst Gap = Symbol('gap')\n\nconst MAX_PAGE_BUTTONS = 8 // fits on 320px-wide screen\n\n// 1-based\n// total | current  | output\n// ------|----------|----------------------\n// 8     | *        | [1, 2, 3, 4, 5, 6, 7, 8]\n// 100   | 1...4    | [1, 2, 3, 4, 5, 6, <G>, 100]\n// 100   | 5...95   | [1, <G>, N-1, N, N+1, N+2, <G>, 100]\n// 100   | 96...100 | [1, <G>, 95, 96, 97, 98, 99, 100]\nconst displayRange = (total, current, max = MAX_PAGE_BUTTONS) => {\n  if (total <= max) return R.range(1, total + 1)\n  if (current <= max - 4) {\n    return [...R.range(1, max - 1), Gap, total]\n  }\n  if (current >= total - max + 4) {\n    return [1, Gap, ...R.range(total - max + 3, total + 1)]\n  }\n  return [1, Gap, ...R.range(current - 1, current + 3), Gap, total]\n}\n\nexport const renderPageRange = ({ pages, page, max, renderPage, renderGap }) =>\n  displayRange(pages, page, max).map((p, i) => (p === Gap ? renderGap(i) : renderPage(p)))\n\nconst useStyles = M.makeStyles((t) => ({\n  button: {\n    background: t.palette.common.white,\n    height: 40,\n    lineHeight: 1,\n    paddingLeft: t.spacing(1.5),\n    paddingRight: t.spacing(1.5),\n  },\n  current: {\n    color: t.palette.primary.contrastText,\n    backgroundColor: t.palette.primary.main,\n    '&:hover': {\n      backgroundColor: t.palette.primary.dark,\n    },\n  },\n  gap: {\n    cursor: 'default',\n    pointerEvents: 'none',\n  },\n}))\n\nexport default React.forwardRef(function Pagination2(\n  {\n    page,\n    pages,\n    makePageUrl,\n    onChange,\n    classes: customClasses = {},\n    buttonGroupProps,\n    ...props\n  },\n  ref,\n) {\n  const classes = useStyles()\n\n  const renderGap = (i) => (\n    <M.Button\n      // eslint-disable-next-line react/no-array-index-key\n      key={`gap:${i}`}\n      className={cx(classes.button, classes.gap, customClasses.button, customClasses.gap)}\n      component=\"span\"\n    >\n      &hellip;\n    </M.Button>\n  )\n\n  const renderPage = (p) => {\n    const ps = {}\n    if (makePageUrl) {\n      ps.component = Link\n      ps.to = makePageUrl(p)\n    }\n    if (onChange) {\n      ps.onClick = () => onChange(p)\n    }\n    return (\n      <M.Button\n        key={`page:${p}`}\n        className={cx(\n          classes.button,\n          customClasses.button,\n          page === p && classes.current,\n          page === p && customClasses.current,\n        )}\n        {...ps}\n      >\n        {p}\n      </M.Button>\n    )\n  }\n\n  return (\n    <M.Box\n      display=\"flex\"\n      justifyContent=\"center\"\n      mt={3}\n      mb={{ xs: 5, sm: 0 }}\n      {...props}\n      ref={ref}\n    >\n      <M.ButtonGroup variant=\"contained\" {...buttonGroupProps}>\n        {renderPageRange({ pages, page, renderGap, renderPage })}\n      </M.ButtonGroup>\n    </M.Box>\n  )\n})\n","import cx from 'classnames'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\n\nimport Skeleton from 'components/Skeleton'\nimport * as AWS from 'utils/AWS'\nimport AsyncResult from 'utils/AsyncResult'\nimport { useConfig } from 'utils/Config'\nimport { mkSearch } from 'utils/NamedRoutes'\nimport { HTTPError } from 'utils/APIConnector'\nimport pipeThru from 'utils/pipeThru'\nimport usePrevious from 'utils/usePrevious'\n\nimport checkboard from './checkboard.svg'\nimport glacier from './glacier.svg'\n\nexport const SUPPORTED_EXTENSIONS = [\n  '.jpg',\n  '.jpeg',\n  '.png',\n  '.gif',\n  '.webp',\n  '.bmp',\n  '.tiff',\n  '.tif',\n  '.czi',\n]\n\nconst SIZES = {\n  sm: { w: 256, h: 256 },\n  lg: { w: 1024, h: 768 },\n}\n\nconst sizeStr = (s) => `w${SIZES[s].w}h${SIZES[s].h}`\n\nconst loadImg = async (src) => {\n  const r = await fetch(src)\n  if (r.status === 200) return r.blob()\n  const text = await r.text()\n  const e = new HTTPError(r, text)\n  throw e\n}\n\nconst useSkeletonStyles = M.makeStyles((t) => ({\n  container: {\n    paddingBottom: '70%',\n    position: 'relative',\n  },\n  inner: {\n    alignItems: 'center',\n    bottom: 0,\n    display: 'flex',\n    justifyContent: 'center',\n    left: 0,\n    position: 'absolute',\n    right: 0,\n    top: 0,\n  },\n  iconGlacier: {\n    maxHeight: '50%',\n    maxWidth: '50%',\n    opacity: 0.1,\n  },\n  iconError: {\n    color: t.palette.text.primary,\n    fontSize: 80,\n    opacity: 0.1,\n  },\n}))\n\nexport function ThumbnailSkeleton({\n  icon, // glacier | error\n  className,\n  animate,\n  ...props\n}) {\n  const classes = useSkeletonStyles()\n  return (\n    <Skeleton\n      borderRadius=\"borderRadius\"\n      className={cx(className, classes.container)}\n      animate={animate != null ? animate : !icon}\n      {...props}\n    >\n      {icon === 'glacier' && (\n        <div className={classes.inner}>\n          <img alt=\"\" src={glacier} className={classes.iconGlacier} />\n        </div>\n      )}\n      {icon === 'error' && (\n        <div className={classes.inner}>\n          <M.Icon className={classes.iconError}>error_outline</M.Icon>\n        </div>\n      )}\n    </Skeleton>\n  )\n}\n\nconst useStyles = M.makeStyles({\n  root: {\n    background: `0 0 url(\"${checkboard}\") repeat`,\n  },\n})\n\nexport default function Thumbnail({\n  handle,\n  size = 'sm', // sm | lg\n  alt = '',\n  skeletonProps,\n  className,\n  ...props\n}) {\n  const api = useConfig().binaryApiGatewayEndpoint\n  const sign = AWS.Signer.useS3Signer()\n\n  const classes = useStyles()\n\n  const [state, setState] = React.useState(AsyncResult.Init())\n\n  usePrevious(handle, (prev) => {\n    if (R.equals(handle, prev)) return\n    const url = sign(handle)\n    const src = `${api}/thumbnail${mkSearch({ url, size: sizeStr(size) })}`\n    setState(AsyncResult.Pending())\n    loadImg(src)\n      .then((blob) => {\n        const objUrl = window.URL.createObjectURL(blob)\n        setState(AsyncResult.Ok(objUrl))\n      })\n      .catch((e) => {\n        setState(AsyncResult.Err(e))\n      })\n  })\n\n  // revoke object url when it changes or component unmounts\n  const cleanupUrl = pipeThru(state)(AsyncResult.case({ Ok: R.identity, _: () => null }))\n  React.useEffect(\n    () => () => {\n      if (cleanupUrl) window.URL.revokeObjectURL(cleanupUrl)\n    },\n    [cleanupUrl],\n  )\n\n  return pipeThru(state)(\n    AsyncResult.case({\n      _: () => <ThumbnailSkeleton {...skeletonProps} {...props} />,\n      Ok: (src) => (\n        <M.Box\n          className={cx(classes.root, className)}\n          component=\"img\"\n          src={src}\n          alt={alt}\n          {...props}\n        />\n      ),\n      Err: (e) => {\n        let title = 'Error loading image'\n        let icon = 'error'\n        if (e instanceof HTTPError) {\n          if (\n            e.json &&\n            e.json.error === 'Forbidden' &&\n            e.json.text &&\n            e.json.text.match(/InvalidObjectState/)\n          ) {\n            title = 'Object archived'\n            icon = 'glacier'\n          } else if (e.message) {\n            title = e.message\n          }\n        }\n        return (\n          <ThumbnailSkeleton\n            icon={icon}\n            {...skeletonProps}\n            {...props}\n            title={props.title ? `${props.title}: ${title}` : title}\n          />\n        )\n      },\n    }),\n  )\n}\n","/* constants for use in CSS. prefer integers over strings so we can do math */\nimport { colors, createMuiTheme } from '@material-ui/core'\n\nconst defaultTheme = createMuiTheme()\n\nconst appPalette = {\n  primary: {\n    main: '#282b50',\n    dark: '#1d2146',\n  },\n  secondary: {\n    main: colors.orange[600],\n  },\n  info: {\n    main: colors.lightBlue[600],\n    light: colors.lightBlue[50],\n  },\n  warning: {\n    main: colors.yellow[200],\n    dark: colors.yellow[900],\n  },\n}\n\nconst websitePalette = {\n  type: 'dark',\n  background: {\n    default: '#19163b',\n  },\n  primary: {\n    contrastText: colors.common.white,\n    light: '#fabdb3',\n    main: '#f38681',\n  },\n  secondary: {\n    main: '#5471f1',\n    dark: '#2d306d',\n  },\n  tertiary: {\n    contrastText: colors.common.white,\n    main: '#6a93ff',\n  },\n  text: {\n    secondary: '#b2bddb',\n  },\n}\n\nconst baseTypography = {\n  monospace: {\n    fontFamily: ['Roboto Mono', 'monospace'],\n  },\n}\n\nconst appTypography = {\n  ...baseTypography,\n}\n\nconst websiteTypography = {\n  ...baseTypography,\n  h1: {\n    fontSize: '3rem',\n    lineHeight: '3.5rem',\n  },\n  h2: {\n    fontSize: '2.25rem',\n    lineHeight: 44 / 36,\n  },\n  h3: {\n    fontSize: '1.75rem',\n    lineHeight: 32 / 28,\n  },\n  h4: {\n    fontSize: '1.25rem',\n    lineHeight: 1.4,\n  },\n  h5: {\n    fontSize: '1rem',\n    lineHeight: 1.5,\n  },\n  body1: {\n    lineHeight: 2,\n  },\n  body2: {\n    lineHeight: 2,\n  },\n  button: {\n    fontWeight: defaultTheme.typography.fontWeightRegular,\n  },\n}\n\nconst websiteOverrides = {\n  MuiButton: {\n    root: {\n      padding: [[8, 24]],\n      borderRadius: 2,\n    },\n    containedPrimary: {\n      backgroundImage: [\n        'linear-gradient(to left, #f1b39d, #f78881)',\n        'linear-gradient(to top, #000000, rgba(255, 255, 255, 0.7))',\n      ],\n    },\n    containedSecondary: {\n      backgroundImage: [\n        'linear-gradient(225deg, #5c83ea, #6752e6)',\n        'linear-gradient(to top, #000000, rgba(255, 255, 255, 0.7))',\n      ],\n    },\n  },\n}\n\nconst mixins = {\n  // see https://css-tricks.com/almanac/properties/l/line-clamp/\n  lineClamp: (lines) => ({\n    WebkitBoxOrient: 'vertical',\n    WebkitLineClamp: lines,\n    display: '-webkit-box',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n  }),\n}\n\n// default app theme\nexport const appTheme = createMuiTheme({\n  palette: appPalette,\n  typography: appTypography,\n  mixins,\n})\n\n// theme used for navbar and footer\nexport const navTheme = createMuiTheme({\n  palette: websitePalette,\n  typography: appTypography,\n  overrides: websiteOverrides,\n  mixins,\n})\n\n// theme used for marketing pages\nexport const websiteTheme = createMuiTheme({\n  palette: websitePalette,\n  typography: websiteTypography,\n  overrides: websiteOverrides,\n  mixins,\n})\n\nexport const createCustomAppTheme = (\n  { palette, typography, mixins: mxs, ...rest },\n  ...args\n) =>\n  createMuiTheme(\n    {\n      palette: { ...appPalette, ...palette },\n      typography: { ...appTypography, ...typography },\n      mixins: { ...mixins, ...mxs },\n      ...rest,\n    },\n    ...args,\n  )\n\n// expose themes for development purposes\nif (process.env.NODE_ENV === 'development') {\n  window.THEMES = { appTheme, navTheme, websiteTheme }\n}\n","/* Constants are a developer's best friend\n * convention: camelcase, no terminating slash */\nexport const blog = 'https://blog.quiltdata.com'\nexport const blogManage =\n  'https://blog.quiltdata.com/its-time-to-manage-data-like-source-code-3df04cd312b8'\nexport const blogYC =\n  'https://blog.ycombinator.com/data-packages-for-fast-reproducible-python-analysis/'\nexport const caseStudy = 'https://quiltdata.com/docs/quants.pdf'\nexport const company = 'https://company.quiltdata.com'\nexport const docs = 'https://docs.quiltdata.com'\nexport const docsMaster = 'https://docs.quiltdata.com/v/master'\nexport const git = 'https://github.com/quiltdata/quilt.git'\nexport const gitWeb = 'https://github.com/quiltdata/quilt'\nexport const homeMarketing = 'https://quiltdata.com'\nexport const instagram = 'https://www.instagram.com/quiltdata/'\nexport const installGit = 'https://git-scm.com/downloads'\nexport const installQuilt = `${docs}/get-started/installation`\nexport const jobs = 'https://quilt-data.breezy.hr/'\nexport const linkedin = 'https://www.linkedin.com/company/quilt-data'\nexport const slackInvite = 'https://slack.quiltdata.com/'\nexport const pipGit = `git+${git}`\nexport const icon256 = 'https://d1zvn9rasera71.cloudfront.net/q-256-square.png'\nexport const tutorial =\n  'https://github.com/quiltdata/quilt/blob/master/README.md#tutorial'\nexport const twitter = 'https://twitter.com/quiltdata'\nexport const facebook = 'https://www.facebook.com/quiltdata/'\nexport const curate = 'https://forms.gle/oNoiRYDxnkZEnppq7'\nexport const mailingListGeneral = 'http://eepurl.com/bOyxRz'\n","import { createActions } from 'utils/reduxTools'\n\nexport const REDUX_KEY = 'app/Auth'\n\nexport const states = ['SIGNED_OUT', 'SIGNING_IN', 'SIGNED_IN', 'REFRESHING']\n\nexport const waitingStates = ['SIGNING_IN', 'REFRESHING']\n\nexport const actions = createActions(\n  REDUX_KEY,\n  'SIGN_UP',\n  'RESET_PASSWORD',\n  'CHANGE_PASSWORD',\n  'SIGN_IN',\n  'SIGN_IN_RESULT',\n  'SIGN_OUT',\n  'SIGN_OUT_RESULT',\n  'CHECK',\n  'GET_TOKENS',\n  'REFRESH',\n  'REFRESH_RESULT',\n  'AUTH_LOST',\n  'GET_CODE',\n)\n","import { Map } from 'immutable'\nimport * as R from 'ramda'\nimport { createSelector } from 'reselect'\n\nimport { get, getIn, toJS } from 'utils/immutableTools'\n\nimport { REDUX_KEY, waitingStates } from './constants'\n\nexport const domain = createSelector(get(REDUX_KEY, Map({})), toJS())\n\nexport const state = createSelector(getIn([REDUX_KEY, 'state']), R.identity)\n\nexport const waiting = createSelector(state, (s) => waitingStates.includes(s))\n\nexport const error = createSelector(getIn([REDUX_KEY, 'error']), R.identity)\n\nexport const username = createSelector(\n  getIn([REDUX_KEY, 'user', 'current_user']),\n  R.identity,\n)\n\nexport const authenticated = createSelector(username, Boolean)\n\nexport const isAdmin = createSelector(getIn([REDUX_KEY, 'user', 'is_staff']), R.identity)\n\nexport const email = createSelector(getIn([REDUX_KEY, 'user', 'email']), R.identity)\n\nexport const tokens = createSelector(getIn([REDUX_KEY, 'tokens']), toJS())\n\nexport const sessionId = createSelector(getIn([REDUX_KEY, 'sessionId']), R.identity)\n","import cx from 'classnames'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport * as M from '@material-ui/core'\nimport * as Lab from '@material-ui/lab'\n\nimport JsonDisplay from 'components/JsonDisplay'\nimport AsyncResult from 'utils/AsyncResult'\nimport * as BucketPreferences from 'utils/BucketPreferences'\nimport { JsonRecord } from 'utils/types'\n\nimport Section, { SectionProps } from './Section'\n\ninterface MetaData {\n  message?: string\n  user_meta?: JsonRecord\n  workflow?: JsonRecord\n  version?: string\n}\n\nconst errorHandler = (error: Error) => (\n  <Lab.Alert severity=\"error\">{error.message}</Lab.Alert>\n)\n\nconst noop = () => null\n\nconst useHeadCellStyles = M.makeStyles((t) => ({\n  root: {\n    paddingTop: t.spacing(1),\n    verticalAlign: 'top',\n    whiteSpace: 'nowrap',\n  },\n}))\n\ninterface HeadCellProps {\n  children: React.ReactNode\n  className?: string\n  title: string\n}\n\nconst HeadCell = ({ className, children, title }: HeadCellProps) => {\n  const classes = useHeadCellStyles()\n  return (\n    <M.TableCell className={cx(classes.root, className)} component=\"th\" scope=\"row\">\n      <M.Tooltip title={title}>\n        <span>{children}</span>\n      </M.Tooltip>\n    </M.TableCell>\n  )\n}\n\nconst usePackageMetaStyles = M.makeStyles({\n  headCell: {\n    width: '137px',\n  },\n  message: {\n    paddingLeft: '4px',\n  },\n  row: {\n    '&:last-child th, &:last-child td': {\n      borderBottom: 0,\n    },\n    '&:only-child th': {\n      paddingLeft: 0,\n    },\n  },\n  table: {\n    tableLayout: 'fixed',\n    width: '100%',\n  },\n  wrapper: {\n    width: '100%',\n  },\n})\n\ninterface WrapperProps extends Partial<SectionProps> {\n  data: $TSFixMe\n}\n\ninterface PackageMetaProps extends Partial<SectionProps> {\n  meta: MetaData\n  preferences: BucketPreferences.MetaBlockPreferences\n}\n\nfunction PackageMetaSection({ meta, preferences, ...props }: PackageMetaProps) {\n  const classes = usePackageMetaStyles()\n  const { message, user_meta: userMeta, workflow } = meta\n  return (\n    <Section icon=\"list\" heading=\"Metadata\" defaultExpanded {...props}>\n      <M.Table className={classes.table} size=\"small\" data-testid=\"package-meta\">\n        <M.TableBody>\n          {message && (\n            <M.TableRow className={classes.row} data-key=\"message\" data-value={message}>\n              <HeadCell className={classes.headCell} title=\"/message\">\n                Message:\n              </HeadCell>\n              <M.TableCell>\n                <M.Typography className={classes.message}>{message}</M.Typography>\n              </M.TableCell>\n            </M.TableRow>\n          )}\n          {userMeta && (\n            <M.TableRow\n              className={classes.row}\n              data-key=\"user_meta\"\n              data-value={JSON.stringify(userMeta)}\n            >\n              <HeadCell className={classes.headCell} title=\"/user_meta\">\n                User metadata:\n              </HeadCell>\n              <M.TableCell>\n                {/* @ts-expect-error */}\n                <JsonDisplay\n                  defaultExpanded={preferences.userMeta.expanded}\n                  value={userMeta}\n                />\n              </M.TableCell>\n            </M.TableRow>\n          )}\n          {workflow && (\n            <M.TableRow\n              className={classes.row}\n              data-key=\"workflow\"\n              data-value={JSON.stringify(workflow)}\n            >\n              <HeadCell className={classes.headCell} title=\"/workflow\">\n                Workflow:\n              </HeadCell>\n              <M.TableCell>\n                {/* @ts-expect-error */}\n                <JsonDisplay\n                  defaultExpanded={preferences.workflows.expanded}\n                  value={workflow}\n                />\n              </M.TableCell>\n            </M.TableRow>\n          )}\n        </M.TableBody>\n      </M.Table>\n    </Section>\n  )\n}\n\nexport function PackageMeta({ data, ...props }: WrapperProps) {\n  const { result } = BucketPreferences.use()\n  return AsyncResult.case(\n    {\n      Ok: (meta?: MetaData) => {\n        if (!meta || R.isEmpty(meta)) return null\n        return AsyncResult.case(\n          {\n            Ok: (preferences: BucketPreferences.BucketPreferences) =>\n              !!preferences.ui.blocks.meta && (\n                <PackageMetaSection\n                  meta={meta}\n                  preferences={preferences.ui.blocks.meta}\n                  {...props}\n                />\n              ),\n            Err: errorHandler,\n            _: noop,\n          },\n          result,\n        )\n      },\n      Err: errorHandler,\n      _: noop,\n    },\n    data,\n  )\n}\n\ninterface ObjectMetaProps extends Partial<SectionProps> {\n  meta: JsonRecord\n}\n\nfunction ObjectMetaSection({ meta, ...props }: ObjectMetaProps) {\n  return (\n    <Section icon=\"list\" heading=\"Metadata\" defaultExpanded {...props}>\n      {/* @ts-expect-error */}\n      <JsonDisplay value={meta} defaultExpanded={1} />\n    </Section>\n  )\n}\n\nexport function ObjectMeta({ data, ...props }: WrapperProps) {\n  return AsyncResult.case(\n    {\n      Ok: (meta?: JsonRecord) => {\n        if (!meta || R.isEmpty(meta)) return null\n        return <ObjectMetaSection meta={meta} {...props} />\n      },\n      Err: errorHandler,\n      _: noop,\n    },\n    data,\n  )\n}\n","import cx from 'classnames'\nimport * as React from 'react'\nimport * as redux from 'react-redux'\nimport * as M from '@material-ui/core'\n\n// import Message from 'components/Message'\nimport SelectDropdown from 'components/SelectDropdown'\nimport { tokens as tokensSelector } from 'containers/Auth/selectors'\nimport * as AWS from 'utils/AWS'\nimport * as Config from 'utils/Config'\n\nexport * from './Meta'\n\n// TODO: move here everything that's reused btw Bucket/File, Bucket/PackageTree and Embed/File\n\nconst useAdaptiveButtonStyles = M.makeStyles((t) => ({\n  root: {\n    flexShrink: 0,\n    marginBottom: -3,\n    marginTop: -3,\n  },\n  label: {\n    marginRight: t.spacing(1),\n  },\n}))\n\nexport function AdaptiveButtonLayout({ className, label, icon, ...props }) {\n  const classes = useAdaptiveButtonStyles()\n  const t = M.useTheme()\n  const sm = M.useMediaQuery(t.breakpoints.down('sm'))\n\n  return sm ? (\n    <M.IconButton\n      className={cx(classes.root, className)}\n      edge=\"end\"\n      size=\"small\"\n      {...props}\n    >\n      <M.Icon>{icon}</M.Icon>\n    </M.IconButton>\n  ) : (\n    <M.Button\n      className={cx(classes.root, className)}\n      variant=\"outlined\"\n      size=\"small\"\n      startIcon={<M.Icon>{icon}</M.Icon>}\n      {...props}\n    >\n      {label}\n    </M.Button>\n  )\n}\n\nexport function DownloadButton({ className, handle }) {\n  return AWS.Signer.withDownloadUrl(handle, (url) => (\n    <AdaptiveButtonLayout\n      className={className}\n      href={url}\n      download\n      label=\"Download file\"\n      icon=\"arrow_downward\"\n    />\n  ))\n}\n\nexport function ViewModeSelector({ className, ...props }) {\n  const classes = useAdaptiveButtonStyles()\n  const t = M.useTheme()\n  const sm = M.useMediaQuery(t.breakpoints.down('sm'))\n  return (\n    <SelectDropdown className={cx(classes.root, className)} {...props}>\n      {sm ? <M.Icon>visibility</M.Icon> : <span className={classes.label}>View as:</span>}\n    </SelectDropdown>\n  )\n}\n\nexport function ZipDownloadForm({ className, suffix, label, newTab = false }) {\n  const { s3Proxy, noDownload } = Config.use()\n  const { token } = redux.useSelector(tokensSelector) || {}\n  if (!token || noDownload) return null\n  const action = `${s3Proxy}/zip/${suffix}`\n  return (\n    <form\n      action={action}\n      target={newTab ? '_blank' : undefined}\n      method=\"POST\"\n      style={{ flexShrink: 0 }}\n    >\n      <input type=\"hidden\" name=\"token\" value={token} />\n      <AdaptiveButtonLayout\n        className={className}\n        label={label}\n        icon=\"archive\"\n        type=\"submit\"\n      />\n    </form>\n  )\n}\n\nexport function Root(props) {\n  return <M.Box pt={2} pb={4} {...props} />\n}\n\n/*\nexport function Header() {\n}\n\nexport function TopBar() {\n}\n\nexport function GlobalProgress() {\n}\n\nexport function GlobalError(props) {\n  return <Message {...props} />\n}\n\nconst renderDownload = (handle) => !!handle && <DownloadButton {...{ handle }} />\n\nfunction FileView({\n  header,\n  subheader, \n}) {\n  return (\n    <Root>\n      <Header>{header}</Header>\n      <TopBar>\n        {subheader}\n        'spacer'\n        {withDownloadData(renderDownload)}\n      </TopBar>\n      {withFileData(AsyncResult.case({\n        //_: () => <GlobalProgress />,\n        _: renderFileProgress,\n        // TODO: use proper err msgs\n        //Err: (e) => <GlobalError />,\n        Err: renderFileErr,\n        Ok: () => (\n          <>\n            {withCodeData(renderCode)}\n            {withAnalyticsData(renderAnalytics)}\n            {withPreviewData(renderPreview)}\n            {withMetaData(renderMeta)}\n          </>\n        ),\n      }))}\n    </Root>\n  )\n}\n*/\n","import { join as pathJoin } from 'path'\n\nimport * as dateFns from 'date-fns'\nimport * as FP from 'fp-ts'\nimport sampleSize from 'lodash/fp/sampleSize'\nimport * as R from 'ramda'\n\nimport quiltSummarizeSchema from 'schemas/quilt_summarize.json'\n\nimport { SUPPORTED_EXTENSIONS as IMG_EXTS } from 'components/Thumbnail'\nimport * as quiltConfigs from 'constants/quiltConfigs'\nimport * as Resource from 'utils/Resource'\nimport { makeSchemaValidator } from 'utils/json-schema'\nimport mkSearch from 'utils/mkSearch'\nimport * as s3paths from 'utils/s3paths'\nimport tagged from 'utils/tagged'\nimport * as workflows from 'utils/workflows'\n\nimport * as errors from '../errors'\n\nimport { decodeS3Key } from './utils'\n\nconst promiseProps = (obj) =>\n  Promise.all(Object.values(obj)).then(R.zipObj(Object.keys(obj)))\n\nconst MAX_BANDS = 10\n\nexport const bucketAccessCounts = async ({\n  s3,\n  analyticsBucket,\n  bucket,\n  today,\n  window,\n}) => {\n  if (!analyticsBucket) throw new Error('bucketAccessCounts: \"analyticsBucket\" required')\n\n  const dates = R.unfold(\n    (daysLeft) => daysLeft >= 0 && [dateFns.subDays(today, daysLeft), daysLeft - 1],\n    window,\n  )\n\n  try {\n    const result = await s3Select({\n      s3,\n      Bucket: analyticsBucket,\n      Key: `${ACCESS_COUNTS_PREFIX}/Exts.csv`,\n      Expression: `\n        SELECT ext, counts FROM s3object\n        WHERE eventname = 'GetObject'\n        AND bucket = '${sqlEscape(bucket)}'\n      `,\n      InputSerialization: {\n        CSV: {\n          FileHeaderInfo: 'Use',\n          AllowQuotedRecordDelimiter: true,\n        },\n      },\n    })\n    return FP.function.pipe(\n      result,\n      R.map((r) => {\n        const recordedCounts = JSON.parse(r.counts)\n        const { counts, total } = dates.reduce(\n          (acc, date) => {\n            const value = recordedCounts[dateFns.format(date, 'yyyy-MM-dd')] || 0\n            const sum = acc.total + value\n            return {\n              total: sum,\n              counts: acc.counts.concat({ date, value, sum }),\n            }\n          },\n          { total: 0, counts: [] },\n        )\n        return { ext: r.ext && `.${r.ext}`, total, counts }\n      }),\n      R.filter((i) => i.total),\n      R.sort(R.descend(R.prop('total'))),\n      R.applySpec({\n        byExt: R.identity,\n        byExtCollapsed: (bands) => {\n          if (bands.length <= MAX_BANDS) return bands\n          const [other, rest] = R.partition((b) => b.ext === '', bands)\n          const [toKeep, toMerge] = R.splitAt(MAX_BANDS - 1, rest)\n          const merged = [...other, ...toMerge].reduce((acc, band) => ({\n            ext: '',\n            total: acc.total + band.total,\n            counts: R.zipWith(\n              (a, b) => ({\n                date: a.date,\n                value: a.value + b.value,\n                sum: a.sum + b.sum,\n              }),\n              acc.counts,\n              band.counts,\n            ),\n          }))\n          return R.sort(R.descend(R.prop('total')), toKeep.concat(merged))\n        },\n        combined: {\n          total: R.reduce((sum, { total }) => sum + total, 0),\n          counts: R.pipe(\n            R.pluck('counts'),\n            R.transpose,\n            R.map(\n              R.reduce(\n                (acc, { date, value, sum }) => ({\n                  date,\n                  value: acc.value + value,\n                  sum: acc.sum + sum,\n                }),\n                { value: 0, sum: 0 },\n              ),\n            ),\n          ),\n        },\n      }),\n    )\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log('Unable to fetch bucket access counts:')\n    // eslint-disable-next-line no-console\n    console.error(e)\n    return {\n      byExt: [],\n      byExtCollapsed: [],\n      combined: { total: 0, counts: [] },\n    }\n  }\n}\n\nconst parseDate = (d) => d && new Date(d)\n\nconst getOverviewBucket = (url) => s3paths.parseS3Url(url).bucket\nconst getOverviewPrefix = (url) => s3paths.parseS3Url(url).key\nconst getOverviewKey = (url, path) => pathJoin(getOverviewPrefix(url), path)\n\nconst processStats = R.applySpec({\n  exts: R.pipe(\n    R.path(['aggregations', 'exts', 'buckets']),\n    R.map((i) => ({\n      ext: i.key,\n      objects: i.doc_count,\n      bytes: i.size.value,\n    })),\n    R.sort(R.descend(R.prop('bytes'))),\n  ),\n  totalObjects: R.path(['hits', 'total']),\n  totalBytes: R.path(['aggregations', 'totalBytes', 'value']),\n})\n\nexport const bucketStats = async ({ req, s3, bucket, overviewUrl }) => {\n  if (overviewUrl) {\n    try {\n      const r = await s3\n        .getObject({\n          Bucket: getOverviewBucket(overviewUrl),\n          Key: getOverviewKey(overviewUrl, 'stats.json'),\n        })\n        .promise()\n      return processStats(JSON.parse(r.Body.toString('utf-8')))\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.log(`Unable to fetch pre-rendered stats from '${overviewUrl}':`)\n      // eslint-disable-next-line no-console\n      console.error(e)\n    }\n  }\n\n  try {\n    const qs = mkSearch({ index: bucket, action: 'stats' })\n    const result = await req(`/search${qs}`)\n    return processStats(result)\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log('Unable to fetch live stats:')\n    // eslint-disable-next-line no-console\n    console.error(e)\n  }\n\n  throw new Error('Stats unavailable')\n}\n\nconst ensureObjectIsPresentInCollection = async ({ s3, bucket, keys, version }) => {\n  if (!keys.length) return null\n\n  const [key, ...keysTail] = keys\n  const fileExists = await ensureObjectIsPresent({\n    s3,\n    bucket,\n    key,\n    version,\n  })\n\n  return (\n    fileExists ||\n    (await ensureObjectIsPresentInCollection({ s3, bucket, keys: keysTail }))\n  )\n}\n\nconst fetchFileVersioned = async ({ s3, bucket, path, version }) => {\n  const keys = Array.isArray(path) ? path : [path]\n  const versionExists = await ensureObjectIsPresentInCollection({\n    s3,\n    bucket,\n    keys,\n    version,\n  })\n  if (!versionExists) {\n    throw new errors.VersionNotFound(\n      `${path} for ${bucket} and version ${version} does not exist`,\n    )\n  }\n\n  return s3\n    .getObject({\n      Bucket: bucket,\n      Key: versionExists.key,\n      VersionId: version,\n    })\n    .promise()\n}\n\nconst fetchFileLatest = async ({ s3, bucket, path }) => {\n  const keys = Array.isArray(path) ? path : [path]\n  const fileExists = await ensureObjectIsPresentInCollection({\n    s3,\n    bucket,\n    keys,\n  })\n  if (!fileExists) {\n    throw new errors.FileNotFound(`${path} for ${bucket} does not exist`)\n  }\n\n  const versions = await objectVersions({\n    s3,\n    bucket,\n    path: fileExists.key,\n  })\n  const latest = R.find(R.prop('isLatest'), versions)\n  const version = latest && latest.id !== 'null' ? latest.id : undefined\n\n  return fetchFileVersioned({ s3, bucket, path: fileExists.key, version })\n}\n\nexport const fetchFile = R.ifElse(R.prop('version'), fetchFileVersioned, fetchFileLatest)\n\nexport const metadataSchema = async ({ s3, schemaUrl }) => {\n  if (!schemaUrl) return null\n\n  const { bucket, key, version } = s3paths.parseS3Url(schemaUrl)\n\n  const response = await fetchFile({ s3, bucket, path: key, version })\n  return JSON.parse(response.Body.toString('utf-8'))\n}\n\nexport const WORKFLOWS_CONFIG_PATH = quiltConfigs.workflows\n// TODO: enable this when backend is ready\n// const WORKFLOWS_CONFIG_PATH = [\n//   '.quilt/workflows/config.yaml',\n//   '.quilt/workflows/config.yml',\n// ]\n\nexport const workflowsConfig = async ({ s3, bucket }) => {\n  try {\n    const response = await fetchFile({ s3, bucket, path: WORKFLOWS_CONFIG_PATH })\n    return workflows.parse(response.Body.toString('utf-8'))\n  } catch (e) {\n    if (e instanceof errors.FileNotFound || e instanceof errors.VersionNotFound)\n      return workflows.emptyConfig\n\n    // eslint-disable-next-line no-console\n    console.log('Unable to fetch')\n    // eslint-disable-next-line no-console\n    console.error(e)\n    throw e\n  }\n}\n\nconst README_KEYS = ['README.md', 'README.txt', 'README.ipynb']\nconst SAMPLE_EXTS = [\n  '*.parquet',\n  '*.parquet.gz',\n  '*.csv',\n  '*.csv.gz',\n  '*.tsv',\n  '*.tsv.gz',\n  '*.txt',\n  '*.txt.gz',\n  '*.vcf',\n  '*.vcf.gz',\n  '*.xls',\n  '*.xls.gz',\n  '*.xlsx',\n  '*.xlsx.gz',\n  '*.ipynb',\n  '*.md',\n  '*.pdf',\n  '*.pdf.gz',\n  '*.json',\n  '*.json.gz',\n]\nconst SAMPLE_SIZE = 20\nconst SUMMARIZE_KEY = 'quilt_summarize.json'\nconst MAX_IMGS = 100\n\nexport const ObjectExistence = tagged(['Exists', 'DoesNotExist'])\n\nexport async function getObjectExistence({ s3, bucket, key, version }) {\n  const req = s3.headObject({ Bucket: bucket, Key: key, VersionId: version })\n  try {\n    const h = await req.promise()\n    return ObjectExistence.Exists({\n      bucket,\n      key,\n      version: h.VersionId,\n      size: h.ContentLength,\n      deleted: !!h.DeleteMarker,\n      archived: h.StorageClass === 'GLACIER' || h.StorageClass === 'DEEP_ARCHIVE',\n      lastModified: parseDate(h.LastModified),\n    })\n  } catch (e) {\n    if (e.code === 405 && version != null) {\n      // assume delete marker when 405 and version is defined,\n      // since GET and HEAD methods are not allowed on delete markers\n      // (https://github.com/boto/botocore/issues/674)\n      return ObjectExistence.Exists({ bucket, key, version, deleted: true })\n    }\n    if (e.code === 'BadRequest' && version != null) {\n      // assume invalid version when 400 and version is defined\n      return ObjectExistence.DoesNotExist()\n    }\n    if (e.code === 'NotFound') {\n      const { headers } = req.response.httpResponse\n      if (headers['x-amz-delete-marker'] === 'true') {\n        return ObjectExistence.Exists({\n          bucket,\n          key,\n          version: headers['x-amz-version-id'],\n          deleted: true,\n        })\n      }\n      return ObjectExistence.DoesNotExist()\n    }\n    throw e\n  }\n}\n\nexport const ensureObjectIsPresent = (...args) =>\n  getObjectExistence(...args).then(\n    ObjectExistence.case({\n      Exists: ({ deleted, archived, ...h }) => (deleted || archived ? null : h),\n      _: () => null,\n    }),\n  )\n\nexport const bucketSummary = async ({ s3, req, bucket, overviewUrl, inStack }) => {\n  const handle = await ensureObjectIsPresent({ s3, bucket, key: SUMMARIZE_KEY })\n  if (handle) {\n    try {\n      return await summarize({ s3, handle })\n    } catch (e) {\n      const display = `${handle.bucket}/${handle.key}`\n      // eslint-disable-next-line no-console\n      console.log(`Unable to fetch configured summary from '${display}':`)\n      // eslint-disable-next-line no-console\n      console.error(e)\n    }\n  }\n  if (overviewUrl) {\n    try {\n      const r = await s3\n        .getObject({\n          Bucket: getOverviewBucket(overviewUrl),\n          Key: getOverviewKey(overviewUrl, 'summary.json'),\n        })\n        .promise()\n      return FP.function.pipe(\n        JSON.parse(r.Body.toString('utf-8')),\n        R.pathOr([], ['aggregations', 'other', 'keys', 'buckets']),\n        R.map((b) => ({\n          bucket,\n          key: b.key,\n          // eslint-disable-next-line no-underscore-dangle\n          version: b.latestVersion.hits.hits[0]._source.version_id,\n          lastModified: parseDate(b.lastModified),\n          // eslint-disable-next-line no-underscore-dangle\n          ext: b.latestVersion.hits.hits[0]._source.ext,\n        })),\n        R.sortWith([\n          R.ascend((h) => SAMPLE_EXTS.indexOf(h.ext)),\n          R.descend(R.prop('lastModified')),\n        ]),\n        R.take(SAMPLE_SIZE),\n        R.map(R.objOf('handle')),\n      )\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.log(`Unable to fetch pre-rendered summary from '${overviewUrl}':`)\n      // eslint-disable-next-line no-console\n      console.error(e)\n    }\n  }\n  if (inStack) {\n    try {\n      const qs = mkSearch({ action: 'sample', index: bucket })\n      const result = await req(`/search${qs}`)\n      return FP.function.pipe(\n        result,\n        R.pathOr([], ['aggregations', 'objects', 'buckets']),\n        R.map((h) => {\n          // eslint-disable-next-line no-underscore-dangle\n          const s = h.latest.hits.hits[0]._source\n          return { bucket, key: s.key, version: s.version_id }\n        }),\n        R.take(SAMPLE_SIZE),\n        R.map(R.objOf('handle')),\n      )\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.log('Unable to fetch live summary:')\n      // eslint-disable-next-line no-console\n      console.error(e)\n    }\n  }\n  try {\n    const result = await s3\n      .listObjectsV2({ Bucket: bucket, EncodingType: 'url' })\n      .promise()\n    return FP.function.pipe(\n      result,\n      R.path(['Contents']),\n      R.map(R.evolve({ Key: decodeS3Key })),\n      R.filter(\n        R.propSatisfies(\n          R.allPass([\n            R.complement(R.startsWith('.quilt/')),\n            R.complement(R.startsWith('/')),\n            R.complement(R.endsWith(SUMMARIZE_KEY)),\n            R.complement(R.includes(R.__, README_KEYS)),\n            R.anyPass(SAMPLE_EXTS.map(R.unary(R.endsWith))),\n          ]),\n          'Key',\n        ),\n      ),\n      sampleSize(SAMPLE_SIZE),\n      R.map(({ Key: key }) => ({ key, bucket })),\n      R.map(R.objOf('handle')),\n    )\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log('Unable to fetch summary from S3 listing:')\n    // eslint-disable-next-line no-console\n    console.error(e)\n  }\n  return []\n}\n\nexport const bucketReadmes = ({ s3, bucket, overviewUrl }) =>\n  promiseProps({\n    forced:\n      overviewUrl &&\n      ensureObjectIsPresent({\n        s3,\n        bucket: getOverviewBucket(overviewUrl),\n        key: getOverviewKey(overviewUrl, 'README.md'),\n      }),\n    discovered: Promise.all(\n      README_KEYS.map((key) => ensureObjectIsPresent({ s3, bucket, key })),\n    ).then(R.filter(Boolean)),\n  })\n\nexport const bucketImgs = async ({ req, s3, bucket, overviewUrl, inStack }) => {\n  if (overviewUrl) {\n    try {\n      const r = await s3\n        .getObject({\n          Bucket: getOverviewBucket(overviewUrl),\n          Key: getOverviewKey(overviewUrl, 'summary.json'),\n        })\n        .promise()\n      return FP.function.pipe(\n        JSON.parse(r.Body.toString('utf-8')),\n        R.pathOr([], ['aggregations', 'images', 'keys', 'buckets']),\n        R.map((b) => ({\n          bucket,\n          key: b.key,\n          // eslint-disable-next-line no-underscore-dangle\n          version: b.latestVersion.hits.hits[0]._source.version_id,\n        })),\n      )\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.log(`Unable to fetch images sample from '${overviewUrl}':`)\n      // eslint-disable-next-line no-console\n      console.error(e)\n    }\n  }\n  if (inStack) {\n    try {\n      const qs = mkSearch({ action: 'images', index: bucket })\n      const result = await req(`/search${qs}`)\n      return FP.function.pipe(\n        result,\n        R.pathOr([], ['aggregations', 'objects', 'buckets']),\n        R.map((h) => {\n          // eslint-disable-next-line no-underscore-dangle\n          const s = h.latest.hits.hits[0]._source\n          return { bucket, key: s.key, version: s.version_id }\n        }),\n        R.take(MAX_IMGS),\n      )\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.log('Unable to fetch live images sample:')\n      // eslint-disable-next-line no-console\n      console.error(e)\n    }\n  }\n  try {\n    const result = await s3\n      .listObjectsV2({ Bucket: bucket, EncodingType: 'url' })\n      .promise()\n    return FP.function.pipe(\n      result,\n      R.path(['Contents']),\n      R.map(R.evolve({ Key: decodeS3Key })),\n      R.filter(\n        (i) =>\n          i.StorageClass !== 'GLACIER' &&\n          i.StorageClass !== 'DEEP_ARCHIVE' &&\n          !i.Key.startsWith('/') &&\n          IMG_EXTS.some((e) => i.Key.toLowerCase().endsWith(e)),\n      ),\n      sampleSize(MAX_IMGS),\n      R.map(({ Key: key }) => ({ key, bucket })),\n    )\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log('Unable to fetch images sample from S3 listing:')\n    // eslint-disable-next-line no-console\n    console.error(e)\n  }\n  return []\n}\n\nexport const objectVersions = ({ s3, bucket, path }) =>\n  s3\n    .listObjectVersions({ Bucket: bucket, Prefix: path, EncodingType: 'url' })\n    .promise()\n    .then(\n      R.pipe(\n        ({ Versions, DeleteMarkers }) => Versions.concat(DeleteMarkers),\n        R.map(R.evolve({ Key: decodeS3Key })),\n        R.filter((v) => v.Key === path),\n        R.map((v) => ({\n          isLatest: v.IsLatest || false,\n          lastModified: v.LastModified,\n          size: v.Size,\n          id: v.VersionId,\n          deleteMarker: v.Size == null,\n          archived: v.StorageClass === 'GLACIER' || v.StorageClass === 'DEEP_ARCHIVE',\n        })),\n        R.sort(R.descend(R.prop('lastModified'))),\n      ),\n    )\n\nexport const objectMeta = ({ s3, bucket, path, version }) =>\n  s3\n    .headObject({\n      Bucket: bucket,\n      Key: path,\n      VersionId: version,\n    })\n    .promise()\n    .then(R.pipe(R.path(['Metadata', 'helium']), R.when(Boolean, JSON.parse)))\n\nconst isFile = (fileHandle) => typeof fileHandle === 'string' || fileHandle.path\n\nconst isValidManifest = makeSchemaValidator(quiltSummarizeSchema)\n\nasync function parseFile(resolvePath, fileHandle) {\n  const handle = await new Promise((resolve, reject) =>\n    R.pipe(\n      Resource.parse,\n      Resource.Pointer.case({\n        Web: () => null,\n        S3: resolve,\n        S3Rel: (path) => resolvePath(path).then(resolve).catch(reject),\n        Path: (path) => resolvePath(path).then(resolve).catch(reject),\n      }),\n    )(fileHandle.path || fileHandle),\n  )\n  return {\n    ...(typeof fileHandle === 'string' ? null : fileHandle),\n    handle,\n  }\n}\n\nexport const summarize = async ({ s3, handle: inputHandle, resolveLogicalKey }) => {\n  if (!inputHandle) return null\n  const handle =\n    resolveLogicalKey && inputHandle.logicalKey && !inputHandle.key\n      ? await resolveLogicalKey(inputHandle.logicalKey)\n      : inputHandle\n\n  try {\n    const file = await s3\n      .getObject({\n        Bucket: handle.bucket,\n        Key: handle.key,\n        VersionId: handle.version,\n        // TODO: figure out caching issues\n        IfMatch: handle.etag,\n      })\n      .promise()\n    const json = file.Body.toString('utf-8')\n    const manifest = JSON.parse(json)\n    const configErrors = isValidManifest(manifest)\n    if (configErrors.length) {\n      // eslint-disable-next-line no-console\n      console.error(configErrors[0])\n      throw new Error(\n        'Invalid manifest: must be a JSON array of files or arrays of files',\n      )\n    }\n\n    const resolvePath = async (path) => {\n      const resolvedHandle = {\n        bucket: handle.bucket,\n        key: s3paths.resolveKey(handle.key, path),\n      }\n\n      if (resolveLogicalKey && handle.logicalKey) {\n        try {\n          const resolvedLogicalHandle = await resolveLogicalKey(\n            s3paths.resolveKey(handle.logicalKey, path),\n          )\n          return resolvedLogicalHandle\n        } catch (error) {\n          // eslint-disable-next-line no-console\n          console.warn('Error resolving logical key for summary', { handle, path })\n          // eslint-disable-next-line no-console\n          console.error(error)\n          return {\n            ...resolvedHandle,\n            error,\n          }\n        }\n      }\n\n      return resolvedHandle\n    }\n\n    return await Promise.all(\n      manifest.map((fileHandle) =>\n        isFile(fileHandle)\n          ? parseFile(resolvePath, fileHandle)\n          : Promise.all(fileHandle.map(parseFile.bind(null, resolvePath))),\n      ),\n    )\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log('Error loading summary:')\n    // eslint-disable-next-line no-console\n    console.error(e)\n    throw e\n  }\n}\n\nconst MANIFESTS_PREFIX = '.quilt/packages/'\n\nconst withCalculatedRevisions = (s) => ({\n  scripted_metric: {\n    init_script: `\n      state.map = new HashMap();\n    `,\n    map_script: `\n      def k = doc.key.getValue();\n      def mtime = doc.last_modified.getValue().toInstant().toEpochMilli();\n      def del = doc.delete_marker.getValue();\n      def v = [\"mtime\": mtime, \"del\": del];\n      state.map.merge(k, v, (old, val) -> val.mtime > old.mtime ? val : old);\n    `,\n    reduce_script: `\n      def merged = new HashMap();\n      for (s in states) {\n        s.map.each((k, v) -> merged.merge(k, v, (old, val) -> val.mtime > old.mtime ? val : old));\n      }\n      ${s}\n    `,\n  },\n})\n\nconst TIMESTAMP_RE_SRC = '[0-9]{10}'\n\n// TODO: remove this, only used by Overview ATM\nexport const countPackageRevisions = ({ req, bucket, name }) =>\n  req(\n    `/search${mkSearch({\n      index: `${bucket}_packages`,\n      action: 'packages',\n      body: JSON.stringify({\n        query: {\n          bool: {\n            must: [\n              name ? { term: { handle: name } } : { match_all: {} },\n              { regexp: { pointer_file: TIMESTAMP_RE_SRC } },\n            ],\n          },\n        },\n        aggs: {\n          revisions: withCalculatedRevisions(`\n          return merged.count((k, v) -> !v.del);\n        `),\n        },\n      }),\n      size: 0,\n      filter_path: ['took', 'timed_out', 'hits.total', 'aggregations.revisions'].join(\n        ',',\n      ),\n    })}`,\n  )\n    .then(R.path(['aggregations', 'revisions', 'value']))\n    .catch(errors.catchErrors())\n\n// TODO: Preview endpoint only allows up to 512 lines right now. Increase it to 1000.\nconst MAX_PACKAGE_ENTRIES = 500\n\n// TODO: remove\nexport const getRevisionData = async ({\n  endpoint,\n  sign,\n  bucket,\n  hash,\n  maxKeys = MAX_PACKAGE_ENTRIES,\n}) => {\n  const url = sign({ bucket, key: `${MANIFESTS_PREFIX}${hash}` })\n  const maxLines = maxKeys + 2 // 1 for the meta and 1 for checking overflow\n  const r = await fetch(\n    `${endpoint}/preview?url=${encodeURIComponent(url)}&input=txt&line_count=${maxLines}`,\n  )\n  const [header, ...entries] = await r\n    .json()\n    .then((json) => json.info.data.head.map((l) => JSON.parse(l)))\n  const files = Math.min(maxKeys, entries.length)\n  const bytes = entries.slice(0, maxKeys).reduce((sum, i) => sum + i.size, 0)\n  const truncated = entries.length > maxKeys\n  return {\n    stats: { files, bytes, truncated },\n    message: header.message,\n    header,\n  }\n}\n\nconst s3Select = ({\n  s3,\n  ExpressionType = 'SQL',\n  InputSerialization = { JSON: { Type: 'LINES' } },\n  ...rest\n}) =>\n  s3\n    .selectObjectContent({\n      ExpressionType,\n      InputSerialization,\n      OutputSerialization: { JSON: {} },\n      ...rest,\n    })\n    .promise()\n    .then(\n      R.pipe(\n        R.prop('Payload'),\n        R.reduce((acc, evt) => {\n          if (!evt.Records) return acc\n          const s = evt.Records.Payload.toString()\n          return acc + s\n        }, ''),\n        R.trim,\n        R.ifElse(R.isEmpty, R.always([]), R.pipe(R.split('\\n'), R.map(JSON.parse))),\n      ),\n    )\n\nconst sqlEscape = (arg) => arg.replace(/'/g, \"''\")\n\nconst ACCESS_COUNTS_PREFIX = 'AccessCounts'\n\nconst queryAccessCounts = async ({\n  s3,\n  analyticsBucket,\n  type,\n  query,\n  today,\n  window = 365,\n}) => {\n  try {\n    const records = await s3Select({\n      s3,\n      Bucket: analyticsBucket,\n      Key: `${ACCESS_COUNTS_PREFIX}/${type}.csv`,\n      Expression: query,\n      InputSerialization: {\n        CSV: {\n          FileHeaderInfo: 'Use',\n          AllowQuotedRecordDelimiter: true,\n        },\n      },\n    })\n\n    const recordedCounts = records.length ? JSON.parse(records[0].counts) : {}\n\n    const counts = R.times((i) => {\n      const date = dateFns.subDays(today, window - i - 1)\n      return {\n        date,\n        value: recordedCounts[dateFns.format(date, 'yyyy-MM-dd')] || 0,\n      }\n    }, window)\n\n    const total = Object.values(recordedCounts).reduce(R.add, 0)\n\n    return { counts, total }\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log('queryAccessCounts: error caught')\n    // eslint-disable-next-line no-console\n    console.error(e)\n    throw e\n  }\n}\n\nexport const objectAccessCounts = ({ s3, analyticsBucket, bucket, path, today }) =>\n  queryAccessCounts({\n    s3,\n    analyticsBucket,\n    type: 'Objects',\n    query: `\n      SELECT counts FROM s3object\n      WHERE eventname = 'GetObject'\n      AND bucket = '${sqlEscape(bucket)}'\n      AND \"key\" = '${sqlEscape(path)}'\n    `,\n    today,\n    window: 365,\n  })\n","import * as uuid from 'uuid'\n\nimport { PUSH, DISMISS } from './constants'\n\nconst DEFAULT_TTL = 4000\n\nexport const push = (message, { action, ttl = DEFAULT_TTL } = {}) => ({\n  type: PUSH,\n  notification: {\n    id: uuid.v1(),\n    message,\n    action,\n    ttl,\n  },\n})\n\nexport const dismiss = (id) => ({\n  type: DISMISS,\n  id,\n})\n","export const REDUX_KEY = 'app/Notifications'\n\nexport const PUSH = 'app/Notifications/PUSH'\nexport const DISMISS = 'app/Notifications/DISMISS'\n","import { fromJS } from 'immutable'\n\nimport { PUSH, DISMISS } from './constants'\n\nconst initialState = fromJS([])\n\n// eslint-disable-next-line @typescript-eslint/default-param-last\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case PUSH:\n      return state.push(fromJS(action.notification))\n    case DISMISS:\n      return state.filter((n) => n.get('id') !== action.id)\n    default:\n      return state\n  }\n}\n","import { fromJS } from 'immutable'\nimport { createSelector } from 'reselect'\n\nimport { REDUX_KEY } from './constants'\n\nexport default createSelector(\n  (state) => state.get(REDUX_KEY, fromJS([])),\n  (ns) => ({ notifications: ns.toJS() }),\n)\n","import PT from 'prop-types'\nimport React from 'react'\nimport * as M from '@material-ui/core'\n\nconst useStyles = M.makeStyles((t) => ({\n  close: {\n    padding: t.spacing(0.5),\n  },\n}))\n\nexport default function Notification({ id, ttl, message, action, dismiss }) {\n  const classes = useStyles()\n\n  const handleClose = React.useCallback(() => dismiss(id), [dismiss, id])\n\n  return (\n    <M.Snackbar\n      open\n      message={message}\n      autoHideDuration={ttl}\n      onClose={handleClose}\n      data-testid=\"notification\"\n      action={\n        <>\n          {!!action && (\n            <M.Button color=\"secondary\" size=\"small\" onClick={action.onClick}>\n              {action.label}\n            </M.Button>\n          )}\n          <M.IconButton\n            aria-label=\"Close\"\n            color=\"inherit\"\n            className={classes.close}\n            onClick={handleClose}\n          >\n            <M.Icon>close</M.Icon>\n          </M.IconButton>\n        </>\n      }\n    />\n  )\n}\n\nNotification.propTypes = {\n  id: PT.string.isRequired,\n  ttl: PT.number.isRequired,\n  message: PT.node.isRequired,\n  action: PT.shape({\n    label: PT.string.isRequired,\n    onClick: PT.func.isRequired,\n  }),\n  dismiss: PT.func.isRequired,\n}\n","import * as React from 'react'\nimport * as redux from 'react-redux'\nimport { bindActionCreators } from 'redux'\n\nimport * as ReducerInjector from 'utils/ReducerInjector'\n\nimport * as actions from './actions'\nimport { REDUX_KEY } from './constants'\nimport reducer from './reducer'\nimport selector from './selectors'\nimport Notification from './Notification'\n\nexport const Provider = function NotificationsProvider({ children }) {\n  ReducerInjector.useReducer(REDUX_KEY, reducer)\n  return children\n}\n\n// notifications: PT.arrayOf(\n//   PT.shape({\n//     id: PT.string.isRequired,\n//     ttl: PT.number.isRequired,\n//     message: PT.node.isRequired,\n//     action: PT.shape({\n//       label: PT.string.isRequired,\n//       onClick: PT.func.isRequired,\n//     }),\n//   }).isRequired,\n// ).isRequired,\nexport function Display() {\n  const { notifications } = redux.useSelector(selector)\n  const dispatch = redux.useDispatch()\n  const handleDismiss = React.useCallback(\n    (id) => dispatch(actions.dismiss(id)),\n    [dispatch],\n  )\n  return notifications.map((n) => (\n    <Notification key={n.id} {...n} dismiss={handleDismiss} />\n  ))\n}\n\nexport function WithNotifications({ children }) {\n  return (\n    <>\n      {children}\n      <Display />\n    </>\n  )\n}\n\nexport const useNotifications = () => {\n  const dispatch = redux.useDispatch()\n  return React.useMemo(() => bindActionCreators(actions, dispatch), [dispatch])\n}\n\nexport { useNotifications as use }\n","import isArrayBuffer from 'lodash/isArrayBuffer'\nimport isBuffer from 'lodash/isBuffer'\nimport isNil from 'lodash/isNil'\nimport isString from 'lodash/isString'\nimport isTypedArray from 'lodash/isTypedArray'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport * as redux from 'react-redux'\nimport { takeEvery, call, put } from 'redux-saga/effects'\n\nimport * as Config from 'utils/Config'\nimport * as SagaInjector from 'utils/SagaInjector'\nimport defer from 'utils/defer'\nimport { BaseError } from 'utils/error'\nimport { actionCreator, createActions } from 'utils/reduxTools'\n\nconst REDUX_KEY = 'app/utils/APIConnector'\n\nconst actions = createActions(REDUX_KEY, 'API_REQUEST', 'API_RESPONSE')\n\n/**\n * Options object for creating Requests, with some minor additions:\n *   - accepts either `endpoint` or `url` property (to keep all the required\n *     options in one object).\n *\n *   - accepts `json` property (to add appropriate Content-Type header and\n *     parse the response body).\n *\n *   - may accept arbitrary properties which can be accessed inside a\n *     middleware.\n *\n * The rest of the props are passed to the `fetch` call (identical to the\n * `Request` constructor) as they are. See for details:\n * https://developer.mozilla.org/en-US/docs/Web/API/Request/Request\n *\n * @typedef {Object} RequestOptions\n *\n * @property {string} endpoint\n *   An endpoint for request (appended to configured base URL).\n *\n * @property {string} url\n *   An absolute URL for the request.\n *\n * @property {boolean} json\n *   Whether to add JSON-related headers and parse the response body.\n *   Defaults to true.\n */\n\n/**\n * Action creator for API_REQUEST action.\n *\n * @param {RequestOptions|string} options\n *   When string, it is considered an endpoint.\n *\n * @param {utils/defer.Resolver} resolver\n *\n * @returns {redux.Action}\n */\nconst request = actionCreator(actions.API_REQUEST, (payload, resolver) => ({\n  payload: typeof payload === 'string' ? { endpoint: payload } : payload,\n  meta: { ...resolver },\n}))\n\n/**\n * Action creator for API_RESPONSE action.\n *\n * @param {any} response\n *\n * @params {RequestOptions} requestOpts\n *\n * @returns {redux.Action}\n */\nconst response = actionCreator(actions.API_RESPONSE, (payload, requestOpts) => ({\n  payload,\n  meta: { ...requestOpts },\n}))\n\nconst test = R.ifElse(R.is(RegExp), R.test, R.equals)\n\nexport class HTTPError extends BaseError {\n  static displayName = 'HTTPError'\n\n  static is = (e, status, msg) => {\n    if (!(e instanceof HTTPError)) return false\n    if (status && e.status !== status) return false\n    if (msg && !(e.json && test(msg)(e.json.message))) return false\n    return true\n  }\n\n  constructor(resp, text, { message, status } = {}) {\n    let json\n    try {\n      json = JSON.parse(text)\n    } catch (e) {\n      json = { message: message || text }\n    }\n\n    super(message || (json && (json.message || json.error)) || resp.statusText, {\n      response: resp,\n      status: status || resp.status,\n      text,\n      json,\n    })\n  }\n}\n\n/**\n * Request middleware saga.\n *\n * @typedef {function} Middleware\n *\n * @param {any} input\n *\n * @param {function} next\n *   Next middleware in chain (should be invoked with `yield call()`).\n *\n * @returns {any}\n *\n * @example\n * function* exampleMiddleware(opts, next) {\n *   // pre-processing: for example, we can intercept and adjust request options\n *   const newOpts = { ...opts, headers: { 'Content-Type': 'application/json' } };\n *   const resp = yield call(next, newOpts);\n *   // post-processing\n *   if (!resp.ok) throw new Error(resp.status);\n *   return yield resp.json();\n * }\n */\n\n/**\n * Compose middleware sagas.\n *\n * @param {...Middleware} middleware\n *\n * @returns {function} Result of middleware composition.\n */\nconst composeMiddleware = (handler, ...rest) =>\n  // TODO: optimize\n  function* composed(arg) {\n    return yield call(handler, arg, composeMiddleware(...rest))\n  }\n\n/**\n * Middleware for handling HTTP errors.\n *\n * @type {Middleware}\n *\n * @throws {HTTPError}\n */\nfunction* errorMiddleware(opts, next) {\n  const resp = yield call(next, opts)\n  if (!resp.ok) {\n    const text = yield resp.text()\n    throw new HTTPError(resp, text)\n  }\n  return resp\n}\n\nconst isInstance = (cls) => (b) => cls ? b instanceof cls : false\n\nconst validBodyTests = [\n  isNil,\n  isArrayBuffer,\n  isBuffer,\n  isTypedArray,\n  isString,\n  isInstance(global.Blob),\n  isInstance(global.FormData),\n  isInstance(global.URLSearchParams),\n  isInstance(global.ReadableStream),\n]\n\nconst isValidBody = (b) => validBodyTests.some((t) => t && t(b))\n\n/**\n * Valid body type for fetch / Request. One of:\n *\n *   - ArrayBuffer\n *   - Buffer\n *   - TypedArray\n *   - String\n *   - Blob\n *   - FormData\n *   - URLSearchParams\n *   - ReadableStream\n *\n * Details: https://developer.mozilla.org/en-US/docs/Web/API/Request/Request\n *\n * @typedef {ArrayBuffer|Buffer|TypedArray|String|Blob|FormData|URLSearchParams|ReadableStream} Body\n */\n\n/**\n * Stringify body if it's not of a type accepted by fetch / Request.\n *\n * @param {any} body\n *\n * @returns {Body}\n */\nconst stringifyBody = (body) => (isValidBody(body) ? body : JSON.stringify(body))\n\nconst jsonContentType = {\n  'Content-Type': 'application/json',\n}\n\nconst jsonAccepts = {\n  Accepts: 'application/json',\n}\n\n/**\n * Middleware for working with JSON endpoints:\n *   - adds JSON-related headers\n *   - parses the response body\n *\n * @type {Middleware}\n *\n * @param {boolean} options.json Use JSON handling.\n */\nfunction* jsonMiddleware({ json = true, ...opts }, next) {\n  if (!json) return yield call(next, opts)\n\n  const {\n    stringify = true,\n    parse = true,\n    contentType = true,\n    accepts = true,\n  } = json === true ? {} : json\n\n  if (!stringify && !parse && !contentType && !accepts) {\n    return yield call(next, opts)\n  }\n\n  const nextOpts = {\n    ...opts,\n    headers: {\n      ...(contentType ? jsonContentType : {}),\n      ...(accepts ? jsonAccepts : {}),\n      ...opts.headers,\n    },\n    body: stringify ? stringifyBody(opts.body) : opts.body,\n  }\n  const resp = yield call(next, nextOpts)\n  return parse ? yield resp.json() : resp\n}\n\n/**\n * Create fetch middleware.\n *\n * @param {Object} options\n *\n * @param {function} options.fetch\n *\n * @param {string} options.base\n *\n * @returns {Middleware}\n */\nconst mkFetchMiddleware = ({ fetch, base }) =>\n  function* fetchMiddleware({ url, endpoint, ...init }) {\n    return yield call(fetch, url || base + endpoint, init)\n  }\n\n/**\n * The saga that listens for API_REQUEST actions and executes the requests.\n *\n * @param {Object} options\n *\n * @param {function} options.fetch `fetch` implementation to use.\n *\n * @param {string} options.base\n *   API base URL, prepended to the `endpoint` for every request.\n *\n * @param {[Middleware]} options.middleware Middleware chain.\n */\nfunction* apiSaga({ fetch, base = '', middleware = [] }) {\n  const execRequest = composeMiddleware(\n    ...middleware,\n    jsonMiddleware,\n    errorMiddleware,\n    mkFetchMiddleware({ fetch, base }),\n  )\n\n  yield takeEvery(\n    request.type,\n    function* handleRequest({ payload: opts, meta: { resolve, reject } }) {\n      try {\n        const result = yield call(execRequest, opts)\n        yield put(response(result, opts))\n        yield call(resolve, result)\n      } catch (e) {\n        yield put(response(e, opts))\n        yield call(reject, e)\n      }\n    },\n  )\n}\n\n/**\n * Make an API request.\n *\n * @param {Object} options\n *\n * @returns {any}\n */\nexport function* apiRequest(opts) {\n  const dfd = defer()\n  yield put(request(opts, dfd.resolver))\n  return yield dfd.promise\n}\n\nconst Ctx = React.createContext()\n\nexport const useApi = () => React.useContext(Ctx)\n\nexport const use = useApi\n\n// fetch: window.fetch, middleware: ((any) => any)[]\nexport function Provider({ fetch, middleware, children }) {\n  const base = `${Config.useConfig().registryUrl}/api`\n  SagaInjector.useSaga(apiSaga, { fetch, base, middleware })\n\n  const dispatch = redux.useDispatch()\n  const req = React.useCallback(\n    (opts) => {\n      const dfd = defer()\n      dispatch(request(opts, dfd.resolver))\n      return dfd.promise\n    },\n    [dispatch],\n  )\n\n  return <Ctx.Provider value={req}>{children}</Ctx.Provider>\n}\n","import AWS from 'aws-sdk/lib/core'\nimport 'aws-sdk/lib/credentials'\nimport * as React from 'react'\nimport * as redux from 'react-redux'\n\nimport * as authSelectors from 'containers/Auth/selectors'\nimport * as APIConnector from 'utils/APIConnector'\nimport * as Config from 'utils/Config'\nimport { BaseError } from 'utils/error'\nimport useMemoEq from 'utils/useMemoEq'\n\nclass RegistryCredentials extends AWS.Credentials {\n  constructor({ req, reqOpts }) {\n    super()\n    this.req = req\n    this.reqOpts = reqOpts\n  }\n\n  refresh(callback) {\n    if (!this.refreshing) {\n      this.refreshing = this.req({ endpoint: '/auth/get_credentials', ...this.reqOpts })\n        .then((data) => {\n          this.expireTime = data.Expiration ? new Date(data.Expiration) : null\n          this.accessKeyId = data.AccessKeyId\n          this.secretAccessKey = data.SecretAccessKey\n          this.sessionToken = data.SessionToken\n          delete this.refreshing\n          if (callback) callback()\n        })\n        .catch((e) => {\n          delete this.refreshing\n          this.error = new Error(`Unable to fetch AWS credentials: ${e}`)\n          if (callback) callback(this.error)\n          throw this.error\n        })\n    }\n    return this.refreshing\n  }\n\n  suspend() {\n    if (this.error) throw this.error\n    if (this.needsRefresh()) throw this.refresh()\n    return this\n  }\n}\n\nclass EmptyCredentials extends AWS.Credentials {\n  suspend() {\n    return this\n  }\n}\n\nfunction useCredentialsMemo({ local }) {\n  const empty = React.useMemo(() => new EmptyCredentials(), [])\n  const reg = useMemoEq(APIConnector.use(), (req) => new RegistryCredentials({ req }))\n  const anon = useMemoEq(\n    APIConnector.use(),\n    (req) => new RegistryCredentials({ req, reqOpts: { auth: false } }),\n  )\n\n  return useMemoEq(\n    {\n      local,\n      auth: redux.useSelector(authSelectors.authenticated),\n      reg,\n      anon,\n      empty,\n    },\n    // eslint-disable-next-line no-nested-ternary\n    (i) => (i.auth ? i.reg : i.local ? i.anon : i.empty),\n  )\n}\n\nconst Ctx = React.createContext()\n\nexport function AWSCredentialsProvider({ children }) {\n  const cfg = Config.use()\n  const local = cfg.mode === 'LOCAL'\n  return <Ctx.Provider value={useCredentialsMemo({ local })}>{children}</Ctx.Provider>\n}\n\nexport class CredentialsError extends BaseError {\n  constructor(headline, detail, object) {\n    super(headline, { headline, detail, object })\n  }\n}\n\nexport function useCredentials() {\n  const credentials = React.useContext(Ctx)\n  // TODO: find out real reason\n  if (!credentials) throw new CredentialsError('Session expired')\n  return React.useContext(Ctx)\n}\n\nexport { AWSCredentialsProvider as Provider, useCredentials as use }\n","import isEqual from 'lodash/isEqual'\nimport * as React from 'react'\n\nexport default (input, cons, eq = isEqual) => {\n  const ref = React.useRef({})\n  if (!eq(ref.current && ref.current.input, input)) {\n    delete ref.current.value\n    delete ref.current.get\n  }\n  if (!ref.current.get) {\n    ref.current.get = function get() {\n      if (!('value' in ref.current)) {\n        ref.current.value = cons(input)\n      }\n      return ref.current.value\n    }\n  }\n  ref.current = { ...ref.current, input }\n  return ref.current.get\n}\n","import AWS from 'aws-sdk/lib/core'\nimport 'aws-sdk/lib/config'\nimport * as React from 'react'\n\nimport useMemoEq from 'utils/useMemoEq'\n\nimport * as Credentials from './Credentials'\n\nconst Ctx = React.createContext()\n\nconst useConfig = (props) => {\n  const credentials = Credentials.use()\n  // TODO: use cache?\n  return useMemoEq({ credentials, ...props }, (input) => new AWS.Config(input))\n}\n\nexport function Provider({ children, ...props }) {\n  return <Ctx.Provider value={props}>{children}</Ctx.Provider>\n}\n\nconst useAll = () => useConfig(React.useContext(Ctx))\n\nexport const use = useAll\n","import Athena from 'aws-sdk/clients/athena'\nimport * as R from 'ramda'\nimport * as React from 'react'\n\nimport * as CatalogConfig from 'utils/Config'\nimport useMemoEqLazy from 'utils/useMemoEqLazy'\n\nimport * as Config from './Config'\nimport * as Credentials from './Credentials'\n\nconst getRegion: (input: string) => string = R.pipe(\n  R.match(/\\.([a-z]{2}-[a-z]+-\\d)\\.amazonaws\\.com/),\n  R.nth(1),\n  R.defaultTo('us-east-1'),\n)\n\nconst AthenaContext = React.createContext<() => Athena | null>(() => null)\n\ntype AthenaProviderProps = React.PropsWithChildren<Partial<Athena.ClientConfiguration>>\n\nexport const Provider = function AthenaProvider({\n  children,\n  ...overrides\n}: AthenaProviderProps) {\n  const awsConfig = Config.use()\n  const catalogConfig = CatalogConfig.use()\n\n  const region = React.useMemo(\n    () => getRegion(catalogConfig.apiGatewayEndpoint),\n    [catalogConfig],\n  )\n\n  const client: () => Athena = useMemoEqLazy(\n    {\n      ...awsConfig,\n      region,\n      ...overrides,\n    },\n    (opts: Athena.ClientConfiguration) => new Athena(opts),\n  )\n\n  return <AthenaContext.Provider value={client}>{children}</AthenaContext.Provider>\n}\n\nexport const useAthena = () => {\n  Credentials.use().suspend()\n  return React.useContext(AthenaContext)()\n}\n\nexport const use = useAthena\n","import S3 from 'aws-sdk/clients/s3'\nimport AWS from 'aws-sdk/lib/core'\nimport * as React from 'react'\nimport * as redux from 'react-redux'\n\nimport * as authSelectors from 'containers/Auth/selectors'\nimport * as BucketConfig from 'utils/BucketConfig'\nimport { useConfig } from 'utils/Config'\nimport { useStatusReportsBucket } from 'utils/StatusReportsBucket'\nimport useConstant from 'utils/useConstant'\nimport useMemoEqLazy from 'utils/useMemoEqLazy'\n\nimport * as Config from './Config'\nimport * as Credentials from './Credentials'\n\nconst DEFAULT_OPTS = {\n  signatureVersion: 'v4',\n  s3UsEast1RegionalEndpoint: 'regional',\n}\n\nconst PROXIED = Symbol('proxied')\nconst PRESIGN = Symbol('presign')\nconst FORCE_PROXY = Symbol('forceProxy')\n\nconst Ctx = React.createContext()\n\nfunction useTracking(val) {\n  const ref = React.useRef()\n  ref.current = val\n  return () => ref.current\n}\n\nfunction useTrackingFn(fn) {\n  const get = useTracking(fn)\n  return (...args) => get()(...args)\n}\n\nfunction useSmartS3() {\n  const cfg = useConfig()\n  const selectEndpoint = `${cfg.binaryApiGatewayEndpoint}/s3select/`\n  const isAuthenticated = useTracking(redux.useSelector(authSelectors.authenticated))\n  const isInStack = useTrackingFn(BucketConfig.useIsInStack())\n  const statusReportsBucket = useStatusReportsBucket()\n\n  return useConstant(() => {\n    class SmartS3 extends S3 {\n      getReqType(req) {\n        const bucket = req.params.Bucket\n        if (cfg.mode === 'LOCAL') {\n          return 'signed'\n        }\n        if (isAuthenticated()) {\n          if (\n            // sign if operation is not bucket-specific\n            // (not sure if there are any such operations that can be used from the browser)\n            !bucket ||\n            cfg.analyticsBucket === bucket ||\n            statusReportsBucket === bucket ||\n            (cfg.mode !== 'OPEN' && isInStack(bucket))\n          ) {\n            return 'signed'\n          }\n        } else if (req.operation === 'selectObjectContent') {\n          return 'select'\n        }\n        return 'unsigned'\n      }\n\n      populateURI(req) {\n        if (req.service.getReqType(req) === 'select') {\n          return\n        }\n        super.populateURI(req)\n      }\n\n      customRequestHandler(req) {\n        const b = req.params.Bucket\n        const type = this.getReqType(req)\n\n        if (b) {\n          const endpoint = new AWS.Endpoint(\n            type === 'select' ? selectEndpoint : cfg.s3Proxy,\n          )\n          req.on('sign', () => {\n            if (req.httpRequest[PRESIGN]) return\n            // Monkey-patch the request object after it has been signed and save the original\n            // values in case of retry.\n            req.httpRequest[PROXIED] = {\n              endpoint: req.httpRequest.endpoint,\n              path: req.httpRequest.path,\n            }\n            const basePath = endpoint.path.replace(/\\/$/, '')\n            // handle buckets with dots in their names\n            if (\n              req.httpRequest.path.startsWith(`/${b}`) &&\n              !req.httpRequest.endpoint.host.startsWith(`${b}.`)\n            ) {\n              req.httpRequest.path = req.httpRequest.path.replace(`/${b}`, '')\n            }\n\n            req.httpRequest.endpoint = endpoint\n            req.httpRequest.path =\n              type === 'select'\n                ? `${basePath}${req.httpRequest.path}`\n                : `${basePath}/${req.httpRequest.region}/${b}${req.httpRequest.path}`\n          })\n          req.on(\n            'retry',\n            () => {\n              if (req.httpRequest[PRESIGN]) return\n              // Revert our patch so that the request can be re-signed in case of retry.\n              // AWS SDK reuses and mutates the httpRequest object, so we have to track our\n              // monkey-patching to avoid applying it repeatedly.\n              if (req.httpRequest[PROXIED]) {\n                req.httpRequest.endpoint = req.httpRequest[PROXIED].endpoint\n                req.httpRequest.path = req.httpRequest[PROXIED].path\n                delete req.httpRequest[PROXIED]\n              }\n            },\n            true,\n          )\n        }\n      }\n\n      prepareSignedUrl(req) {\n        super.prepareSignedUrl(req)\n        if (!req.httpRequest[FORCE_PROXY]) req.httpRequest[PRESIGN] = true\n      }\n\n      makeRequest(operation, params, callback) {\n        if (typeof params === 'function') {\n          // eslint-disable-next-line no-param-reassign\n          callback = params\n          // eslint-disable-next-line no-param-reassign\n          params = null\n        }\n\n        const forceProxy = params?.forceProxy ?? false\n        delete params?.forceProxy\n        const req = super.makeRequest(operation, params)\n        if (forceProxy) {\n          req.httpRequest[FORCE_PROXY] = true\n        }\n        const type = this.getReqType(req)\n\n        if (type !== 'signed') {\n          req.toUnauthenticated()\n        }\n\n        if (callback) req.send(callback)\n        return req\n      }\n    }\n\n    return SmartS3\n  })\n}\n\nexport const Provider = function S3Provider({ children, ...overrides }) {\n  const awsCfg = Config.use()\n\n  const SmartS3 = useSmartS3()\n\n  const client = useMemoEqLazy(\n    { ...awsCfg, ...DEFAULT_OPTS, ...overrides },\n    (opts) => new SmartS3(opts),\n  )\n\n  return <Ctx.Provider value={client}>{children}</Ctx.Provider>\n}\n\nexport function useS3() {\n  Credentials.use().suspend()\n  return React.useContext(Ctx)()\n}\n\nexport const use = useS3\n","import * as React from 'react'\nimport * as redux from 'react-redux'\n\nimport * as authSelectors from 'containers/Auth/selectors'\nimport * as BucketConfig from 'utils/BucketConfig'\nimport * as Config from 'utils/Config'\nimport { useStatusReportsBucket } from 'utils/StatusReportsBucket'\nimport { handleToHttpsUri } from 'utils/s3paths'\n\nimport * as Credentials from './Credentials'\nimport * as S3 from './S3'\n\nconst DEFAULT_URL_EXPIRATION = 5 * 60 // in seconds\nconst POLL_INTERVAL = 10 // in seconds\nconst LAG = POLL_INTERVAL * 3\n\nconst Ctx = React.createContext({ urlExpiration: DEFAULT_URL_EXPIRATION })\n\nexport function useS3Signer({ urlExpiration: exp, forceProxy = false } = {}) {\n  const ctx = React.useContext(Ctx)\n  const urlExpiration = exp || ctx.urlExpiration\n  Credentials.use().suspend()\n  const authenticated = redux.useSelector(authSelectors.authenticated)\n  const cfg = Config.useConfig()\n  const isInStack = BucketConfig.useIsInStack()\n  const statusReportsBucket = useStatusReportsBucket()\n  const s3 = S3.use()\n  const inStackOrSpecial = React.useCallback(\n    (b) => isInStack(b) || cfg.analyticsBucket === b || statusReportsBucket === b,\n    [isInStack, cfg.analyticsBucket, statusReportsBucket],\n  )\n  return React.useCallback(\n    ({ bucket, key, version }, opts) =>\n      cfg.mode !== 'OPEN' &&\n      (cfg.mode === 'LOCAL' || (inStackOrSpecial(bucket) && authenticated))\n        ? s3.getSignedUrl('getObject', {\n            Bucket: bucket,\n            Key: key,\n            VersionId: version,\n            Expires: urlExpiration,\n            forceProxy,\n            ...opts,\n          })\n        : handleToHttpsUri({ bucket, key, version }), // TODO: handle ResponseContentDisposition for unsigned case\n    [cfg.mode, inStackOrSpecial, authenticated, s3, urlExpiration, forceProxy],\n  )\n}\n\nfunction usePolling(callback, { interval = POLL_INTERVAL } = {}) {\n  const callbackRef = React.useRef()\n  callbackRef.current = callback\n  React.useEffect(() => {\n    const int = setInterval(() => {\n      if (callbackRef.current) callbackRef.current(Date.now())\n    }, interval * 1000)\n    return () => {\n      clearInterval(int)\n    }\n  }, [interval])\n}\n\nexport function useDownloadUrl(handle, { filename = '', contentType = '' } = {}) {\n  const { urlExpiration } = React.useContext(Ctx)\n  const sign = useS3Signer()\n  const filenameSuffix = filename ? `; filename=\"${filename}\"` : ''\n  const doSign = () => ({\n    url: sign(handle, {\n      ResponseContentDisposition: `attachment${filenameSuffix}`,\n      ResponseContentType: contentType || 'binary/octet-stream',\n    }),\n    ts: Date.now(),\n  })\n  const [state, setState] = React.useState(doSign)\n  usePolling((now) => {\n    if ((now - state.ts) / 1000 > urlExpiration - LAG) {\n      setState(doSign())\n    }\n  })\n  return state.url\n}\n\nexport function WithDownloadUrl({ handle, children }) {\n  return children(useDownloadUrl(handle))\n}\n\nexport const withDownloadUrl = (handle, callback) => (\n  <WithDownloadUrl handle={handle}>{callback}</WithDownloadUrl>\n)\n\nexport function AWSSignerProvider({ children, urlExpiration = DEFAULT_URL_EXPIRATION }) {\n  return <Ctx.Provider value={{ urlExpiration }}>{children}</Ctx.Provider>\n}\n\nexport const Provider = AWSSignerProvider\n","import * as R from 'ramda'\n\nimport tagged from 'utils/tagged'\n\nconst AsyncResult = tagged(['Init', 'Pending', 'Ok', 'Err'])\n\nAsyncResult.prop = (name, ...args) => AsyncResult.mapCase({ Ok: R.prop(name) }, ...args)\n\nAsyncResult.props = R.curryN(2, (names, ...args) =>\n  names.reduce(\n    (acc, name) => ({\n      ...acc,\n      [name]: AsyncResult.prop(name, ...args),\n    }),\n    {},\n  ),\n)\n\nAsyncResult.getPrevResult = AsyncResult.case({\n  Ok: R.identity,\n  Pending: (p) => AsyncResult.getPrevResult(p),\n  _: () => null,\n})\n\nexport default AsyncResult\n","import * as R from 'ramda'\nimport * as React from 'react'\n\nimport AsyncResult from 'utils/AsyncResult'\nimport tagged from 'utils/tagged'\nimport useMemoEq from 'utils/useMemoEq'\nimport usePrevious from 'utils/usePrevious'\n\nconst Action = tagged(['Reset', 'Request', 'Response'])\n\nconst initial = AsyncResult.Init()\n\nconst mapResult = AsyncResult.mapCase({ Pending: R.prop('prev') })\n\nconst reducer = Action.reducer({\n  Reset: () => () => initial,\n  Request:\n    ({ request, params }) =>\n    (prev) =>\n      AsyncResult.Pending({ request, params, prev: mapResult(prev) }),\n  Response: ({ request, params, result }) =>\n    AsyncResult.case({\n      Pending: (p) =>\n        R.equals([p.request, p.params], [request, params])\n          ? result\n          : AsyncResult.Pending(p),\n      _: R.identity,\n    }),\n})\n\n// Use it to test AsyncResult states\n// example: `createResult(AsyncResult.Err(new Error('Expected')))`\nexport function createResult(result) {\n  return {\n    case: (cases, ...args) => AsyncResult.case(cases, result, ...args),\n    result,\n  }\n}\n\nexport function useData(request, params, { noAutoFetch = false } = {}) {\n  // TODO: accept custom key extraction fn (params => key for comparison)\n  const [state, setState] = React.useState(initial)\n  const stateRef = React.useRef()\n  stateRef.current = state\n\n  const dispatch = (action) => {\n    setState((stateRef.current = reducer(stateRef.current, action)))\n  }\n\n  const fetch = useMemoEq([request, params], () => () => {\n    dispatch(Action.Request({ request, params }))\n    return request(params)\n      .then(AsyncResult.Ok)\n      .catch(AsyncResult.Err)\n      .then((result) => {\n        dispatch(Action.Response({ request, params, result }))\n        return result\n      })\n  })\n\n  const prev = usePrevious({ params, noAutoFetch })\n  if (!R.equals({ params, noAutoFetch }, prev)) {\n    if (noAutoFetch) dispatch(Action.Reset())\n    else fetch()\n  }\n\n  const result = useMemoEq(stateRef.current, mapResult)\n\n  const doCase = useMemoEq(\n    [result],\n    () =>\n      (cases, ...args) =>\n        AsyncResult.case(cases, result, ...args),\n  )\n\n  return useMemoEq({ result, fetch, case: doCase }, R.identity)\n}\n\nexport const use = useData\n\nexport function Fetcher({ fetch, params, noAutoFetch, children }) {\n  const { result, ...rest } = useData(fetch, params, { noAutoFetch })\n  return children(result, rest)\n}\n\nexport default Fetcher\n","import * as React from 'react'\nimport Dialog from '@material-ui/core/Dialog'\n\nimport defer from 'utils/defer'\n\nexport const useDialogs = () => {\n  // open | closed | closing\n  const [state, setState] = React.useState('closed')\n  // { render, resolver }\n  const [dialog, setDialog] = React.useState(null)\n\n  const open = React.useCallback(\n    (render, props) => {\n      const { resolver, promise } = defer()\n      setDialog({ render, props, resolver })\n      setState('open')\n      return promise\n    },\n    [setDialog, setState],\n  )\n\n  const close = React.useCallback(\n    (reason) => {\n      if (dialog) dialog.resolver.resolve(reason)\n      setState('closing')\n    },\n    [setState, dialog],\n  )\n\n  const cleanup = React.useCallback(() => {\n    if (state === 'closing') {\n      setState('closed')\n      setDialog(null)\n    }\n  }, [state, setState, setDialog])\n\n  const render = (props) => (\n    <Dialog\n      open={state === 'open'}\n      onClose={close}\n      onExited={cleanup}\n      {...props}\n      {...(dialog && dialog.props)}\n    >\n      {dialog ? dialog.render({ close }) : ''}\n    </Dialog>\n  )\n\n  return { open, render }\n}\n\nexport const use = useDialogs\n","import PT from 'prop-types'\nimport * as React from 'react'\n\n// TODO: TSify or, better yet, use react-error-boundary package\nexport const createBoundary = (handle, name = 'ErrorBoundary') =>\n  class extends React.Component {\n    static displayName = name\n\n    static propTypes = {\n      children: PT.node,\n      id: PT.string,\n    }\n\n    constructor(props) {\n      super(props)\n      this.state = { handled: null }\n      this.boundReset = this.reset.bind(this)\n    }\n\n    componentDidUpdate({ id: oldId }) {\n      if (this.props.id !== oldId) this.reset()\n    }\n\n    componentDidCatch(error, info) {\n      const handled = handle(this.props, { reset: this.boundReset })(error, info)\n      if (handled && handled !== error) {\n        this.setState({ handled })\n      } else {\n        throw error\n      }\n    }\n\n    reset() {\n      this.setState({ handled: null })\n    }\n\n    render() {\n      return this.state.handled || this.props.children\n    }\n  }\n","import * as React from 'react'\n\nimport * as NamedRoutes from 'utils/NamedRoutes'\nimport { BaseError } from 'utils/error'\n\nexport class OktaError extends BaseError {\n  constructor(code, details) {\n    super('Okta login failure', { code, details })\n  }\n}\n\nexport function useOkta({ clientId, baseUrl }) {\n  return React.useCallback(\n    () =>\n      new Promise((resolve, reject) => {\n        const nonce = Math.random().toString(36).substr(2)\n        const state = Math.random().toString(36).substr(2)\n        const query = NamedRoutes.mkSearch({\n          client_id: clientId,\n          redirect_uri: window.location.origin,\n          response_mode: 'okta_post_message',\n          response_type: 'id_token',\n          scope: 'openid email',\n          nonce,\n          state,\n        })\n        const url = `${baseUrl}/v1/authorize${query}`\n        const popup = window.open(url, 'quilt_okta_popup', 'width=300,height=400')\n        const timer = setInterval(() => {\n          if (popup.closed) {\n            window.removeEventListener('message', handleMessage)\n            clearInterval(timer)\n            reject(new OktaError('popup_closed_by_user'))\n          }\n        }, 500)\n        const handleMessage = ({ source, origin, data }) => {\n          if (source !== popup || !url.startsWith(`${origin}/`)) return\n          try {\n            const {\n              id_token: idToken,\n              error,\n              error_description: details,\n              state: respState,\n            } = data\n            if (respState !== state) {\n              throw new OktaError(\n                'state_mismatch',\n                \"Response state doesn't match request state\",\n              )\n            }\n            if (error) {\n              throw new OktaError(error, details)\n            }\n            const { nonce: respNonce } = JSON.parse(atob(idToken.split('.')[1]))\n            if (respNonce !== nonce) {\n              throw new OktaError(\n                'nonce_mismatch',\n                \"Response nonce doesn't match request nonce\",\n              )\n            }\n            resolve(idToken)\n          } catch (e) {\n            reject(e)\n          } finally {\n            window.removeEventListener('message', handleMessage)\n            clearInterval(timer)\n            popup.close()\n          }\n        }\n        window.addEventListener('message', handleMessage)\n        popup.focus()\n      }),\n    [baseUrl, clientId],\n  )\n}\n\nexport { useOkta as use }\n","import invariant from 'invariant'\nimport isEmpty from 'lodash/isEmpty'\nimport isFunction from 'lodash/isFunction'\nimport isString from 'lodash/isString'\nimport * as R from 'ramda'\nimport * as redux from 'react-redux'\n\nconst scope = 'app/utils/ReducerInjector'\n\nconst isValidKey = (key) => isString(key) && !isEmpty(key)\n\n/**\n * Create a reducer injector.\n *\n * @param {function} onSet\n *   Callback that gets called with the injected reducer map when it gets updated\n *   (a new reducer injected).\n *\n * @returns {{ inject: function, eject: function, injected: function }}\n *   An object containing reducer injection and ejection functions, which\n *   take a key (mountpoint) and a reducer (in case of injector).\n */\nconst createReducerInjector = (onSet) => {\n  const innerScope = `${scope}/createReducerInjector`\n  invariant(isFunction(onSet), `${innerScope}: Expected 'onSet' to be a function`)\n\n  let reducers = {}\n\n  const inject = (key, reducer) => {\n    const innerScope2 = `${scope}/injectReducer`\n    invariant(isValidKey(key), `${innerScope2}: Expected 'key' to be a non-empty string`)\n    invariant(isFunction(reducer), `${innerScope2}: Expected 'reducer' to be a function`)\n    // Check `reducers[key] === reducer` for hot reloading\n    // when a key is the same but a reducer is different\n    if (key in reducers && reducers[key] === reducer) return\n\n    reducers = R.assoc(key, reducer, reducers)\n    onSet(reducers)\n  }\n\n  const injected = (key, reducer) => {\n    const current = reducers[key]\n    const check = reducer ? R.equals(reducer) : Boolean\n    return check(current)\n  }\n\n  const eject = (key) => {\n    reducers = R.dissoc(key, reducers)\n    onSet(reducers)\n  }\n\n  return { inject, eject, injected }\n}\n\n/**\n * React hook for reducer injection.\n *\n * @param {string} mountpoint\n *\n * @param {function} reducer\n *\n * @param {object} options\n *\n * @param {bool} options.remount\n *   Whether to remount reducer when a new one given.\n *   This option exists for compatibility with HoCs to opt-out from remounting\n *   and should be removed once the migration to hooks is complete.\n */\nexport const useReducer = (mountpoint, reducer, { remount = true } = {}) => {\n  const { injector } = redux.useStore()\n  const shouldInject = remount\n    ? !injector.injected(mountpoint, reducer)\n    : !injector.injected(mountpoint)\n\n  if (shouldInject) injector.inject(mountpoint, reducer)\n\n  // keep reducers injected to avoid redux warnings\n}\n/**\n * Component that injects a given reducer into the store on mount.\n */\nexport const Inject = function ReducerInjector({\n  children,\n  /**\n   * A key under which the reducer gets injected.\n   */\n  mount, // string.isRequired\n  /**\n   * A reducer that gets injected.\n   */\n  reducer, // func.isRequired\n  /**\n   * Whether to remount reducer when given a new one.\n   */\n  remount, // bool\n}) {\n  useReducer(mount, reducer, { remount })\n  return children\n}\n\n/**\n * Create a store enhancer that attaches `injectReducer` method to the store.\n *\n * @param {function} createReducer\n *   A function that creates a reducer from the given reducer map.\n *\n * @returns {reduxTools.StoreEnhancer}\n */\nexport const withInjectableReducers =\n  (createReducer) =>\n  (createStore) =>\n  (...args) => {\n    const store = createStore(...args)\n    const injector = createReducerInjector((injected) => {\n      store.replaceReducer(createReducer(injected))\n    })\n    return { ...store, injector }\n  }\n","import * as I from 'immutable'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport * as redux from 'react-redux'\nimport * as effects from 'redux-saga/effects'\nimport * as uuid from 'uuid'\n\nimport AsyncResult from 'utils/AsyncResult'\nimport { useReducer } from 'utils/ReducerInjector'\nimport { useSaga } from 'utils/SagaInjector'\nimport defer from 'utils/defer'\nimport * as reduxTools from 'utils/reduxTools'\nimport * as sagaTools from 'utils/sagaTools'\nimport tagged from 'utils/tagged'\nimport useMemoEq from 'utils/useMemoEq'\n\nconst REDUX_KEY = 'app/ResourceCache'\n\nconst Ctx = React.createContext()\n\nconst RELEASE_TIME = 5000\n\n// Resource<I, O> = {\n//   name: string,\n//   id: string,\n//   fetch<I, O>: I -> Promise<O>,\n// }\n//\n// Entry<O> = {\n//   promise: Promise<O>,\n//   result: AsyncResult<{\n//     Init: void\n//     Pending: void\n//     Err: any\n//     Ok: O\n//   }),\n//   claimed: number,\n//   releasedAt: Date?\n// }\n// State = Map<string, Map<I, Entry<O>>>\n\nexport const createResource = ({ name, fetch, key = R.identity, persist = false }) => ({\n  name,\n  fetch,\n  id: uuid.v4(),\n  key,\n  persist,\n})\n\nconst Action = tagged([\n  'Init', // { resource, input: any, promise, resolver }\n  'Request', // { resource, input: any }\n  'Response', // { resource, input: any, result: Result }\n  'Patch', // { resource, input: any, update: fn, silent: bool }\n  'Claim', // { resource, input: any }\n  'Release', // { resource, input: any, releasedAt: Date }\n  'CleanUp', // { time: Date }\n])\n\nconst keyFor = (resource, input) => [resource.id, I.fromJS(resource.key(input))]\n\nconst reducer = reduxTools.withInitialState(\n  I.Map(),\n  Action.reducer({\n    Init:\n      ({ resource, input, promise }) =>\n      (s) =>\n        s.updateIn(keyFor(resource, input), (entry) => {\n          if (entry) throw new Error('Init: entry already exists')\n          return {\n            promise,\n            result: AsyncResult.Init(),\n            claimed: resource.persist ? 1 : 0, // \"persistent\" resources won't be released\n          }\n        }),\n    Request:\n      ({ resource, input }) =>\n      (s) =>\n        s.updateIn(keyFor(resource, input), (entry) => {\n          if (!entry) throw new Error('Request: entry does not exist')\n          if (!AsyncResult.Init.is(entry.result)) {\n            throw new Error('Request: invalid transition')\n          }\n          return { ...entry, result: AsyncResult.Pending() }\n        }),\n    Response:\n      ({ resource, input, result }) =>\n      (s) =>\n        s.updateIn(keyFor(resource, input), (entry) => {\n          if (!entry) return undefined // released before response\n          if (!AsyncResult.Pending.is(entry.result)) {\n            throw new Error('Response: invalid transition')\n          }\n          return { ...entry, result }\n        }),\n    Patch:\n      ({ resource, input, update, silent = false }) =>\n      (s) =>\n        s.updateIn(keyFor(resource, input), (entry) => {\n          if (!entry) {\n            if (silent) return entry\n            throw new Error('Patch: entry does not exist')\n          }\n          return update(entry)\n        }),\n    Claim:\n      ({ resource, input }) =>\n      (s) =>\n        s.updateIn(keyFor(resource, input), (entry) => {\n          if (!entry) throw new Error('Claim: entry does not exist')\n          return { ...entry, claimed: entry.claimed + 1 }\n        }),\n    Release:\n      ({ resource, input, releasedAt }) =>\n      (s) =>\n        s.updateIn(keyFor(resource, input), (entry) => {\n          if (!entry) throw new Error('Release: entry does not exist')\n          return { ...entry, claimed: entry.claimed - 1, releasedAt }\n        }),\n    CleanUp:\n      ({ time }) =>\n      (s) =>\n        s.map((r) =>\n          r.filter(\n            (entry) =>\n              entry.claimed >= 1 ||\n              !entry.releasedAt ||\n              time - entry.releasedAt < RELEASE_TIME,\n          ),\n        ),\n    __: () => R.identity,\n  }),\n)\n\nconst selectEntry = (resource, input) => (s) =>\n  s.getIn([REDUX_KEY, ...keyFor(resource, input)])\n\nfunction* handleInit({ resource, input, resolver }) {\n  yield effects.put(Action.Request({ resource, input }))\n  try {\n    const res = yield effects.call(resource.fetch, input)\n    yield effects.put(Action.Response({ resource, input, result: AsyncResult.Ok(res) }))\n    resolver.resolve(res)\n  } catch (e) {\n    yield effects.put(Action.Response({ resource, input, result: AsyncResult.Err(e) }))\n    resolver.reject(e)\n  }\n}\n\nfunction* cleanup() {\n  // TODO: refactor cleanup logic, so that the cleanup action is only dispatched\n  // when there's anything to cleanup (to avoid re-renders every 5 sec)\n  while (true) {\n    yield effects.delay(RELEASE_TIME)\n    yield effects.put(Action.CleanUp({ time: new Date() }))\n  }\n}\n\nfunction* saga() {\n  yield sagaTools.takeEveryTagged(Action.Init, handleInit)\n  yield effects.fork(cleanup)\n}\n\nexport const suspend = ({ promise, result }) =>\n  AsyncResult.case(\n    {\n      Init: () => {\n        throw promise\n      },\n      Pending: () => {\n        throw promise\n      },\n      Err: (e) => {\n        throw e\n      },\n      Ok: R.identity,\n    },\n    result,\n  )\n\nexport const Provider = function ResourceCacheProvider({ children }) {\n  useSaga(saga)\n  useReducer(REDUX_KEY, reducer)\n  const store = redux.useStore()\n  const accessResult = React.useCallback(\n    (resource, input) => {\n      const getEntry = () => selectEntry(resource, input)(store.getState())\n      const entry = getEntry()\n      if (entry) return entry\n      store.dispatch(Action.Init({ resource, input, ...defer() }))\n      return getEntry()\n    },\n    [store],\n  )\n\n  const get = React.useMemo(() => R.pipe(accessResult, suspend), [accessResult])\n\n  const patch = React.useCallback(\n    (resource, input, update, silent) => {\n      store.dispatch(Action.Patch({ resource, input, update, silent }))\n    },\n    [store],\n  )\n\n  const patchOk = React.useCallback(\n    (resource, input, updateOk, silent) => {\n      const update = R.when(\n        (s) => AsyncResult.Ok.is(s.result),\n        R.evolve({\n          result: AsyncResult.case({\n            Ok: R.pipe(updateOk, AsyncResult.Ok),\n            _: R.identity,\n          }),\n          promise: R.andThen(updateOk),\n        }),\n      )\n      return patch(resource, input, update, silent)\n    },\n    [patch],\n  )\n\n  const claim = React.useCallback(\n    (resource, input) => {\n      store.dispatch(Action.Claim({ resource, input }))\n    },\n    [store],\n  )\n\n  const release = React.useCallback(\n    (resource, input) => {\n      const releasedAt = new Date()\n      store.dispatch(Action.Release({ resource, input, releasedAt }))\n    },\n    [store],\n  )\n\n  const inst = React.useMemo(\n    () => ({ access: accessResult, get, patch, patchOk, claim, release }),\n    [accessResult, get, patch, patchOk, claim, release],\n  )\n\n  return <Ctx.Provider value={inst}>{children}</Ctx.Provider>\n}\n\nexport function useResourceCache() {\n  return React.useContext(Ctx)\n}\n\nexport const use = useResourceCache\n\nexport function useData(resource, input, opts = {}) {\n  const cache = use()\n  const inputMemo = useMemoEq(input, R.identity)\n  const [entry, setEntry] = React.useState(() => cache.access(resource, input))\n  const store = redux.useStore()\n  React.useEffect(() => {\n    let prevEntry = cache.access(resource, inputMemo)\n    cache.claim(resource, inputMemo)\n    const unsubscribe = store.subscribe(() => {\n      const newEntry = cache.access(resource, inputMemo)\n      if (!R.equals(newEntry, prevEntry)) {\n        setEntry(newEntry)\n        prevEntry = newEntry\n      }\n    })\n    return () => {\n      unsubscribe()\n      cache.release(resource, inputMemo)\n    }\n  }, [store, cache, resource, inputMemo])\n\n  return opts.suspend ? suspend(entry) : entry\n}\n","import invariant from 'invariant'\nimport isFunction from 'lodash/isFunction'\nimport * as React from 'react'\nimport * as redux from 'react-redux'\nimport { applyMiddleware } from 'redux'\nimport createSagaMiddleware from 'redux-saga'\n\nconst scope = 'app/utils/SagaInjector'\n\nexport const useSaga = (saga, ...args) => {\n  const innerScope = `${scope}/SagaInjector/useSaga`\n  invariant(isFunction(saga), `${innerScope}: Expected 'saga' to be a function`)\n\n  const { runSaga } = redux.useStore()\n  const running = React.useRef()\n\n  if (running.current && running.current.saga !== saga) {\n    running.current.task.cancel()\n    running.current = null\n  }\n\n  if (!running.current) {\n    const task = runSaga(saga, ...args)\n    running.current = { saga, task }\n  }\n\n  React.useEffect(\n    () => () => {\n      if (running.current) running.current.task.cancel()\n    },\n    [],\n  )\n\n  return running.current.task\n}\n\n// saga: any => any, args: any[]\nexport function Inject({ saga, args = [], children }) {\n  useSaga(saga, ...args)\n  return children\n}\n\nexport const withSaga =\n  (...sagaMWArgs) =>\n  (createStore) =>\n  (...args) => {\n    const sagaMiddleware = createSagaMiddleware(...sagaMWArgs)\n    const store = applyMiddleware(sagaMiddleware)(createStore)(...args)\n    return {\n      ...store,\n      runSaga: sagaMiddleware.run,\n    }\n  }\n","import { routerMiddleware } from 'connected-react-router/esm/immutable'\nimport { fromJS, Iterable } from 'immutable'\nimport * as React from 'react'\nimport { Provider as ReduxProvider } from 'react-redux'\nimport { createStore, applyMiddleware, compose } from 'redux'\nimport { composeWithDevTools } from 'redux-devtools-extension'\nimport { combineReducers } from 'redux-immutable'\nimport * as Sentry from '@sentry/react'\n\nimport { withInjectableReducers } from 'utils/ReducerInjector'\nimport { withSaga } from 'utils/SagaInjector'\n\nconst stateTransformer = (state) =>\n  // pure JS is easier to read than Immutable objects\n  Iterable.isIterable(state) ? state.toJS() : state\n\nconst actionTransformer = (action) => {\n  switch (action.type) {\n    case 'app/Auth/SIGN_UP':\n    case 'app/Auth/SIGN_IN':\n    case 'app/Auth/CHANGE_PASSWORD':\n      return {\n        ...action,\n        payload: {\n          ...action.payload,\n          password: '***',\n        },\n      }\n  }\n  return action\n}\n\nconst composeEnhancers = composeWithDevTools({})\n\nconst sentryEnhancer = Sentry.createReduxEnhancer({ actionTransformer, stateTransformer })\n\nconst sentryfyReducer = (originalReducer) => {\n  let extracted\n  const extractReducer = (reducer) => {\n    extracted = reducer\n  }\n  sentryEnhancer(extractReducer)(originalReducer, {})\n  return extracted\n}\n\nconst createReducer = compose(sentryfyReducer, combineReducers)\n\nexport const Provider = function StoreProvider({ initialState = {}, history, children }) {\n  // Create the store with asynchronously loaded reducers\n  const [store] = React.useState(() => {\n    const middlewares = []\n    if (history) {\n      // routerMiddleware: Syncs the location/URL path to the state\n      middlewares.push(routerMiddleware(history))\n    }\n    // log redux state in development\n    if (\n      process.env.NODE_ENV === 'development' &&\n      process.env.LOGGER_REDUX === 'enabled'\n    ) {\n      // eslint-disable-next-line global-require\n      const { createLogger } = require('redux-logger')\n      middlewares.push(createLogger({ stateTransformer, collapsed: true }))\n    }\n\n    return createStore(\n      (state) => state, // noop reducer, the actual ones will be injected\n      fromJS(initialState),\n      composeEnhancers(\n        withSaga({ onError: Sentry.captureException }),\n        applyMiddleware(...middlewares),\n        withInjectableReducers(createReducer),\n      ),\n    )\n  })\n\n  return <ReduxProvider store={store}>{children}</ReduxProvider>\n}\n","/**\n * Copy a string to the clipboard.\n * Must be called from within an event handler such as click.\n * May return false if it failed, but this is not always possible.\n * Browser support for Chrome 43+, Firefox 42+, Safari 10+, Edge and IE 10+.\n * IE: The clipboard feature may be disabled by an administrator.\n * By default a prompt is shown the first time the clipboard is used (per session).\n *\n * Taken from this SO answer: https://stackoverflow.com/a/33928558/2129080\n *\n * @name copyToClipboard\n *\n * @param {string} text\n *\n * @returns {boolean}\n */\nexport default function copyToClipboard(text, { container = document.body } = {}) {\n  if (window.clipboardData && window.clipboardData.setData) {\n    // IE specific code path to prevent textarea being shown while dialog is visible.\n    return window.clipboardData.setData('Text', text)\n  }\n\n  if (!(document.queryCommandSupported && document.queryCommandSupported('copy'))) {\n    return false\n  }\n\n  const textarea = document.createElement('textarea')\n  textarea.textContent = text\n  // Prevent scrolling to bottom of page in MS Edge.\n  textarea.style.position = 'fixed'\n  container.appendChild(textarea)\n  textarea.select()\n  try {\n    // Security exception may be thrown by some browsers.\n    return document.execCommand('copy')\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.warn('copy to clipboard failed', e)\n    return false\n  } finally {\n    container.removeChild(textarea)\n  }\n}\n","// TODO: deprecate\nimport { fromJS as iFromJS } from 'immutable'\n\nexport const invoke =\n  (method) =>\n  (...args) =>\n  (obj) =>\n    obj && method in obj ? obj[method](...args) : obj\n\nexport const get = invoke('get')\nexport const getIn = invoke('getIn')\nexport const update = invoke('update')\nexport const updateIn = invoke('updateIn')\nexport const remove = invoke('remove')\nexport const removeIn = invoke('removeIn')\nexport const sortBy = invoke('sortBy')\nexport const push = invoke('push')\nexport const map = invoke('map')\nexport const toJS = invoke('toJS')\nexport const fromJS =\n  (...args) =>\n  (obj) =>\n    iFromJS(obj, ...args)\n","import * as R from 'ramda'\n\n/** @deprecated Use pipe from fp-ts */\nexport default (...args) =>\n  (...fns) =>\n    R.pipe(...fns)(...args)\n","import id from 'lodash/identity'\nimport isFunction from 'lodash/isFunction'\n\nexport const unset = Symbol('reduxTools/unset')\nexport const noop = Symbol('reduxTools/noop')\n\n/**\n * A redux action.\n *\n * @typedef {Object} Action\n */\n\n/**\n * A redux reducer.\n *\n * @typedef {function} Reducer\n *\n * @param {any} state\n * @param {Action} action\n *\n * @returns {any}\n */\n\n/**\n * Value to use for the current key.\n * If equals `unset` Symbol, unset the current key.\n * If equals `noop` Symbol, keep the value under the current key.\n * Otherwise, set the given value to the current key.\n *\n * @typedef {Symbol|any} Value\n */\n\n/**\n * Function used to update the current value.\n *\n * @typedef {function} ValueUpdater\n *\n * @param {any} currentValue\n *\n * @returns {Value}\n *   The updated value.\n */\n\n/**\n * Function used to handle an action.\n * Returns the new value or a ValueUpdater function.\n *\n * @typedef {function} ActionHandler\n *\n * @param {any} payload\n * @param {any} meta\n * @param {Action} action\n *\n * @returns {ValueUpdater|Value}\n */\n\n/**\n * Combine handlers for given keys (state should be an Immutable Map).\n *\n * @param {Object.<string, ActionHandler|Value>} handlers\n *   Handler map (key -> handler).\n *   If handler is a Value, use it for the current key.\n *   If handler is a function (ActionHandler),\n *   call it with action.payload, action.meta and action.\n *   If result is a Value, use it for the current key.\n *   If result is a function (ValueUpdater),\n *   use it as an updater for the current key.\n *\n * @returns {Reducer}\n */\nexport const combine = (handlers) => (state, action) =>\n  Object.entries(handlers).reduce((acc, [key, handler]) => {\n    const updater = isFunction(handler)\n      ? handler(action.payload, action.meta, action)\n      : handler\n    const updated = isFunction(updater) ? updater(acc.get(key)) : updater\n    switch (updated) {\n      case noop:\n        return acc\n      case unset:\n        return acc.remove(key)\n      default:\n        return acc.set(key, updated)\n    }\n  }, state)\n\n/**\n * Create a reducer that handles actions based on a given reducer map.\n *\n * @param {Object.<string, Reducer>} reducers\n *   Reducer map (action type -> reducer).\n *\n * @returns {Reducer}\n */\nexport const handleActions = (reducers) => (state, action) =>\n  (reducers[action.type] || id)(state, action)\n\n/**\n * Create a reducer that handles transitions.\n *\n * @param {function} getState\n *   Selector for getting FSM state.\n *\n * @param {Object.<string, Reducer>} reducers\n *   Reducer map (FSM state -> Reducer).\n */\nexport const handleTransitions = (getState, reducers) => (state, action) =>\n  (reducers[getState(state)] || id)(state, action)\n\n/**\n * Sets the initial state for a reducer.\n *\n * @param {any} initialState\n * @param {Reducer} reducer\n *\n * @returns {Reducer}\n *   Reducer with the given initial state.\n */\nexport const withInitialState =\n  (initialState, reducer) =>\n  // eslint-disable-next-line @typescript-eslint/default-param-last\n  (state = initialState, action) =>\n    reducer(state, action)\n\n/**\n * Create a reducer that uses different handlers for error and non-error actions.\n *\n * @param {Object} handlers\n * @param {Reducer} handlers.resolve\n *   Reducer used to handle non-error actions (with falsy error prop).\n * @param {Reducer} handlers.reject\n *   Reducer used to handle error actions (with truthy error prop).\n *\n *  @returns {Reducer}\n */\nexport const handleResult =\n  ({ resolve, reject }) =>\n  (state, action) =>\n    ((action.error ? reject : resolve) || id)(state, action)\n\n/**\n * Create map of actions prefixed with the given scope.\n *\n * @param {string} scope\n * @param {...string} actions\n *\n * @returns {Object.<string, string>}\n *   A map of actions with the original strings as keys\n *   and the prefixed strings as values.\n */\nexport const createActions = (scope, ...actions) =>\n  actions.reduce((acc, action) => ({ ...acc, [action]: `${scope}/${action}` }), {})\n\n/**\n * Create an action creator for the given action type.\n *\n * @param {string} type\n *   Action type (exposed as .type on the resulting function for convenience).\n *\n * @param {function} create\n *   Wrapped action creator function, which is called with the arguments\n *   provided to the resulting function.\n *   Result of calling it is extended with the .type prop provided above.\n *\n * @returns {function} The action creator.\n */\nexport const actionCreator = (type, create = () => {}) =>\n  Object.assign((...args) => ({ type, ...create(...args) }), { type })\n","import {\n  ConnectedRouter,\n  connectRouter,\n  LOCATION_CHANGE,\n} from 'connected-react-router/esm/immutable'\nimport * as React from 'react'\nimport { matchPath } from 'react-router-dom'\nimport * as redux from 'react-redux'\n\nimport * as ReducerInjector from 'utils/ReducerInjector'\n\nexport { LOCATION_CHANGE }\n\nexport const REDUX_KEY = 'router'\n\nexport const selectLocation = (s) => s.getIn([REDUX_KEY, 'location']).toJS()\n\nexport const useLocation = () => redux.useSelector(selectLocation)\n\nexport const useRoute = (path, opts) => {\n  const location = useLocation()\n  const match = matchPath(location.pathname, { path, ...opts })\n  return { location, match }\n}\n\nexport default function RouterProvider(props) {\n  const reducer = React.useMemo(() => connectRouter(props.history), [props.history])\n  ReducerInjector.useReducer(REDUX_KEY, reducer)\n  return <ConnectedRouter {...props} />\n}\n","import * as R from 'ramda'\nimport { select, take, takeEvery, takeLatest } from 'redux-saga/effects'\n\nconst mapAction =\n  (mapping, fn) =>\n  (...args) =>\n    fn(...R.adjust(-1, mapping, args))\n\nconst mkTaker =\n  (taker) =>\n  (variant, fn, ...args) =>\n    taker(variant.is, mapAction(variant.unbox, fn), ...args)\n\nexport const takeLatestTagged = mkTaker(takeLatest)\n\nexport const takeEveryTagged = mkTaker(takeEvery)\n\nexport function* waitTil(selector, predicate = Boolean) {\n  while (true) {\n    const state = yield select(selector)\n    if (predicate(state)) return state\n    yield take('*')\n  }\n}\n","/* storage - abstract persistence; currently uses\n * enforce write/read from predefined keys only */\nimport invariant from 'invariant'\nimport mapValues from 'lodash/mapValues'\n\nexport default (keys) => {\n  const assertKey = (key, scope) =>\n    invariant(key in keys, `storage.${scope}: unexpected key: ${key}`)\n\n  function get(key) {\n    assertKey(key, 'get')\n    return JSON.parse(localStorage.getItem(keys[key]))\n  }\n\n  function set(key, value) {\n    assertKey(key, 'set')\n    return localStorage.setItem(keys[key], JSON.stringify(value))\n  }\n\n  function remove(key) {\n    assertKey(key, 'remove')\n    return localStorage.removeItem(keys[key])\n  }\n\n  function load() {\n    // user privacy may cause reads from localStorage to fail and throw\n    try {\n      return mapValues(keys, (_v, k) => get(k))\n    } catch (err) {\n      console.error('storage.load:', err) // eslint-disable-line no-console\n      // let reducers determine state\n      return undefined\n    }\n  }\n\n  return {\n    get,\n    set,\n    remove,\n    load,\n  }\n}\n","/* String utils */\nimport * as R from 'ramda'\nimport React from 'react'\n\nexport function printObject(obj) {\n  return JSON.stringify(obj, null, '  ')\n}\n\nconst suffixes = ['', 'k', 'M', 'G', 'T', 'P', 'E', 'Z', 'Y']\n\nconst splitNumber = (n) => {\n  const exp = n === 0 ? 0 : Math.log10(n)\n  const index = Math.min(Math.floor(exp / 3), suffixes.length - 1)\n  const coeff = (n / 10 ** (index * 3)).toFixed(1)\n  return [coeff, suffixes[index]]\n}\n\nconst numberFormat = new Intl.NumberFormat('en-US')\n\nexport function formatQuantity(\n  q,\n  {\n    fallback,\n    renderValue = R.identity,\n    renderSuffix = R.identity,\n    Component = React.Fragment,\n  } = {},\n) {\n  if (!Number.isInteger(q)) {\n    return typeof fallback === 'function' ? fallback(q) : fallback\n  }\n  const [coeff, suffix] = splitNumber(q)\n  return (\n    <Component>\n      {renderValue(numberFormat.format(coeff).toString())}\n      {renderSuffix(suffix)}\n    </Component>\n  )\n}\n\nexport const mkFormatQuantity = (opts) => (q) => formatQuantity(q, opts)\n\nexport const readableQuantity = mkFormatQuantity({ fallback: '?', Component: 'span' })\n\nexport const readableBytes = (bytes, extra) =>\n  formatQuantity(bytes, {\n    fallback: '?',\n    renderSuffix: (suffix) => (\n      <>\n        {extra}&nbsp;{suffix}B\n      </>\n    ),\n    Component: 'span',\n  })\n\nexport const trimCenter = (str, maxLength) => {\n  if (str.length <= maxLength) return str\n  const divider = ' … '\n  const to = (maxLength - divider.length) / 2\n  const from = str.length - (maxLength - divider.length) / 2\n  return str.substring(0, to) + divider + str.substring(from, str.length)\n}\n","import invariant from 'invariant'\nimport * as R from 'ramda'\n\nconst scope = 'app/utils/tagged'\n\nconst withValue =\n  (fn) =>\n  (inst, ...rest) =>\n    fn(R.prop('value', inst), ...rest)\n\nconst exhaustive = (variants, cases) => cases._ || variants.every((v) => cases[v])\n\nconst chooseCase = (cases, variant) => {\n  if (!variant) return cases.__\n  if (!(variant in cases)) return cases._\n  return withValue(cases[variant])\n}\n\n/**\n * Create a tagged union constructor.\n *\n * @param {[string]} variants\n *\n * @returns {TaggedUnionType}\n */\nexport default (variants) => {\n  invariant(\n    R.type(variants) === 'Array' &&\n      R.equals(variants, R.uniq(variants)) &&\n      variants.every(R.is(String)),\n    `${scope}: variants must be an array of unique strings`,\n  )\n  invariant(\n    variants.every((v) => v !== '_' && v !== '__'),\n    `${scope}: variants may not contain placeholder strings (_ and __)`,\n  )\n\n  const symbols = R.fromPairs(variants.map((str) => [str, Symbol(str)]))\n\n  const variantMap = R.invertObj(symbols)\n\n  const getVariant = (inst) => {\n    const tag = R.prop('type', inst)\n    return tag && variantMap[tag]\n  }\n\n  const mkConstructor = (tag, variant) => {\n    const constructor = (value) => ({ type: tag, value })\n\n    constructor.is = (inst, pred) =>\n      getVariant(inst) === variant && (pred ? pred(constructor.unbox(inst)) : true)\n\n    constructor.unbox = (inst) => {\n      invariant(\n        constructor.is(inst),\n        `${scope}/unbox: must be called with an instance of type`,\n      )\n      return R.prop('value', inst)\n    }\n\n    return constructor\n  }\n\n  const constructors = R.mapObjIndexed(mkConstructor, symbols)\n\n  const doCase = (cases, ...args) => {\n    invariant(\n      R.all((x) => typeof x === 'function', cases),\n      `${scope}/case: cases must be an object of functions`,\n    )\n    invariant(\n      R.all(R.contains(R.__, ['_', '__', ...variants]), R.keys(cases)),\n      `${scope}/case: cases may only include type variants and placeholders (_ and __)`,\n    )\n    invariant(exhaustive(variants, cases), `${scope}/case: non-exhaustive cases`)\n\n    const exec = (inst, ...extra) => {\n      const variant = getVariant(inst)\n      if (!cases.__) {\n        invariant(\n          variant,\n          `${scope}/case: must be called with an instance of type, otherwise cases must include the __ placeholder`,\n        )\n      }\n      return chooseCase(cases, variant)(inst, ...extra)\n    }\n\n    return args.length ? exec(...args) : exec\n  }\n\n  return {\n    is: (inst) => !!getVariant(inst),\n\n    /**\n     *\n     */\n    case: doCase,\n\n    mapCase: (cases, ...args) => {\n      invariant(\n        !Object.keys(cases).includes('_') && !Object.keys(cases).includes('__'),\n        `${scope}/mapCase: cases should not include placeholders (_ and __)`,\n      )\n      return doCase(\n        {\n          ...R.mapObjIndexed((fn, variant) => R.pipe(fn, constructors[variant]), cases),\n          _: R.identity,\n        },\n        ...args,\n      )\n    },\n\n    /**\n     *\n     */\n    reducer: (cases) => (acc, next) => doCase(cases, next)(acc),\n\n    ...constructors,\n  }\n}\n","import * as React from 'react'\n\nexport default function useConstant(cons) {\n  const ref = React.useRef()\n  if (!ref.current) {\n    ref.current = cons()\n  }\n  return ref.current\n}\n","import memoize from 'lodash/memoize'\nimport * as R from 'ramda'\n\nimport * as s3paths from './s3paths'\n\n/**\n * @typedef {function} TestFunction\n *\n * @param {any} value\n *\n * @param {Immutable.Map} allValues\n *\n * @param {Object} props\n *\n * @returns {boolean}\n *   true if value is valid, false if invalid.\n */\n\n/**\n * Validation result:\n * undefined if the value is valid,\n * a string representing the validation error otherwise.\n *\n * @typedef {?string} ValidationResult\n */\n\n/**\n * Validator function to use with final-form.\n *\n * @typedef {function} Validator\n *\n * @param {any} value\n *\n * @param {Immutable.Map} allValues\n *\n * @param {Object} props\n *\n * @returns {ValidationResult}\n */\n\n/**\n * Create a validator using given error and test function.\n * Validation doesn't fire if the value is falsy.\n * The function is memoized to avoid unnecessary rerenders.\n *\n * @name validate\n *\n * @param {string} error\n *   Return this string if the test result is falsy.\n *\n * @param {TestFunction} test\n *\n * @returns {Validator}\n *\n * @example\n * <Field\n *   validate={[\n *     validate('strong', minlength(8)),\n *     validate('check', matchesField('password')),\n *   ]}\n *   ...\n * />\n */\nexport default memoize(\n  (error, test) => (v, vs, props) =>\n    // only test truthy values\n    v && !test(v, vs, props) ? error : undefined,\n)\n\n/**\n * Create a test function that checks if the value matches the given RegExp.\n *\n * @param {RegExp} re\n *\n * @returns {TestFunction}\n */\nexport const matches = (re) => (str) => re.test(str)\n\n/**\n * Create a test function that checks if the value matches the other field's\n * value. Test passes if the other field's value is empty (falsy).\n *\n * @param {string} field\n *\n * @returns {TestFunction}\n */\nexport const matchesField = (field) => (v, vs) => {\n  const other = typeof vs.get === 'function' ? vs.get(field) : vs[field]\n  return !other || v === other\n}\n\n/**\n * Validate that the value is present (truthy). Error string: 'required'.\n *\n * @type {Validator}\n */\nexport const required = (v) => (v ? undefined : 'required')\n\n/**\n * Validate that the value is a non-empty object or array.  Error string: 'nonEmpty'.\n *\n * @type {Validator}\n */\nexport const nonEmpty = (v) => (v && !R.isEmpty(v) ? undefined : 'nonEmpty')\n\n/**\n * Validate that the string represents a valid integer. Error string: 'integer'.\n *\n * @type {Validator}\n */\nexport const integer = (v) => (!v || Number.isInteger(Number(v)) ? undefined : 'integer')\n\n/**\n * Validate that the string is a valid JSON. Error string: 'json'.\n *\n * @type {Validator}\n */\nexport const json = (v) => {\n  if (!v) return undefined\n  try {\n    JSON.parse(v)\n    return undefined\n  } catch (e) {\n    return 'json'\n  }\n}\n\nexport const hexColor = (v) => {\n  if (!v) return undefined\n  return matches(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/)(v) ? undefined : 'hex'\n}\n\nexport const url = (v) => {\n  if (!v) return undefined\n  try {\n    // if v is not valid URL, then URL will throws\n    new window.URL(v)\n  } catch (e) {\n    return 'url'\n  }\n}\n\nexport const s3Url = (v) => {\n  if (!v) return undefined\n  try {\n    const { bucket, key } = s3paths.parseS3Url(v)\n    if (!bucket || !key) return 's3Url'\n  } catch (e) {\n    return 's3Url'\n  }\n}\n\nexport const file = (v) => {\n  if (!v) return undefined\n  return v instanceof File ? undefined : 'file'\n}\n\n/**\n * Validate that the string represents a valid JSON object. Error string: 'jsonObject'.\n *\n * @type {Validator}\n */\nexport const jsonObject = (v) => {\n  if (!v) return undefined\n  try {\n    const parsed = JSON.parse(v)\n    return R.is(Object, parsed) ? undefined : 'jsonObject'\n  } catch (e) {\n    return 'jsonObject'\n  }\n}\n\nexport const composeOr =\n  (...validators) =>\n  (v) => {\n    let error\n    // check if any of validators returns undefined\n    validators.some((validator) => {\n      error = validator(v)\n      return !error\n    })\n    return error\n  }\n\nexport const composeAnd =\n  (...validators) =>\n  (v) => {\n    let error\n    // check if all validators returns undefined\n    validators.every((validator) => {\n      error = validator(v)\n      return !error\n    })\n    return error\n  }\n\nexport const composeAsync =\n  (...validators) =>\n  (...args) =>\n    validators.reduce(\n      (error, next) => Promise.resolve(error).then((e) => e || next(...args)),\n      undefined,\n    )\n"],"names":["module","exports","useStyles","t","root","height","spacing","width","BucketIcon","alt","optClassName","optClasses","src","props","classes","className","custom","stub","useCodeStyles","background","palette","grey","borderRadius","color","text","primary","fontFamily","typography","monospace","padding","whiteSpace","Code","children","collaborators","sorted","setSorted","sort","setSort","toggleSort","key","currentDirection","direction","undefined","preSorted","getSortProperty","reverse","hasUnmanagedRole","find","size","length","active","username","onClick","email","permissionLevel","map","collaborator","colSpan","close","marginLeft","title","display","alignItems","Popup","bucket","open","onClose","fullWidth","maxWidth","hint","clickable","cursor","Component","badgeContent","icon","max","knownNumber","useAvatarStyles","backgroundColor","info","main","light","getContrastText","fontSize","textTransform","index","substring","position","zIndex","more","common","white","lineHeight","transition","userpic","marginTop","avatarWrapper","flexDirection","margin","Avatars","knownCollaborators","filter","potentialCollaborators","avatars","slice","moreNum","reduce","memo","DataGrid","inProps","ref","name","licenseStatus","Ctx","Provider","value","use","buttonCell","border","borderWidth","emptyCell","AddArrayItem","columnPath","onAdd","variant","COLUMN_IDS","EMPTY_VALUE","Symbol","isNumber","v","Number","isNaN","useContextMenuStyles","group","borderTop","divider","paddingTop","marginBottom","ContextMenu","anchorEl","onChange","bootstrapObject","bootstrapArray","convertToNumber","convertToString","isConvertibleToNumber","error","isConvertibleToString","isConvertible","startIcon","stringifyJSON","obj","JSON","stringify","parseJSON","str","parse","e","useArrayStyles","lbracket","secondary","dark","marginRight","rbracket","useObjectStyles","lbrace","rbrace","PreviewArray","items","item","hasDelimiter","PreviewValue","PreviewObject","hintText","Object","keys","join","Array","isArray","String","toString","select","body2","outline","EnumSelect","data","onContextMenu","options","valueSchema","enum","Error","innerValue","setInnerValue","handleBlur","freeSolo","getOptionLabel","option","inputValue","newValue","onInputChange","openOnFocus","renderInput","InputProps","inputProps","rest","autoFocus","disableUnderline","onBlur","renderOption","getNormalizedValue","optSchema","type","Input","columnId","placeholder","originalValue","setValue","normalizedValue","getNormalizedValueStr","valueStr","setValueStr","inputRef","current","some","leftBracket","rightBracket","hasBrackets","setSelectionRange","onChangeInternal","event","target","isFinite","willBeNullInJson","onKeyDown","stopPropagation","preventDefault","ButtonExpand","tooltip","body1","boxShadow","shadows","StyledTooltip","getTypeHelps","examples","errors","humanReadableSchema","mismatch","schema","output","push","Boolean","description","example","useTypeHelpStyles","TypeHelp","groups","i","typeHelp","j","useNoteValueStyles","default","caption","disabled","NoteValue","typeHelps","Note","button","opacity","flexGrow","overflow","textOverflow","required","fontWeight","fontWeightBold","menu","Preview","onExpand","onRemove","requiredKey","isEmpty","isExpandable","hasDeleteButton","cellPlaceholders","Cell","column","contextMenuPath","editingInitial","row","updateMyData","initialValue","editing","setEditing","values","fieldPath","concat","hasKey","id","isKeyCell","isValueCell","isEditable","original","isEnumCell","onDoubleClick","onKeyPress","ValueComponent","addressPath","setAnchorEl","handleContextMenu","role","tabIndex","inputCell","breakpoints","up","emptyKeyProps","address","reactId","sortIndex","emptyValueProps","AddRow","onChangeKey","_1","_2","onChangeValue","useOverrideStyles","li","separator","useItemStyles","Item","CurrentItem","BreadcrumbsDivider","shoudShowItem","itemsNumber","tailOnly","onSelect","overrideClasses","onBreadcrumb","path","scrollIntoView","actualIndex","cell","cellContent","EmptyRow","borderColor","Row","cells","fresh","getCellProps","render","getAddressPath","parentPath","getSchemaItem","s","noKeys","getSchemaItemKeys","schemaItem","properties","sortOrder","Infinity","iterateSchema","additionalProperties","rawItem","counter","JSONPointer","requiredKeys","forEach","includes","assocObjValue","getObjValue","dissocObjValue","NO_ERRORS","bigintError","MAX_SAFE_INTEGER","getJsonDictItemRecursively","jsonDict","weight","placeholderItem","entries","every","doesPlaceholderPathMatch","getJsonDictItem","allErrors","valuePath","itemAddress","storedValue","jsonDictItem","defaultFromSchema","getDefaultValue","instancePath","collectErrors","pathPrefix","calcReactId","dict","getObjValueKeys","objValue","getSchemaAndObjKeys","objPath","rootKeys","getSchemaItemKeysByPath","getObjValueKeysByPath","JsonEditorState","jsonObject","setFieldPath","menuFieldPath","setMenuFieldPath","MIN_SAFE_INTEGER","result","schemaKeys","objKeys","mergeSchemaAndObjRootKeys","columns","_","pathPart","parent","iterateJsonDict","removeField","removingFieldPath","changeValue","editingFieldPath","oldObjPath","oldItem","oldValue","safeStr","addRow","addFieldPath","newKeyPath","transformer","transform","flex","breadcrumbs","sibling","siblingButton","paddingLeft","scroll","maxHeight","overflowY","table","tableLayout","toolbar","getColumnType","columnSchema","getJsonDictValue","useEmptyColumnStyles","EmptyColumn","columnType","ColumnFiller","hasSiblingColumn","filledRowsNumber","emptyRows","Column","onAddRow","onToolbar","accessor","hasNewRow","setHasNewRow","tableInstance","defaultColumn","getTableProps","getTableBodyProps","rows","prepareRow","onAddRowInternal","Toolbar","isLastRow","getRowProps","EmptyStateCase","video","videoRef","togglePlayback","el","paused","play","pause","autoPlay","loop","EmptyState","noValue","notExpanded","useSqueezeStyles","alignSelf","Squeeze","bottom","content","left","right","top","inner","help","JsonEditor","multiColumned","md","down","handleRowAdd","newData","handleRowRemove","handleValueChange","handleToolbar","columnsView","columnData","columnIndex","shouldSqueezeColumn","stateProps","useSingleErrorStyles","code","contrastText","SingleError","severity","message","JsonValidationErrors","Link","useVersionStyles","revision","Version","Notifications","handleCopy","FooterLogo","Logo","NavLink","underline","component","to","HashLink","NavSpacer","ml","xs","sm","NavIcon","padded","bg","backgroundSize","paddingBottom","container","gridRowGap","gridTemplateColumns","gridTemplateRows","gridTemplateAreas","Footer","cfg","Config","settings","CatalogSettings","urls","NamedRoutes","intercom","Intercom","year","Date","getFullYear","reservedSpaceForIntercom","dummy","isCustom","theme","style","mode","gridArea","justifyContent","logo","url","href","home","about","normalizeBucket","WrappedAutosizeInput","AutosizeInput","inputClassName","placeholderIsMinWidth","useNavInputStyles","input","letterSpacing","borderBottomColor","NavInput","inputComponent","useBucketStyles","flexShrink","desc","Bucket","iconUrl","CustomPopper","css","placement","BucketSelect","cancel","forwardedRef","currentBucket","BucketConfig","bucketConfigs","dispatch","setInputValue","focus","Autocomplete","PopperComponent","disableClearable","reason","bucketRoot","blur","filterOptions","params","filtered","threshold","maxRanking","b","unshift","pr","setTimeout","fallback","Delay","containers_NavBar_BucketCollaboratorsDocument","kind","definitions","operation","variableDefinitions","variable","selectionSet","selections","arguments","NO_COLLABORATORS","hidden","query","variables","bucketConfig","usePotentialCollaborators","allCollaborators","setOpen","handleOpen","handleClose","expandAnimationDuration","shape","iconized","helpWrapper","expanded","inputIcon","inputOptions","paddingRight","wrapper","SearchBox","onHelpClose","onToggleOptions","onQuery","helpOpened","disabledCls","expandedCls","helpWrapperCls","helpCls","hiddenCls","iconizedCls","inputIconCls","inputOptionsCls","wrapperCls","onClickAway","in","startAdornment","selected","State","makeUrl","onFocus","change","setExpanded","setHelpOpened","evt","handleExpand","handleCollapse","handleHelpOpen","handleHelpClose","handleQuery","strPart","handleToggleOptions","onHelpOpen","onCollapse","BucketSearch","isInStack","paths","bucketSearch","l","search","q","state","GlobalSearch","buckets","disableNavigator","DelayedProgress","TransitionComponent","ProgressComponent","progressProps","transitionProps","alwaysRender","ready","useBucketDisplayStyles","locked","s3","BucketDisplay","GlobalControls","disableSearch","setState","Search","BucketControls","selectRef","focusSelect","onEnter","Controls","useLogoLinkStyles","bgQuilt","bgCustom","minHeight","LogoLink","wide","QuiltLink","selectUser","isAdmin","userDisplay","user","useBadgeStyles","badge","invisible","UserDropdown","bookmarks","Bookmarks","isProfile","profile","exact","match","admin","anchor","setAnchor","visible","setVisible","showBookmarks","show","hasUpdates","signOut","useHam","edge","MenuListProps","minWidth","AuthHamburger","authenticated","waiting","ham","links","useLinks","signIn","label","LinksHamburger","useSignInStyles","SignIn","useAppBarStyles","appBar","bgWrapper","AppBar","useContainerStyles","trigger","customBg","appear","disableGutters","isActive","customNavLink","uriResolver","selector","useNavBarStyles","nav","navItem","quiltLogo","spacer","NavBar","isSignIn","useHamburger","alwaysRequiresAuth","useRootStyles","overflowX","Root","bgcolor","Layout","bare","pre","isHomepage","bucketRoute","p","isExact","paper","Lock","quilt","parseInt","backgroundImage","backgroundPosition","backgroundRepeat","QuiltLogo","CustomLogo","sign","AWS","parsedSrc","s3paths","verbose","editorHtmlProps","MetadataEditor","isRaw","schemaValidator","setErrors","handleChange","ace","ajv","htmlElementProps","mainMenuBar","navigationBar","onError","onValidationError","statusBar","Placeholder","delay","ms","expand","progress","SelectDropdown","ButtonProps","emptySlot","loading","onOpen","currentTarget","handleSelect","aboveSm","buttonClassName","buttonProps","elevation","dense","valueOf","shimmerSize","action","hover","animate","animation","bucketPreferences","esQueries","workflows","all","setEntries","append","logicalKey","s3File","clear","merge","files","STORAGE_KEYS","initialBookmarks","keyResolver","file","setUpdates","isOpened","setOpened","get","console","setGroups","updateGroups","updater","newGroups","set","groupName","entry","createAppendUpdater","remove","isLastBookmark","createRemoveUpdater","createClearUpdater","isBookmarked","toggle","hide","useBookmarks","useBookmarksItemStyles","iconWrapper","BookmarkItem","handle","bucketFile","StyledLink","useNoBookmarksStyles","NoBookmarks","useDrawerStyles","actions","listWrapper","handles","onClear","onPackage","Sidebar","addToPackage","AddToPackage","setError","traversing","setTraversing","bucketListing","headFile","S3","version","Promise","headObject","Key","VersionId","promise","useHeadFile","handlesToS3Files","requests","delimiter","drain","response","acc","useHandlesToS3Files","createDialog","delayHashing","disableStateDisplay","handleRemove","handleClear","handleSubmit","successTitle","successRenderMessage","packageLink","DownloadButton","desktop","suffix","storage","useLocalFolder","EMPTY","TIP_DELAY","computeStats","dirs","modified","a","usePrefixFilterStyles","btn","clearIcon","searchIcon","PrefixFilter","prefix","setPrefix","prefixValue","setPrefixValue","apply","handleKeyDown","endAdornment","endIcon","optionsSelector","usePaginationStyles","Pagination","truncated","loadMore","apiRef","paginationState","page","pages","Math","ceil","rowCount","pageSize","rowsPerPageOptions","indexOf","onPageSizeChange","newPageSize","setPageSize","setPage","r","renderPage","renderGap","ActiveFilters","activeFilters","lookup","getLocaleText","columnField","headerName","operatorValue","FilterToolbarButton","preferencePanel","tooltipContentNode","toggleFilter","openedPanelValue","hideFilterPanel","showFilterPanel","arrow","enterDelay","overlap","useToolbarStyles","borderBottom","flexWrap","lock","font","usePanelStyles","boxSizing","Panel","handleClickAway","hidePreferences","columnHeadersElementRef","modifiers","flip","enabled","disablePortal","ColumnMenu","hideMenu","currentColumn","labelledby","handleListKeyDown","useFooterStyles","truncationWarning","cellFirst","cellSecond","textAlign","cellLast","COL_MODIFIED_W","COL_MODIFIED_W_SM","filterCount","stats","filteredStats","visibleItems","visibleRows","idRowsLookup","toLocaleString","FilteredOverlay","getNameSortValueAsc","getNameSortValueDesc","localeText","columnMenuSortAsc","columnMenuSortDesc","modal","grid","pointerEvents","order","link","linkFlex","ellipsis","archived","Listing","toolbarContents","prefixFilter","selection","onSelectionChange","CellComponent","RootComponent","dataGridProps","filteredToZero","setFilteredToZero","handleFilterModelChange","handlePageChange","newPage","handlePageSizeChange","prevItems","itemsOnPrevPages","field","sortComparator","_v1","_v2","p1","p2","getValue","va","vb","api","sorting","sortModel","renderCell","COL_SIZE_W","align","noRowsLabel","LoadingOverlay","handleSelectionModelChange","newSelection","selectionModel","onFilterModelChange","autoHeight","components","componentsProps","footer","getRowId","replaceAll","pagination","onPageChange","headerHeight","rowHeight","disableSelectionOnClick","disableColumnSelector","disableColumnResize","disableColumnReorder","disableMultipleSelection","disableMultipleColumnsSorting","checkboxSelection","onSelectionModelChange","overlay","errorDisplay","gutterBottom","DialogError","cancelText","onCancel","skeletonElement","submitText","DialogLoading","defaultRenderMessage","bucketLink","DialogSuccess","browseText","hash","renderMessage","isFullHash","packageUrl","bucketPackageTree","bucketPackageRevisions","bucketOverview","defaultBrowseText","useDialogStyles","switch","dialogClasses","setRaw","handleCancel","control","checked","MetadataIcon","EditFileMeta","closeEditor","openEditor","COLORS","added","deleted","hashLimit","computeHash","f","hasHash","hashP","fh","catch","log","then","FilesAction","Add","AddFromS3","Delete","DeleteDir","Meta","Revert","RevertDir","Reset","handleFilesAction","basePrefix","existing","dissocBy","k","startsWith","meta","mkSetMeta","filesDict","window","File","fileCopy","defineProperty","addMetaToFile","initial","FilesEntry","Dir","insertIntoTree","inserted","restEntries","d","baseDir","childEntries","existingDir","dir","unbox","newChildren","entryState","insertIntoDir","computeEntries","existingEntries","S3FilePicker","addedEntries","parts","split","prefixPath","HASHING","HASHING_ERROR","validateHashingComplete","useEntryIconStyles","stateContainer","hashProgress","EntryIcon","stateContents","hashing","unchanged","thickness","useFileStyles","interactive","faint","metaDisabled","onMeta","stateDisplay","metaKey","useDirStyles","head","headInner","body","bar","emptyDummy","empty","fontStyle","onHeadClick","mountOnEnter","unmountOnExit","useDropzoneMessageStyles","warning","DropzoneMessage","defaultLabel","warn","count","upload","useHeaderStyles","Header","useHeaderTitleStyles","regular","HeaderTitle","useLockStyles","progressContainer","progressPercent","h5","progressSize","total","percent","loaded","useFilesContainerStyles","err","FilesContainer","noBorder","useContentsContainerStyles","outlined","outlineOffset","ContentsContainer","useContentsStyles","Contents","FileUpload","handler","assertNever","m","DirUpload","toggleExpanded","x","onDrop","noDragEventsBubbling","noClick","getRootProps","isDragActive","ps","DOCS_URL_SOURCE_BUCKETS","useFilesInputStyles","FilesInput","onFilesAction","totalProgress","selectBucket","ui","initialS3Path","pRef","submitting","submitSucceeded","submitFailed","submitError","refProps","scheduleUpdate","waitFor","cur","resetFiles","isDragging","getInputProps","computedEntries","useMemoEq","s3FilePickerOpen","setS3FilePickerOpen","closeS3FilePicker","handleS3Btn","isS3FilePickerEnabled","initialPath","dirty","reset","checkbox","hoverOpacity","Container","useColumnStyles","flexBasis","GAP","RightColumn","useLeftColumnStyles","LeftColumn","containers_Bucket_PackageDialog_gql_ManifestDocument","directives","EMPTY_MANIFEST_ENTRIES","useManifest","skipEntries","res","useQuery","hashOrTag","doCase","pausedNoData","package","contentsFlatMap","userMeta","workflowId","workflow","fetching","case","cases","args","rowsToJson","pipeThru","parseSpreadsheet","sheet","transpose","xlsx","header","maxSize","nullsTail","readSpreadsheet","resolve","reject","reader","FileReader","onabort","onerror","onload","workbook","cellDates","Sheets","SheetNames","readAsArrayBuffer","scoreObjectDiff","obj1","obj2","isDate","format","isBoolean","postProcessValue","representation","isObject","postProcess","postProcessArrayValue","contains","isArrayOfDates","isArrayOfArrays","isArrayOfBooleans","isArrayValue","parseSpreadsheetAgainstSchema","verticalObj","schemaRoot","horizontalObj","readAgainstSchema","MAX_META_FILE_SIZE","readFile","mimeType","test","readAsText","readTextFile","useMetaInputStyles","add","sep","json","jsonTrigger","dropzone","metaContent","overlayDraggable","overlayDragActive","overlayContents","overlayText","overlayProgress","EMPTY_META_VALUE","MetaInput","schemaError","onChangeFullscreen","setJsonInlineEditorKey","onChangeInline","setJsonFullscreenEditorKey","notify","setLocked","jsonInlineEditorKey","jsonFullscreenEditorKey","contents","finally","fakeProgress","getFilesFromEvent","dataTransfer","webkitGetAsEntry","isDirectory","isDroppedDirectory","LocalFolderInput","ipc","disabledInternal","handleClick","invoke","newLocalPath","maxFiles","basename","containers_Bucket_PackageDialog_gql_PackageConstructDocument","CANCEL","README_PATH","ConfirmReadme","FormError","pl","filesWithError","filesError","form","PackageCreationForm","successor","onSuccessor","responseError","schemaLoading","selectedWorkflow","setSubmitting","setSuccess","setWorkflow","sourceBuckets","validateMetaInput","workflowsConfig","nameValidator","nameExistence","slug","nameWarning","setNameWarning","metaHeight","setMetaHeight","dialogContentClasses","validateWorkflow","dialogs","Dialogs","D","entriesError","setEntriesError","getDefault","selectedBucket","initialFiles","uploads","removeByPrefix","constructPackage","validateEntries","uploadPackage","payload","onSubmitElectron","msg","localFolder","uploadResult","onSubmitWeb","addedS3Entries","addedLocalEntries","toUpload","logical_key","createReadmeFile","getMeta","uploadedEntries","s3Entries","physicalKey","allEntries","packageConstruct","__typename","handleNameChange","validate","nameExists","exists","editorElement","setEditorElement","resizeObserver","ResizeObserver","contentRect","onFormChange","dirtyFields","observe","unobserve","validateFiles","hideMeta","setHideMeta","defaultLocalFolder","Download","onSubmit","subscription","hasValidationErrors","Successors","validateFields","validators","invalid","pattern","packageNamePattern","helperText","validating","processing","isEqual","list","SubmitSpinner","submit","prependSourceBucket","DialogState","Closed","Loading","Form","Success","EMPTY_MANIFEST_RESULT","AsyncResult","usePackageCreationDialog","initialOpen","isOpen","exited","setExited","s3Path","setS3Path","success","setSuccessor","workflowsData","Data","noAutoFetch","preferences","BucketPreferences","manifestData","manifestResult","Ok","manifest","handleExited","Err","onExited","initialWorkflowId","schemaProps","successBrowse","crop","spinner","SelectWorkflow","noChoice","shrink","labelId","isDisabled","WorkflowsConfigLink","containers_Bucket_PackageDialog_gql_PackageExistsDocument","MAX_UPLOAD_SIZE","MAX_S3_SIZE","MAX_FILE_COUNT","ERROR_MESSAGES","UPLOAD","MANIFEST","getNormalizedPath","hashFile","crypto","subtle","digest","arrayBuffer","buf","hashBuf","from","Uint8Array","padStart","cacheDebounce","fn","wait","getKey","timer","cache","resolveList","resolveNew","clearTimeout","useNameValidator","req","APIConnector","setCounter","setProcessing","inc","validator","endpoint","method","valid","validateName","useNameExistence","client","requestPolicy","toPromise","mkMetaValidator","setDefaults","useFieldInputStyles","Field","inputClasses","InputLabelProps","PackageNameInput","directory","errorCode","setModified","packageName","getDefaultPackageName","CommitMessageInput","WorkflowInput","errorKey","useWorkflowValidator","isWorkflowRequired","noopValidator","SchemaFetcher","sentry","Sentry","initialWorkflow","w","isDefault","schemaUrl","useCryptoApiValidation","useContentStyles","windowHeight","neededSpace","availableSpace","calcDialogHeight","innerHeight","usernamePrefix","validParts","getUsernamePrefix","templateBasedName","packageHandle","usePackageNameWarningStyles","verticalAlign","PackageNameWarning","DialogWrapper","useEntriesValidator","entriesSchema","limit","isS3File","getCrumbs","segPath","ExpandMore","useBucketSelectStyles","IconComponent","crumbs","overflowWrap","Dialog","setPath","prev","setPrev","setSelection","_e","continuationToken","dirsPromises","dirsChildren","allChildren","disableTypography","getLinkProps","Init","DirContents","px","pt","useDirContentsStyles","TextFieldSkeleton","mt","mb","FilesInputSkeleton","MetaInputSkeleton","WorkflowsInputSkeleton","useFormSkeletonStyles","FormSkeleton","hasValue","useUploads","setUploads","floor","computeTotalProgress","doUpload","rejected","pendingUploads","uploadFile","Body","on","uploadP","u","abort","uploadStates","uploaded","InvalidInputSelectionFragmentDoc","typeCondition","OperationErrorSelectionFragmentDoc","PackagePushSuccessSelectionFragmentDoc","block","alias","ButtonIcon","summaryExpanded","summaryRoot","summaryContent","heading","gutterTop","Section","defaultExpanded","expandable","extraSummary","expandedState","changedExpanded","renderNodeOrFn","nodeOrFn","expandIcon","EmptySlot","py","ErrorSlot","useMenuPlaceholderStyles","MenuPlaceholder","SuccessorsSelect","successors","useButtonStyles","Dropdown","setNoAutoFetch","useSuccessors","buttonClasses","ButtonInner","Button","menuAnchorEl","setMenuAnchorEl","onButtonClick","onMenuClick","menuItem","onMenuClose","next","toConfig","BucketError","displayName","WhenAuth","pathname","defaultHandlers","CORSError","headline","NoSuchBucket","ESNoIndex","ESTimeout","ESThrottle","AccessDenied","true","false","displayError","pairs","startsWithSafe","catchErrors","drainObjectList","maxRequests","reqNo","CommonPrefixes","listObjectsV2","Delimiter","Prefix","ContinuationToken","EncodingType","IsTruncated","NextContinuationToken","endsWith","LastModified","Size","etag","ETag","StorageClass","useBucketListing","objectSchema","getMetaValue","trim","getWorkflowApiParam","decodeS3Key","decodeURIComponent","ES_REF","headerLabel","subList","syntaxHelpRows","namespace","syntax","s1","s2","useExamplePartStyles","Example","syntaxParts","part","Syntax","useItemsHeaderStyles","ItemsHeader","useDocsExternalLinkStyles","DocsExternalLink","Help","defaultCollapseIcon","defaultExpandIcon","disableSelection","nodeId","replace","useGlobalStyles","textRendering","wordBreak","textDecoration","h1","marginBlockEnd","marginBlockStart","GlobalStyles","WithGlobalStyles","utils_BucketConfigListDocument","defaultValue","useBucketConfigs","includeCollaborators","useRelevantBucketConfigs","bs","relevanceScore","useCurrentBucket","useIsInStack","bc","defaultBlockMeta","defaultPreferences","copyPackage","createPackage","deleteRevision","openInDesktop","revisePackage","athena","blocks","analytics","browser","packages","queries","package_description","S3_PREFIX","normalizeBucketName","bucketPreferencesValidator","parseAthena","defaultWorkflow","defaultWorkgroup","parseSourceBuckets","defaultSourceBucketInput","defaultSourceBucket","found","extendDefaults","user_meta","bucketPreferencesYaml","localModePreferences","LocalProvider","fetchBucketPreferences","quiltConfigs","CatalogProvider","beta","context","CONFIG_KEY","CatalogSettingsResource","fetch","serviceBucket","location","getObject","useUploadFile","useWriteSettings","putObject","patchOk","useCatalogSettings","suspend","removeAdditional","addSchema","AUTH_MAP","ENABLED","DISABLED","SIGN_IN_ONLY","startWithOrigin","origin","prepareConfig","ConfigError","errorsText","validateConfig","passwordAuth","ssoAuth","ssoProviders","enableMarketingPages","s3Proxy","apiGatewayEndpoint","binaryApiGatewayEndpoint","noDownload","noOverviewImages","originalError","cachedConfig","configKey","getConfig","rawConfig","useConfig","setReady","timeout","routes","Pointer","Web","h","S3Rel","Path","WEB_RE","S3_RE","pth","TypeError","RELEASE","init","history","sentryDSN","tracingOpts","routingInstrumentation","S","dsn","release","environment","integrations","depth","normalizeDepth","denyUrls","userSelector","current_user","userEq","UserTracker","userRef","callSentry","utils_StatusReportsBucketDocument","useStatusReportsBucket","status","reportsBucket","linkStyle","defer","resolver","useDragging","setDragActive","setActive","setInactive","document","addEventListener","removeEventListener","DOWNLOAD_PACKAGE","LOCALPATH_REQUEST","UPLOAD_PACKAGE","SYNC_FOLDERS_ADD","SYNC_FOLDERS_EDIT","SYNC_FOLDERS_LIST","SYNC_FOLDERS_REMOVE","eventName","callback","request","off","send","setPrototypeOf","prototype","captureStackTrace","constructor","assign","BaseError","enumerable","this","detail","object","mkFormError","mapInputErrors","inputErrors","mapping","formErrors","isSchemaCompound","hasTypeInCompoundSchema","typeCheck","allOf","anyOf","oneOf","check","not","findTypeInCompoundSchema","isSchemaArray","isSchemaObject","isSchemaString","isSchemaNumber","isSchemaInteger","isSchemaBoolean","isSchemaNull","isSchemaEnum","isSchemaOneOf","isSchemaAnyOf","isSchemaAllOf","isSchemaConst","const","isSchemaReference","$ref","isNestedType","compoundTypeToHumanString","condition","schemaTypeToHumanString","doesTypeMatchCompoundSchema","subSchema","doesTypeMatchSchema","foundSchema","includesEnum","isInteger","EMPTY_SCHEMA","makeSchemaValidator","optSchemas","ajvOptions","mainSchema","$id","schemas","allowUnionTypes","schemaId","useDefaults","addKeyword","scanSchemaAndPrefillValues","valueItem","preDefinedValue","dateformat","makeSchemaDefaultsSetter","shortenRevision","fullRevision","execTemplate","templatesDict","template","execTemplateItem","firstOnly","parsed","fromEntries","nest","reduceRight","comp","actualProps","mkLazy","importFunc","FallbackComp","ensureNoSlash","ensureSlash","dirname","isDir","getPrefix","getBasename","withoutPrefix","isS3Url","parseS3Url","versionId","hostname","decode","resolveKey","handleToHttpsUri","encode","handleToS3Url","getBreadCrumbs","encodeURIComponent","create","typeTag","vConsMap","constructors","valueCons","variantTag","cons","inst","is","mkCons","exec","c","extra","wild","eq","utils_PotentialCollaboratorsDocument","usePrevious","defaultErrorHandler","mkCase","opts","isPartial","cacheOutcome","partial","QueryError","ctxMemo","suspense","run","defaultPackageNameTemplates","notAvailable","parsePackageNameTemplates","globalTemplates","workflowTemplates","notSelected","getNoWorkflow","hasConfig","default_workflow","is_workflow_required","catalog","package_handle","emptyConfig","validateConfigVersion","objectVersion","schemaVersion","workflowsConfigValidator","versionErrors","objectCompoundVersion","baseVersion","catalogVersion","invalidBaseVersion","invalidCatalogVersion","validateConfigCompoundVersion","base","workflowsYaml","rawData","removeCatalog","prepareData","workflowsList","workflowSlug","schemaSlug","entries_schema","handle_pattern","RegExp","metadata_schema","parseWorkflow","noWorkflow","copyData","copy_data","parseSuccessor","inputObj","inputStr","Crumb","tagged","Segment","Sep","copyWithoutSpaces","clipboardData","setData","getSelection","DOM_ID","SELECTOR","fontWeightRegular","img","Launcher","canUseDOM","createElement","dummyIntercomApi","isAvailable","defaultUserSelector","APILoader","appId","app_id","custom_launcher_selector","hide_default_launcher","async","getElementsByTagName","parentNode","insertBefore","prevUser","IntercomProvider","useIntercom","usePauseVisibilityWhen","isVisible","showIntercom","shouldShow","compoundInner","iconBlank","IconBlank","IconExpand","IconCollapse","useWaitingJsonRenderStyles","WaitingJsonRender","NonStringValue","S3UrlValue","StringValue","URL","getHref","PrimitiveEntry","topLevel","More","CompoundEntry","showKeysWhenCollapsed","braces","stateExpanded","renderCollapsed","done","JsonDisplayInner","isPrimitive","optTimeout","useComponentOnNextTick","JsonDisplay","currentBPWidth","computedKeys","POSITIVE_INFINITY","Message","Gap","renderPageRange","displayRange","gap","makePageUrl","customClasses","buttonGroupProps","SUPPORTED_EXTENSIONS","SIZES","lg","useSkeletonStyles","iconGlacier","iconError","ThumbnailSkeleton","Skeleton","Thumbnail","skeletonProps","blob","loadImg","objUrl","createObjectURL","cleanupUrl","revokeObjectURL","defaultTheme","appPalette","websitePalette","tertiary","baseTypography","appTypography","websiteTypography","h2","h3","h4","websiteOverrides","MuiButton","containedPrimary","containedSecondary","mixins","lineClamp","lines","WebkitBoxOrient","WebkitLineClamp","appTheme","navTheme","overrides","websiteTheme","createCustomAppTheme","mxs","blog","docs","docsMaster","gitWeb","homeMarketing","instagram","jobs","linkedin","slackInvite","twitter","facebook","curate","mailingListGeneral","REDUX_KEY","waitingStates","domain","Map","tokens","sessionId","errorHandler","noop","useHeadCellStyles","HeadCell","scope","usePackageMetaStyles","headCell","PackageMetaSection","PackageMeta","ObjectMetaSection","ObjectMeta","useAdaptiveButtonStyles","AdaptiveButtonLayout","download","ViewModeSelector","ZipDownloadForm","newTab","token","pb","bucketAccessCounts","analyticsBucket","today","dates","daysLeft","s3Select","ACCESS_COUNTS_PREFIX","Expression","sqlEscape","InputSerialization","CSV","FileHeaderInfo","AllowQuotedRecordDelimiter","recordedCounts","counts","date","sum","ext","byExt","byExtCollapsed","bands","other","MAX_BANDS","toKeep","toMerge","merged","band","combined","parseDate","getOverviewBucket","getOverviewKey","getOverviewPrefix","processStats","exts","objects","doc_count","bytes","totalObjects","totalBytes","bucketStats","overviewUrl","qs","mkSearch","ensureObjectIsPresentInCollection","keysTail","ensureObjectIsPresent","fileExists","fetchFileVersioned","versionExists","fetchFile","objectVersions","versions","latest","metadataSchema","WORKFLOWS_CONFIG_PATH","README_KEYS","SAMPLE_EXTS","SUMMARIZE_KEY","ObjectExistence","getObjectExistence","Exists","ContentLength","DeleteMarker","lastModified","DoesNotExist","headers","httpResponse","bucketSummary","inStack","summarize","latestVersion","hits","_source","version_id","bucketReadmes","forced","discovered","bucketImgs","toLowerCase","listObjectVersions","Versions","DeleteMarkers","isLatest","IsLatest","deleteMarker","objectMeta","isValidManifest","parseFile","resolvePath","fileHandle","Resource","inputHandle","resolveLogicalKey","IfMatch","configErrors","resolvedHandle","isFile","bind","countPackageRevisions","bool","must","term","match_all","regexp","pointer_file","aggs","revisions","scripted_metric","init_script","map_script","reduce_script","filter_path","ExpressionType","Type","selectObjectContent","OutputSerialization","Records","Payload","arg","objectAccessCounts","records","queryAccessCounts","ttl","notification","dismiss","PUSH","DISMISS","initialState","fromJS","n","ns","notifications","toJS","Notification","autoHideDuration","propTypes","ReducerInjector","reducer","Display","handleDismiss","WithNotifications","useNotifications","API_REQUEST","API_RESPONSE","requestOpts","resp","statusText","HTTPError","composeMiddleware","errorMiddleware","ok","isInstance","cls","validBodyTests","g","Blob","FormData","URLSearchParams","ReadableStream","stringifyBody","jsonContentType","jsonAccepts","Accepts","jsonMiddleware","contentType","accepts","nextOpts","mkFetchMiddleware","apiSaga","middleware","execRequest","apiRequest","dfd","registryUrl","reqOpts","refresh","refreshing","expireTime","Expiration","accessKeyId","AccessKeyId","secretAccessKey","SecretAccessKey","sessionToken","SessionToken","needsRefresh","useCredentialsMemo","local","EmptyCredentials","reg","RegistryCredentials","anon","auth","AWSCredentialsProvider","useCredentials","CredentialsError","credentials","Credentials","getRegion","AthenaContext","awsConfig","catalogConfig","region","useMemoEqLazy","useAthena","DEFAULT_OPTS","signatureVersion","s3UsEast1RegionalEndpoint","PROXIED","PRESIGN","FORCE_PROXY","useTracking","val","useSmartS3","selectEndpoint","isAuthenticated","statusReportsBucket","useConstant","getReqType","populateURI","service","customRequestHandler","httpRequest","basePath","host","prepareSignedUrl","makeRequest","forceProxy","toUnauthenticated","SmartS3","awsCfg","useS3","urlExpiration","useS3Signer","exp","ctx","inStackOrSpecial","getSignedUrl","Expires","useDownloadUrl","filename","filenameSuffix","doSign","ResponseContentDisposition","ResponseContentType","ts","now","interval","callbackRef","int","setInterval","clearInterval","usePolling","POLL_INTERVAL","WithDownloadUrl","withDownloadUrl","AWSSignerProvider","prop","mapCase","names","getPrevResult","Pending","Action","mapResult","Request","Response","useData","stateRef","dialog","setDialog","cleanup","createBoundary","handled","boundReset","componentDidUpdate","oldId","componentDidCatch","details","useOkta","clientId","baseUrl","nonce","random","substr","client_id","redirect_uri","response_mode","response_type","popup","closed","handleMessage","OktaError","source","idToken","atob","createReducerInjector","onSet","innerScope","reducers","inject","innerScope2","isValidKey","eject","injected","useReducer","mountpoint","remount","injector","withInjectableReducers","createReducer","createStore","store","replaceReducer","createResource","persist","keyFor","resource","updateIn","claimed","Patch","update","silent","Claim","Release","releasedAt","CleanUp","time","__","handleInit","saga","accessResult","getEntry","getIn","selectEntry","getState","patch","updateOk","claim","access","inputMemo","setEntry","prevEntry","unsubscribe","subscribe","newEntry","useSaga","runSaga","running","task","withSaga","sagaMiddleware","sagaMWArgs","composeEnhancers","sentryEnhancer","actionTransformer","password","stateTransformer","Iterable","originalReducer","extracted","middlewares","copyToClipboard","queryCommandSupported","textarea","textContent","appendChild","execCommand","removeChild","fns","unset","combine","handlers","updated","handleActions","handleTransitions","withInitialState","handleResult","createActions","actionCreator","selectLocation","useLocation","useRoute","RouterProvider","mapAction","mkTaker","taker","takeEveryTagged","waitTil","predicate","assertKey","localStorage","getItem","setItem","removeItem","load","_v","printObject","suffixes","numberFormat","Intl","NumberFormat","formatQuantity","renderValue","renderSuffix","log10","min","toFixed","coeff","readableQuantity","readableBytes","trimCenter","maxLength","exhaustive","variants","chooseCase","symbols","variantMap","getVariant","tag","pred","vs","matches","re","matchesField","integer","hexColor","s3Url","composeOr","composeAnd","composeAsync"],"sourceRoot":""}